<!DOCTYPE html>
<html data-init="no-js">
<head>
<meta charset="UTF-8" />
<title>The Mage&#39;s Tower</title>
<meta name="viewport" content="width=device-width,initial-scale=1" />
<!--

SugarCube (v2.36.1): A free (gratis and libre) story format.

Copyright © 2013–2021 Thomas Michael Edwards <thomasmedwards@gmail.com>.
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:

1. Redistributions of source code must retain the above copyright notice, this
   list of conditions and the following disclaimer.
2. Redistributions in binary form must reproduce the above copyright notice,
   this list of conditions and the following disclaimer in the documentation
   and/or other materials provided with the distribution.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR
ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

-->
<script id="script-libraries" type="text/javascript">
if(document.head&&document.addEventListener&&document.querySelector&&Object.create&&Object.freeze&&JSON){document.documentElement.setAttribute("data-init", "loading");
/*! @source http://purl.eligrey.com/github/classList.js/blob/1.2.20171210/classList.js */
"document"in self&&("classList"in document.createElement("_")&&(!document.createElementNS||"classList"in document.createElementNS("http://www.w3.org/2000/svg","g"))||!function(t){"use strict";if("Element"in t){var e="classList",n="prototype",i=t.Element[n],s=Object,r=String[n].trim||function(){return this.replace(/^\s+|\s+$/g,"")},o=Array[n].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1},c=function(t,e){this.name=t,this.code=DOMException[t],this.message=e},a=function(t,e){if(""===e)throw new c("SYNTAX_ERR","The token must not be empty.");if(/\s/.test(e))throw new c("INVALID_CHARACTER_ERR","The token must not contain space characters.");return o.call(t,e)},l=function(t){for(var e=r.call(t.getAttribute("class")||""),n=e?e.split(/\s+/):[],i=0,s=n.length;s>i;i++)this.push(n[i]);this._updateClassName=function(){t.setAttribute("class",this.toString())}},u=l[n]=[],h=function(){return new l(this)};if(c[n]=Error[n],u.item=function(t){return this[t]||null},u.contains=function(t){return~a(this,t+"")},u.add=function(){var t,e=arguments,n=0,i=e.length,s=!1;do t=e[n]+"",~a(this,t)||(this.push(t),s=!0);while(++n<i);s&&this._updateClassName()},u.remove=function(){var t,e,n=arguments,i=0,s=n.length,r=!1;do for(t=n[i]+"",e=a(this,t);~e;)this.splice(e,1),r=!0,e=a(this,t);while(++i<s);r&&this._updateClassName()},u.toggle=function(t,e){var n=this.contains(t),i=n?e!==!0&&"remove":e!==!1&&"add";return i&&this[i](t),e===!0||e===!1?e:!n},u.replace=function(t,e){var n=a(t+"");~n&&(this.splice(n,1,e),this._updateClassName())},u.toString=function(){return this.join(" ")},s.defineProperty){var f={get:h,enumerable:!0,configurable:!0};try{s.defineProperty(i,e,f)}catch(p){void 0!==p.number&&-2146823252!==p.number||(f.enumerable=!1,s.defineProperty(i,e,f))}}else s[n].__defineGetter__&&i.__defineGetter__(e,h)}}(self),function(){"use strict";var t=document.createElement("_");if(t.classList.add("c1","c2"),!t.classList.contains("c2")){var e=function(t){var e=DOMTokenList.prototype[t];DOMTokenList.prototype[t]=function(t){var n,i=arguments.length;for(n=0;i>n;n++)t=arguments[n],e.call(this,t)}};e("add"),e("remove")}if(t.classList.toggle("c3",!1),t.classList.contains("c3")){var n=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(t,e){return 1 in arguments&&!this.contains(t)==!e?e:n.call(this,t)}}"replace"in document.createElement("_").classList||(DOMTokenList.prototype.replace=function(t,e){var n=this.toString().split(" "),i=n.indexOf(t+"");~i&&(n=n.slice(i),this.remove.apply(this,n),this.add(e),this.add.apply(this,n.slice(1)))}),t=null}());
/*!
 * https://github.com/es-shims/es5-shim
 * @license es5-shim Copyright 2009-2020 by contributors, MIT License
 * see https://github.com/es-shims/es5-shim/blob/v4.5.14/LICENSE
 */
(function(t,r){"use strict";if(typeof define==="function"&&define.amd){define(r)}else if(typeof exports==="object"){module.exports=r()}else{t.returnExports=r()}})(this,function(){var t=Array;var r=t.prototype;var e=Object;var n=e.prototype;var i=Function;var a=i.prototype;var o=String;var f=o.prototype;var u=Number;var l=u.prototype;var s=r.slice;var c=r.splice;var v=r.push;var h=r.unshift;var p=r.concat;var y=r.join;var d=a.call;var g=a.apply;var w=Math.max;var b=Math.min;var T=n.toString;var m=typeof Symbol==="function"&&typeof Symbol.toStringTag==="symbol";var D;var S=Function.prototype.toString,x=/^\s*class /,O=function isES6ClassFn(t){try{var r=S.call(t);var e=r.replace(/\/\/.*\n/g,"");var n=e.replace(/\/\*[.\s\S]*\*\//g,"");var i=n.replace(/\n/gm," ").replace(/ {2}/g," ");return x.test(i)}catch(a){return false}},E=function tryFunctionObject(t){try{if(O(t)){return false}S.call(t);return true}catch(r){return false}},j="[object Function]",I="[object GeneratorFunction]",D=function isCallable(t){if(!t){return false}if(typeof t!=="function"&&typeof t!=="object"){return false}if(m){return E(t)}if(O(t)){return false}var r=T.call(t);return r===j||r===I};var M;var U=RegExp.prototype.exec,$=function tryRegexExec(t){try{U.call(t);return true}catch(r){return false}},F="[object RegExp]";M=function isRegex(t){if(typeof t!=="object"){return false}return m?$(t):T.call(t)===F};var N;var C=String.prototype.valueOf,k=function tryStringObject(t){try{C.call(t);return true}catch(r){return false}},A="[object String]";N=function isString(t){if(typeof t==="string"){return true}if(typeof t!=="object"){return false}return m?k(t):T.call(t)===A};var R=e.defineProperty&&function(){try{var t={};e.defineProperty(t,"x",{enumerable:false,value:t});for(var r in t){return false}return t.x===t}catch(n){return false}}();var P=function(t){var r;if(R){r=function(t,r,n,i){if(!i&&r in t){return}e.defineProperty(t,r,{configurable:true,enumerable:false,writable:true,value:n})}}else{r=function(t,r,e,n){if(!n&&r in t){return}t[r]=e}}return function defineProperties(e,n,i){for(var a in n){if(t.call(n,a)){r(e,a,n[a],i)}}}}(n.hasOwnProperty);var J=function isPrimitive(t){var r=typeof t;return t===null||r!=="object"&&r!=="function"};var Y=u.isNaN||function isActualNaN(t){return t!==t};var z={ToInteger:function ToInteger(t){var r=+t;if(Y(r)){r=0}else if(r!==0&&r!==1/0&&r!==-(1/0)){r=(r>0||-1)*Math.floor(Math.abs(r))}return r},ToPrimitive:function ToPrimitive(t){var r,e,n;if(J(t)){return t}e=t.valueOf;if(D(e)){r=e.call(t);if(J(r)){return r}}n=t.toString;if(D(n)){r=n.call(t);if(J(r)){return r}}throw new TypeError},ToObject:function(t){if(t==null){throw new TypeError("can't convert "+t+" to object")}return e(t)},ToUint32:function ToUint32(t){return t>>>0}};var Z=function Empty(){};P(a,{bind:function bind(t){var r=this;if(!D(r)){throw new TypeError("Function.prototype.bind called on incompatible "+r)}var n=s.call(arguments,1);var a;var o=function(){if(this instanceof a){var i=g.call(r,this,p.call(n,s.call(arguments)));if(e(i)===i){return i}return this}else{return g.call(r,t,p.call(n,s.call(arguments)))}};var f=w(0,r.length-n.length);var u=[];for(var l=0;l<f;l++){v.call(u,"$"+l)}a=i("binder","return function ("+y.call(u,",")+"){ return binder.apply(this, arguments); }")(o);if(r.prototype){Z.prototype=r.prototype;a.prototype=new Z;Z.prototype=null}return a}});var G=d.bind(n.hasOwnProperty);var H=d.bind(n.toString);var W=d.bind(s);var B=g.bind(s);if(typeof document==="object"&&document&&document.documentElement){try{W(document.documentElement.childNodes)}catch(X){var L=W;var q=B;W=function arraySliceIE(t){var r=[];var e=t.length;while(e-- >0){r[e]=t[e]}return q(r,L(arguments,1))};B=function arraySliceApplyIE(t,r){return q(W(t),r)}}}var K=d.bind(f.slice);var Q=d.bind(f.split);var V=d.bind(f.indexOf);var _=d.bind(v);var tt=d.bind(n.propertyIsEnumerable);var rt=d.bind(r.sort);var et=t.isArray||function isArray(t){return H(t)==="[object Array]"};var nt=[].unshift(0)!==1;P(r,{unshift:function(){h.apply(this,arguments);return this.length}},nt);P(t,{isArray:et});var it=e("a");var at=it[0]!=="a"||!(0 in it);var ot=function properlyBoxed(t){var r=true;var e=true;var n=false;if(t){try{t.call("foo",function(t,e,n){if(typeof n!=="object"){r=false}});t.call([1],function(){"use strict";e=typeof this==="string"},"x")}catch(i){n=true}}return!!t&&!n&&r&&e};P(r,{forEach:function forEach(t){var r=z.ToObject(this);var e=at&&N(this)?Q(this,""):r;var n=-1;var i=z.ToUint32(e.length);var a;if(arguments.length>1){a=arguments[1]}if(!D(t)){throw new TypeError("Array.prototype.forEach callback must be a function")}while(++n<i){if(n in e){if(typeof a==="undefined"){t(e[n],n,r)}else{t.call(a,e[n],n,r)}}}}},!ot(r.forEach));P(r,{map:function map(r){var e=z.ToObject(this);var n=at&&N(this)?Q(this,""):e;var i=z.ToUint32(n.length);var a=t(i);var o;if(arguments.length>1){o=arguments[1]}if(!D(r)){throw new TypeError("Array.prototype.map callback must be a function")}for(var f=0;f<i;f++){if(f in n){if(typeof o==="undefined"){a[f]=r(n[f],f,e)}else{a[f]=r.call(o,n[f],f,e)}}}return a}},!ot(r.map));P(r,{filter:function filter(t){var r=z.ToObject(this);var e=at&&N(this)?Q(this,""):r;var n=z.ToUint32(e.length);var i=[];var a;var o;if(arguments.length>1){o=arguments[1]}if(!D(t)){throw new TypeError("Array.prototype.filter callback must be a function")}for(var f=0;f<n;f++){if(f in e){a=e[f];if(typeof o==="undefined"?t(a,f,r):t.call(o,a,f,r)){_(i,a)}}}return i}},!ot(r.filter));P(r,{every:function every(t){var r=z.ToObject(this);var e=at&&N(this)?Q(this,""):r;var n=z.ToUint32(e.length);var i;if(arguments.length>1){i=arguments[1]}if(!D(t)){throw new TypeError("Array.prototype.every callback must be a function")}for(var a=0;a<n;a++){if(a in e&&!(typeof i==="undefined"?t(e[a],a,r):t.call(i,e[a],a,r))){return false}}return true}},!ot(r.every));P(r,{some:function some(t){var r=z.ToObject(this);var e=at&&N(this)?Q(this,""):r;var n=z.ToUint32(e.length);var i;if(arguments.length>1){i=arguments[1]}if(!D(t)){throw new TypeError("Array.prototype.some callback must be a function")}for(var a=0;a<n;a++){if(a in e&&(typeof i==="undefined"?t(e[a],a,r):t.call(i,e[a],a,r))){return true}}return false}},!ot(r.some));var ft=false;if(r.reduce){ft=typeof r.reduce.call("es5",function(t,r,e,n){return n})==="object"}P(r,{reduce:function reduce(t){var r=z.ToObject(this);var e=at&&N(this)?Q(this,""):r;var n=z.ToUint32(e.length);if(!D(t)){throw new TypeError("Array.prototype.reduce callback must be a function")}if(n===0&&arguments.length===1){throw new TypeError("reduce of empty array with no initial value")}var i=0;var a;if(arguments.length>=2){a=arguments[1]}else{do{if(i in e){a=e[i++];break}if(++i>=n){throw new TypeError("reduce of empty array with no initial value")}}while(true)}for(;i<n;i++){if(i in e){a=t(a,e[i],i,r)}}return a}},!ft);var ut=false;if(r.reduceRight){ut=typeof r.reduceRight.call("es5",function(t,r,e,n){return n})==="object"}P(r,{reduceRight:function reduceRight(t){var r=z.ToObject(this);var e=at&&N(this)?Q(this,""):r;var n=z.ToUint32(e.length);if(!D(t)){throw new TypeError("Array.prototype.reduceRight callback must be a function")}if(n===0&&arguments.length===1){throw new TypeError("reduceRight of empty array with no initial value")}var i;var a=n-1;if(arguments.length>=2){i=arguments[1]}else{do{if(a in e){i=e[a--];break}if(--a<0){throw new TypeError("reduceRight of empty array with no initial value")}}while(true)}if(a<0){return i}do{if(a in e){i=t(i,e[a],a,r)}}while(a--);return i}},!ut);var lt=r.indexOf&&[0,1].indexOf(1,2)!==-1;P(r,{indexOf:function indexOf(t){var r=at&&N(this)?Q(this,""):z.ToObject(this);var e=z.ToUint32(r.length);if(e===0){return-1}var n=0;if(arguments.length>1){n=z.ToInteger(arguments[1])}n=n>=0?n:w(0,e+n);for(;n<e;n++){if(n in r&&r[n]===t){return n}}return-1}},lt);var st=r.lastIndexOf&&[0,1].lastIndexOf(0,-3)!==-1;P(r,{lastIndexOf:function lastIndexOf(t){var r=at&&N(this)?Q(this,""):z.ToObject(this);var e=z.ToUint32(r.length);if(e===0){return-1}var n=e-1;if(arguments.length>1){n=b(n,z.ToInteger(arguments[1]))}n=n>=0?n:e-Math.abs(n);for(;n>=0;n--){if(n in r&&t===r[n]){return n}}return-1}},st);var ct=function(){var t=[1,2];var r=t.splice();return t.length===2&&et(r)&&r.length===0}();P(r,{splice:function splice(t,r){if(arguments.length===0){return[]}else{return c.apply(this,arguments)}}},!ct);var vt=function(){var t={};r.splice.call(t,0,0,1);return t.length===1}();P(r,{splice:function splice(t,r){if(arguments.length===0){return[]}var e=arguments;this.length=w(z.ToInteger(this.length),0);if(arguments.length>0&&typeof r!=="number"){e=W(arguments);if(e.length<2){_(e,this.length-t)}else{e[1]=z.ToInteger(r)}}return c.apply(this,e)}},!vt);var ht=function(){var r=new t(1e5);r[8]="x";r.splice(1,1);return r.indexOf("x")===7}();var pt=function(){var t=256;var r=[];r[t]="a";r.splice(t+1,0,"b");return r[t]==="a"}();P(r,{splice:function splice(t,r){var e=z.ToObject(this);var n=[];var i=z.ToUint32(e.length);var a=z.ToInteger(t);var f=a<0?w(i+a,0):b(a,i);var u=arguments.length===0?0:arguments.length===1?i-f:b(w(z.ToInteger(r),0),i-f);var l=0;var s;while(l<u){s=o(f+l);if(G(e,s)){n[l]=e[s]}l+=1}var c=W(arguments,2);var v=c.length;var h;if(v<u){l=f;var p=i-u;while(l<p){s=o(l+u);h=o(l+v);if(G(e,s)){e[h]=e[s]}else{delete e[h]}l+=1}l=i;var y=i-u+v;while(l>y){delete e[l-1];l-=1}}else if(v>u){l=i-u;while(l>f){s=o(l+u-1);h=o(l+v-1);if(G(e,s)){e[h]=e[s]}else{delete e[h]}l-=1}}l=f;for(var d=0;d<c.length;++d){e[l]=c[d];l+=1}e.length=i-u+v;return n}},!ht||!pt);var yt=r.join;var dt;try{dt=Array.prototype.join.call("123",",")!=="1,2,3"}catch(X){dt=true}if(dt){P(r,{join:function join(t){var r=typeof t==="undefined"?",":t;return yt.call(N(this)?Q(this,""):this,r)}},dt)}var gt=[1,2].join(undefined)!=="1,2";if(gt){P(r,{join:function join(t){var r=typeof t==="undefined"?",":t;return yt.call(this,r)}},gt)}var wt=function push(t){var r=z.ToObject(this);var e=z.ToUint32(r.length);var n=0;while(n<arguments.length){r[e+n]=arguments[n];n+=1}r.length=e+n;return e+n};var bt=function(){var t={};var r=Array.prototype.push.call(t,undefined);return r!==1||t.length!==1||typeof t[0]!=="undefined"||!G(t,0)}();P(r,{push:function push(t){if(et(this)){return v.apply(this,arguments)}return wt.apply(this,arguments)}},bt);var Tt=function(){var t=[];var r=t.push(undefined);return r!==1||t.length!==1||typeof t[0]!=="undefined"||!G(t,0)}();P(r,{push:wt},Tt);P(r,{slice:function(t,r){var e=N(this)?Q(this,""):this;return B(e,arguments)}},at);var mt=function(){try{[1,2].sort(null)}catch(t){try{[1,2].sort({})}catch(r){return false}}return true}();var Dt=function(){try{[1,2].sort(/a/);return false}catch(t){}return true}();var St=function(){try{[1,2].sort(undefined);return true}catch(t){}return false}();P(r,{sort:function sort(t){if(typeof t==="undefined"){return rt(this)}if(!D(t)){throw new TypeError("Array.prototype.sort callback must be a function")}return rt(this,t)}},mt||!St||!Dt);var xt=!tt({toString:null},"toString");var Ot=tt(function(){},"prototype");var Et=!G("x","0");var jt=function(t){var r=t.constructor;return r&&r.prototype===t};var It={$applicationCache:true,$console:true,$external:true,$frame:true,$frameElement:true,$frames:true,$innerHeight:true,$innerWidth:true,$onmozfullscreenchange:true,$onmozfullscreenerror:true,$outerHeight:true,$outerWidth:true,$pageXOffset:true,$pageYOffset:true,$parent:true,$scrollLeft:true,$scrollTop:true,$scrollX:true,$scrollY:true,$self:true,$webkitIndexedDB:true,$webkitStorageInfo:true,$window:true,$width:true,$height:true,$top:true,$localStorage:true};var Mt=function(){if(typeof window==="undefined"){return false}for(var t in window){try{if(!It["$"+t]&&G(window,t)&&window[t]!==null&&typeof window[t]==="object"){jt(window[t])}}catch(r){return true}}return false}();var Ut=function(t){if(typeof window==="undefined"||!Mt){return jt(t)}try{return jt(t)}catch(r){return false}};var $t=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];var Ft=$t.length;var Nt=function isArguments(t){return H(t)==="[object Arguments]"};var Ct=function isArguments(t){return t!==null&&typeof t==="object"&&typeof t.length==="number"&&t.length>=0&&!et(t)&&D(t.callee)};var kt=Nt(arguments)?Nt:Ct;P(e,{keys:function keys(t){var r=D(t);var e=kt(t);var n=t!==null&&typeof t==="object";var i=n&&N(t);if(!n&&!r&&!e){throw new TypeError("Object.keys called on a non-object")}var a=[];var f=Ot&&r;if(i&&Et||e){for(var u=0;u<t.length;++u){_(a,o(u))}}if(!e){for(var l in t){if(!(f&&l==="prototype")&&G(t,l)){_(a,o(l))}}}if(xt){var s=Ut(t);for(var c=0;c<Ft;c++){var v=$t[c];if(!(s&&v==="constructor")&&G(t,v)){_(a,v)}}}return a}});var At=e.keys&&function(){return e.keys(arguments).length===2}(1,2);var Rt=e.keys&&function(){var t=e.keys(arguments);return arguments.length!==1||t.length!==1||t[0]!==1}(1);var Pt=e.keys;P(e,{keys:function keys(t){if(kt(t)){return Pt(W(t))}else{return Pt(t)}}},!At||Rt);var Jt=new Date(-0xc782b5b342b24).getUTCMonth()!==0;var Yt=new Date(-0x55d318d56a724);var zt=new Date(14496624e5);var Zt=Yt.toUTCString()!=="Mon, 01 Jan -45875 11:59:59 GMT";var Gt;var Ht;var Wt=Yt.getTimezoneOffset();if(Wt<-720){Gt=Yt.toDateString()!=="Tue Jan 02 -45875";Ht=!/^Thu Dec 10 2015 \d\d:\d\d:\d\d GMT[-+]\d\d\d\d(?: |$)/.test(String(zt))}else{Gt=Yt.toDateString()!=="Mon Jan 01 -45875";Ht=!/^Wed Dec 09 2015 \d\d:\d\d:\d\d GMT[-+]\d\d\d\d(?: |$)/.test(String(zt))}var Bt=d.bind(Date.prototype.getFullYear);var Xt=d.bind(Date.prototype.getMonth);var Lt=d.bind(Date.prototype.getDate);var qt=d.bind(Date.prototype.getUTCFullYear);var Kt=d.bind(Date.prototype.getUTCMonth);var Qt=d.bind(Date.prototype.getUTCDate);var Vt=d.bind(Date.prototype.getUTCDay);var _t=d.bind(Date.prototype.getUTCHours);var tr=d.bind(Date.prototype.getUTCMinutes);var rr=d.bind(Date.prototype.getUTCSeconds);var er=d.bind(Date.prototype.getUTCMilliseconds);var nr=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];var ir=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var ar=function daysInMonth(t,r){return Lt(new Date(r,t,0))};P(Date.prototype,{getFullYear:function getFullYear(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=Bt(this);if(t<0&&Xt(this)>11){return t+1}return t},getMonth:function getMonth(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=Bt(this);var r=Xt(this);if(t<0&&r>11){return 0}return r},getDate:function getDate(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=Bt(this);var r=Xt(this);var e=Lt(this);if(t<0&&r>11){if(r===12){return e}var n=ar(0,t+1);return n-e+1}return e},getUTCFullYear:function getUTCFullYear(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=qt(this);if(t<0&&Kt(this)>11){return t+1}return t},getUTCMonth:function getUTCMonth(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=qt(this);var r=Kt(this);if(t<0&&r>11){return 0}return r},getUTCDate:function getUTCDate(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=qt(this);var r=Kt(this);var e=Qt(this);if(t<0&&r>11){if(r===12){return e}var n=ar(0,t+1);return n-e+1}return e}},Jt);P(Date.prototype,{toUTCString:function toUTCString(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=Vt(this);var r=Qt(this);var e=Kt(this);var n=qt(this);var i=_t(this);var a=tr(this);var o=rr(this);return nr[t]+", "+(r<10?"0"+r:r)+" "+ir[e]+" "+n+" "+(i<10?"0"+i:i)+":"+(a<10?"0"+a:a)+":"+(o<10?"0"+o:o)+" GMT"}},Jt||Zt);P(Date.prototype,{toDateString:function toDateString(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=this.getDay();var r=this.getDate();var e=this.getMonth();var n=this.getFullYear();return nr[t]+" "+ir[e]+" "+(r<10?"0"+r:r)+" "+n}},Jt||Gt);if(Jt||Ht){Date.prototype.toString=function toString(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=this.getDay();var r=this.getDate();var e=this.getMonth();var n=this.getFullYear();var i=this.getHours();var a=this.getMinutes();var o=this.getSeconds();var f=this.getTimezoneOffset();var u=Math.floor(Math.abs(f)/60);var l=Math.floor(Math.abs(f)%60);return nr[t]+" "+ir[e]+" "+(r<10?"0"+r:r)+" "+n+" "+(i<10?"0"+i:i)+":"+(a<10?"0"+a:a)+":"+(o<10?"0"+o:o)+" GMT"+(f>0?"-":"+")+(u<10?"0"+u:u)+(l<10?"0"+l:l)};if(R){e.defineProperty(Date.prototype,"toString",{configurable:true,enumerable:false,writable:true})}}var or=-621987552e5;var fr="-000001";var ur=Date.prototype.toISOString&&new Date(or).toISOString().indexOf(fr)===-1;var lr=Date.prototype.toISOString&&new Date(-1).toISOString()!=="1969-12-31T23:59:59.999Z";var sr=d.bind(Date.prototype.getTime);P(Date.prototype,{toISOString:function toISOString(){if(!isFinite(this)||!isFinite(sr(this))){throw new RangeError("Date.prototype.toISOString called on non-finite value.")}var t=qt(this);var r=Kt(this);t+=Math.floor(r/12);r=(r%12+12)%12;var e=[r+1,Qt(this),_t(this),tr(this),rr(this)];t=(t<0?"-":t>9999?"+":"")+K("00000"+Math.abs(t),0<=t&&t<=9999?-4:-6);for(var n=0;n<e.length;++n){e[n]=K("00"+e[n],-2)}return t+"-"+W(e,0,2).join("-")+"T"+W(e,2).join(":")+"."+K("000"+er(this),-3)+"Z"}},ur||lr);var cr=function(){try{return Date.prototype.toJSON&&new Date(NaN).toJSON()===null&&new Date(or).toJSON().indexOf(fr)!==-1&&Date.prototype.toJSON.call({toISOString:function(){return true}})}catch(t){return false}}();if(!cr){Date.prototype.toJSON=function toJSON(t){var r=e(this);var n=z.ToPrimitive(r);if(typeof n==="number"&&!isFinite(n)){return null}var i=r.toISOString;if(!D(i)){throw new TypeError("toISOString property is not callable")}return i.call(r)}}var vr=Date.parse("+033658-09-27T01:46:40.000Z")===1e15;var hr=!isNaN(Date.parse("2012-04-04T24:00:00.500Z"))||!isNaN(Date.parse("2012-11-31T23:59:59.000Z"))||!isNaN(Date.parse("2012-12-31T23:59:60.000Z"));var pr=isNaN(Date.parse("2000-01-01T00:00:00.000Z"));if(pr||hr||!vr){var yr=Math.pow(2,31)-1;var dr=Y(new Date(1970,0,1,0,0,0,yr+1).getTime());Date=function(t){var r=function Date(e,n,i,a,f,u,l){var s=arguments.length;var c;if(this instanceof t){var v=u;var h=l;if(dr&&s>=7&&l>yr){var p=Math.floor(l/yr)*yr;var y=Math.floor(p/1e3);v+=y;h-=y*1e3}c=s===1&&o(e)===e?new t(r.parse(e)):s>=7?new t(e,n,i,a,f,v,h):s>=6?new t(e,n,i,a,f,v):s>=5?new t(e,n,i,a,f):s>=4?new t(e,n,i,a):s>=3?new t(e,n,i):s>=2?new t(e,n):s>=1?new t(e instanceof t?+e:e):new t}else{c=t.apply(this,arguments)}if(!J(c)){P(c,{constructor:r},true)}return c};var e=new RegExp("^"+"(\\d{4}|[+-]\\d{6})"+"(?:-(\\d{2})"+"(?:-(\\d{2})"+"(?:"+"T(\\d{2})"+":(\\d{2})"+"(?:"+":(\\d{2})"+"(?:(\\.\\d{1,}))?"+")?"+"("+"Z|"+"(?:"+"([-+])"+"(\\d{2})"+":(\\d{2})"+")"+")?)?)?)?"+"$");var n=[0,31,59,90,120,151,181,212,243,273,304,334,365];var i=function dayFromMonth(t,r){var e=r>1?1:0;return n[r]+Math.floor((t-1969+e)/4)-Math.floor((t-1901+e)/100)+Math.floor((t-1601+e)/400)+365*(t-1970)};var a=function toUTC(r){var e=0;var n=r;if(dr&&n>yr){var i=Math.floor(n/yr)*yr;var a=Math.floor(i/1e3);e+=a;n-=a*1e3}return u(new t(1970,0,1,0,0,e,n))};for(var f in t){if(G(t,f)){r[f]=t[f]}}P(r,{now:t.now,UTC:t.UTC},true);r.prototype=t.prototype;P(r.prototype,{constructor:r},true);var l=function parse(r){var n=e.exec(r);if(n){var o=u(n[1]),f=u(n[2]||1)-1,l=u(n[3]||1)-1,s=u(n[4]||0),c=u(n[5]||0),v=u(n[6]||0),h=Math.floor(u(n[7]||0)*1e3),p=Boolean(n[4]&&!n[8]),y=n[9]==="-"?1:-1,d=u(n[10]||0),g=u(n[11]||0),w;var b=c>0||v>0||h>0;if(s<(b?24:25)&&c<60&&v<60&&h<1e3&&f>-1&&f<12&&d<24&&g<60&&l>-1&&l<i(o,f+1)-i(o,f)){w=((i(o,f)+l)*24+s+d*y)*60;w=((w+c+g*y)*60+v)*1e3+h;if(p){w=a(w)}if(-864e13<=w&&w<=864e13){return w}}return NaN}return t.parse.apply(this,arguments)};P(r,{parse:l});return r}(Date)}if(!Date.now){Date.now=function now(){return(new Date).getTime()}}var gr=l.toFixed&&(8e-5.toFixed(3)!=="0.000"||.9.toFixed(0)!=="1"||1.255.toFixed(2)!=="1.25"||(1000000000000000128).toFixed(0)!=="1000000000000000128");var wr={base:1e7,size:6,data:[0,0,0,0,0,0],multiply:function multiply(t,r){var e=-1;var n=r;while(++e<wr.size){n+=t*wr.data[e];wr.data[e]=n%wr.base;n=Math.floor(n/wr.base)}},divide:function divide(t){var r=wr.size;var e=0;while(--r>=0){e+=wr.data[r];wr.data[r]=Math.floor(e/t);e=e%t*wr.base}},numToString:function numToString(){var t=wr.size;var r="";while(--t>=0){if(r!==""||t===0||wr.data[t]!==0){var e=o(wr.data[t]);if(r===""){r=e}else{r+=K("0000000",0,7-e.length)+e}}}return r},pow:function pow(t,r,e){return r===0?e:r%2===1?pow(t,r-1,e*t):pow(t*t,r/2,e)},log:function log(t){var r=0;var e=t;while(e>=4096){r+=12;e/=4096}while(e>=2){r+=1;e/=2}return r}};var br=function toFixed(t){var r,e,n,i,a,f,l,s;r=u(t);r=Y(r)?0:Math.floor(r);if(r<0||r>20){throw new RangeError("Number.toFixed called with invalid number of decimals")}e=u(this);if(Y(e)){return"NaN"}if(e<=-1e21||e>=1e21){return o(e)}n="";if(e<0){n="-";e=-e}i="0";if(e>1e-21){a=wr.log(e*wr.pow(2,69,1))-69;f=a<0?e*wr.pow(2,-a,1):e/wr.pow(2,a,1);f*=4503599627370496;a=52-a;if(a>0){wr.multiply(0,f);l=r;while(l>=7){wr.multiply(1e7,0);l-=7}wr.multiply(wr.pow(10,l,1),0);l=a-1;while(l>=23){wr.divide(1<<23);l-=23}wr.divide(1<<l);wr.multiply(1,1);wr.divide(2);i=wr.numToString()}else{wr.multiply(0,f);wr.multiply(1<<-a,0);i=wr.numToString()+K("0.00000000000000000000",2,2+r)}}if(r>0){s=i.length;if(s<=r){i=n+K("0.0000000000000000000",0,r-s+2)+i}else{i=n+K(i,0,s-r)+"."+K(i,s-r)}}else{i=n+i}return i};P(l,{toFixed:br},gr);var Tr=function(){try{return 1..toPrecision(undefined)==="1"}catch(t){return true}}();var mr=l.toPrecision;P(l,{toPrecision:function toPrecision(t){return typeof t==="undefined"?mr.call(this):mr.call(this,t)}},Tr);if("ab".split(/(?:ab)*/).length!==2||".".split(/(.?)(.?)/).length!==4||"tesst".split(/(s)*/)[1]==="t"||"test".split(/(?:)/,-1).length!==4||"".split(/.?/).length||".".split(/()()/).length>1){(function(){var t=typeof/()??/.exec("")[1]==="undefined";var r=Math.pow(2,32)-1;f.split=function(e,n){var i=String(this);if(typeof e==="undefined"&&n===0){return[]}if(!M(e)){return Q(this,e,n)}var a=[];var o=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),f=0,u,l,s,c;var h=new RegExp(e.source,o+"g");if(!t){u=new RegExp("^"+h.source+"$(?!\\s)",o)}var p=typeof n==="undefined"?r:z.ToUint32(n);l=h.exec(i);while(l){s=l.index+l[0].length;if(s>f){_(a,K(i,f,l.index));if(!t&&l.length>1){l[0].replace(u,function(){for(var t=1;t<arguments.length-2;t++){if(typeof arguments[t]==="undefined"){l[t]=void 0}}})}if(l.length>1&&l.index<i.length){v.apply(a,W(l,1))}c=l[0].length;f=s;if(a.length>=p){break}}if(h.lastIndex===l.index){h.lastIndex++}l=h.exec(i)}if(f===i.length){if(c||!h.test("")){_(a,"")}}else{_(a,K(i,f))}return a.length>p?W(a,0,p):a}})()}else if("0".split(void 0,0).length){f.split=function split(t,r){if(typeof t==="undefined"&&r===0){return[]}return Q(this,t,r)}}var Dr=f.replace;var Sr=function(){var t=[];"x".replace(/x(.)?/g,function(r,e){_(t,e)});return t.length===1&&typeof t[0]==="undefined"}();if(!Sr){f.replace=function replace(t,r){var e=D(r);var n=M(t)&&/\)[*?]/.test(t.source);if(!e||!n){return Dr.call(this,t,r)}else{var i=function(e){var n=arguments.length;var i=t.lastIndex;t.lastIndex=0;var a=t.exec(e)||[];t.lastIndex=i;_(a,arguments[n-2],arguments[n-1]);return r.apply(this,a)};return Dr.call(this,t,i)}}}var xr=f.substr;var Or="".substr&&"0b".substr(-1)!=="b";P(f,{substr:function substr(t,r){var e=t;if(t<0){e=w(this.length+t,0)}return xr.call(this,e,r)}},Or);var Er="\t\n\x0B\f\r \xa0\u1680\u2000\u2001\u2002\u2003"+"\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028"+"\u2029\ufeff";var jr="\u200b";var Ir="["+Er+"]";var Mr=new RegExp("^"+Ir+Ir+"*");var Ur=new RegExp(Ir+Ir+"*$");var $r=f.trim&&(Er.trim()||!jr.trim());P(f,{trim:function trim(){if(typeof this==="undefined"||this===null){throw new TypeError("can't convert "+this+" to object")}return o(this).replace(Mr,"").replace(Ur,"")}},$r);var Fr=d.bind(String.prototype.trim);var Nr=f.lastIndexOf&&"abc\u3042\u3044".lastIndexOf("\u3042\u3044",2)!==-1;P(f,{lastIndexOf:function lastIndexOf(t){if(typeof this==="undefined"||this===null){throw new TypeError("can't convert "+this+" to object")}var r=o(this);var e=o(t);var n=arguments.length>1?u(arguments[1]):NaN;var i=Y(n)?Infinity:z.ToInteger(n);var a=b(w(i,0),r.length);var f=e.length;var l=a+f;while(l>0){l=w(0,l-f);var s=V(K(r,l,a+f),e);if(s!==-1){return l+s}}return-1}},Nr);var Cr=f.lastIndexOf;P(f,{lastIndexOf:function lastIndexOf(t){return Cr.apply(this,arguments)}},f.lastIndexOf.length!==1);if(parseInt(Er+"08")!==8||parseInt(Er+"0x16")!==22){parseInt=function(t){var r=/^[-+]?0[xX]/;return function parseInt(e,n){if(typeof e==="symbol"){""+e}var i=Fr(String(e));var a=u(n)||(r.test(i)?16:10);return t(i,a)}}(parseInt)}if(1/parseFloat("-0")!==-Infinity){parseFloat=function(t){return function parseFloat(r){var e=Fr(String(r));var n=t(e);return n===0&&K(e,0,1)==="-"?-0:n}}(parseFloat)}if(String(new RangeError("test"))!=="RangeError: test"){var kr=function toString(){if(typeof this==="undefined"||this===null){throw new TypeError("can't convert "+this+" to object")}var t=this.name;if(typeof t==="undefined"){t="Error"}else if(typeof t!=="string"){t=o(t)}var r=this.message;if(typeof r==="undefined"){r=""}else if(typeof r!=="string"){r=o(r)}if(!t){return r}if(!r){return t}return t+": "+r};Error.prototype.toString=kr}if(R){var Ar=function(t,r){if(tt(t,r)){var e=Object.getOwnPropertyDescriptor(t,r);if(e.configurable){e.enumerable=false;Object.defineProperty(t,r,e)}}};Ar(Error.prototype,"message");if(Error.prototype.message!==""){Error.prototype.message=""}Ar(Error.prototype,"name")}if(String(/a/gim)!=="/a/gim"){var Rr=function toString(){var t="/"+this.source+"/";if(this.global){t+="g"}if(this.ignoreCase){t+="i"}if(this.multiline){t+="m"}return t};RegExp.prototype.toString=Rr}});
/*!
 * https://github.com/paulmillr/es6-shim
 * @license es6-shim Copyright 2013-2016 by Paul Miller (http://paulmillr.com)
 *   and contributors,  MIT License
 * es6-shim: v0.35.4
 * see https://github.com/paulmillr/es6-shim/blob/0.35.4/LICENSE
 * Details and documentation:
 * https://github.com/paulmillr/es6-shim/
 */
(function(e,t){if(typeof define==="function"&&define.amd){define(t)}else if(typeof exports==="object"){module.exports=t()}else{e.returnExports=t()}})(this,function(){"use strict";var e=Function.call.bind(Function.apply);var t=Function.call.bind(Function.call);var r=Array.isArray;var n=Object.keys;var o=function notThunker(t){return function notThunk(){return!e(t,this,arguments)}};var i=function(e){try{e();return false}catch(t){return true}};var a=function valueOrFalseIfThrows(e){try{return e()}catch(t){return false}};var u=o(i);var f=function(){return!i(function(){return Object.defineProperty({},"x",{get:function(){}})})};var s=!!Object.defineProperty&&f();var c=function foo(){}.name==="foo";var l=Function.call.bind(Array.prototype.forEach);var p=Function.call.bind(Array.prototype.reduce);var v=Function.call.bind(Array.prototype.filter);var y=Function.call.bind(Array.prototype.some);var h=function(e,t,r,n){if(!n&&t in e){return}if(s){Object.defineProperty(e,t,{configurable:true,enumerable:false,writable:true,value:r})}else{e[t]=r}};var b=function(e,t,r){l(n(t),function(n){var o=t[n];h(e,n,o,!!r)})};var g=Function.call.bind(Object.prototype.toString);var d=typeof/abc/==="function"?function IsCallableSlow(e){return typeof e==="function"&&g(e)==="[object Function]"}:function IsCallableFast(e){return typeof e==="function"};var m={getter:function(e,t,r){if(!s){throw new TypeError("getters require true ES5 support")}Object.defineProperty(e,t,{configurable:true,enumerable:false,get:r})},proxy:function(e,t,r){if(!s){throw new TypeError("getters require true ES5 support")}var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,{configurable:n.configurable,enumerable:n.enumerable,get:function getKey(){return e[t]},set:function setKey(r){e[t]=r}})},redefine:function(e,t,r){if(s){var n=Object.getOwnPropertyDescriptor(e,t);n.value=r;Object.defineProperty(e,t,n)}else{e[t]=r}},defineByDescriptor:function(e,t,r){if(s){Object.defineProperty(e,t,r)}else if("value"in r){e[t]=r.value}},preserveToString:function(e,t){if(t&&d(t.toString)){h(e,"toString",t.toString.bind(t),true)}}};var O=Object.create||function(e,t){var r=function Prototype(){};r.prototype=e;var o=new r;if(typeof t!=="undefined"){n(t).forEach(function(e){m.defineByDescriptor(o,e,t[e])})}return o};var w=function(e,t){if(!Object.setPrototypeOf){return false}return a(function(){var r=function Subclass(t){var r=new e(t);Object.setPrototypeOf(r,Subclass.prototype);return r};Object.setPrototypeOf(r,e);r.prototype=O(e.prototype,{constructor:{value:r}});return t(r)})};var j=function(){if(typeof self!=="undefined"){return self}if(typeof window!=="undefined"){return window}if(typeof global!=="undefined"){return global}throw new Error("unable to locate global object")};var S=j();var T=S.isFinite;var I=Function.call.bind(String.prototype.indexOf);var E=Function.apply.bind(Array.prototype.indexOf);var P=Function.call.bind(Array.prototype.concat);var C=Function.call.bind(String.prototype.slice);var M=Function.call.bind(Array.prototype.push);var x=Function.apply.bind(Array.prototype.push);var N=Function.call.bind(Array.prototype.shift);var A=Math.max;var R=Math.min;var _=Math.floor;var k=Math.abs;var L=Math.exp;var F=Math.log;var D=Math.sqrt;var z=Function.call.bind(Object.prototype.hasOwnProperty);var q;var W=function(){};var G=S.Map;var H=G&&G.prototype["delete"];var V=G&&G.prototype.get;var B=G&&G.prototype.has;var U=G&&G.prototype.set;var $=S.Symbol||{};var J=$.species||"@@species";var X=Number.isNaN||function isNaN(e){return e!==e};var K=Number.isFinite||function isFinite(e){return typeof e==="number"&&T(e)};var Z=d(Math.sign)?Math.sign:function sign(e){var t=Number(e);if(t===0){return t}if(X(t)){return t}return t<0?-1:1};var Y=function log1p(e){var t=Number(e);if(t<-1||X(t)){return NaN}if(t===0||t===Infinity){return t}if(t===-1){return-Infinity}return 1+t-1===0?t:t*(F(1+t)/(1+t-1))};var Q=function isArguments(e){return g(e)==="[object Arguments]"};var ee=function isArguments(e){return e!==null&&typeof e==="object"&&typeof e.length==="number"&&e.length>=0&&g(e)!=="[object Array]"&&g(e.callee)==="[object Function]"};var te=Q(arguments)?Q:ee;var re={primitive:function(e){return e===null||typeof e!=="function"&&typeof e!=="object"},string:function(e){return g(e)==="[object String]"},regex:function(e){return g(e)==="[object RegExp]"},symbol:function(e){return typeof S.Symbol==="function"&&typeof e==="symbol"}};var ne=function overrideNative(e,t,r){var n=e[t];h(e,t,r,true);m.preserveToString(e[t],n)};var oe=typeof $==="function"&&typeof $["for"]==="function"&&re.symbol($());var ie=re.symbol($.iterator)?$.iterator:"_es6-shim iterator_";if(S.Set&&typeof(new S.Set)["@@iterator"]==="function"){ie="@@iterator"}if(!S.Reflect){h(S,"Reflect",{},true)}var ae=S.Reflect;var ue=String;var fe=typeof document==="undefined"||!document?null:document.all;var se=fe==null?function isNullOrUndefined(e){return e==null}:function isNullOrUndefinedAndNotDocumentAll(e){return e==null&&e!==fe};var ce={Call:function Call(t,r){var n=arguments.length>2?arguments[2]:[];if(!ce.IsCallable(t)){throw new TypeError(t+" is not a function")}return e(t,r,n)},RequireObjectCoercible:function(e,t){if(se(e)){throw new TypeError(t||"Cannot call method on "+e)}return e},TypeIsObject:function(e){if(e===void 0||e===null||e===true||e===false){return false}return typeof e==="function"||typeof e==="object"||e===fe},ToObject:function(e,t){return Object(ce.RequireObjectCoercible(e,t))},IsCallable:d,IsConstructor:function(e){return ce.IsCallable(e)},ToInt32:function(e){return ce.ToNumber(e)>>0},ToUint32:function(e){return ce.ToNumber(e)>>>0},ToNumber:function(e){if(g(e)==="[object Symbol]"){throw new TypeError("Cannot convert a Symbol value to a number")}return+e},ToInteger:function(e){var t=ce.ToNumber(e);if(X(t)){return 0}if(t===0||!K(t)){return t}return(t>0?1:-1)*_(k(t))},ToLength:function(e){var t=ce.ToInteger(e);if(t<=0){return 0}if(t>Number.MAX_SAFE_INTEGER){return Number.MAX_SAFE_INTEGER}return t},SameValue:function(e,t){if(e===t){if(e===0){return 1/e===1/t}return true}return X(e)&&X(t)},SameValueZero:function(e,t){return e===t||X(e)&&X(t)},IsIterable:function(e){return ce.TypeIsObject(e)&&(typeof e[ie]!=="undefined"||te(e))},GetIterator:function(e){if(te(e)){return new q(e,"value")}var t=ce.GetMethod(e,ie);if(!ce.IsCallable(t)){throw new TypeError("value is not an iterable")}var r=ce.Call(t,e);if(!ce.TypeIsObject(r)){throw new TypeError("bad iterator")}return r},GetMethod:function(e,t){var r=ce.ToObject(e)[t];if(se(r)){return void 0}if(!ce.IsCallable(r)){throw new TypeError("Method not callable: "+t)}return r},IteratorComplete:function(e){return!!e.done},IteratorClose:function(e,t){var r=ce.GetMethod(e,"return");if(r===void 0){return}var n,o;try{n=ce.Call(r,e)}catch(i){o=i}if(t){return}if(o){throw o}if(!ce.TypeIsObject(n)){throw new TypeError("Iterator's return method returned a non-object.")}},IteratorNext:function(e){var t=arguments.length>1?e.next(arguments[1]):e.next();if(!ce.TypeIsObject(t)){throw new TypeError("bad iterator")}return t},IteratorStep:function(e){var t=ce.IteratorNext(e);var r=ce.IteratorComplete(t);return r?false:t},Construct:function(e,t,r,n){var o=typeof r==="undefined"?e:r;if(!n&&ae.construct){return ae.construct(e,t,o)}var i=o.prototype;if(!ce.TypeIsObject(i)){i=Object.prototype}var a=O(i);var u=ce.Call(e,a,t);return ce.TypeIsObject(u)?u:a},SpeciesConstructor:function(e,t){var r=e.constructor;if(r===void 0){return t}if(!ce.TypeIsObject(r)){throw new TypeError("Bad constructor")}var n=r[J];if(se(n)){return t}if(!ce.IsConstructor(n)){throw new TypeError("Bad @@species")}return n},CreateHTML:function(e,t,r,n){var o=ce.ToString(e);var i="<"+t;if(r!==""){var a=ce.ToString(n);var u=a.replace(/"/g,"&quot;");i+=" "+r+'="'+u+'"'}var f=i+">";var s=f+o;return s+"</"+t+">"},IsRegExp:function IsRegExp(e){if(!ce.TypeIsObject(e)){return false}var t=e[$.match];if(typeof t!=="undefined"){return!!t}return re.regex(e)},ToString:function ToString(e){return ue(e)}};if(s&&oe){var le=function defineWellKnownSymbol(e){if(re.symbol($[e])){return $[e]}var t=$["for"]("Symbol."+e);Object.defineProperty($,e,{configurable:false,enumerable:false,writable:false,value:t});return t};if(!re.symbol($.search)){var pe=le("search");var ve=String.prototype.search;h(RegExp.prototype,pe,function search(e){return ce.Call(ve,e,[this])});var ye=function search(e){var t=ce.RequireObjectCoercible(this);if(!se(e)){var r=ce.GetMethod(e,pe);if(typeof r!=="undefined"){return ce.Call(r,e,[t])}}return ce.Call(ve,t,[ce.ToString(e)])};ne(String.prototype,"search",ye)}if(!re.symbol($.replace)){var he=le("replace");var be=String.prototype.replace;h(RegExp.prototype,he,function replace(e,t){return ce.Call(be,e,[this,t])});var ge=function replace(e,t){var r=ce.RequireObjectCoercible(this);if(!se(e)){var n=ce.GetMethod(e,he);if(typeof n!=="undefined"){return ce.Call(n,e,[r,t])}}return ce.Call(be,r,[ce.ToString(e),t])};ne(String.prototype,"replace",ge)}if(!re.symbol($.split)){var de=le("split");var me=String.prototype.split;h(RegExp.prototype,de,function split(e,t){return ce.Call(me,e,[this,t])});var Oe=function split(e,t){var r=ce.RequireObjectCoercible(this);if(!se(e)){var n=ce.GetMethod(e,de);if(typeof n!=="undefined"){return ce.Call(n,e,[r,t])}}return ce.Call(me,r,[ce.ToString(e),t])};ne(String.prototype,"split",Oe)}var we=re.symbol($.match);var je=we&&function(){var e={};e[$.match]=function(){return 42};return"a".match(e)!==42}();if(!we||je){var Se=le("match");var Te=String.prototype.match;h(RegExp.prototype,Se,function match(e){return ce.Call(Te,e,[this])});var Ie=function match(e){var t=ce.RequireObjectCoercible(this);if(!se(e)){var r=ce.GetMethod(e,Se);if(typeof r!=="undefined"){return ce.Call(r,e,[t])}}return ce.Call(Te,t,[ce.ToString(e)])};ne(String.prototype,"match",Ie)}}var Ee=function wrapConstructor(e,t,r){m.preserveToString(t,e);if(Object.setPrototypeOf){Object.setPrototypeOf(e,t)}if(s){l(Object.getOwnPropertyNames(e),function(n){if(n in W||r[n]){return}m.proxy(e,n,t)})}else{l(Object.keys(e),function(n){if(n in W||r[n]){return}t[n]=e[n]})}t.prototype=e.prototype;m.redefine(e.prototype,"constructor",t)};var Pe=function(){return this};var Ce=function(e){if(s&&!z(e,J)){m.getter(e,J,Pe)}};var Me=function(e,t){var r=t||function iterator(){return this};h(e,ie,r);if(!e[ie]&&re.symbol(ie)){e[ie]=r}};var xe=function createDataProperty(e,t,r){if(s){Object.defineProperty(e,t,{configurable:true,enumerable:true,writable:true,value:r})}else{e[t]=r}};var Ne=function createDataPropertyOrThrow(e,t,r){xe(e,t,r);if(!ce.SameValue(e[t],r)){throw new TypeError("property is nonconfigurable")}};var Ae=function(e,t,r,n){if(!ce.TypeIsObject(e)){throw new TypeError("Constructor requires `new`: "+t.name)}var o=t.prototype;if(!ce.TypeIsObject(o)){o=r}var i=O(o);for(var a in n){if(z(n,a)){var u=n[a];h(i,a,u,true)}}return i};if(String.fromCodePoint&&String.fromCodePoint.length!==1){var Re=String.fromCodePoint;ne(String,"fromCodePoint",function fromCodePoint(e){return ce.Call(Re,this,arguments)})}var _e={fromCodePoint:function fromCodePoint(e){var t=[];var r;for(var n=0,o=arguments.length;n<o;n++){r=Number(arguments[n]);if(!ce.SameValue(r,ce.ToInteger(r))||r<0||r>1114111){throw new RangeError("Invalid code point "+r)}if(r<65536){M(t,String.fromCharCode(r))}else{r-=65536;M(t,String.fromCharCode((r>>10)+55296));M(t,String.fromCharCode(r%1024+56320))}}return t.join("")},raw:function raw(e){var t=ce.ToObject(e,"bad callSite");var r=ce.ToObject(t.raw,"bad raw value");var n=r.length;var o=ce.ToLength(n);if(o<=0){return""}var i=[];var a=0;var u,f,s,c;while(a<o){u=ce.ToString(a);s=ce.ToString(r[u]);M(i,s);if(a+1>=o){break}f=a+1<arguments.length?arguments[a+1]:"";c=ce.ToString(f);M(i,c);a+=1}return i.join("")}};if(String.raw&&String.raw({raw:{0:"x",1:"y",length:2}})!=="xy"){ne(String,"raw",_e.raw)}b(String,_e);var ke=function repeat(e,t){if(t<1){return""}if(t%2){return repeat(e,t-1)+e}var r=repeat(e,t/2);return r+r};var Le=Infinity;var Fe={repeat:function repeat(e){var t=ce.ToString(ce.RequireObjectCoercible(this));var r=ce.ToInteger(e);if(r<0||r>=Le){throw new RangeError("repeat count must be less than infinity and not overflow maximum string size")}return ke(t,r)},startsWith:function startsWith(e){var t=ce.ToString(ce.RequireObjectCoercible(this));if(ce.IsRegExp(e)){throw new TypeError('Cannot call method "startsWith" with a regex')}var r=ce.ToString(e);var n;if(arguments.length>1){n=arguments[1]}var o=A(ce.ToInteger(n),0);return C(t,o,o+r.length)===r},endsWith:function endsWith(e){var t=ce.ToString(ce.RequireObjectCoercible(this));if(ce.IsRegExp(e)){throw new TypeError('Cannot call method "endsWith" with a regex')}var r=ce.ToString(e);var n=t.length;var o;if(arguments.length>1){o=arguments[1]}var i=typeof o==="undefined"?n:ce.ToInteger(o);var a=R(A(i,0),n);return C(t,a-r.length,a)===r},includes:function includes(e){if(ce.IsRegExp(e)){throw new TypeError('"includes" does not accept a RegExp')}var t=ce.ToString(e);var r;if(arguments.length>1){r=arguments[1]}return I(this,t,r)!==-1},codePointAt:function codePointAt(e){var t=ce.ToString(ce.RequireObjectCoercible(this));var r=ce.ToInteger(e);var n=t.length;if(r>=0&&r<n){var o=t.charCodeAt(r);var i=r+1===n;if(o<55296||o>56319||i){return o}var a=t.charCodeAt(r+1);if(a<56320||a>57343){return o}return(o-55296)*1024+(a-56320)+65536}}};if(String.prototype.includes&&"a".includes("a",Infinity)!==false){ne(String.prototype,"includes",Fe.includes)}if(String.prototype.startsWith&&String.prototype.endsWith){var De=i(function(){return"/a/".startsWith(/a/)});var ze=a(function(){return"abc".startsWith("a",Infinity)===false});if(!De||!ze){ne(String.prototype,"startsWith",Fe.startsWith);ne(String.prototype,"endsWith",Fe.endsWith)}}if(oe){var qe=a(function(){var e=/a/;e[$.match]=false;return"/a/".startsWith(e)});if(!qe){ne(String.prototype,"startsWith",Fe.startsWith)}var We=a(function(){var e=/a/;e[$.match]=false;return"/a/".endsWith(e)});if(!We){ne(String.prototype,"endsWith",Fe.endsWith)}var Ge=a(function(){var e=/a/;e[$.match]=false;return"/a/".includes(e)});if(!Ge){ne(String.prototype,"includes",Fe.includes)}}b(String.prototype,Fe);var He=["\t\n\x0B\f\r \xa0\u1680\u180e\u2000\u2001\u2002\u2003","\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028","\u2029\ufeff"].join("");var Ve=new RegExp("(^["+He+"]+)|(["+He+"]+$)","g");var Be=function trim(){return ce.ToString(ce.RequireObjectCoercible(this)).replace(Ve,"")};var Ue=["\x85","\u200b","\ufffe"].join("");var $e=new RegExp("["+Ue+"]","g");var Je=/^[-+]0x[0-9a-f]+$/i;var Xe=Ue.trim().length!==Ue.length;h(String.prototype,"trim",Be,Xe);var Ke=function(e){return{value:e,done:arguments.length===0}};var Ze=function(e){ce.RequireObjectCoercible(e);this._s=ce.ToString(e);this._i=0};Ze.prototype.next=function(){var e=this._s;var t=this._i;if(typeof e==="undefined"||t>=e.length){this._s=void 0;return Ke()}var r=e.charCodeAt(t);var n,o;if(r<55296||r>56319||t+1===e.length){o=1}else{n=e.charCodeAt(t+1);o=n<56320||n>57343?1:2}this._i=t+o;return Ke(e.substr(t,o))};Me(Ze.prototype);Me(String.prototype,function(){return new Ze(this)});var Ye={from:function from(e){var r=this;var n;if(arguments.length>1){n=arguments[1]}var o,i;if(typeof n==="undefined"){o=false}else{if(!ce.IsCallable(n)){throw new TypeError("Array.from: when provided, the second argument must be a function")}if(arguments.length>2){i=arguments[2]}o=true}var a=typeof(te(e)||ce.GetMethod(e,ie))!=="undefined";var u,f,s;if(a){f=ce.IsConstructor(r)?Object(new r):[];var c=ce.GetIterator(e);var l,p;s=0;while(true){l=ce.IteratorStep(c);if(l===false){break}p=l.value;try{if(o){p=typeof i==="undefined"?n(p,s):t(n,i,p,s)}f[s]=p}catch(v){ce.IteratorClose(c,true);throw v}s+=1}u=s}else{var y=ce.ToObject(e);u=ce.ToLength(y.length);f=ce.IsConstructor(r)?Object(new r(u)):new Array(u);var h;for(s=0;s<u;++s){h=y[s];if(o){h=typeof i==="undefined"?n(h,s):t(n,i,h,s)}Ne(f,s,h)}}f.length=u;return f},of:function of(){var e=arguments.length;var t=this;var n=r(t)||!ce.IsCallable(t)?new Array(e):ce.Construct(t,[e]);for(var o=0;o<e;++o){Ne(n,o,arguments[o])}n.length=e;return n}};b(Array,Ye);Ce(Array);q=function(e,t){this.i=0;this.array=e;this.kind=t};b(q.prototype,{next:function(){var e=this.i;var t=this.array;if(!(this instanceof q)){throw new TypeError("Not an ArrayIterator")}if(typeof t!=="undefined"){var r=ce.ToLength(t.length);for(;e<r;e++){var n=this.kind;var o;if(n==="key"){o=e}else if(n==="value"){o=t[e]}else if(n==="entry"){o=[e,t[e]]}this.i=e+1;return Ke(o)}}this.array=void 0;return Ke()}});Me(q.prototype);var Qe=Array.of===Ye.of||function(){var e=function Foo(e){this.length=e};e.prototype=[];var t=Array.of.apply(e,[1,2]);return t instanceof e&&t.length===2}();if(!Qe){ne(Array,"of",Ye.of)}var et={copyWithin:function copyWithin(e,t){var r=ce.ToObject(this);var n=ce.ToLength(r.length);var o=ce.ToInteger(e);var i=ce.ToInteger(t);var a=o<0?A(n+o,0):R(o,n);var u=i<0?A(n+i,0):R(i,n);var f;if(arguments.length>2){f=arguments[2]}var s=typeof f==="undefined"?n:ce.ToInteger(f);var c=s<0?A(n+s,0):R(s,n);var l=R(c-u,n-a);var p=1;if(u<a&&a<u+l){p=-1;u+=l-1;a+=l-1}while(l>0){if(u in r){r[a]=r[u]}else{delete r[a]}u+=p;a+=p;l-=1}return r},fill:function fill(e){var t;if(arguments.length>1){t=arguments[1]}var r;if(arguments.length>2){r=arguments[2]}var n=ce.ToObject(this);var o=ce.ToLength(n.length);t=ce.ToInteger(typeof t==="undefined"?0:t);r=ce.ToInteger(typeof r==="undefined"?o:r);var i=t<0?A(o+t,0):R(t,o);var a=r<0?o+r:r;for(var u=i;u<o&&u<a;++u){n[u]=e}return n},find:function find(e){var r=ce.ToObject(this);var n=ce.ToLength(r.length);if(!ce.IsCallable(e)){throw new TypeError("Array#find: predicate must be a function")}var o=arguments.length>1?arguments[1]:null;for(var i=0,a;i<n;i++){a=r[i];if(o){if(t(e,o,a,i,r)){return a}}else if(e(a,i,r)){return a}}},findIndex:function findIndex(e){var r=ce.ToObject(this);var n=ce.ToLength(r.length);if(!ce.IsCallable(e)){throw new TypeError("Array#findIndex: predicate must be a function")}var o=arguments.length>1?arguments[1]:null;for(var i=0;i<n;i++){if(o){if(t(e,o,r[i],i,r)){return i}}else if(e(r[i],i,r)){return i}}return-1},keys:function keys(){return new q(this,"key")},values:function values(){return new q(this,"value")},entries:function entries(){return new q(this,"entry")}};if(Array.prototype.keys&&!ce.IsCallable([1].keys().next)){delete Array.prototype.keys}if(Array.prototype.entries&&!ce.IsCallable([1].entries().next)){delete Array.prototype.entries}if(Array.prototype.keys&&Array.prototype.entries&&!Array.prototype.values&&Array.prototype[ie]){b(Array.prototype,{values:Array.prototype[ie]});if(re.symbol($.unscopables)){Array.prototype[$.unscopables].values=true}}if(c&&Array.prototype.values&&Array.prototype.values.name!=="values"){var tt=Array.prototype.values;ne(Array.prototype,"values",function values(){return ce.Call(tt,this,arguments)});h(Array.prototype,ie,Array.prototype.values,true)}b(Array.prototype,et);if(1/[true].indexOf(true,-0)<0){h(Array.prototype,"indexOf",function indexOf(e){var t=E(this,arguments);if(t===0&&1/t<0){return 0}return t},true)}Me(Array.prototype,function(){return this.values()});if(Object.getPrototypeOf){Me(Object.getPrototypeOf([].values()))}var rt=function(){return a(function(){return Array.from({length:-1}).length===0})}();var nt=function(){var e=Array.from([0].entries());return e.length===1&&r(e[0])&&e[0][0]===0&&e[0][1]===0}();if(!rt||!nt){ne(Array,"from",Ye.from)}var ot=function(){return a(function(){return Array.from([0],void 0)})}();if(!ot){var it=Array.from;ne(Array,"from",function from(e){if(arguments.length>1&&typeof arguments[1]!=="undefined"){return ce.Call(it,this,arguments)}else{return t(it,this,e)}})}var at=-(Math.pow(2,32)-1);var ut=function(e,r){var n={length:at};n[r?(n.length>>>0)-1:0]=true;return a(function(){t(e,n,function(){throw new RangeError("should not reach here")},[]);return true})};if(!ut(Array.prototype.forEach)){var ft=Array.prototype.forEach;ne(Array.prototype,"forEach",function forEach(e){return ce.Call(ft,this.length>=0?this:[],arguments)},true)}if(!ut(Array.prototype.map)){var st=Array.prototype.map;ne(Array.prototype,"map",function map(e){return ce.Call(st,this.length>=0?this:[],arguments)},true)}if(!ut(Array.prototype.filter)){var ct=Array.prototype.filter;ne(Array.prototype,"filter",function filter(e){return ce.Call(ct,this.length>=0?this:[],arguments)},true)}if(!ut(Array.prototype.some)){var lt=Array.prototype.some;ne(Array.prototype,"some",function some(e){return ce.Call(lt,this.length>=0?this:[],arguments)},true)}if(!ut(Array.prototype.every)){var pt=Array.prototype.every;ne(Array.prototype,"every",function every(e){return ce.Call(pt,this.length>=0?this:[],arguments)},true)}if(!ut(Array.prototype.reduce)){var vt=Array.prototype.reduce;ne(Array.prototype,"reduce",function reduce(e){return ce.Call(vt,this.length>=0?this:[],arguments)},true)}if(!ut(Array.prototype.reduceRight,true)){var yt=Array.prototype.reduceRight;ne(Array.prototype,"reduceRight",function reduceRight(e){return ce.Call(yt,this.length>=0?this:[],arguments)},true)}var ht=Number("0o10")!==8;var bt=Number("0b10")!==2;var gt=y(Ue,function(e){return Number(e+0+e)===0});if(ht||bt||gt){var dt=Number;var mt=/^0b[01]+$/i;var Ot=/^0o[0-7]+$/i;var wt=mt.test.bind(mt);var jt=Ot.test.bind(Ot);var St=function(e){var t;if(typeof e.valueOf==="function"){t=e.valueOf();if(re.primitive(t)){return t}}if(typeof e.toString==="function"){t=e.toString();if(re.primitive(t)){return t}}throw new TypeError("No default value")};var Tt=$e.test.bind($e);var It=Je.test.bind(Je);var Et=function(){var e=function Number(t){var r;if(arguments.length>0){r=re.primitive(t)?t:St(t,"number")}else{r=0}if(typeof r==="string"){r=ce.Call(Be,r);if(wt(r)){r=parseInt(C(r,2),2)}else if(jt(r)){r=parseInt(C(r,2),8)}else if(Tt(r)||It(r)){r=NaN}}var n=this;var o=a(function(){dt.prototype.valueOf.call(n);return true});if(n instanceof e&&!o){return new dt(r)}return dt(r)};return e}();Ee(dt,Et,{});b(Et,{NaN:dt.NaN,MAX_VALUE:dt.MAX_VALUE,MIN_VALUE:dt.MIN_VALUE,NEGATIVE_INFINITY:dt.NEGATIVE_INFINITY,POSITIVE_INFINITY:dt.POSITIVE_INFINITY});Number=Et;m.redefine(S,"Number",Et)}var Pt=Math.pow(2,53)-1;b(Number,{MAX_SAFE_INTEGER:Pt,MIN_SAFE_INTEGER:-Pt,EPSILON:2.220446049250313e-16,parseInt:S.parseInt,parseFloat:S.parseFloat,isFinite:K,isInteger:function isInteger(e){return K(e)&&ce.ToInteger(e)===e},isSafeInteger:function isSafeInteger(e){return Number.isInteger(e)&&k(e)<=Number.MAX_SAFE_INTEGER},isNaN:X});h(Number,"parseInt",S.parseInt,Number.parseInt!==S.parseInt);if([,1].find(function(){return true})===1){ne(Array.prototype,"find",et.find)}if([,1].findIndex(function(){return true})!==0){ne(Array.prototype,"findIndex",et.findIndex)}var Ct=Function.bind.call(Function.bind,Object.prototype.propertyIsEnumerable);var Mt=function ensureEnumerable(e,t){if(s&&Ct(e,t)){Object.defineProperty(e,t,{enumerable:false})}};var xt=function sliceArgs(){var e=Number(this);var t=arguments.length;var r=t-e;var n=new Array(r<0?0:r);for(var o=e;o<t;++o){n[o-e]=arguments[o]}return n};var Nt=function assignTo(e){return function assignToSource(t,r){t[r]=e[r];return t}};var At=function(e,t){var r=n(Object(t));var o;if(ce.IsCallable(Object.getOwnPropertySymbols)){o=v(Object.getOwnPropertySymbols(Object(t)),Ct(t))}return p(P(r,o||[]),Nt(t),e)};var Rt={assign:function(e,t){var r=ce.ToObject(e,"Cannot convert undefined or null to object");return p(ce.Call(xt,1,arguments),At,r)},is:function is(e,t){return ce.SameValue(e,t)}};var _t=Object.assign&&Object.preventExtensions&&function(){var e=Object.preventExtensions({1:2});try{Object.assign(e,"xy")}catch(t){return e[1]==="y"}}();if(_t){ne(Object,"assign",Rt.assign)}b(Object,Rt);if(s){var kt={setPrototypeOf:function(e,r){var n;var o=function(e,t){if(!ce.TypeIsObject(e)){throw new TypeError("cannot set prototype on a non-object")}if(!(t===null||ce.TypeIsObject(t))){throw new TypeError("can only set prototype to an object or null"+t)}};var i=function(e,r){o(e,r);t(n,e,r);return e};try{n=e.getOwnPropertyDescriptor(e.prototype,r).set;t(n,{},null)}catch(a){if(e.prototype!=={}[r]){return}n=function(e){this[r]=e};i.polyfill=i(i({},null),e.prototype)instanceof e}return i}(Object,"__proto__")};b(Object,kt)}if(Object.setPrototypeOf&&Object.getPrototypeOf&&Object.getPrototypeOf(Object.setPrototypeOf({},null))!==null&&Object.getPrototypeOf(Object.create(null))===null){(function(){var e=Object.create(null);var t=Object.getPrototypeOf;var r=Object.setPrototypeOf;Object.getPrototypeOf=function(r){var n=t(r);return n===e?null:n};Object.setPrototypeOf=function(t,n){var o=n===null?e:n;return r(t,o)};Object.setPrototypeOf.polyfill=false})()}var Lt=!i(function(){return Object.keys("foo")});if(!Lt){var Ft=Object.keys;ne(Object,"keys",function keys(e){return Ft(ce.ToObject(e))});n=Object.keys}var Dt=i(function(){return Object.keys(/a/g)});if(Dt){var zt=Object.keys;ne(Object,"keys",function keys(e){if(re.regex(e)){var t=[];for(var r in e){if(z(e,r)){M(t,r)}}return t}return zt(e)});n=Object.keys}if(Object.getOwnPropertyNames){var qt=!i(function(){return Object.getOwnPropertyNames("foo")});if(!qt){var Wt=typeof window==="object"?Object.getOwnPropertyNames(window):[];var Gt=Object.getOwnPropertyNames;ne(Object,"getOwnPropertyNames",function getOwnPropertyNames(e){var t=ce.ToObject(e);if(g(t)==="[object Window]"){try{return Gt(t)}catch(r){return P([],Wt)}}return Gt(t)})}}if(Object.getOwnPropertyDescriptor){var Ht=!i(function(){return Object.getOwnPropertyDescriptor("foo","bar")});if(!Ht){var Vt=Object.getOwnPropertyDescriptor;ne(Object,"getOwnPropertyDescriptor",function getOwnPropertyDescriptor(e,t){return Vt(ce.ToObject(e),t)})}}if(Object.seal){var Bt=!i(function(){return Object.seal("foo")});if(!Bt){var Ut=Object.seal;ne(Object,"seal",function seal(e){if(!ce.TypeIsObject(e)){return e}return Ut(e)})}}if(Object.isSealed){var $t=!i(function(){return Object.isSealed("foo")});if(!$t){var Jt=Object.isSealed;ne(Object,"isSealed",function isSealed(e){if(!ce.TypeIsObject(e)){return true}return Jt(e)})}}if(Object.freeze){var Xt=!i(function(){return Object.freeze("foo")});if(!Xt){var Kt=Object.freeze;ne(Object,"freeze",function freeze(e){if(!ce.TypeIsObject(e)){return e}return Kt(e)})}}if(Object.isFrozen){var Zt=!i(function(){return Object.isFrozen("foo")});if(!Zt){var Yt=Object.isFrozen;ne(Object,"isFrozen",function isFrozen(e){if(!ce.TypeIsObject(e)){return true}return Yt(e)})}}if(Object.preventExtensions){var Qt=!i(function(){return Object.preventExtensions("foo")});if(!Qt){var er=Object.preventExtensions;ne(Object,"preventExtensions",function preventExtensions(e){if(!ce.TypeIsObject(e)){return e}return er(e)})}}if(Object.isExtensible){var tr=!i(function(){return Object.isExtensible("foo")});if(!tr){var rr=Object.isExtensible;ne(Object,"isExtensible",function isExtensible(e){if(!ce.TypeIsObject(e)){return false}return rr(e)})}}if(Object.getPrototypeOf){var nr=!i(function(){return Object.getPrototypeOf("foo")});if(!nr){var or=Object.getPrototypeOf;ne(Object,"getPrototypeOf",function getPrototypeOf(e){return or(ce.ToObject(e))})}}var ir=s&&function(){var e=Object.getOwnPropertyDescriptor(RegExp.prototype,"flags");return e&&ce.IsCallable(e.get)}();if(s&&!ir){var ar=function flags(){if(!ce.TypeIsObject(this)){throw new TypeError("Method called on incompatible type: must be an object.")}var e="";if(this.global){e+="g"}if(this.ignoreCase){e+="i"}if(this.multiline){e+="m"}if(this.unicode){e+="u"}if(this.sticky){e+="y"}return e};m.getter(RegExp.prototype,"flags",ar)}var ur=s&&a(function(){return String(new RegExp(/a/g,"i"))==="/a/i"});var fr=oe&&s&&function(){var e=/./;e[$.match]=false;return RegExp(e)===e}();var sr=a(function(){return RegExp.prototype.toString.call({source:"abc"})==="/abc/"});var cr=sr&&a(function(){return RegExp.prototype.toString.call({source:"a",flags:"b"})==="/a/b"});if(!sr||!cr){var lr=RegExp.prototype.toString;h(RegExp.prototype,"toString",function toString(){var e=ce.RequireObjectCoercible(this);if(re.regex(e)){return t(lr,e)}var r=ue(e.source);var n=ue(e.flags);return"/"+r+"/"+n},true);m.preserveToString(RegExp.prototype.toString,lr)}if(s&&(!ur||fr)){var pr=Object.getOwnPropertyDescriptor(RegExp.prototype,"flags").get;var vr=Object.getOwnPropertyDescriptor(RegExp.prototype,"source")||{};var yr=function(){return this.source};var hr=ce.IsCallable(vr.get)?vr.get:yr;var br=RegExp;var gr=function(){return function RegExp(e,t){var r=ce.IsRegExp(e);var n=this instanceof RegExp;if(!n&&r&&typeof t==="undefined"&&e.constructor===RegExp){return e}var o=e;var i=t;if(re.regex(e)){o=ce.Call(hr,e);i=typeof t==="undefined"?ce.Call(pr,e):t;return new RegExp(o,i)}else if(r){o=e.source;i=typeof t==="undefined"?e.flags:t}return new br(e,t)}}();Ee(br,gr,{$input:true});RegExp=gr;m.redefine(S,"RegExp",gr)}if(s){var dr={input:"$_",lastMatch:"$&",lastParen:"$+",leftContext:"$`",rightContext:"$'"};l(n(dr),function(e){if(e in RegExp&&!(dr[e]in RegExp)){m.getter(RegExp,dr[e],function get(){return RegExp[e]})}})}Ce(RegExp);var mr=1/Number.EPSILON;var Or=function roundTiesToEven(e){return e+mr-mr};var wr=Math.pow(2,-23);var jr=Math.pow(2,127)*(2-wr);var Sr=Math.pow(2,-126);var Tr=Math.E;var Ir=Math.LOG2E;var Er=Math.LOG10E;var Pr=Number.prototype.clz;delete Number.prototype.clz;var Cr={acosh:function acosh(e){var t=Number(e);if(X(t)||e<1){return NaN}if(t===1){return 0}if(t===Infinity){return t}var r=1/(t*t);if(t<2){return Y(t-1+D(1-r)*t)}var n=t/2;return Y(n+D(1-r)*n-1)+1/Ir},asinh:function asinh(e){var t=Number(e);if(t===0||!T(t)){return t}var r=k(t);var n=r*r;var o=Z(t);if(r<1){return o*Y(r+n/(D(n+1)+1))}return o*(Y(r/2+D(1+1/n)*r/2-1)+1/Ir)},atanh:function atanh(e){var t=Number(e);if(t===0){return t}if(t===-1){return-Infinity}if(t===1){return Infinity}if(X(t)||t<-1||t>1){return NaN}var r=k(t);return Z(t)*Y(2*r/(1-r))/2},cbrt:function cbrt(e){var t=Number(e);if(t===0){return t}var r=t<0;var n;if(r){t=-t}if(t===Infinity){n=Infinity}else{n=L(F(t)/3);n=(t/(n*n)+2*n)/3}return r?-n:n},clz32:function clz32(e){var t=Number(e);var r=ce.ToUint32(t);if(r===0){return 32}return Pr?ce.Call(Pr,r):31-_(F(r+.5)*Ir)},cosh:function cosh(e){var t=Number(e);if(t===0){return 1}if(X(t)){return NaN}if(!T(t)){return Infinity}var r=L(k(t)-1);return(r+1/(r*Tr*Tr))*(Tr/2)},expm1:function expm1(e){var t=Number(e);if(t===-Infinity){return-1}if(!T(t)||t===0){return t}if(k(t)>.5){return L(t)-1}var r=t;var n=0;var o=1;while(n+r!==n){n+=r;o+=1;r*=t/o}return n},hypot:function hypot(e,t){var r=0;var n=0;for(var o=0;o<arguments.length;++o){var i=k(Number(arguments[o]));if(n<i){r*=n/i*(n/i);r+=1;n=i}else{r+=i>0?i/n*(i/n):i}}return n===Infinity?Infinity:n*D(r)},log2:function log2(e){return F(e)*Ir},log10:function log10(e){return F(e)*Er},log1p:Y,sign:Z,sinh:function sinh(e){var t=Number(e);if(!T(t)||t===0){return t}var r=k(t);if(r<1){var n=Math.expm1(r);return Z(t)*n*(1+1/(n+1))/2}var o=L(r-1);return Z(t)*(o-1/(o*Tr*Tr))*(Tr/2)},tanh:function tanh(e){var t=Number(e);if(X(t)||t===0){return t}if(t>=20){return 1}if(t<=-20){return-1}return(Math.expm1(t)-Math.expm1(-t))/(L(t)+L(-t))},trunc:function trunc(e){var t=Number(e);return t<0?-_(-t):_(t)},imul:function imul(e,t){var r=ce.ToUint32(e);var n=ce.ToUint32(t);var o=r>>>16&65535;var i=r&65535;var a=n>>>16&65535;var u=n&65535;return i*u+(o*u+i*a<<16>>>0)|0},fround:function fround(e){var t=Number(e);if(t===0||t===Infinity||t===-Infinity||X(t)){return t}var r=Z(t);var n=k(t);if(n<Sr){return r*Or(n/Sr/wr)*Sr*wr}var o=(1+wr/Number.EPSILON)*n;var i=o-(o-n);if(i>jr||X(i)){return r*Infinity}return r*i}};var Mr=function withinULPDistance(e,t,r){return k(1-e/t)/Number.EPSILON<(r||8)};b(Math,Cr);h(Math,"sinh",Cr.sinh,Math.sinh(710)===Infinity);h(Math,"cosh",Cr.cosh,Math.cosh(710)===Infinity);h(Math,"log1p",Cr.log1p,Math.log1p(-1e-17)!==-1e-17);h(Math,"asinh",Cr.asinh,Math.asinh(-1e7)!==-Math.asinh(1e7));h(Math,"asinh",Cr.asinh,Math.asinh(1e300)===Infinity);h(Math,"atanh",Cr.atanh,Math.atanh(1e-300)===0);h(Math,"tanh",Cr.tanh,Math.tanh(-2e-17)!==-2e-17);
h(Math,"acosh",Cr.acosh,Math.acosh(Number.MAX_VALUE)===Infinity);h(Math,"acosh",Cr.acosh,!Mr(Math.acosh(1+Number.EPSILON),Math.sqrt(2*Number.EPSILON)));h(Math,"cbrt",Cr.cbrt,!Mr(Math.cbrt(1e-300),1e-100));h(Math,"sinh",Cr.sinh,Math.sinh(-2e-17)!==-2e-17);var xr=Math.expm1(10);h(Math,"expm1",Cr.expm1,xr>22025.465794806718||xr<22025.465794806718);var Nr=Math.round;var Ar=Math.round(.5-Number.EPSILON/4)===0&&Math.round(-.5+Number.EPSILON/3.99)===1;var Rr=mr+1;var _r=2*mr-1;var kr=[Rr,_r].every(function(e){return Math.round(e)===e});h(Math,"round",function round(e){var t=_(e);var r=t===-1?-0:t+1;return e-t<.5?t:r},!Ar||!kr);m.preserveToString(Math.round,Nr);var Lr=Math.imul;if(Math.imul(4294967295,5)!==-5){Math.imul=Cr.imul;m.preserveToString(Math.imul,Lr)}if(Math.imul.length!==2){ne(Math,"imul",function imul(e,t){return ce.Call(Lr,Math,arguments)})}var Fr=function(){var e=S.setTimeout;if(typeof e!=="function"&&typeof e!=="object"){return}ce.IsPromise=function(e){if(!ce.TypeIsObject(e)){return false}if(typeof e._promise==="undefined"){return false}return true};var r=function(e){if(!ce.IsConstructor(e)){throw new TypeError("Bad promise constructor")}var t=this;var r=function(e,r){if(t.resolve!==void 0||t.reject!==void 0){throw new TypeError("Bad Promise implementation!")}t.resolve=e;t.reject=r};t.resolve=void 0;t.reject=void 0;t.promise=new e(r);if(!(ce.IsCallable(t.resolve)&&ce.IsCallable(t.reject))){throw new TypeError("Bad promise constructor")}};var n;if(typeof window!=="undefined"&&ce.IsCallable(window.postMessage)){n=function(){var e=[];var t="zero-timeout-message";var r=function(r){M(e,r);window.postMessage(t,"*")};var n=function(r){if(r.source===window&&r.data===t){r.stopPropagation();if(e.length===0){return}var n=N(e);n()}};window.addEventListener("message",n,true);return r}}var o=function(){var e=S.Promise;var t=e&&e.resolve&&e.resolve();return t&&function(e){return t.then(e)}};var i=ce.IsCallable(S.setImmediate)?S.setImmediate:typeof process==="object"&&process.nextTick?process.nextTick:o()||(ce.IsCallable(n)?n():function(t){e(t,0)});var a=function(e){return e};var u=function(e){throw e};var f=0;var s=1;var c=2;var l=0;var p=1;var v=2;var y={};var h=function(e,t,r){i(function(){g(e,t,r)})};var g=function(e,t,r){var n,o;if(t===y){return e(r)}try{n=e(r);o=t.resolve}catch(i){n=i;o=t.reject}o(n)};var d=function(e,t){var r=e._promise;var n=r.reactionLength;if(n>0){h(r.fulfillReactionHandler0,r.reactionCapability0,t);r.fulfillReactionHandler0=void 0;r.rejectReactions0=void 0;r.reactionCapability0=void 0;if(n>1){for(var o=1,i=0;o<n;o++,i+=3){h(r[i+l],r[i+v],t);e[i+l]=void 0;e[i+p]=void 0;e[i+v]=void 0}}}r.result=t;r.state=s;r.reactionLength=0};var m=function(e,t){var r=e._promise;var n=r.reactionLength;if(n>0){h(r.rejectReactionHandler0,r.reactionCapability0,t);r.fulfillReactionHandler0=void 0;r.rejectReactions0=void 0;r.reactionCapability0=void 0;if(n>1){for(var o=1,i=0;o<n;o++,i+=3){h(r[i+p],r[i+v],t);e[i+l]=void 0;e[i+p]=void 0;e[i+v]=void 0}}}r.result=t;r.state=c;r.reactionLength=0};var O=function(e){var t=false;var r=function(r){var n;if(t){return}t=true;if(r===e){return m(e,new TypeError("Self resolution"))}if(!ce.TypeIsObject(r)){return d(e,r)}try{n=r.then}catch(o){return m(e,o)}if(!ce.IsCallable(n)){return d(e,r)}i(function(){j(e,r,n)})};var n=function(r){if(t){return}t=true;return m(e,r)};return{resolve:r,reject:n}};var w=function(e,r,n,o){if(e===I){t(e,r,n,o,y)}else{t(e,r,n,o)}};var j=function(e,t,r){var n=O(e);var o=n.resolve;var i=n.reject;try{w(r,t,o,i)}catch(a){i(a)}};var T,I;var E=function(){var e=function Promise(t){if(!(this instanceof e)){throw new TypeError('Constructor Promise requires "new"')}if(this&&this._promise){throw new TypeError("Bad construction")}if(!ce.IsCallable(t)){throw new TypeError("not a valid resolver")}var r=Ae(this,e,T,{_promise:{result:void 0,state:f,reactionLength:0,fulfillReactionHandler0:void 0,rejectReactionHandler0:void 0,reactionCapability0:void 0}});var n=O(r);var o=n.reject;try{t(n.resolve,o)}catch(i){o(i)}return r};return e}();T=E.prototype;var P=function(e,t,r,n){var o=false;return function(i){if(o){return}o=true;t[e]=i;if(--n.count===0){var a=r.resolve;a(t)}}};var C=function(e,t,r){var n=e.iterator;var o=[];var i={count:1};var a,u;var f=0;while(true){try{a=ce.IteratorStep(n);if(a===false){e.done=true;break}u=a.value}catch(s){e.done=true;throw s}o[f]=void 0;var c=t.resolve(u);var l=P(f,o,r,i);i.count+=1;w(c.then,c,l,r.reject);f+=1}if(--i.count===0){var p=r.resolve;p(o)}return r.promise};var x=function(e,t,r){var n=e.iterator;var o,i,a;while(true){try{o=ce.IteratorStep(n);if(o===false){e.done=true;break}i=o.value}catch(u){e.done=true;throw u}a=t.resolve(i);w(a.then,a,r.resolve,r.reject)}return r.promise};b(E,{all:function all(e){var t=this;if(!ce.TypeIsObject(t)){throw new TypeError("Promise is not object")}var n=new r(t);var o,i;try{o=ce.GetIterator(e);i={iterator:o,done:false};return C(i,t,n)}catch(a){var u=a;if(i&&!i.done){try{ce.IteratorClose(o,true)}catch(f){u=f}}var s=n.reject;s(u);return n.promise}},race:function race(e){var t=this;if(!ce.TypeIsObject(t)){throw new TypeError("Promise is not object")}var n=new r(t);var o,i;try{o=ce.GetIterator(e);i={iterator:o,done:false};return x(i,t,n)}catch(a){var u=a;if(i&&!i.done){try{ce.IteratorClose(o,true)}catch(f){u=f}}var s=n.reject;s(u);return n.promise}},reject:function reject(e){var t=this;if(!ce.TypeIsObject(t)){throw new TypeError("Bad promise constructor")}var n=new r(t);var o=n.reject;o(e);return n.promise},resolve:function resolve(e){var t=this;if(!ce.TypeIsObject(t)){throw new TypeError("Bad promise constructor")}if(ce.IsPromise(e)){var n=e.constructor;if(n===t){return e}}var o=new r(t);var i=o.resolve;i(e);return o.promise}});b(T,{"catch":function(e){return this.then(null,e)},then:function then(e,t){var n=this;if(!ce.IsPromise(n)){throw new TypeError("not a promise")}var o=ce.SpeciesConstructor(n,E);var i;var b=arguments.length>2&&arguments[2]===y;if(b&&o===E){i=y}else{i=new r(o)}var g=ce.IsCallable(e)?e:a;var d=ce.IsCallable(t)?t:u;var m=n._promise;var O;if(m.state===f){if(m.reactionLength===0){m.fulfillReactionHandler0=g;m.rejectReactionHandler0=d;m.reactionCapability0=i}else{var w=3*(m.reactionLength-1);m[w+l]=g;m[w+p]=d;m[w+v]=i}m.reactionLength+=1}else if(m.state===s){O=m.result;h(g,i,O)}else if(m.state===c){O=m.result;h(d,i,O)}else{throw new TypeError("unexpected Promise state")}return i.promise}});y=new r(E);I=T.then;return E}();if(S.Promise){delete S.Promise.accept;delete S.Promise.defer;delete S.Promise.prototype.chain}if(typeof Fr==="function"){b(S,{Promise:Fr});var Dr=w(S.Promise,function(e){return e.resolve(42).then(function(){})instanceof e});var zr=!i(function(){return S.Promise.reject(42).then(null,5).then(null,W)});var qr=i(function(){return S.Promise.call(3,W)});var Wr=function(e){var t=e.resolve(5);t.constructor={};var r=e.resolve(t);try{r.then(null,W).then(null,W)}catch(n){return true}return t===r}(S.Promise);var Gr=s&&function(){var e=0;var t=Object.defineProperty({},"then",{get:function(){e+=1}});Promise.resolve(t);return e===1}();var Hr=function BadResolverPromise(e){var t=new Promise(e);e(3,function(){});this.then=t.then;this.constructor=BadResolverPromise};Hr.prototype=Promise.prototype;Hr.all=Promise.all;var Vr=a(function(){return!!Hr.all([1,2])});if(!Dr||!zr||!qr||Wr||!Gr||Vr){Promise=Fr;ne(S,"Promise",Fr)}if(Promise.all.length!==1){var Br=Promise.all;ne(Promise,"all",function all(e){return ce.Call(Br,this,arguments)})}if(Promise.race.length!==1){var Ur=Promise.race;ne(Promise,"race",function race(e){return ce.Call(Ur,this,arguments)})}if(Promise.resolve.length!==1){var $r=Promise.resolve;ne(Promise,"resolve",function resolve(e){return ce.Call($r,this,arguments)})}if(Promise.reject.length!==1){var Jr=Promise.reject;ne(Promise,"reject",function reject(e){return ce.Call(Jr,this,arguments)})}Mt(Promise,"all");Mt(Promise,"race");Mt(Promise,"resolve");Mt(Promise,"reject");Ce(Promise)}var Xr=function(e){var t=n(p(e,function(e,t){e[t]=true;return e},{}));return e.join(":")===t.join(":")};var Kr=Xr(["z","a","bb"]);var Zr=Xr(["z",1,"a","3",2]);if(s){var Yr=function fastkey(e,t){if(!t&&!Kr){return null}if(se(e)){return"^"+ce.ToString(e)}else if(typeof e==="string"){return"$"+e}else if(typeof e==="number"){if(!Zr){return"n"+e}return e}else if(typeof e==="boolean"){return"b"+e}return null};var Qr=function emptyObject(){return Object.create?Object.create(null):{}};var en=function addIterableToMap(e,n,o){if(r(o)||re.string(o)){l(o,function(e){if(!ce.TypeIsObject(e)){throw new TypeError("Iterator value "+e+" is not an entry object")}n.set(e[0],e[1])})}else if(o instanceof e){t(e.prototype.forEach,o,function(e,t){n.set(t,e)})}else{var i,a;if(!se(o)){a=n.set;if(!ce.IsCallable(a)){throw new TypeError("bad map")}i=ce.GetIterator(o)}if(typeof i!=="undefined"){while(true){var u=ce.IteratorStep(i);if(u===false){break}var f=u.value;try{if(!ce.TypeIsObject(f)){throw new TypeError("Iterator value "+f+" is not an entry object")}t(a,n,f[0],f[1])}catch(s){ce.IteratorClose(i,true);throw s}}}}};var tn=function addIterableToSet(e,n,o){if(r(o)||re.string(o)){l(o,function(e){n.add(e)})}else if(o instanceof e){t(e.prototype.forEach,o,function(e){n.add(e)})}else{var i,a;if(!se(o)){a=n.add;if(!ce.IsCallable(a)){throw new TypeError("bad set")}i=ce.GetIterator(o)}if(typeof i!=="undefined"){while(true){var u=ce.IteratorStep(i);if(u===false){break}var f=u.value;try{t(a,n,f)}catch(s){ce.IteratorClose(i,true);throw s}}}}};var rn={Map:function(){var e={};var r=function MapEntry(e,t){this.key=e;this.value=t;this.next=null;this.prev=null};r.prototype.isRemoved=function isRemoved(){return this.key===e};var n=function isMap(e){return!!e._es6map};var o=function requireMapSlot(e,t){if(!ce.TypeIsObject(e)||!n(e)){throw new TypeError("Method Map.prototype."+t+" called on incompatible receiver "+ce.ToString(e))}};var i=function MapIterator(e,t){o(e,"[[MapIterator]]");this.head=e._head;this.i=this.head;this.kind=t};i.prototype={isMapIterator:true,next:function next(){if(!this.isMapIterator){throw new TypeError("Not a MapIterator")}var e=this.i;var t=this.kind;var r=this.head;if(typeof this.i==="undefined"){return Ke()}while(e.isRemoved()&&e!==r){e=e.prev}var n;while(e.next!==r){e=e.next;if(!e.isRemoved()){if(t==="key"){n=e.key}else if(t==="value"){n=e.value}else{n=[e.key,e.value]}this.i=e;return Ke(n)}}this.i=void 0;return Ke()}};Me(i.prototype);var a;var u=function Map(){if(!(this instanceof Map)){throw new TypeError('Constructor Map requires "new"')}if(this&&this._es6map){throw new TypeError("Bad construction")}var e=Ae(this,Map,a,{_es6map:true,_head:null,_map:G?new G:null,_size:0,_storage:Qr()});var t=new r(null,null);t.next=t.prev=t;e._head=t;if(arguments.length>0){en(Map,e,arguments[0])}return e};a=u.prototype;m.getter(a,"size",function(){if(typeof this._size==="undefined"){throw new TypeError("size method called on incompatible Map")}return this._size});b(a,{get:function get(e){o(this,"get");var t;var r=Yr(e,true);if(r!==null){t=this._storage[r];if(t){return t.value}else{return}}if(this._map){t=V.call(this._map,e);if(t){return t.value}else{return}}var n=this._head;var i=n;while((i=i.next)!==n){if(ce.SameValueZero(i.key,e)){return i.value}}},has:function has(e){o(this,"has");var t=Yr(e,true);if(t!==null){return typeof this._storage[t]!=="undefined"}if(this._map){return B.call(this._map,e)}var r=this._head;var n=r;while((n=n.next)!==r){if(ce.SameValueZero(n.key,e)){return true}}return false},set:function set(e,t){o(this,"set");var n=this._head;var i=n;var a;var u=Yr(e,true);if(u!==null){if(typeof this._storage[u]!=="undefined"){this._storage[u].value=t;return this}else{a=this._storage[u]=new r(e,t);i=n.prev}}else if(this._map){if(B.call(this._map,e)){V.call(this._map,e).value=t}else{a=new r(e,t);U.call(this._map,e,a);i=n.prev}}while((i=i.next)!==n){if(ce.SameValueZero(i.key,e)){i.value=t;return this}}a=a||new r(e,t);if(ce.SameValue(-0,e)){a.key=+0}a.next=this._head;a.prev=this._head.prev;a.prev.next=a;a.next.prev=a;this._size+=1;return this},"delete":function(t){o(this,"delete");var r=this._head;var n=r;var i=Yr(t,true);if(i!==null){if(typeof this._storage[i]==="undefined"){return false}n=this._storage[i].prev;delete this._storage[i]}else if(this._map){if(!B.call(this._map,t)){return false}n=V.call(this._map,t).prev;H.call(this._map,t)}while((n=n.next)!==r){if(ce.SameValueZero(n.key,t)){n.key=e;n.value=e;n.prev.next=n.next;n.next.prev=n.prev;this._size-=1;return true}}return false},clear:function clear(){o(this,"clear");this._map=G?new G:null;this._size=0;this._storage=Qr();var t=this._head;var r=t;var n=r.next;while((r=n)!==t){r.key=e;r.value=e;n=r.next;r.next=r.prev=t}t.next=t.prev=t},keys:function keys(){o(this,"keys");return new i(this,"key")},values:function values(){o(this,"values");return new i(this,"value")},entries:function entries(){o(this,"entries");return new i(this,"key+value")},forEach:function forEach(e){o(this,"forEach");var r=arguments.length>1?arguments[1]:null;var n=this.entries();for(var i=n.next();!i.done;i=n.next()){if(r){t(e,r,i.value[1],i.value[0],this)}else{e(i.value[1],i.value[0],this)}}}});Me(a,a.entries);return u}(),Set:function(){var e=function isSet(e){return e._es6set&&typeof e._storage!=="undefined"};var r=function requireSetSlot(t,r){if(!ce.TypeIsObject(t)||!e(t)){throw new TypeError("Set.prototype."+r+" called on incompatible receiver "+ce.ToString(t))}};var o;var i=function Set(){if(!(this instanceof Set)){throw new TypeError('Constructor Set requires "new"')}if(this&&this._es6set){throw new TypeError("Bad construction")}var e=Ae(this,Set,o,{_es6set:true,"[[SetData]]":null,_storage:Qr()});if(!e._es6set){throw new TypeError("bad set")}if(arguments.length>0){tn(Set,e,arguments[0])}return e};o=i.prototype;var a=function(e){var t=e;if(t==="^null"){return null}else if(t==="^undefined"){return void 0}else{var r=t.charAt(0);if(r==="$"){return C(t,1)}else if(r==="n"){return+C(t,1)}else if(r==="b"){return t==="btrue"}}return+t};var u=function ensureMap(e){if(!e["[[SetData]]"]){var t=new rn.Map;e["[[SetData]]"]=t;l(n(e._storage),function(e){var r=a(e);t.set(r,r)});e["[[SetData]]"]=t}e._storage=null};m.getter(i.prototype,"size",function(){r(this,"size");if(this._storage){return n(this._storage).length}u(this);return this["[[SetData]]"].size});b(i.prototype,{has:function has(e){r(this,"has");var t;if(this._storage&&(t=Yr(e))!==null){return!!this._storage[t]}u(this);return this["[[SetData]]"].has(e)},add:function add(e){r(this,"add");var t;if(this._storage&&(t=Yr(e))!==null){this._storage[t]=true;return this}u(this);this["[[SetData]]"].set(e,e);return this},"delete":function(e){r(this,"delete");var t;if(this._storage&&(t=Yr(e))!==null){var n=z(this._storage,t);return delete this._storage[t]&&n}u(this);return this["[[SetData]]"]["delete"](e)},clear:function clear(){r(this,"clear");if(this._storage){this._storage=Qr()}if(this["[[SetData]]"]){this["[[SetData]]"].clear()}},values:function values(){r(this,"values");u(this);return new f(this["[[SetData]]"].values())},entries:function entries(){r(this,"entries");u(this);return new f(this["[[SetData]]"].entries())},forEach:function forEach(e){r(this,"forEach");var n=arguments.length>1?arguments[1]:null;var o=this;u(o);this["[[SetData]]"].forEach(function(r,i){if(n){t(e,n,i,i,o)}else{e(i,i,o)}})}});h(i.prototype,"keys",i.prototype.values,true);Me(i.prototype,i.prototype.values);var f=function SetIterator(e){this.it=e};f.prototype={isSetIterator:true,next:function next(){if(!this.isSetIterator){throw new TypeError("Not a SetIterator")}return this.it.next()}};Me(f.prototype);return i}()};var nn=S.Set&&!Set.prototype["delete"]&&Set.prototype.remove&&Set.prototype.items&&Set.prototype.map&&Array.isArray((new Set).keys);if(nn){S.Set=rn.Set}if(S.Map||S.Set){var on=a(function(){return new Map([[1,2]]).get(1)===2});if(!on){S.Map=function Map(){if(!(this instanceof Map)){throw new TypeError('Constructor Map requires "new"')}var e=new G;if(arguments.length>0){en(Map,e,arguments[0])}delete e.constructor;Object.setPrototypeOf(e,S.Map.prototype);return e};S.Map.prototype=O(G.prototype);h(S.Map.prototype,"constructor",S.Map,true);m.preserveToString(S.Map,G)}var an=new Map;var un=function(){var e=new Map([[1,0],[2,0],[3,0],[4,0]]);e.set(-0,e);return e.get(0)===e&&e.get(-0)===e&&e.has(0)&&e.has(-0)}();var fn=an.set(1,2)===an;if(!un||!fn){ne(Map.prototype,"set",function set(e,r){t(U,this,e===0?0:e,r);return this})}if(!un){b(Map.prototype,{get:function get(e){return t(V,this,e===0?0:e)},has:function has(e){return t(B,this,e===0?0:e)}},true);m.preserveToString(Map.prototype.get,V);m.preserveToString(Map.prototype.has,B)}var sn=new Set;var cn=Set.prototype["delete"]&&Set.prototype.add&&Set.prototype.has&&function(e){e["delete"](0);e.add(-0);return!e.has(0)}(sn);var ln=sn.add(1)===sn;if(!cn||!ln){var pn=Set.prototype.add;Set.prototype.add=function add(e){t(pn,this,e===0?0:e);return this};m.preserveToString(Set.prototype.add,pn)}if(!cn){var vn=Set.prototype.has;Set.prototype.has=function has(e){return t(vn,this,e===0?0:e)};m.preserveToString(Set.prototype.has,vn);var yn=Set.prototype["delete"];Set.prototype["delete"]=function SetDelete(e){return t(yn,this,e===0?0:e)};m.preserveToString(Set.prototype["delete"],yn)}var hn=w(S.Map,function(e){var t=new e([]);t.set(42,42);return t instanceof e});var bn=Object.setPrototypeOf&&!hn;var gn=function(){try{return!(S.Map()instanceof S.Map)}catch(e){return e instanceof TypeError}}();if(S.Map.length!==0||bn||!gn){S.Map=function Map(){if(!(this instanceof Map)){throw new TypeError('Constructor Map requires "new"')}var e=new G;if(arguments.length>0){en(Map,e,arguments[0])}delete e.constructor;Object.setPrototypeOf(e,Map.prototype);return e};S.Map.prototype=G.prototype;h(S.Map.prototype,"constructor",S.Map,true);m.preserveToString(S.Map,G)}var dn=w(S.Set,function(e){var t=new e([]);t.add(42,42);return t instanceof e});var mn=Object.setPrototypeOf&&!dn;var On=function(){try{return!(S.Set()instanceof S.Set)}catch(e){return e instanceof TypeError}}();if(S.Set.length!==0||mn||!On){var wn=S.Set;S.Set=function Set(){if(!(this instanceof Set)){throw new TypeError('Constructor Set requires "new"')}var e=new wn;if(arguments.length>0){tn(Set,e,arguments[0])}delete e.constructor;Object.setPrototypeOf(e,Set.prototype);return e};S.Set.prototype=wn.prototype;h(S.Set.prototype,"constructor",S.Set,true);m.preserveToString(S.Set,wn)}var jn=new S.Map;var Sn=!a(function(){return jn.keys().next().done});if(typeof S.Map.prototype.clear!=="function"||(new S.Set).size!==0||jn.size!==0||typeof S.Map.prototype.keys!=="function"||typeof S.Set.prototype.keys!=="function"||typeof S.Map.prototype.forEach!=="function"||typeof S.Set.prototype.forEach!=="function"||u(S.Map)||u(S.Set)||typeof jn.keys().next!=="function"||Sn||!hn){b(S,{Map:rn.Map,Set:rn.Set},true)}if(S.Set.prototype.keys!==S.Set.prototype.values){h(S.Set.prototype,"keys",S.Set.prototype.values,true)}Me(Object.getPrototypeOf((new S.Map).keys()));Me(Object.getPrototypeOf((new S.Set).keys()));if(c&&S.Set.prototype.has.name!=="has"){var Tn=S.Set.prototype.has;ne(S.Set.prototype,"has",function has(e){return t(Tn,this,e)})}}b(S,rn);Ce(S.Map);Ce(S.Set)}var In=function throwUnlessTargetIsObject(e){if(!ce.TypeIsObject(e)){throw new TypeError("target must be an object")}};var En={apply:function apply(){return ce.Call(ce.Call,null,arguments)},construct:function construct(e,t){if(!ce.IsConstructor(e)){throw new TypeError("First argument must be a constructor.")}var r=arguments.length>2?arguments[2]:e;if(!ce.IsConstructor(r)){throw new TypeError("new.target must be a constructor.")}return ce.Construct(e,t,r,"internal")},deleteProperty:function deleteProperty(e,t){In(e);if(s){var r=Object.getOwnPropertyDescriptor(e,t);if(r&&!r.configurable){return false}}return delete e[t]},has:function has(e,t){In(e);return t in e}};if(Object.getOwnPropertyNames){Object.assign(En,{ownKeys:function ownKeys(e){In(e);var t=Object.getOwnPropertyNames(e);if(ce.IsCallable(Object.getOwnPropertySymbols)){x(t,Object.getOwnPropertySymbols(e))}return t}})}var Pn=function ConvertExceptionToBoolean(e){return!i(e)};if(Object.preventExtensions){Object.assign(En,{isExtensible:function isExtensible(e){In(e);return Object.isExtensible(e)},preventExtensions:function preventExtensions(e){In(e);return Pn(function(){return Object.preventExtensions(e)})}})}if(s){var Cn=function get(e,t,r){var n=Object.getOwnPropertyDescriptor(e,t);if(!n){var o=Object.getPrototypeOf(e);if(o===null){return void 0}return Cn(o,t,r)}if("value"in n){return n.value}if(n.get){return ce.Call(n.get,r)}return void 0};var Mn=function set(e,r,n,o){var i=Object.getOwnPropertyDescriptor(e,r);if(!i){var a=Object.getPrototypeOf(e);if(a!==null){return Mn(a,r,n,o)}i={value:void 0,writable:true,enumerable:true,configurable:true}}if("value"in i){if(!i.writable){return false}if(!ce.TypeIsObject(o)){return false}var u=Object.getOwnPropertyDescriptor(o,r);if(u){return ae.defineProperty(o,r,{value:n})}else{return ae.defineProperty(o,r,{value:n,writable:true,enumerable:true,configurable:true})}}if(i.set){t(i.set,o,n);return true}return false};Object.assign(En,{defineProperty:function defineProperty(e,t,r){In(e);return Pn(function(){return Object.defineProperty(e,t,r)})},getOwnPropertyDescriptor:function getOwnPropertyDescriptor(e,t){In(e);return Object.getOwnPropertyDescriptor(e,t)},get:function get(e,t){In(e);var r=arguments.length>2?arguments[2]:e;return Cn(e,t,r)},set:function set(e,t,r){In(e);var n=arguments.length>3?arguments[3]:e;return Mn(e,t,r,n)}})}if(Object.getPrototypeOf){var xn=Object.getPrototypeOf;En.getPrototypeOf=function getPrototypeOf(e){In(e);return xn(e)}}if(Object.setPrototypeOf&&En.getPrototypeOf){var Nn=function(e,t){var r=t;while(r){if(e===r){return true}r=En.getPrototypeOf(r)}return false};Object.assign(En,{setPrototypeOf:function setPrototypeOf(e,t){In(e);if(t!==null&&!ce.TypeIsObject(t)){throw new TypeError("proto must be an object or null")}if(t===ae.getPrototypeOf(e)){return true}if(ae.isExtensible&&!ae.isExtensible(e)){return false}if(Nn(e,t)){return false}Object.setPrototypeOf(e,t);return true}})}var An=function(e,t){if(!ce.IsCallable(S.Reflect[e])){h(S.Reflect,e,t)}else{var r=a(function(){S.Reflect[e](1);S.Reflect[e](NaN);S.Reflect[e](true);return true});if(r){ne(S.Reflect,e,t)}}};Object.keys(En).forEach(function(e){An(e,En[e])});var Rn=S.Reflect.getPrototypeOf;if(c&&Rn&&Rn.name!=="getPrototypeOf"){ne(S.Reflect,"getPrototypeOf",function getPrototypeOf(e){return t(Rn,S.Reflect,e)})}if(S.Reflect.setPrototypeOf){if(a(function(){S.Reflect.setPrototypeOf(1,{});return true})){ne(S.Reflect,"setPrototypeOf",En.setPrototypeOf)}}if(S.Reflect.defineProperty){if(!a(function(){var e=!S.Reflect.defineProperty(1,"test",{value:1});var t=typeof Object.preventExtensions!=="function"||!S.Reflect.defineProperty(Object.preventExtensions({}),"test",{});return e&&t})){ne(S.Reflect,"defineProperty",En.defineProperty)}}if(S.Reflect.construct){if(!a(function(){var e=function F(){};return S.Reflect.construct(function(){},[],e)instanceof e})){ne(S.Reflect,"construct",En.construct)}}if(String(new Date(NaN))!=="Invalid Date"){var _n=Date.prototype.toString;var kn=function toString(){var e=+this;if(e!==e){return"Invalid Date"}return ce.Call(_n,this)};ne(Date.prototype,"toString",kn)}var Ln={anchor:function anchor(e){return ce.CreateHTML(this,"a","name",e)},big:function big(){return ce.CreateHTML(this,"big","","")},blink:function blink(){return ce.CreateHTML(this,"blink","","")},bold:function bold(){return ce.CreateHTML(this,"b","","")},fixed:function fixed(){return ce.CreateHTML(this,"tt","","")},fontcolor:function fontcolor(e){return ce.CreateHTML(this,"font","color",e)},fontsize:function fontsize(e){return ce.CreateHTML(this,"font","size",e)},italics:function italics(){return ce.CreateHTML(this,"i","","")},link:function link(e){return ce.CreateHTML(this,"a","href",e)},small:function small(){return ce.CreateHTML(this,"small","","")},strike:function strike(){return ce.CreateHTML(this,"strike","","")},sub:function sub(){return ce.CreateHTML(this,"sub","","")},sup:function sub(){return ce.CreateHTML(this,"sup","","")}};l(Object.keys(Ln),function(e){var r=String.prototype[e];var n=false;if(ce.IsCallable(r)){var o=t(r,"",' " ');var i=P([],o.match(/"/g)).length;n=o!==o.toLowerCase()||i>2}else{n=true}if(n){ne(String.prototype,e,Ln[e])}});var Fn=function(){if(!oe){return false}var e=typeof JSON==="object"&&typeof JSON.stringify==="function"?JSON.stringify:null;if(!e){return false}if(typeof e($())!=="undefined"){return true}if(e([$()])!=="[null]"){return true}var t={a:$()};t[$()]=true;if(e(t)!=="{}"){return true}return false}();var Dn=a(function(){if(!oe){return true}return JSON.stringify(Object($()))==="{}"&&JSON.stringify([Object($())])==="[{}]"});if(Fn||!Dn){var zn=JSON.stringify;ne(JSON,"stringify",function stringify(e){if(typeof e==="symbol"){return}var n;if(arguments.length>1){n=arguments[1]}var o=[e];if(!r(n)){var i=ce.IsCallable(n)?n:null;var a=function(e,r){var n=i?t(i,this,e,r):r;if(typeof n!=="symbol"){if(re.symbol(n)){return Nt({})(n)}else{return n}}};o.push(a)}else{o.push(n)}if(arguments.length>2){o.push(arguments[2])}return zn.apply(this,o)})}return S});
/*! jQuery v3.6.0 | (c) OpenJS Foundation and other contributors | jquery.org/license */
!function(e,t){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(C,e){"use strict";var t=[],r=Object.getPrototypeOf,s=t.slice,g=t.flat?function(e){return t.flat.call(e)}:function(e){return t.concat.apply([],e)},u=t.push,i=t.indexOf,n={},o=n.toString,v=n.hasOwnProperty,a=v.toString,l=a.call(Object),y={},m=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType&&"function"!=typeof e.item},x=function(e){return null!=e&&e===e.window},E=C.document,c={type:!0,src:!0,nonce:!0,noModule:!0};function b(e,t,n){var r,i,o=(n=n||E).createElement("script");if(o.text=e,t)for(r in c)(i=t[r]||t.getAttribute&&t.getAttribute(r))&&o.setAttribute(r,i);n.head.appendChild(o).parentNode.removeChild(o)}function w(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?n[o.call(e)]||"object":typeof e}var f="3.6.0",S=function(e,t){return new S.fn.init(e,t)};function p(e){var t=!!e&&"length"in e&&e.length,n=w(e);return!m(e)&&!x(e)&&("array"===n||0===t||"number"==typeof t&&0<t&&t-1 in e)}S.fn=S.prototype={jquery:f,constructor:S,length:0,toArray:function(){return s.call(this)},get:function(e){return null==e?s.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=S.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return S.each(this,e)},map:function(n){return this.pushStack(S.map(this,function(e,t){return n.call(e,t,e)}))},slice:function(){return this.pushStack(s.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(S.grep(this,function(e,t){return(t+1)%2}))},odd:function(){return this.pushStack(S.grep(this,function(e,t){return t%2}))},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(0<=n&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:u,sort:t.sort,splice:t.splice},S.extend=S.fn.extend=function(){var e,t,n,r,i,o,a=arguments[0]||{},s=1,u=arguments.length,l=!1;for("boolean"==typeof a&&(l=a,a=arguments[s]||{},s++),"object"==typeof a||m(a)||(a={}),s===u&&(a=this,s--);s<u;s++)if(null!=(e=arguments[s]))for(t in e)r=e[t],"__proto__"!==t&&a!==r&&(l&&r&&(S.isPlainObject(r)||(i=Array.isArray(r)))?(n=a[t],o=i&&!Array.isArray(n)?[]:i||S.isPlainObject(n)?n:{},i=!1,a[t]=S.extend(l,o,r)):void 0!==r&&(a[t]=r));return a},S.extend({expando:"jQuery"+(f+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,n;return!(!e||"[object Object]"!==o.call(e))&&(!(t=r(e))||"function"==typeof(n=v.call(t,"constructor")&&t.constructor)&&a.call(n)===l)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e,t,n){b(e,{nonce:t&&t.nonce},n)},each:function(e,t){var n,r=0;if(p(e)){for(n=e.length;r<n;r++)if(!1===t.call(e[r],r,e[r]))break}else for(r in e)if(!1===t.call(e[r],r,e[r]))break;return e},makeArray:function(e,t){var n=t||[];return null!=e&&(p(Object(e))?S.merge(n,"string"==typeof e?[e]:e):u.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:i.call(t,e,n)},merge:function(e,t){for(var n=+t.length,r=0,i=e.length;r<n;r++)e[i++]=t[r];return e.length=i,e},grep:function(e,t,n){for(var r=[],i=0,o=e.length,a=!n;i<o;i++)!t(e[i],i)!==a&&r.push(e[i]);return r},map:function(e,t,n){var r,i,o=0,a=[];if(p(e))for(r=e.length;o<r;o++)null!=(i=t(e[o],o,n))&&a.push(i);else for(o in e)null!=(i=t(e[o],o,n))&&a.push(i);return g(a)},guid:1,support:y}),"function"==typeof Symbol&&(S.fn[Symbol.iterator]=t[Symbol.iterator]),S.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){n["[object "+t+"]"]=t.toLowerCase()});var d=function(n){var e,d,b,o,i,h,f,g,w,u,l,T,C,a,E,v,s,c,y,S="sizzle"+1*new Date,p=n.document,k=0,r=0,m=ue(),x=ue(),A=ue(),N=ue(),j=function(e,t){return e===t&&(l=!0),0},D={}.hasOwnProperty,t=[],q=t.pop,L=t.push,H=t.push,O=t.slice,P=function(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},R="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",M="[\\x20\\t\\r\\n\\f]",I="(?:\\\\[\\da-fA-F]{1,6}"+M+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",W="\\["+M+"*("+I+")(?:"+M+"*([*^$|!~]?=)"+M+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+I+"))|)"+M+"*\\]",F=":("+I+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+W+")*)|.*)\\)|)",B=new RegExp(M+"+","g"),$=new RegExp("^"+M+"+|((?:^|[^\\\\])(?:\\\\.)*)"+M+"+$","g"),_=new RegExp("^"+M+"*,"+M+"*"),z=new RegExp("^"+M+"*([>+~]|"+M+")"+M+"*"),U=new RegExp(M+"|>"),X=new RegExp(F),V=new RegExp("^"+I+"$"),G={ID:new RegExp("^#("+I+")"),CLASS:new RegExp("^\\.("+I+")"),TAG:new RegExp("^("+I+"|[*])"),ATTR:new RegExp("^"+W),PSEUDO:new RegExp("^"+F),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+M+"*(even|odd|(([+-]|)(\\d*)n|)"+M+"*(?:([+-]|)"+M+"*(\\d+)|))"+M+"*\\)|)","i"),bool:new RegExp("^(?:"+R+")$","i"),needsContext:new RegExp("^"+M+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+M+"*((?:-\\d)?\\d*)"+M+"*\\)|)(?=[^-]|$)","i")},Y=/HTML$/i,Q=/^(?:input|select|textarea|button)$/i,J=/^h\d$/i,K=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ee=/[+~]/,te=new RegExp("\\\\[\\da-fA-F]{1,6}"+M+"?|\\\\([^\\r\\n\\f])","g"),ne=function(e,t){var n="0x"+e.slice(1)-65536;return t||(n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320))},re=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,ie=function(e,t){return t?"\0"===e?"\ufffd":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e},oe=function(){T()},ae=be(function(e){return!0===e.disabled&&"fieldset"===e.nodeName.toLowerCase()},{dir:"parentNode",next:"legend"});try{H.apply(t=O.call(p.childNodes),p.childNodes),t[p.childNodes.length].nodeType}catch(e){H={apply:t.length?function(e,t){L.apply(e,O.call(t))}:function(e,t){var n=e.length,r=0;while(e[n++]=t[r++]);e.length=n-1}}}function se(t,e,n,r){var i,o,a,s,u,l,c,f=e&&e.ownerDocument,p=e?e.nodeType:9;if(n=n||[],"string"!=typeof t||!t||1!==p&&9!==p&&11!==p)return n;if(!r&&(T(e),e=e||C,E)){if(11!==p&&(u=Z.exec(t)))if(i=u[1]){if(9===p){if(!(a=e.getElementById(i)))return n;if(a.id===i)return n.push(a),n}else if(f&&(a=f.getElementById(i))&&y(e,a)&&a.id===i)return n.push(a),n}else{if(u[2])return H.apply(n,e.getElementsByTagName(t)),n;if((i=u[3])&&d.getElementsByClassName&&e.getElementsByClassName)return H.apply(n,e.getElementsByClassName(i)),n}if(d.qsa&&!N[t+" "]&&(!v||!v.test(t))&&(1!==p||"object"!==e.nodeName.toLowerCase())){if(c=t,f=e,1===p&&(U.test(t)||z.test(t))){(f=ee.test(t)&&ye(e.parentNode)||e)===e&&d.scope||((s=e.getAttribute("id"))?s=s.replace(re,ie):e.setAttribute("id",s=S)),o=(l=h(t)).length;while(o--)l[o]=(s?"#"+s:":scope")+" "+xe(l[o]);c=l.join(",")}try{return H.apply(n,f.querySelectorAll(c)),n}catch(e){N(t,!0)}finally{s===S&&e.removeAttribute("id")}}}return g(t.replace($,"$1"),e,n,r)}function ue(){var r=[];return function e(t,n){return r.push(t+" ")>b.cacheLength&&delete e[r.shift()],e[t+" "]=n}}function le(e){return e[S]=!0,e}function ce(e){var t=C.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function fe(e,t){var n=e.split("|"),r=n.length;while(r--)b.attrHandle[n[r]]=t}function pe(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(r)return r;if(n)while(n=n.nextSibling)if(n===t)return-1;return e?1:-1}function de(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function he(n){return function(e){var t=e.nodeName.toLowerCase();return("input"===t||"button"===t)&&e.type===n}}function ge(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&ae(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function ve(a){return le(function(o){return o=+o,le(function(e,t){var n,r=a([],e.length,o),i=r.length;while(i--)e[n=r[i]]&&(e[n]=!(t[n]=e[n]))})})}function ye(e){return e&&"undefined"!=typeof e.getElementsByTagName&&e}for(e in d=se.support={},i=se.isXML=function(e){var t=e&&e.namespaceURI,n=e&&(e.ownerDocument||e).documentElement;return!Y.test(t||n&&n.nodeName||"HTML")},T=se.setDocument=function(e){var t,n,r=e?e.ownerDocument||e:p;return r!=C&&9===r.nodeType&&r.documentElement&&(a=(C=r).documentElement,E=!i(C),p!=C&&(n=C.defaultView)&&n.top!==n&&(n.addEventListener?n.addEventListener("unload",oe,!1):n.attachEvent&&n.attachEvent("onunload",oe)),d.scope=ce(function(e){return a.appendChild(e).appendChild(C.createElement("div")),"undefined"!=typeof e.querySelectorAll&&!e.querySelectorAll(":scope fieldset div").length}),d.attributes=ce(function(e){return e.className="i",!e.getAttribute("className")}),d.getElementsByTagName=ce(function(e){return e.appendChild(C.createComment("")),!e.getElementsByTagName("*").length}),d.getElementsByClassName=K.test(C.getElementsByClassName),d.getById=ce(function(e){return a.appendChild(e).id=S,!C.getElementsByName||!C.getElementsByName(S).length}),d.getById?(b.filter.ID=function(e){var t=e.replace(te,ne);return function(e){return e.getAttribute("id")===t}},b.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&E){var n=t.getElementById(e);return n?[n]:[]}}):(b.filter.ID=function(e){var n=e.replace(te,ne);return function(e){var t="undefined"!=typeof e.getAttributeNode&&e.getAttributeNode("id");return t&&t.value===n}},b.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&E){var n,r,i,o=t.getElementById(e);if(o){if((n=o.getAttributeNode("id"))&&n.value===e)return[o];i=t.getElementsByName(e),r=0;while(o=i[r++])if((n=o.getAttributeNode("id"))&&n.value===e)return[o]}return[]}}),b.find.TAG=d.getElementsByTagName?function(e,t){return"undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName(e):d.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);if("*"===e){while(n=o[i++])1===n.nodeType&&r.push(n);return r}return o},b.find.CLASS=d.getElementsByClassName&&function(e,t){if("undefined"!=typeof t.getElementsByClassName&&E)return t.getElementsByClassName(e)},s=[],v=[],(d.qsa=K.test(C.querySelectorAll))&&(ce(function(e){var t;a.appendChild(e).innerHTML="<a id='"+S+"'></a><select id='"+S+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&v.push("[*^$]="+M+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||v.push("\\["+M+"*(?:value|"+R+")"),e.querySelectorAll("[id~="+S+"-]").length||v.push("~="),(t=C.createElement("input")).setAttribute("name",""),e.appendChild(t),e.querySelectorAll("[name='']").length||v.push("\\["+M+"*name"+M+"*="+M+"*(?:''|\"\")"),e.querySelectorAll(":checked").length||v.push(":checked"),e.querySelectorAll("a#"+S+"+*").length||v.push(".#.+[+~]"),e.querySelectorAll("\\\f"),v.push("[\\r\\n\\f]")}),ce(function(e){e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var t=C.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&v.push("name"+M+"*[*^$|!~]?="),2!==e.querySelectorAll(":enabled").length&&v.push(":enabled",":disabled"),a.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&v.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),v.push(",.*:")})),(d.matchesSelector=K.test(c=a.matches||a.webkitMatchesSelector||a.mozMatchesSelector||a.oMatchesSelector||a.msMatchesSelector))&&ce(function(e){d.disconnectedMatch=c.call(e,"*"),c.call(e,"[s!='']:x"),s.push("!=",F)}),v=v.length&&new RegExp(v.join("|")),s=s.length&&new RegExp(s.join("|")),t=K.test(a.compareDocumentPosition),y=t||K.test(a.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)while(t=t.parentNode)if(t===e)return!0;return!1},j=t?function(e,t){if(e===t)return l=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n||(1&(n=(e.ownerDocument||e)==(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!d.sortDetached&&t.compareDocumentPosition(e)===n?e==C||e.ownerDocument==p&&y(p,e)?-1:t==C||t.ownerDocument==p&&y(p,t)?1:u?P(u,e)-P(u,t):0:4&n?-1:1)}:function(e,t){if(e===t)return l=!0,0;var n,r=0,i=e.parentNode,o=t.parentNode,a=[e],s=[t];if(!i||!o)return e==C?-1:t==C?1:i?-1:o?1:u?P(u,e)-P(u,t):0;if(i===o)return pe(e,t);n=e;while(n=n.parentNode)a.unshift(n);n=t;while(n=n.parentNode)s.unshift(n);while(a[r]===s[r])r++;return r?pe(a[r],s[r]):a[r]==p?-1:s[r]==p?1:0}),C},se.matches=function(e,t){return se(e,null,null,t)},se.matchesSelector=function(e,t){if(T(e),d.matchesSelector&&E&&!N[t+" "]&&(!s||!s.test(t))&&(!v||!v.test(t)))try{var n=c.call(e,t);if(n||d.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(e){N(t,!0)}return 0<se(t,C,null,[e]).length},se.contains=function(e,t){return(e.ownerDocument||e)!=C&&T(e),y(e,t)},se.attr=function(e,t){(e.ownerDocument||e)!=C&&T(e);var n=b.attrHandle[t.toLowerCase()],r=n&&D.call(b.attrHandle,t.toLowerCase())?n(e,t,!E):void 0;return void 0!==r?r:d.attributes||!E?e.getAttribute(t):(r=e.getAttributeNode(t))&&r.specified?r.value:null},se.escape=function(e){return(e+"").replace(re,ie)},se.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},se.uniqueSort=function(e){var t,n=[],r=0,i=0;if(l=!d.detectDuplicates,u=!d.sortStable&&e.slice(0),e.sort(j),l){while(t=e[i++])t===e[i]&&(r=n.push(i));while(r--)e.splice(n[r],1)}return u=null,e},o=se.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=o(e)}else if(3===i||4===i)return e.nodeValue}else while(t=e[r++])n+=o(t);return n},(b=se.selectors={cacheLength:50,createPseudo:le,match:G,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(te,ne),e[3]=(e[3]||e[4]||e[5]||"").replace(te,ne),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||se.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&se.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return G.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&X.test(n)&&(t=h(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(te,ne).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=m[e+" "];return t||(t=new RegExp("(^|"+M+")"+e+"("+M+"|$)"))&&m(e,function(e){return t.test("string"==typeof e.className&&e.className||"undefined"!=typeof e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(n,r,i){return function(e){var t=se.attr(e,n);return null==t?"!="===r:!r||(t+="","="===r?t===i:"!="===r?t!==i:"^="===r?i&&0===t.indexOf(i):"*="===r?i&&-1<t.indexOf(i):"$="===r?i&&t.slice(-i.length)===i:"~="===r?-1<(" "+t.replace(B," ")+" ").indexOf(i):"|="===r&&(t===i||t.slice(0,i.length+1)===i+"-"))}},CHILD:function(h,e,t,g,v){var y="nth"!==h.slice(0,3),m="last"!==h.slice(-4),x="of-type"===e;return 1===g&&0===v?function(e){return!!e.parentNode}:function(e,t,n){var r,i,o,a,s,u,l=y!==m?"nextSibling":"previousSibling",c=e.parentNode,f=x&&e.nodeName.toLowerCase(),p=!n&&!x,d=!1;if(c){if(y){while(l){a=e;while(a=a[l])if(x?a.nodeName.toLowerCase()===f:1===a.nodeType)return!1;u=l="only"===h&&!u&&"nextSibling"}return!0}if(u=[m?c.firstChild:c.lastChild],m&&p){d=(s=(r=(i=(o=(a=c)[S]||(a[S]={}))[a.uniqueID]||(o[a.uniqueID]={}))[h]||[])[0]===k&&r[1])&&r[2],a=s&&c.childNodes[s];while(a=++s&&a&&a[l]||(d=s=0)||u.pop())if(1===a.nodeType&&++d&&a===e){i[h]=[k,s,d];break}}else if(p&&(d=s=(r=(i=(o=(a=e)[S]||(a[S]={}))[a.uniqueID]||(o[a.uniqueID]={}))[h]||[])[0]===k&&r[1]),!1===d)while(a=++s&&a&&a[l]||(d=s=0)||u.pop())if((x?a.nodeName.toLowerCase()===f:1===a.nodeType)&&++d&&(p&&((i=(o=a[S]||(a[S]={}))[a.uniqueID]||(o[a.uniqueID]={}))[h]=[k,d]),a===e))break;return(d-=v)===g||d%g==0&&0<=d/g}}},PSEUDO:function(e,o){var t,a=b.pseudos[e]||b.setFilters[e.toLowerCase()]||se.error("unsupported pseudo: "+e);return a[S]?a(o):1<a.length?(t=[e,e,"",o],b.setFilters.hasOwnProperty(e.toLowerCase())?le(function(e,t){var n,r=a(e,o),i=r.length;while(i--)e[n=P(e,r[i])]=!(t[n]=r[i])}):function(e){return a(e,0,t)}):a}},pseudos:{not:le(function(e){var r=[],i=[],s=f(e.replace($,"$1"));return s[S]?le(function(e,t,n,r){var i,o=s(e,null,r,[]),a=e.length;while(a--)(i=o[a])&&(e[a]=!(t[a]=i))}):function(e,t,n){return r[0]=e,s(r,null,n,i),r[0]=null,!i.pop()}}),has:le(function(t){return function(e){return 0<se(t,e).length}}),contains:le(function(t){return t=t.replace(te,ne),function(e){return-1<(e.textContent||o(e)).indexOf(t)}}),lang:le(function(n){return V.test(n||"")||se.error("unsupported lang: "+n),n=n.replace(te,ne).toLowerCase(),function(e){var t;do{if(t=E?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(t=t.toLowerCase())===n||0===t.indexOf(n+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var t=n.location&&n.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===a},focus:function(e){return e===C.activeElement&&(!C.hasFocus||C.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:ge(!1),disabled:ge(!0),checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!b.pseudos.empty(e)},header:function(e){return J.test(e.nodeName)},input:function(e){return Q.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:ve(function(){return[0]}),last:ve(function(e,t){return[t-1]}),eq:ve(function(e,t,n){return[n<0?n+t:n]}),even:ve(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:ve(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:ve(function(e,t,n){for(var r=n<0?n+t:t<n?t:n;0<=--r;)e.push(r);return e}),gt:ve(function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e})}}).pseudos.nth=b.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})b.pseudos[e]=de(e);for(e in{submit:!0,reset:!0})b.pseudos[e]=he(e);function me(){}function xe(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r}function be(s,e,t){var u=e.dir,l=e.next,c=l||u,f=t&&"parentNode"===c,p=r++;return e.first?function(e,t,n){while(e=e[u])if(1===e.nodeType||f)return s(e,t,n);return!1}:function(e,t,n){var r,i,o,a=[k,p];if(n){while(e=e[u])if((1===e.nodeType||f)&&s(e,t,n))return!0}else while(e=e[u])if(1===e.nodeType||f)if(i=(o=e[S]||(e[S]={}))[e.uniqueID]||(o[e.uniqueID]={}),l&&l===e.nodeName.toLowerCase())e=e[u]||e;else{if((r=i[c])&&r[0]===k&&r[1]===p)return a[2]=r[2];if((i[c]=a)[2]=s(e,t,n))return!0}return!1}}function we(i){return 1<i.length?function(e,t,n){var r=i.length;while(r--)if(!i[r](e,t,n))return!1;return!0}:i[0]}function Te(e,t,n,r,i){for(var o,a=[],s=0,u=e.length,l=null!=t;s<u;s++)(o=e[s])&&(n&&!n(o,r,i)||(a.push(o),l&&t.push(s)));return a}function Ce(d,h,g,v,y,e){return v&&!v[S]&&(v=Ce(v)),y&&!y[S]&&(y=Ce(y,e)),le(function(e,t,n,r){var i,o,a,s=[],u=[],l=t.length,c=e||function(e,t,n){for(var r=0,i=t.length;r<i;r++)se(e,t[r],n);return n}(h||"*",n.nodeType?[n]:n,[]),f=!d||!e&&h?c:Te(c,s,d,n,r),p=g?y||(e?d:l||v)?[]:t:f;if(g&&g(f,p,n,r),v){i=Te(p,u),v(i,[],n,r),o=i.length;while(o--)(a=i[o])&&(p[u[o]]=!(f[u[o]]=a))}if(e){if(y||d){if(y){i=[],o=p.length;while(o--)(a=p[o])&&i.push(f[o]=a);y(null,p=[],i,r)}o=p.length;while(o--)(a=p[o])&&-1<(i=y?P(e,a):s[o])&&(e[i]=!(t[i]=a))}}else p=Te(p===t?p.splice(l,p.length):p),y?y(null,t,p,r):H.apply(t,p)})}function Ee(e){for(var i,t,n,r=e.length,o=b.relative[e[0].type],a=o||b.relative[" "],s=o?1:0,u=be(function(e){return e===i},a,!0),l=be(function(e){return-1<P(i,e)},a,!0),c=[function(e,t,n){var r=!o&&(n||t!==w)||((i=t).nodeType?u(e,t,n):l(e,t,n));return i=null,r}];s<r;s++)if(t=b.relative[e[s].type])c=[be(we(c),t)];else{if((t=b.filter[e[s].type].apply(null,e[s].matches))[S]){for(n=++s;n<r;n++)if(b.relative[e[n].type])break;return Ce(1<s&&we(c),1<s&&xe(e.slice(0,s-1).concat({value:" "===e[s-2].type?"*":""})).replace($,"$1"),t,s<n&&Ee(e.slice(s,n)),n<r&&Ee(e=e.slice(n)),n<r&&xe(e))}c.push(t)}return we(c)}return me.prototype=b.filters=b.pseudos,b.setFilters=new me,h=se.tokenize=function(e,t){var n,r,i,o,a,s,u,l=x[e+" "];if(l)return t?0:l.slice(0);a=e,s=[],u=b.preFilter;while(a){for(o in n&&!(r=_.exec(a))||(r&&(a=a.slice(r[0].length)||a),s.push(i=[])),n=!1,(r=z.exec(a))&&(n=r.shift(),i.push({value:n,type:r[0].replace($," ")}),a=a.slice(n.length)),b.filter)!(r=G[o].exec(a))||u[o]&&!(r=u[o](r))||(n=r.shift(),i.push({value:n,type:o,matches:r}),a=a.slice(n.length));if(!n)break}return t?a.length:a?se.error(e):x(e,s).slice(0)},f=se.compile=function(e,t){var n,v,y,m,x,r,i=[],o=[],a=A[e+" "];if(!a){t||(t=h(e)),n=t.length;while(n--)(a=Ee(t[n]))[S]?i.push(a):o.push(a);(a=A(e,(v=o,m=0<(y=i).length,x=0<v.length,r=function(e,t,n,r,i){var o,a,s,u=0,l="0",c=e&&[],f=[],p=w,d=e||x&&b.find.TAG("*",i),h=k+=null==p?1:Math.random()||.1,g=d.length;for(i&&(w=t==C||t||i);l!==g&&null!=(o=d[l]);l++){if(x&&o){a=0,t||o.ownerDocument==C||(T(o),n=!E);while(s=v[a++])if(s(o,t||C,n)){r.push(o);break}i&&(k=h)}m&&((o=!s&&o)&&u--,e&&c.push(o))}if(u+=l,m&&l!==u){a=0;while(s=y[a++])s(c,f,t,n);if(e){if(0<u)while(l--)c[l]||f[l]||(f[l]=q.call(r));f=Te(f)}H.apply(r,f),i&&!e&&0<f.length&&1<u+y.length&&se.uniqueSort(r)}return i&&(k=h,w=p),c},m?le(r):r))).selector=e}return a},g=se.select=function(e,t,n,r){var i,o,a,s,u,l="function"==typeof e&&e,c=!r&&h(e=l.selector||e);if(n=n||[],1===c.length){if(2<(o=c[0]=c[0].slice(0)).length&&"ID"===(a=o[0]).type&&9===t.nodeType&&E&&b.relative[o[1].type]){if(!(t=(b.find.ID(a.matches[0].replace(te,ne),t)||[])[0]))return n;l&&(t=t.parentNode),e=e.slice(o.shift().value.length)}i=G.needsContext.test(e)?0:o.length;while(i--){if(a=o[i],b.relative[s=a.type])break;if((u=b.find[s])&&(r=u(a.matches[0].replace(te,ne),ee.test(o[0].type)&&ye(t.parentNode)||t))){if(o.splice(i,1),!(e=r.length&&xe(o)))return H.apply(n,r),n;break}}}return(l||f(e,c))(r,t,!E,n,!t||ee.test(e)&&ye(t.parentNode)||t),n},d.sortStable=S.split("").sort(j).join("")===S,d.detectDuplicates=!!l,T(),d.sortDetached=ce(function(e){return 1&e.compareDocumentPosition(C.createElement("fieldset"))}),ce(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||fe("type|href|height|width",function(e,t,n){if(!n)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),d.attributes&&ce(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||fe("value",function(e,t,n){if(!n&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),ce(function(e){return null==e.getAttribute("disabled")})||fe(R,function(e,t,n){var r;if(!n)return!0===e[t]?t.toLowerCase():(r=e.getAttributeNode(t))&&r.specified?r.value:null}),se}(C);S.find=d,S.expr=d.selectors,S.expr[":"]=S.expr.pseudos,S.uniqueSort=S.unique=d.uniqueSort,S.text=d.getText,S.isXMLDoc=d.isXML,S.contains=d.contains,S.escapeSelector=d.escape;var h=function(e,t,n){var r=[],i=void 0!==n;while((e=e[t])&&9!==e.nodeType)if(1===e.nodeType){if(i&&S(e).is(n))break;r.push(e)}return r},T=function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n},k=S.expr.match.needsContext;function A(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}var N=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function j(e,n,r){return m(n)?S.grep(e,function(e,t){return!!n.call(e,t,e)!==r}):n.nodeType?S.grep(e,function(e){return e===n!==r}):"string"!=typeof n?S.grep(e,function(e){return-1<i.call(n,e)!==r}):S.filter(n,e,r)}S.filter=function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?S.find.matchesSelector(r,e)?[r]:[]:S.find.matches(e,S.grep(t,function(e){return 1===e.nodeType}))},S.fn.extend({find:function(e){var t,n,r=this.length,i=this;if("string"!=typeof e)return this.pushStack(S(e).filter(function(){for(t=0;t<r;t++)if(S.contains(i[t],this))return!0}));for(n=this.pushStack([]),t=0;t<r;t++)S.find(e,i[t],n);return 1<r?S.uniqueSort(n):n},filter:function(e){return this.pushStack(j(this,e||[],!1))},not:function(e){return this.pushStack(j(this,e||[],!0))},is:function(e){return!!j(this,"string"==typeof e&&k.test(e)?S(e):e||[],!1).length}});var D,q=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(S.fn.init=function(e,t,n){var r,i;if(!e)return this;if(n=n||D,"string"==typeof e){if(!(r="<"===e[0]&&">"===e[e.length-1]&&3<=e.length?[null,e,null]:q.exec(e))||!r[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(r[1]){if(t=t instanceof S?t[0]:t,S.merge(this,S.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:E,!0)),N.test(r[1])&&S.isPlainObject(t))for(r in t)m(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}return(i=E.getElementById(r[2]))&&(this[0]=i,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):m(e)?void 0!==n.ready?n.ready(e):e(S):S.makeArray(e,this)}).prototype=S.fn,D=S(E);var L=/^(?:parents|prev(?:Until|All))/,H={children:!0,contents:!0,next:!0,prev:!0};function O(e,t){while((e=e[t])&&1!==e.nodeType);return e}S.fn.extend({has:function(e){var t=S(e,this),n=t.length;return this.filter(function(){for(var e=0;e<n;e++)if(S.contains(this,t[e]))return!0})},closest:function(e,t){var n,r=0,i=this.length,o=[],a="string"!=typeof e&&S(e);if(!k.test(e))for(;r<i;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(a?-1<a.index(n):1===n.nodeType&&S.find.matchesSelector(n,e))){o.push(n);break}return this.pushStack(1<o.length?S.uniqueSort(o):o)},index:function(e){return e?"string"==typeof e?i.call(S(e),this[0]):i.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(S.uniqueSort(S.merge(this.get(),S(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),S.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return h(e,"parentNode")},parentsUntil:function(e,t,n){return h(e,"parentNode",n)},next:function(e){return O(e,"nextSibling")},prev:function(e){return O(e,"previousSibling")},nextAll:function(e){return h(e,"nextSibling")},prevAll:function(e){return h(e,"previousSibling")},nextUntil:function(e,t,n){return h(e,"nextSibling",n)},prevUntil:function(e,t,n){return h(e,"previousSibling",n)},siblings:function(e){return T((e.parentNode||{}).firstChild,e)},children:function(e){return T(e.firstChild)},contents:function(e){return null!=e.contentDocument&&r(e.contentDocument)?e.contentDocument:(A(e,"template")&&(e=e.content||e),S.merge([],e.childNodes))}},function(r,i){S.fn[r]=function(e,t){var n=S.map(this,i,e);return"Until"!==r.slice(-5)&&(t=e),t&&"string"==typeof t&&(n=S.filter(t,n)),1<this.length&&(H[r]||S.uniqueSort(n),L.test(r)&&n.reverse()),this.pushStack(n)}});var P=/[^\x20\t\r\n\f]+/g;function R(e){return e}function M(e){throw e}function I(e,t,n,r){var i;try{e&&m(i=e.promise)?i.call(e).done(t).fail(n):e&&m(i=e.then)?i.call(e,t,n):t.apply(void 0,[e].slice(r))}catch(e){n.apply(void 0,[e])}}S.Callbacks=function(r){var e,n;r="string"==typeof r?(e=r,n={},S.each(e.match(P)||[],function(e,t){n[t]=!0}),n):S.extend({},r);var i,t,o,a,s=[],u=[],l=-1,c=function(){for(a=a||r.once,o=i=!0;u.length;l=-1){t=u.shift();while(++l<s.length)!1===s[l].apply(t[0],t[1])&&r.stopOnFalse&&(l=s.length,t=!1)}r.memory||(t=!1),i=!1,a&&(s=t?[]:"")},f={add:function(){return s&&(t&&!i&&(l=s.length-1,u.push(t)),function n(e){S.each(e,function(e,t){m(t)?r.unique&&f.has(t)||s.push(t):t&&t.length&&"string"!==w(t)&&n(t)})}(arguments),t&&!i&&c()),this},remove:function(){return S.each(arguments,function(e,t){var n;while(-1<(n=S.inArray(t,s,n)))s.splice(n,1),n<=l&&l--}),this},has:function(e){return e?-1<S.inArray(e,s):0<s.length},empty:function(){return s&&(s=[]),this},disable:function(){return a=u=[],s=t="",this},disabled:function(){return!s},lock:function(){return a=u=[],t||i||(s=t=""),this},locked:function(){return!!a},fireWith:function(e,t){return a||(t=[e,(t=t||[]).slice?t.slice():t],u.push(t),i||c()),this},fire:function(){return f.fireWith(this,arguments),this},fired:function(){return!!o}};return f},S.extend({Deferred:function(e){var o=[["notify","progress",S.Callbacks("memory"),S.Callbacks("memory"),2],["resolve","done",S.Callbacks("once memory"),S.Callbacks("once memory"),0,"resolved"],["reject","fail",S.Callbacks("once memory"),S.Callbacks("once memory"),1,"rejected"]],i="pending",a={state:function(){return i},always:function(){return s.done(arguments).fail(arguments),this},"catch":function(e){return a.then(null,e)},pipe:function(){var i=arguments;return S.Deferred(function(r){S.each(o,function(e,t){var n=m(i[t[4]])&&i[t[4]];s[t[1]](function(){var e=n&&n.apply(this,arguments);e&&m(e.promise)?e.promise().progress(r.notify).done(r.resolve).fail(r.reject):r[t[0]+"With"](this,n?[e]:arguments)})}),i=null}).promise()},then:function(t,n,r){var u=0;function l(i,o,a,s){return function(){var n=this,r=arguments,e=function(){var e,t;if(!(i<u)){if((e=a.apply(n,r))===o.promise())throw new TypeError("Thenable self-resolution");t=e&&("object"==typeof e||"function"==typeof e)&&e.then,m(t)?s?t.call(e,l(u,o,R,s),l(u,o,M,s)):(u++,t.call(e,l(u,o,R,s),l(u,o,M,s),l(u,o,R,o.notifyWith))):(a!==R&&(n=void 0,r=[e]),(s||o.resolveWith)(n,r))}},t=s?e:function(){try{e()}catch(e){S.Deferred.exceptionHook&&S.Deferred.exceptionHook(e,t.stackTrace),u<=i+1&&(a!==M&&(n=void 0,r=[e]),o.rejectWith(n,r))}};i?t():(S.Deferred.getStackHook&&(t.stackTrace=S.Deferred.getStackHook()),C.setTimeout(t))}}return S.Deferred(function(e){o[0][3].add(l(0,e,m(r)?r:R,e.notifyWith)),o[1][3].add(l(0,e,m(t)?t:R)),o[2][3].add(l(0,e,m(n)?n:M))}).promise()},promise:function(e){return null!=e?S.extend(e,a):a}},s={};return S.each(o,function(e,t){var n=t[2],r=t[5];a[t[1]]=n.add,r&&n.add(function(){i=r},o[3-e][2].disable,o[3-e][3].disable,o[0][2].lock,o[0][3].lock),n.add(t[3].fire),s[t[0]]=function(){return s[t[0]+"With"](this===s?void 0:this,arguments),this},s[t[0]+"With"]=n.fireWith}),a.promise(s),e&&e.call(s,s),s},when:function(e){var n=arguments.length,t=n,r=Array(t),i=s.call(arguments),o=S.Deferred(),a=function(t){return function(e){r[t]=this,i[t]=1<arguments.length?s.call(arguments):e,--n||o.resolveWith(r,i)}};if(n<=1&&(I(e,o.done(a(t)).resolve,o.reject,!n),"pending"===o.state()||m(i[t]&&i[t].then)))return o.then();while(t--)I(i[t],a(t),o.reject);return o.promise()}});var W=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;S.Deferred.exceptionHook=function(e,t){C.console&&C.console.warn&&e&&W.test(e.name)&&C.console.warn("jQuery.Deferred exception: "+e.message,e.stack,t)},S.readyException=function(e){C.setTimeout(function(){throw e})};var F=S.Deferred();function B(){E.removeEventListener("DOMContentLoaded",B),C.removeEventListener("load",B),S.ready()}S.fn.ready=function(e){return F.then(e)["catch"](function(e){S.readyException(e)}),this},S.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--S.readyWait:S.isReady)||(S.isReady=!0)!==e&&0<--S.readyWait||F.resolveWith(E,[S])}}),S.ready.then=F.then,"complete"===E.readyState||"loading"!==E.readyState&&!E.documentElement.doScroll?C.setTimeout(S.ready):(E.addEventListener("DOMContentLoaded",B),C.addEventListener("load",B));var $=function(e,t,n,r,i,o,a){var s=0,u=e.length,l=null==n;if("object"===w(n))for(s in i=!0,n)$(e,t,s,n[s],!0,o,a);else if(void 0!==r&&(i=!0,m(r)||(a=!0),l&&(a?(t.call(e,r),t=null):(l=t,t=function(e,t,n){return l.call(S(e),n)})),t))for(;s<u;s++)t(e[s],n,a?r:r.call(e[s],s,t(e[s],n)));return i?e:l?t.call(e):u?t(e[0],n):o},_=/^-ms-/,z=/-([a-z])/g;function U(e,t){return t.toUpperCase()}function X(e){return e.replace(_,"ms-").replace(z,U)}var V=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};function G(){this.expando=S.expando+G.uid++}G.uid=1,G.prototype={cache:function(e){var t=e[this.expando];return t||(t={},V(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,n){var r,i=this.cache(e);if("string"==typeof t)i[X(t)]=n;else for(r in t)i[X(r)]=t[r];return i},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][X(t)]},access:function(e,t,n){return void 0===t||t&&"string"==typeof t&&void 0===n?this.get(e,t):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,r=e[this.expando];if(void 0!==r){if(void 0!==t){n=(t=Array.isArray(t)?t.map(X):(t=X(t))in r?[t]:t.match(P)||[]).length;while(n--)delete r[t[n]]}(void 0===t||S.isEmptyObject(r))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!S.isEmptyObject(t)}};var Y=new G,Q=new G,J=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,K=/[A-Z]/g;function Z(e,t,n){var r,i;if(void 0===n&&1===e.nodeType)if(r="data-"+t.replace(K,"-$&").toLowerCase(),"string"==typeof(n=e.getAttribute(r))){try{n="true"===(i=n)||"false"!==i&&("null"===i?null:i===+i+""?+i:J.test(i)?JSON.parse(i):i)}catch(e){}Q.set(e,t,n)}else n=void 0;return n}S.extend({hasData:function(e){return Q.hasData(e)||Y.hasData(e)},data:function(e,t,n){return Q.access(e,t,n)},removeData:function(e,t){Q.remove(e,t)},_data:function(e,t,n){return Y.access(e,t,n)},_removeData:function(e,t){Y.remove(e,t)}}),S.fn.extend({data:function(n,e){var t,r,i,o=this[0],a=o&&o.attributes;if(void 0===n){if(this.length&&(i=Q.get(o),1===o.nodeType&&!Y.get(o,"hasDataAttrs"))){t=a.length;while(t--)a[t]&&0===(r=a[t].name).indexOf("data-")&&(r=X(r.slice(5)),Z(o,r,i[r]));Y.set(o,"hasDataAttrs",!0)}return i}return"object"==typeof n?this.each(function(){Q.set(this,n)}):$(this,function(e){var t;if(o&&void 0===e)return void 0!==(t=Q.get(o,n))?t:void 0!==(t=Z(o,n))?t:void 0;this.each(function(){Q.set(this,n,e)})},null,e,1<arguments.length,null,!0)},removeData:function(e){return this.each(function(){Q.remove(this,e)})}}),S.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=Y.get(e,t),n&&(!r||Array.isArray(n)?r=Y.access(e,t,S.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=S.queue(e,t),r=n.length,i=n.shift(),o=S._queueHooks(e,t);"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,function(){S.dequeue(e,t)},o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return Y.get(e,n)||Y.access(e,n,{empty:S.Callbacks("once memory").add(function(){Y.remove(e,[t+"queue",n])})})}}),S.fn.extend({queue:function(t,n){var e=2;return"string"!=typeof t&&(n=t,t="fx",e--),arguments.length<e?S.queue(this[0],t):void 0===n?this:this.each(function(){var e=S.queue(this,t,n);S._queueHooks(this,t),"fx"===t&&"inprogress"!==e[0]&&S.dequeue(this,t)})},dequeue:function(e){return this.each(function(){S.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=S.Deferred(),o=this,a=this.length,s=function(){--r||i.resolveWith(o,[o])};"string"!=typeof e&&(t=e,e=void 0),e=e||"fx";while(a--)(n=Y.get(o[a],e+"queueHooks"))&&n.empty&&(r++,n.empty.add(s));return s(),i.promise(t)}});var ee=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,te=new RegExp("^(?:([+-])=|)("+ee+")([a-z%]*)$","i"),ne=["Top","Right","Bottom","Left"],re=E.documentElement,ie=function(e){return S.contains(e.ownerDocument,e)},oe={composed:!0};re.getRootNode&&(ie=function(e){return S.contains(e.ownerDocument,e)||e.getRootNode(oe)===e.ownerDocument});var ae=function(e,t){return"none"===(e=t||e).style.display||""===e.style.display&&ie(e)&&"none"===S.css(e,"display")};function se(e,t,n,r){var i,o,a=20,s=r?function(){return r.cur()}:function(){return S.css(e,t,"")},u=s(),l=n&&n[3]||(S.cssNumber[t]?"":"px"),c=e.nodeType&&(S.cssNumber[t]||"px"!==l&&+u)&&te.exec(S.css(e,t));if(c&&c[3]!==l){u/=2,l=l||c[3],c=+u||1;while(a--)S.style(e,t,c+l),(1-o)*(1-(o=s()/u||.5))<=0&&(a=0),c/=o;c*=2,S.style(e,t,c+l),n=n||[]}return n&&(c=+c||+u||0,i=n[1]?c+(n[1]+1)*n[2]:+n[2],r&&(r.unit=l,r.start=c,r.end=i)),i}var ue={};function le(e,t){for(var n,r,i,o,a,s,u,l=[],c=0,f=e.length;c<f;c++)(r=e[c]).style&&(n=r.style.display,t?("none"===n&&(l[c]=Y.get(r,"display")||null,l[c]||(r.style.display="")),""===r.style.display&&ae(r)&&(l[c]=(u=a=o=void 0,a=(i=r).ownerDocument,s=i.nodeName,(u=ue[s])||(o=a.body.appendChild(a.createElement(s)),u=S.css(o,"display"),o.parentNode.removeChild(o),"none"===u&&(u="block"),ue[s]=u)))):"none"!==n&&(l[c]="none",Y.set(r,"display",n)));for(c=0;c<f;c++)null!=l[c]&&(e[c].style.display=l[c]);return e}S.fn.extend({show:function(){return le(this,!0)},hide:function(){return le(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){ae(this)?S(this).show():S(this).hide()})}});var ce,fe,pe=/^(?:checkbox|radio)$/i,de=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,he=/^$|^module$|\/(?:java|ecma)script/i;ce=E.createDocumentFragment().appendChild(E.createElement("div")),(fe=E.createElement("input")).setAttribute("type","radio"),fe.setAttribute("checked","checked"),fe.setAttribute("name","t"),ce.appendChild(fe),y.checkClone=ce.cloneNode(!0).cloneNode(!0).lastChild.checked,ce.innerHTML="<textarea>x</textarea>",y.noCloneChecked=!!ce.cloneNode(!0).lastChild.defaultValue,ce.innerHTML="<option></option>",y.option=!!ce.lastChild;var ge={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function ve(e,t){var n;return n="undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName(t||"*"):"undefined"!=typeof e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&A(e,t)?S.merge([e],n):n}function ye(e,t){for(var n=0,r=e.length;n<r;n++)Y.set(e[n],"globalEval",!t||Y.get(t[n],"globalEval"))}ge.tbody=ge.tfoot=ge.colgroup=ge.caption=ge.thead,ge.th=ge.td,y.option||(ge.optgroup=ge.option=[1,"<select multiple='multiple'>","</select>"]);var me=/<|&#?\w+;/;function xe(e,t,n,r,i){for(var o,a,s,u,l,c,f=t.createDocumentFragment(),p=[],d=0,h=e.length;d<h;d++)if((o=e[d])||0===o)if("object"===w(o))S.merge(p,o.nodeType?[o]:o);else if(me.test(o)){a=a||f.appendChild(t.createElement("div")),s=(de.exec(o)||["",""])[1].toLowerCase(),u=ge[s]||ge._default,a.innerHTML=u[1]+S.htmlPrefilter(o)+u[2],c=u[0];while(c--)a=a.lastChild;S.merge(p,a.childNodes),(a=f.firstChild).textContent=""}else p.push(t.createTextNode(o));f.textContent="",d=0;while(o=p[d++])if(r&&-1<S.inArray(o,r))i&&i.push(o);else if(l=ie(o),a=ve(f.appendChild(o),"script"),l&&ye(a),n){c=0;while(o=a[c++])he.test(o.type||"")&&n.push(o)}return f}var be=/^([^.]*)(?:\.(.+)|)/;function we(){return!0}function Te(){return!1}function Ce(e,t){return e===function(){try{return E.activeElement}catch(e){}}()==("focus"===t)}function Ee(e,t,n,r,i,o){var a,s;if("object"==typeof t){for(s in"string"!=typeof n&&(r=r||n,n=void 0),t)Ee(e,s,n,r,t[s],o);return e}if(null==r&&null==i?(i=n,r=n=void 0):null==i&&("string"==typeof n?(i=r,r=void 0):(i=r,r=n,n=void 0)),!1===i)i=Te;else if(!i)return e;return 1===o&&(a=i,(i=function(e){return S().off(e),a.apply(this,arguments)}).guid=a.guid||(a.guid=S.guid++)),e.each(function(){S.event.add(this,t,i,r,n)})}function Se(e,i,o){o?(Y.set(e,i,!1),S.event.add(e,i,{namespace:!1,handler:function(e){var t,n,r=Y.get(this,i);if(1&e.isTrigger&&this[i]){if(r.length)(S.event.special[i]||{}).delegateType&&e.stopPropagation();else if(r=s.call(arguments),Y.set(this,i,r),t=o(this,i),this[i](),r!==(n=Y.get(this,i))||t?Y.set(this,i,!1):n={},r!==n)return e.stopImmediatePropagation(),e.preventDefault(),n&&n.value}else r.length&&(Y.set(this,i,{value:S.event.trigger(S.extend(r[0],S.Event.prototype),r.slice(1),this)}),e.stopImmediatePropagation())}})):void 0===Y.get(e,i)&&S.event.add(e,i,we)}S.event={global:{},add:function(t,e,n,r,i){var o,a,s,u,l,c,f,p,d,h,g,v=Y.get(t);if(V(t)){n.handler&&(n=(o=n).handler,i=o.selector),i&&S.find.matchesSelector(re,i),n.guid||(n.guid=S.guid++),(u=v.events)||(u=v.events=Object.create(null)),(a=v.handle)||(a=v.handle=function(e){return"undefined"!=typeof S&&S.event.triggered!==e.type?S.event.dispatch.apply(t,arguments):void 0}),l=(e=(e||"").match(P)||[""]).length;while(l--)d=g=(s=be.exec(e[l])||[])[1],h=(s[2]||"").split(".").sort(),d&&(f=S.event.special[d]||{},d=(i?f.delegateType:f.bindType)||d,f=S.event.special[d]||{},c=S.extend({type:d,origType:g,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&S.expr.match.needsContext.test(i),namespace:h.join(".")},o),(p=u[d])||((p=u[d]=[]).delegateCount=0,f.setup&&!1!==f.setup.call(t,r,h,a)||t.addEventListener&&t.addEventListener(d,a)),f.add&&(f.add.call(t,c),c.handler.guid||(c.handler.guid=n.guid)),i?p.splice(p.delegateCount++,0,c):p.push(c),S.event.global[d]=!0)}},remove:function(e,t,n,r,i){var o,a,s,u,l,c,f,p,d,h,g,v=Y.hasData(e)&&Y.get(e);if(v&&(u=v.events)){l=(t=(t||"").match(P)||[""]).length;while(l--)if(d=g=(s=be.exec(t[l])||[])[1],h=(s[2]||"").split(".").sort(),d){f=S.event.special[d]||{},p=u[d=(r?f.delegateType:f.bindType)||d]||[],s=s[2]&&new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=o=p.length;while(o--)c=p[o],!i&&g!==c.origType||n&&n.guid!==c.guid||s&&!s.test(c.namespace)||r&&r!==c.selector&&("**"!==r||!c.selector)||(p.splice(o,1),c.selector&&p.delegateCount--,f.remove&&f.remove.call(e,c));a&&!p.length&&(f.teardown&&!1!==f.teardown.call(e,h,v.handle)||S.removeEvent(e,d,v.handle),delete u[d])}else for(d in u)S.event.remove(e,d+t[l],n,r,!0);S.isEmptyObject(u)&&Y.remove(e,"handle events")}},dispatch:function(e){var t,n,r,i,o,a,s=new Array(arguments.length),u=S.event.fix(e),l=(Y.get(this,"events")||Object.create(null))[u.type]||[],c=S.event.special[u.type]||{};for(s[0]=u,t=1;t<arguments.length;t++)s[t]=arguments[t];if(u.delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,u)){a=S.event.handlers.call(this,u,l),t=0;while((i=a[t++])&&!u.isPropagationStopped()){u.currentTarget=i.elem,n=0;while((o=i.handlers[n++])&&!u.isImmediatePropagationStopped())u.rnamespace&&!1!==o.namespace&&!u.rnamespace.test(o.namespace)||(u.handleObj=o,u.data=o.data,void 0!==(r=((S.event.special[o.origType]||{}).handle||o.handler).apply(i.elem,s))&&!1===(u.result=r)&&(u.preventDefault(),u.stopPropagation()))}return c.postDispatch&&c.postDispatch.call(this,u),u.result}},handlers:function(e,t){var n,r,i,o,a,s=[],u=t.delegateCount,l=e.target;if(u&&l.nodeType&&!("click"===e.type&&1<=e.button))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&("click"!==e.type||!0!==l.disabled)){for(o=[],a={},n=0;n<u;n++)void 0===a[i=(r=t[n]).selector+" "]&&(a[i]=r.needsContext?-1<S(i,this).index(l):S.find(i,this,null,[l]).length),a[i]&&o.push(r);o.length&&s.push({elem:l,handlers:o})}return l=this,u<t.length&&s.push({elem:l,handlers:t.slice(u)}),s},addProp:function(t,e){Object.defineProperty(S.Event.prototype,t,{enumerable:!0,configurable:!0,get:m(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(e){return e[S.expando]?e:new S.Event(e)},special:{load:{noBubble:!0},click:{setup:function(e){var t=this||e;return pe.test(t.type)&&t.click&&A(t,"input")&&Se(t,"click",we),!1},trigger:function(e){var t=this||e;return pe.test(t.type)&&t.click&&A(t,"input")&&Se(t,"click"),!0},_default:function(e){var t=e.target;return pe.test(t.type)&&t.click&&A(t,"input")&&Y.get(t,"click")||A(t,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},S.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},S.Event=function(e,t){if(!(this instanceof S.Event))return new S.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?we:Te,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&S.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[S.expando]=!0},S.Event.prototype={constructor:S.Event,isDefaultPrevented:Te,isPropagationStopped:Te,isImmediatePropagationStopped:Te,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=we,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=we,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=we,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},S.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,"char":!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},S.event.addProp),S.each({focus:"focusin",blur:"focusout"},function(e,t){S.event.special[e]={setup:function(){return Se(this,e,Ce),!1},trigger:function(){return Se(this,e),!0},_default:function(){return!0},delegateType:t}}),S.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,i){S.event.special[e]={delegateType:i,bindType:i,handle:function(e){var t,n=e.relatedTarget,r=e.handleObj;return n&&(n===this||S.contains(this,n))||(e.type=r.origType,t=r.handler.apply(this,arguments),e.type=i),t}}}),S.fn.extend({on:function(e,t,n,r){return Ee(this,e,t,n,r)},one:function(e,t,n,r){return Ee(this,e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,S(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(i in e)this.off(i,t,e[i]);return this}return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=Te),this.each(function(){S.event.remove(this,e,n,t)})}});var ke=/<script|<style|<link/i,Ae=/checked\s*(?:[^=]|=\s*.checked.)/i,Ne=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function je(e,t){return A(e,"table")&&A(11!==t.nodeType?t:t.firstChild,"tr")&&S(e).children("tbody")[0]||e}function De(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function qe(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function Le(e,t){var n,r,i,o,a,s;if(1===t.nodeType){if(Y.hasData(e)&&(s=Y.get(e).events))for(i in Y.remove(t,"handle events"),s)for(n=0,r=s[i].length;n<r;n++)S.event.add(t,i,s[i][n]);Q.hasData(e)&&(o=Q.access(e),a=S.extend({},o),Q.set(t,a))}}function He(n,r,i,o){r=g(r);var e,t,a,s,u,l,c=0,f=n.length,p=f-1,d=r[0],h=m(d);if(h||1<f&&"string"==typeof d&&!y.checkClone&&Ae.test(d))return n.each(function(e){var t=n.eq(e);h&&(r[0]=d.call(this,e,t.html())),He(t,r,i,o)});if(f&&(t=(e=xe(r,n[0].ownerDocument,!1,n,o)).firstChild,1===e.childNodes.length&&(e=t),t||o)){for(s=(a=S.map(ve(e,"script"),De)).length;c<f;c++)u=e,c!==p&&(u=S.clone(u,!0,!0),s&&S.merge(a,ve(u,"script"))),i.call(n[c],u,c);if(s)for(l=a[a.length-1].ownerDocument,S.map(a,qe),c=0;c<s;c++)u=a[c],he.test(u.type||"")&&!Y.access(u,"globalEval")&&S.contains(l,u)&&(u.src&&"module"!==(u.type||"").toLowerCase()?S._evalUrl&&!u.noModule&&S._evalUrl(u.src,{nonce:u.nonce||u.getAttribute("nonce")},l):b(u.textContent.replace(Ne,""),u,l))}return n}function Oe(e,t,n){for(var r,i=t?S.filter(t,e):e,o=0;null!=(r=i[o]);o++)n||1!==r.nodeType||S.cleanData(ve(r)),r.parentNode&&(n&&ie(r)&&ye(ve(r,"script")),r.parentNode.removeChild(r));return e}S.extend({htmlPrefilter:function(e){return e},clone:function(e,t,n){var r,i,o,a,s,u,l,c=e.cloneNode(!0),f=ie(e);if(!(y.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||S.isXMLDoc(e)))for(a=ve(c),r=0,i=(o=ve(e)).length;r<i;r++)s=o[r],u=a[r],void 0,"input"===(l=u.nodeName.toLowerCase())&&pe.test(s.type)?u.checked=s.checked:"input"!==l&&"textarea"!==l||(u.defaultValue=s.defaultValue);if(t)if(n)for(o=o||ve(e),a=a||ve(c),r=0,i=o.length;r<i;r++)Le(o[r],a[r]);else Le(e,c);return 0<(a=ve(c,"script")).length&&ye(a,!f&&ve(e,"script")),c},cleanData:function(e){for(var t,n,r,i=S.event.special,o=0;void 0!==(n=e[o]);o++)if(V(n)){if(t=n[Y.expando]){if(t.events)for(r in t.events)i[r]?S.event.remove(n,r):S.removeEvent(n,r,t.handle);n[Y.expando]=void 0}n[Q.expando]&&(n[Q.expando]=void 0)}}}),S.fn.extend({detach:function(e){return Oe(this,e,!0)},remove:function(e){return Oe(this,e)},text:function(e){return $(this,function(e){return void 0===e?S.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)})},null,e,arguments.length)},append:function(){return He(this,arguments,function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||je(this,e).appendChild(e)})},prepend:function(){return He(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=je(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return He(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return He(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(S.cleanData(ve(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return S.clone(this,e,t)})},html:function(e){return $(this,function(e){var t=this[0]||{},n=0,r=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!ke.test(e)&&!ge[(de.exec(e)||["",""])[1].toLowerCase()]){e=S.htmlPrefilter(e);try{for(;n<r;n++)1===(t=this[n]||{}).nodeType&&(S.cleanData(ve(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var n=[];return He(this,arguments,function(e){var t=this.parentNode;S.inArray(this,n)<0&&(S.cleanData(ve(this)),t&&t.replaceChild(e,this))},n)}}),S.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,a){S.fn[e]=function(e){for(var t,n=[],r=S(e),i=r.length-1,o=0;o<=i;o++)t=o===i?this:this.clone(!0),S(r[o])[a](t),u.apply(n,t.get());return this.pushStack(n)}});var Pe=new RegExp("^("+ee+")(?!px)[a-z%]+$","i"),Re=function(e){var t=e.ownerDocument.defaultView;return t&&t.opener||(t=C),t.getComputedStyle(e)},Me=function(e,t,n){var r,i,o={};for(i in t)o[i]=e.style[i],e.style[i]=t[i];for(i in r=n.call(e),t)e.style[i]=o[i];return r},Ie=new RegExp(ne.join("|"),"i");function We(e,t,n){var r,i,o,a,s=e.style;return(n=n||Re(e))&&(""!==(a=n.getPropertyValue(t)||n[t])||ie(e)||(a=S.style(e,t)),!y.pixelBoxStyles()&&Pe.test(a)&&Ie.test(t)&&(r=s.width,i=s.minWidth,o=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=n.width,s.width=r,s.minWidth=i,s.maxWidth=o)),void 0!==a?a+"":a}function Fe(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}!function(){function e(){if(l){u.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",l.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",re.appendChild(u).appendChild(l);var e=C.getComputedStyle(l);n="1%"!==e.top,s=12===t(e.marginLeft),l.style.right="60%",o=36===t(e.right),r=36===t(e.width),l.style.position="absolute",i=12===t(l.offsetWidth/3),re.removeChild(u),l=null}}function t(e){return Math.round(parseFloat(e))}var n,r,i,o,a,s,u=E.createElement("div"),l=E.createElement("div");l.style&&(l.style.backgroundClip="content-box",l.cloneNode(!0).style.backgroundClip="",y.clearCloneStyle="content-box"===l.style.backgroundClip,S.extend(y,{boxSizingReliable:function(){return e(),r},pixelBoxStyles:function(){return e(),o},pixelPosition:function(){return e(),n},reliableMarginLeft:function(){return e(),s},scrollboxSize:function(){return e(),i},reliableTrDimensions:function(){var e,t,n,r;return null==a&&(e=E.createElement("table"),t=E.createElement("tr"),n=E.createElement("div"),e.style.cssText="position:absolute;left:-11111px;border-collapse:separate",t.style.cssText="border:1px solid",t.style.height="1px",n.style.height="9px",n.style.display="block",re.appendChild(e).appendChild(t).appendChild(n),r=C.getComputedStyle(t),a=parseInt(r.height,10)+parseInt(r.borderTopWidth,10)+parseInt(r.borderBottomWidth,10)===t.offsetHeight,re.removeChild(e)),a}}))}();var Be=["Webkit","Moz","ms"],$e=E.createElement("div").style,_e={};function ze(e){var t=S.cssProps[e]||_e[e];return t||(e in $e?e:_e[e]=function(e){var t=e[0].toUpperCase()+e.slice(1),n=Be.length;while(n--)if((e=Be[n]+t)in $e)return e}(e)||e)}var Ue=/^(none|table(?!-c[ea]).+)/,Xe=/^--/,Ve={position:"absolute",visibility:"hidden",display:"block"},Ge={letterSpacing:"0",fontWeight:"400"};function Ye(e,t,n){var r=te.exec(t);return r?Math.max(0,r[2]-(n||0))+(r[3]||"px"):t}function Qe(e,t,n,r,i,o){var a="width"===t?1:0,s=0,u=0;if(n===(r?"border":"content"))return 0;for(;a<4;a+=2)"margin"===n&&(u+=S.css(e,n+ne[a],!0,i)),r?("content"===n&&(u-=S.css(e,"padding"+ne[a],!0,i)),"margin"!==n&&(u-=S.css(e,"border"+ne[a]+"Width",!0,i))):(u+=S.css(e,"padding"+ne[a],!0,i),"padding"!==n?u+=S.css(e,"border"+ne[a]+"Width",!0,i):s+=S.css(e,"border"+ne[a]+"Width",!0,i));return!r&&0<=o&&(u+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-o-u-s-.5))||0),u}function Je(e,t,n){var r=Re(e),i=(!y.boxSizingReliable()||n)&&"border-box"===S.css(e,"boxSizing",!1,r),o=i,a=We(e,t,r),s="offset"+t[0].toUpperCase()+t.slice(1);if(Pe.test(a)){if(!n)return a;a="auto"}return(!y.boxSizingReliable()&&i||!y.reliableTrDimensions()&&A(e,"tr")||"auto"===a||!parseFloat(a)&&"inline"===S.css(e,"display",!1,r))&&e.getClientRects().length&&(i="border-box"===S.css(e,"boxSizing",!1,r),(o=s in e)&&(a=e[s])),(a=parseFloat(a)||0)+Qe(e,t,n||(i?"border":"content"),o,r,a)+"px"}function Ke(e,t,n,r,i){return new Ke.prototype.init(e,t,n,r,i)}S.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=We(e,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,o,a,s=X(t),u=Xe.test(t),l=e.style;if(u||(t=ze(s)),a=S.cssHooks[t]||S.cssHooks[s],void 0===n)return a&&"get"in a&&void 0!==(i=a.get(e,!1,r))?i:l[t];"string"===(o=typeof n)&&(i=te.exec(n))&&i[1]&&(n=se(e,t,i),o="number"),null!=n&&n==n&&("number"!==o||u||(n+=i&&i[3]||(S.cssNumber[s]?"":"px")),y.clearCloneStyle||""!==n||0!==t.indexOf("background")||(l[t]="inherit"),a&&"set"in a&&void 0===(n=a.set(e,n,r))||(u?l.setProperty(t,n):l[t]=n))}},css:function(e,t,n,r){var i,o,a,s=X(t);return Xe.test(t)||(t=ze(s)),(a=S.cssHooks[t]||S.cssHooks[s])&&"get"in a&&(i=a.get(e,!0,n)),void 0===i&&(i=We(e,t,r)),"normal"===i&&t in Ge&&(i=Ge[t]),""===n||n?(o=parseFloat(i),!0===n||isFinite(o)?o||0:i):i}}),S.each(["height","width"],function(e,u){S.cssHooks[u]={get:function(e,t,n){if(t)return!Ue.test(S.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?Je(e,u,n):Me(e,Ve,function(){return Je(e,u,n)})},set:function(e,t,n){var r,i=Re(e),o=!y.scrollboxSize()&&"absolute"===i.position,a=(o||n)&&"border-box"===S.css(e,"boxSizing",!1,i),s=n?Qe(e,u,n,a,i):0;return a&&o&&(s-=Math.ceil(e["offset"+u[0].toUpperCase()+u.slice(1)]-parseFloat(i[u])-Qe(e,u,"border",!1,i)-.5)),s&&(r=te.exec(t))&&"px"!==(r[3]||"px")&&(e.style[u]=t,t=S.css(e,u)),Ye(0,t,s)}}}),S.cssHooks.marginLeft=Fe(y.reliableMarginLeft,function(e,t){if(t)return(parseFloat(We(e,"marginLeft"))||e.getBoundingClientRect().left-Me(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px"}),S.each({margin:"",padding:"",border:"Width"},function(i,o){S.cssHooks[i+o]={expand:function(e){for(var t=0,n={},r="string"==typeof e?e.split(" "):[e];t<4;t++)n[i+ne[t]+o]=r[t]||r[t-2]||r[0];return n}},"margin"!==i&&(S.cssHooks[i+o].set=Ye)}),S.fn.extend({css:function(e,t){return $(this,function(e,t,n){var r,i,o={},a=0;if(Array.isArray(t)){for(r=Re(e),i=t.length;a<i;a++)o[t[a]]=S.css(e,t[a],!1,r);return o}return void 0!==n?S.style(e,t,n):S.css(e,t)},e,t,1<arguments.length)}}),((S.Tween=Ke).prototype={constructor:Ke,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||S.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(S.cssNumber[n]?"":"px")},cur:function(){var e=Ke.propHooks[this.prop];return e&&e.get?e.get(this):Ke.propHooks._default.get(this)},run:function(e){var t,n=Ke.propHooks[this.prop];return this.options.duration?this.pos=t=S.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):Ke.propHooks._default.set(this),this}}).init.prototype=Ke.prototype,(Ke.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=S.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){S.fx.step[e.prop]?S.fx.step[e.prop](e):1!==e.elem.nodeType||!S.cssHooks[e.prop]&&null==e.elem.style[ze(e.prop)]?e.elem[e.prop]=e.now:S.style(e.elem,e.prop,e.now+e.unit)}}}).scrollTop=Ke.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},S.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},S.fx=Ke.prototype.init,S.fx.step={};var Ze,et,tt,nt,rt=/^(?:toggle|show|hide)$/,it=/queueHooks$/;function ot(){et&&(!1===E.hidden&&C.requestAnimationFrame?C.requestAnimationFrame(ot):C.setTimeout(ot,S.fx.interval),S.fx.tick())}function at(){return C.setTimeout(function(){Ze=void 0}),Ze=Date.now()}function st(e,t){var n,r=0,i={height:e};for(t=t?1:0;r<4;r+=2-t)i["margin"+(n=ne[r])]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function ut(e,t,n){for(var r,i=(lt.tweeners[t]||[]).concat(lt.tweeners["*"]),o=0,a=i.length;o<a;o++)if(r=i[o].call(n,t,e))return r}function lt(o,e,t){var n,a,r=0,i=lt.prefilters.length,s=S.Deferred().always(function(){delete u.elem}),u=function(){if(a)return!1;for(var e=Ze||at(),t=Math.max(0,l.startTime+l.duration-e),n=1-(t/l.duration||0),r=0,i=l.tweens.length;r<i;r++)l.tweens[r].run(n);return s.notifyWith(o,[l,n,t]),n<1&&i?t:(i||s.notifyWith(o,[l,1,0]),s.resolveWith(o,[l]),!1)},l=s.promise({elem:o,props:S.extend({},e),opts:S.extend(!0,{specialEasing:{},easing:S.easing._default},t),originalProperties:e,originalOptions:t,startTime:Ze||at(),duration:t.duration,tweens:[],createTween:function(e,t){var n=S.Tween(o,l.opts,e,t,l.opts.specialEasing[e]||l.opts.easing);return l.tweens.push(n),n},stop:function(e){var t=0,n=e?l.tweens.length:0;if(a)return this;for(a=!0;t<n;t++)l.tweens[t].run(1);return e?(s.notifyWith(o,[l,1,0]),s.resolveWith(o,[l,e])):s.rejectWith(o,[l,e]),this}}),c=l.props;for(!function(e,t){var n,r,i,o,a;for(n in e)if(i=t[r=X(n)],o=e[n],Array.isArray(o)&&(i=o[1],o=e[n]=o[0]),n!==r&&(e[r]=o,delete e[n]),(a=S.cssHooks[r])&&"expand"in a)for(n in o=a.expand(o),delete e[r],o)n in e||(e[n]=o[n],t[n]=i);else t[r]=i}(c,l.opts.specialEasing);r<i;r++)if(n=lt.prefilters[r].call(l,o,c,l.opts))return m(n.stop)&&(S._queueHooks(l.elem,l.opts.queue).stop=n.stop.bind(n)),n;return S.map(c,ut,l),m(l.opts.start)&&l.opts.start.call(o,l),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always),S.fx.timer(S.extend(u,{elem:o,anim:l,queue:l.opts.queue})),l}S.Animation=S.extend(lt,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return se(n.elem,e,te.exec(t),n),n}]},tweener:function(e,t){m(e)?(t=e,e=["*"]):e=e.match(P);for(var n,r=0,i=e.length;r<i;r++)n=e[r],lt.tweeners[n]=lt.tweeners[n]||[],lt.tweeners[n].unshift(t)},prefilters:[function(e,t,n){var r,i,o,a,s,u,l,c,f="width"in t||"height"in t,p=this,d={},h=e.style,g=e.nodeType&&ae(e),v=Y.get(e,"fxshow");for(r in n.queue||(null==(a=S._queueHooks(e,"fx")).unqueued&&(a.unqueued=0,s=a.empty.fire,a.empty.fire=function(){a.unqueued||s()}),a.unqueued++,p.always(function(){p.always(function(){a.unqueued--,S.queue(e,"fx").length||a.empty.fire()})})),t)if(i=t[r],rt.test(i)){if(delete t[r],o=o||"toggle"===i,i===(g?"hide":"show")){if("show"!==i||!v||void 0===v[r])continue;g=!0}d[r]=v&&v[r]||S.style(e,r)}if((u=!S.isEmptyObject(t))||!S.isEmptyObject(d))for(r in f&&1===e.nodeType&&(n.overflow=[h.overflow,h.overflowX,h.overflowY],null==(l=v&&v.display)&&(l=Y.get(e,"display")),"none"===(c=S.css(e,"display"))&&(l?c=l:(le([e],!0),l=e.style.display||l,c=S.css(e,"display"),le([e]))),("inline"===c||"inline-block"===c&&null!=l)&&"none"===S.css(e,"float")&&(u||(p.done(function(){h.display=l}),null==l&&(c=h.display,l="none"===c?"":c)),h.display="inline-block")),n.overflow&&(h.overflow="hidden",p.always(function(){h.overflow=n.overflow[0],h.overflowX=n.overflow[1],h.overflowY=n.overflow[2]})),u=!1,d)u||(v?"hidden"in v&&(g=v.hidden):v=Y.access(e,"fxshow",{display:l}),o&&(v.hidden=!g),g&&le([e],!0),p.done(function(){for(r in g||le([e]),Y.remove(e,"fxshow"),d)S.style(e,r,d[r])})),u=ut(g?v[r]:0,r,p),r in v||(v[r]=u.start,g&&(u.end=u.start,u.start=0))}],prefilter:function(e,t){t?lt.prefilters.unshift(e):lt.prefilters.push(e)}}),S.speed=function(e,t,n){var r=e&&"object"==typeof e?S.extend({},e):{complete:n||!n&&t||m(e)&&e,duration:e,easing:n&&t||t&&!m(t)&&t};return S.fx.off?r.duration=0:"number"!=typeof r.duration&&(r.duration in S.fx.speeds?r.duration=S.fx.speeds[r.duration]:r.duration=S.fx.speeds._default),null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){m(r.old)&&r.old.call(this),r.queue&&S.dequeue(this,r.queue)},r},S.fn.extend({fadeTo:function(e,t,n,r){return this.filter(ae).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(t,e,n,r){var i=S.isEmptyObject(t),o=S.speed(e,n,r),a=function(){var e=lt(this,S.extend({},t),o);(i||Y.get(this,"finish"))&&e.stop(!0)};return a.finish=a,i||!1===o.queue?this.each(a):this.queue(o.queue,a)},stop:function(i,e,o){var a=function(e){var t=e.stop;delete e.stop,t(o)};return"string"!=typeof i&&(o=e,e=i,i=void 0),e&&this.queue(i||"fx",[]),this.each(function(){var e=!0,t=null!=i&&i+"queueHooks",n=S.timers,r=Y.get(this);if(t)r[t]&&r[t].stop&&a(r[t]);else for(t in r)r[t]&&r[t].stop&&it.test(t)&&a(r[t]);for(t=n.length;t--;)n[t].elem!==this||null!=i&&n[t].queue!==i||(n[t].anim.stop(o),e=!1,n.splice(t,1));!e&&o||S.dequeue(this,i)})},finish:function(a){return!1!==a&&(a=a||"fx"),this.each(function(){var e,t=Y.get(this),n=t[a+"queue"],r=t[a+"queueHooks"],i=S.timers,o=n?n.length:0;for(t.finish=!0,S.queue(this,a,[]),r&&r.stop&&r.stop.call(this,!0),e=i.length;e--;)i[e].elem===this&&i[e].queue===a&&(i[e].anim.stop(!0),i.splice(e,1));for(e=0;e<o;e++)n[e]&&n[e].finish&&n[e].finish.call(this);delete t.finish})}}),S.each(["toggle","show","hide"],function(e,r){var i=S.fn[r];S.fn[r]=function(e,t,n){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate(st(r,!0),e,t,n)}}),S.each({slideDown:st("show"),slideUp:st("hide"),slideToggle:st("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,r){S.fn[e]=function(e,t,n){return this.animate(r,e,t,n)}}),S.timers=[],S.fx.tick=function(){var e,t=0,n=S.timers;for(Ze=Date.now();t<n.length;t++)(e=n[t])()||n[t]!==e||n.splice(t--,1);n.length||S.fx.stop(),Ze=void 0},S.fx.timer=function(e){S.timers.push(e),S.fx.start()},S.fx.interval=13,S.fx.start=function(){et||(et=!0,ot())},S.fx.stop=function(){et=null},S.fx.speeds={slow:600,fast:200,_default:400},S.fn.delay=function(r,e){return r=S.fx&&S.fx.speeds[r]||r,e=e||"fx",this.queue(e,function(e,t){var n=C.setTimeout(e,r);t.stop=function(){C.clearTimeout(n)}})},tt=E.createElement("input"),nt=E.createElement("select").appendChild(E.createElement("option")),tt.type="checkbox",y.checkOn=""!==tt.value,y.optSelected=nt.selected,(tt=E.createElement("input")).value="t",tt.type="radio",y.radioValue="t"===tt.value;var ct,ft=S.expr.attrHandle;S.fn.extend({attr:function(e,t){return $(this,S.attr,e,t,1<arguments.length)},removeAttr:function(e){return this.each(function(){S.removeAttr(this,e)})}}),S.extend({attr:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return"undefined"==typeof e.getAttribute?S.prop(e,t,n):(1===o&&S.isXMLDoc(e)||(i=S.attrHooks[t.toLowerCase()]||(S.expr.match.bool.test(t)?ct:void 0)),void 0!==n?null===n?void S.removeAttr(e,t):i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:(e.setAttribute(t,n+""),n):i&&"get"in i&&null!==(r=i.get(e,t))?r:null==(r=S.find.attr(e,t))?void 0:r)},attrHooks:{type:{set:function(e,t){if(!y.radioValue&&"radio"===t&&A(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,r=0,i=t&&t.match(P);if(i&&1===e.nodeType)while(n=i[r++])e.removeAttribute(n)}}),ct={set:function(e,t,n){return!1===t?S.removeAttr(e,n):e.setAttribute(n,n),n}},S.each(S.expr.match.bool.source.match(/\w+/g),function(e,t){var a=ft[t]||S.find.attr;ft[t]=function(e,t,n){var r,i,o=t.toLowerCase();return n||(i=ft[o],ft[o]=r,r=null!=a(e,t,n)?o:null,ft[o]=i),r}});var pt=/^(?:input|select|textarea|button)$/i,dt=/^(?:a|area)$/i;function ht(e){return(e.match(P)||[]).join(" ")}function gt(e){return e.getAttribute&&e.getAttribute("class")||""}function vt(e){return Array.isArray(e)?e:"string"==typeof e&&e.match(P)||[]}S.fn.extend({prop:function(e,t){return $(this,S.prop,e,t,1<arguments.length)},removeProp:function(e){return this.each(function(){delete this[S.propFix[e]||e]})}}),S.extend({prop:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&S.isXMLDoc(e)||(t=S.propFix[t]||t,i=S.propHooks[t]),void 0!==n?i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:e[t]=n:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){var t=S.find.attr(e,"tabindex");return t?parseInt(t,10):pt.test(e.nodeName)||dt.test(e.nodeName)&&e.href?0:-1}}},propFix:{"for":"htmlFor","class":"className"}}),y.optSelected||(S.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),S.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){S.propFix[this.toLowerCase()]=this}),S.fn.extend({addClass:function(t){var e,n,r,i,o,a,s,u=0;if(m(t))return this.each(function(e){S(this).addClass(t.call(this,e,gt(this)))});if((e=vt(t)).length)while(n=this[u++])if(i=gt(n),r=1===n.nodeType&&" "+ht(i)+" "){a=0;while(o=e[a++])r.indexOf(" "+o+" ")<0&&(r+=o+" ");i!==(s=ht(r))&&n.setAttribute("class",s)}return this},removeClass:function(t){var e,n,r,i,o,a,s,u=0;if(m(t))return this.each(function(e){S(this).removeClass(t.call(this,e,gt(this)))});if(!arguments.length)return this.attr("class","");if((e=vt(t)).length)while(n=this[u++])if(i=gt(n),r=1===n.nodeType&&" "+ht(i)+" "){a=0;while(o=e[a++])while(-1<r.indexOf(" "+o+" "))r=r.replace(" "+o+" "," ");i!==(s=ht(r))&&n.setAttribute("class",s)}return this},toggleClass:function(i,t){var o=typeof i,a="string"===o||Array.isArray(i);return"boolean"==typeof t&&a?t?this.addClass(i):this.removeClass(i):m(i)?this.each(function(e){S(this).toggleClass(i.call(this,e,gt(this),t),t)}):this.each(function(){var e,t,n,r;if(a){t=0,n=S(this),r=vt(i);while(e=r[t++])n.hasClass(e)?n.removeClass(e):n.addClass(e)}else void 0!==i&&"boolean"!==o||((e=gt(this))&&Y.set(this,"__className__",e),this.setAttribute&&this.setAttribute("class",e||!1===i?"":Y.get(this,"__className__")||""))})},hasClass:function(e){var t,n,r=0;t=" "+e+" ";while(n=this[r++])if(1===n.nodeType&&-1<(" "+ht(gt(n))+" ").indexOf(t))return!0;return!1}});var yt=/\r/g;S.fn.extend({val:function(n){var r,e,i,t=this[0];return arguments.length?(i=m(n),this.each(function(e){var t;1===this.nodeType&&(null==(t=i?n.call(this,e,S(this).val()):n)?t="":"number"==typeof t?t+="":Array.isArray(t)&&(t=S.map(t,function(e){return null==e?"":e+""})),(r=S.valHooks[this.type]||S.valHooks[this.nodeName.toLowerCase()])&&"set"in r&&void 0!==r.set(this,t,"value")||(this.value=t))})):t?(r=S.valHooks[t.type]||S.valHooks[t.nodeName.toLowerCase()])&&"get"in r&&void 0!==(e=r.get(t,"value"))?e:"string"==typeof(e=t.value)?e.replace(yt,""):null==e?"":e:void 0}}),S.extend({valHooks:{option:{get:function(e){var t=S.find.attr(e,"value");return null!=t?t:ht(S.text(e))}},select:{get:function(e){var t,n,r,i=e.options,o=e.selectedIndex,a="select-one"===e.type,s=a?null:[],u=a?o+1:i.length;for(r=o<0?u:a?o:0;r<u;r++)if(((n=i[r]).selected||r===o)&&!n.disabled&&(!n.parentNode.disabled||!A(n.parentNode,"optgroup"))){if(t=S(n).val(),a)return t;s.push(t)}return s},set:function(e,t){var n,r,i=e.options,o=S.makeArray(t),a=i.length;while(a--)((r=i[a]).selected=-1<S.inArray(S.valHooks.option.get(r),o))&&(n=!0);return n||(e.selectedIndex=-1),o}}}}),S.each(["radio","checkbox"],function(){S.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=-1<S.inArray(S(e).val(),t)}},y.checkOn||(S.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}),y.focusin="onfocusin"in C;var mt=/^(?:focusinfocus|focusoutblur)$/,xt=function(e){e.stopPropagation()};S.extend(S.event,{trigger:function(e,t,n,r){var i,o,a,s,u,l,c,f,p=[n||E],d=v.call(e,"type")?e.type:e,h=v.call(e,"namespace")?e.namespace.split("."):[];if(o=f=a=n=n||E,3!==n.nodeType&&8!==n.nodeType&&!mt.test(d+S.event.triggered)&&(-1<d.indexOf(".")&&(d=(h=d.split(".")).shift(),h.sort()),u=d.indexOf(":")<0&&"on"+d,(e=e[S.expando]?e:new S.Event(d,"object"==typeof e&&e)).isTrigger=r?2:3,e.namespace=h.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=n),t=null==t?[e]:S.makeArray(t,[e]),c=S.event.special[d]||{},r||!c.trigger||!1!==c.trigger.apply(n,t))){if(!r&&!c.noBubble&&!x(n)){for(s=c.delegateType||d,mt.test(s+d)||(o=o.parentNode);o;o=o.parentNode)p.push(o),a=o;a===(n.ownerDocument||E)&&p.push(a.defaultView||a.parentWindow||C)}i=0;while((o=p[i++])&&!e.isPropagationStopped())f=o,e.type=1<i?s:c.bindType||d,(l=(Y.get(o,"events")||Object.create(null))[e.type]&&Y.get(o,"handle"))&&l.apply(o,t),(l=u&&o[u])&&l.apply&&V(o)&&(e.result=l.apply(o,t),!1===e.result&&e.preventDefault());return e.type=d,r||e.isDefaultPrevented()||c._default&&!1!==c._default.apply(p.pop(),t)||!V(n)||u&&m(n[d])&&!x(n)&&((a=n[u])&&(n[u]=null),S.event.triggered=d,e.isPropagationStopped()&&f.addEventListener(d,xt),n[d](),e.isPropagationStopped()&&f.removeEventListener(d,xt),S.event.triggered=void 0,a&&(n[u]=a)),e.result}},simulate:function(e,t,n){var r=S.extend(new S.Event,n,{type:e,isSimulated:!0});S.event.trigger(r,null,t)}}),S.fn.extend({trigger:function(e,t){return this.each(function(){S.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return S.event.trigger(e,t,n,!0)}}),y.focusin||S.each({focus:"focusin",blur:"focusout"},function(n,r){var i=function(e){S.event.simulate(r,e.target,S.event.fix(e))};S.event.special[r]={setup:function(){var e=this.ownerDocument||this.document||this,t=Y.access(e,r);t||e.addEventListener(n,i,!0),Y.access(e,r,(t||0)+1)},teardown:function(){var e=this.ownerDocument||this.document||this,t=Y.access(e,r)-1;t?Y.access(e,r,t):(e.removeEventListener(n,i,!0),Y.remove(e,r))}}});var bt=C.location,wt={guid:Date.now()},Tt=/\?/;S.parseXML=function(e){var t,n;if(!e||"string"!=typeof e)return null;try{t=(new C.DOMParser).parseFromString(e,"text/xml")}catch(e){}return n=t&&t.getElementsByTagName("parsererror")[0],t&&!n||S.error("Invalid XML: "+(n?S.map(n.childNodes,function(e){return e.textContent}).join("\n"):e)),t};var Ct=/\[\]$/,Et=/\r?\n/g,St=/^(?:submit|button|image|reset|file)$/i,kt=/^(?:input|select|textarea|keygen)/i;function At(n,e,r,i){var t;if(Array.isArray(e))S.each(e,function(e,t){r||Ct.test(n)?i(n,t):At(n+"["+("object"==typeof t&&null!=t?e:"")+"]",t,r,i)});else if(r||"object"!==w(e))i(n,e);else for(t in e)At(n+"["+t+"]",e[t],r,i)}S.param=function(e,t){var n,r=[],i=function(e,t){var n=m(t)?t():t;r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==n?"":n)};if(null==e)return"";if(Array.isArray(e)||e.jquery&&!S.isPlainObject(e))S.each(e,function(){i(this.name,this.value)});else for(n in e)At(n,e[n],t,i);return r.join("&")},S.fn.extend({serialize:function(){return S.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=S.prop(this,"elements");return e?S.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!S(this).is(":disabled")&&kt.test(this.nodeName)&&!St.test(e)&&(this.checked||!pe.test(e))}).map(function(e,t){var n=S(this).val();return null==n?null:Array.isArray(n)?S.map(n,function(e){return{name:t.name,value:e.replace(Et,"\r\n")}}):{name:t.name,value:n.replace(Et,"\r\n")}}).get()}});var Nt=/%20/g,jt=/#.*$/,Dt=/([?&])_=[^&]*/,qt=/^(.*?):[ \t]*([^\r\n]*)$/gm,Lt=/^(?:GET|HEAD)$/,Ht=/^\/\//,Ot={},Pt={},Rt="*/".concat("*"),Mt=E.createElement("a");function It(o){return function(e,t){"string"!=typeof e&&(t=e,e="*");var n,r=0,i=e.toLowerCase().match(P)||[];if(m(t))while(n=i[r++])"+"===n[0]?(n=n.slice(1)||"*",(o[n]=o[n]||[]).unshift(t)):(o[n]=o[n]||[]).push(t)}}function Wt(t,i,o,a){var s={},u=t===Pt;function l(e){var r;return s[e]=!0,S.each(t[e]||[],function(e,t){var n=t(i,o,a);return"string"!=typeof n||u||s[n]?u?!(r=n):void 0:(i.dataTypes.unshift(n),l(n),!1)}),r}return l(i.dataTypes[0])||!s["*"]&&l("*")}function Ft(e,t){var n,r,i=S.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((i[n]?e:r||(r={}))[n]=t[n]);return r&&S.extend(!0,e,r),e}Mt.href=bt.href,S.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:bt.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(bt.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Rt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":S.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Ft(Ft(e,S.ajaxSettings),t):Ft(S.ajaxSettings,e)},ajaxPrefilter:It(Ot),ajaxTransport:It(Pt),ajax:function(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var c,f,p,n,d,r,h,g,i,o,v=S.ajaxSetup({},t),y=v.context||v,m=v.context&&(y.nodeType||y.jquery)?S(y):S.event,x=S.Deferred(),b=S.Callbacks("once memory"),w=v.statusCode||{},a={},s={},u="canceled",T={readyState:0,getResponseHeader:function(e){var t;if(h){if(!n){n={};while(t=qt.exec(p))n[t[1].toLowerCase()+" "]=(n[t[1].toLowerCase()+" "]||[]).concat(t[2])}t=n[e.toLowerCase()+" "]}return null==t?null:t.join(", ")},getAllResponseHeaders:function(){return h?p:null},setRequestHeader:function(e,t){return null==h&&(e=s[e.toLowerCase()]=s[e.toLowerCase()]||e,a[e]=t),this},overrideMimeType:function(e){return null==h&&(v.mimeType=e),this},statusCode:function(e){var t;if(e)if(h)T.always(e[T.status]);else for(t in e)w[t]=[w[t],e[t]];return this},abort:function(e){var t=e||u;return c&&c.abort(t),l(0,t),this}};if(x.promise(T),v.url=((e||v.url||bt.href)+"").replace(Ht,bt.protocol+"//"),v.type=t.method||t.type||v.method||v.type,v.dataTypes=(v.dataType||"*").toLowerCase().match(P)||[""],null==v.crossDomain){r=E.createElement("a");try{r.href=v.url,r.href=r.href,v.crossDomain=Mt.protocol+"//"+Mt.host!=r.protocol+"//"+r.host}catch(e){v.crossDomain=!0}}if(v.data&&v.processData&&"string"!=typeof v.data&&(v.data=S.param(v.data,v.traditional)),Wt(Ot,v,t,T),h)return T;for(i in(g=S.event&&v.global)&&0==S.active++&&S.event.trigger("ajaxStart"),v.type=v.type.toUpperCase(),v.hasContent=!Lt.test(v.type),f=v.url.replace(jt,""),v.hasContent?v.data&&v.processData&&0===(v.contentType||"").indexOf("application/x-www-form-urlencoded")&&(v.data=v.data.replace(Nt,"+")):(o=v.url.slice(f.length),v.data&&(v.processData||"string"==typeof v.data)&&(f+=(Tt.test(f)?"&":"?")+v.data,delete v.data),!1===v.cache&&(f=f.replace(Dt,"$1"),o=(Tt.test(f)?"&":"?")+"_="+wt.guid+++o),v.url=f+o),v.ifModified&&(S.lastModified[f]&&T.setRequestHeader("If-Modified-Since",S.lastModified[f]),S.etag[f]&&T.setRequestHeader("If-None-Match",S.etag[f])),(v.data&&v.hasContent&&!1!==v.contentType||t.contentType)&&T.setRequestHeader("Content-Type",v.contentType),T.setRequestHeader("Accept",v.dataTypes[0]&&v.accepts[v.dataTypes[0]]?v.accepts[v.dataTypes[0]]+("*"!==v.dataTypes[0]?", "+Rt+"; q=0.01":""):v.accepts["*"]),v.headers)T.setRequestHeader(i,v.headers[i]);if(v.beforeSend&&(!1===v.beforeSend.call(y,T,v)||h))return T.abort();if(u="abort",b.add(v.complete),T.done(v.success),T.fail(v.error),c=Wt(Pt,v,t,T)){if(T.readyState=1,g&&m.trigger("ajaxSend",[T,v]),h)return T;v.async&&0<v.timeout&&(d=C.setTimeout(function(){T.abort("timeout")},v.timeout));try{h=!1,c.send(a,l)}catch(e){if(h)throw e;l(-1,e)}}else l(-1,"No Transport");function l(e,t,n,r){var i,o,a,s,u,l=t;h||(h=!0,d&&C.clearTimeout(d),c=void 0,p=r||"",T.readyState=0<e?4:0,i=200<=e&&e<300||304===e,n&&(s=function(e,t,n){var r,i,o,a,s=e.contents,u=e.dataTypes;while("*"===u[0])u.shift(),void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in s)if(s[i]&&s[i].test(r)){u.unshift(i);break}if(u[0]in n)o=u[0];else{for(i in n){if(!u[0]||e.converters[i+" "+u[0]]){o=i;break}a||(a=i)}o=o||a}if(o)return o!==u[0]&&u.unshift(o),n[o]}(v,T,n)),!i&&-1<S.inArray("script",v.dataTypes)&&S.inArray("json",v.dataTypes)<0&&(v.converters["text script"]=function(){}),s=function(e,t,n,r){var i,o,a,s,u,l={},c=e.dataTypes.slice();if(c[1])for(a in e.converters)l[a.toLowerCase()]=e.converters[a];o=c.shift();while(o)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!u&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),u=o,o=c.shift())if("*"===o)o=u;else if("*"!==u&&u!==o){if(!(a=l[u+" "+o]||l["* "+o]))for(i in l)if((s=i.split(" "))[1]===o&&(a=l[u+" "+s[0]]||l["* "+s[0]])){!0===a?a=l[i]:!0!==l[i]&&(o=s[0],c.unshift(s[1]));break}if(!0!==a)if(a&&e["throws"])t=a(t);else try{t=a(t)}catch(e){return{state:"parsererror",error:a?e:"No conversion from "+u+" to "+o}}}return{state:"success",data:t}}(v,s,T,i),i?(v.ifModified&&((u=T.getResponseHeader("Last-Modified"))&&(S.lastModified[f]=u),(u=T.getResponseHeader("etag"))&&(S.etag[f]=u)),204===e||"HEAD"===v.type?l="nocontent":304===e?l="notmodified":(l=s.state,o=s.data,i=!(a=s.error))):(a=l,!e&&l||(l="error",e<0&&(e=0))),T.status=e,T.statusText=(t||l)+"",i?x.resolveWith(y,[o,l,T]):x.rejectWith(y,[T,l,a]),T.statusCode(w),w=void 0,g&&m.trigger(i?"ajaxSuccess":"ajaxError",[T,v,i?o:a]),b.fireWith(y,[T,l]),g&&(m.trigger("ajaxComplete",[T,v]),--S.active||S.event.trigger("ajaxStop")))}return T},getJSON:function(e,t,n){return S.get(e,t,n,"json")},getScript:function(e,t){return S.get(e,void 0,t,"script")}}),S.each(["get","post"],function(e,i){S[i]=function(e,t,n,r){return m(t)&&(r=r||n,n=t,t=void 0),S.ajax(S.extend({url:e,type:i,dataType:r,data:t,success:n},S.isPlainObject(e)&&e))}}),S.ajaxPrefilter(function(e){var t;for(t in e.headers)"content-type"===t.toLowerCase()&&(e.contentType=e.headers[t]||"")}),S._evalUrl=function(e,t,n){return S.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(e){S.globalEval(e,t,n)}})},S.fn.extend({wrapAll:function(e){var t;return this[0]&&(m(e)&&(e=e.call(this[0])),t=S(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstElementChild)e=e.firstElementChild;return e}).append(this)),this},wrapInner:function(n){return m(n)?this.each(function(e){S(this).wrapInner(n.call(this,e))}):this.each(function(){var e=S(this),t=e.contents();t.length?t.wrapAll(n):e.append(n)})},wrap:function(t){var n=m(t);return this.each(function(e){S(this).wrapAll(n?t.call(this,e):t)})},unwrap:function(e){return this.parent(e).not("body").each(function(){S(this).replaceWith(this.childNodes)}),this}}),S.expr.pseudos.hidden=function(e){return!S.expr.pseudos.visible(e)},S.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},S.ajaxSettings.xhr=function(){try{return new C.XMLHttpRequest}catch(e){}};var Bt={0:200,1223:204},$t=S.ajaxSettings.xhr();y.cors=!!$t&&"withCredentials"in $t,y.ajax=$t=!!$t,S.ajaxTransport(function(i){var o,a;if(y.cors||$t&&!i.crossDomain)return{send:function(e,t){var n,r=i.xhr();if(r.open(i.type,i.url,i.async,i.username,i.password),i.xhrFields)for(n in i.xhrFields)r[n]=i.xhrFields[n];for(n in i.mimeType&&r.overrideMimeType&&r.overrideMimeType(i.mimeType),i.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest"),e)r.setRequestHeader(n,e[n]);o=function(e){return function(){o&&(o=a=r.onload=r.onerror=r.onabort=r.ontimeout=r.onreadystatechange=null,"abort"===e?r.abort():"error"===e?"number"!=typeof r.status?t(0,"error"):t(r.status,r.statusText):t(Bt[r.status]||r.status,r.statusText,"text"!==(r.responseType||"text")||"string"!=typeof r.responseText?{binary:r.response}:{text:r.responseText},r.getAllResponseHeaders()))}},r.onload=o(),a=r.onerror=r.ontimeout=o("error"),void 0!==r.onabort?r.onabort=a:r.onreadystatechange=function(){4===r.readyState&&C.setTimeout(function(){o&&a()})},o=o("abort");try{r.send(i.hasContent&&i.data||null)}catch(e){if(o)throw e}},abort:function(){o&&o()}}}),S.ajaxPrefilter(function(e){e.crossDomain&&(e.contents.script=!1)}),S.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return S.globalEval(e),e}}}),S.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),S.ajaxTransport("script",function(n){var r,i;if(n.crossDomain||n.scriptAttrs)return{send:function(e,t){r=S("<script>").attr(n.scriptAttrs||{}).prop({charset:n.scriptCharset,src:n.url}).on("load error",i=function(e){r.remove(),i=null,e&&t("error"===e.type?404:200,e.type)}),E.head.appendChild(r[0])},abort:function(){i&&i()}}});var _t,zt=[],Ut=/(=)\?(?=&|$)|\?\?/;S.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=zt.pop()||S.expando+"_"+wt.guid++;return this[e]=!0,e}}),S.ajaxPrefilter("json jsonp",function(e,t,n){var r,i,o,a=!1!==e.jsonp&&(Ut.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Ut.test(e.data)&&"data");if(a||"jsonp"===e.dataTypes[0])return r=e.jsonpCallback=m(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,a?e[a]=e[a].replace(Ut,"$1"+r):!1!==e.jsonp&&(e.url+=(Tt.test(e.url)?"&":"?")+e.jsonp+"="+r),e.converters["script json"]=function(){return o||S.error(r+" was not called"),o[0]},e.dataTypes[0]="json",i=C[r],C[r]=function(){o=arguments},n.always(function(){void 0===i?S(C).removeProp(r):C[r]=i,e[r]&&(e.jsonpCallback=t.jsonpCallback,zt.push(r)),o&&m(i)&&i(o[0]),o=i=void 0}),"script"}),y.createHTMLDocument=((_t=E.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===_t.childNodes.length),S.parseHTML=function(e,t,n){return"string"!=typeof e?[]:("boolean"==typeof t&&(n=t,t=!1),t||(y.createHTMLDocument?((r=(t=E.implementation.createHTMLDocument("")).createElement("base")).href=E.location.href,t.head.appendChild(r)):t=E),o=!n&&[],(i=N.exec(e))?[t.createElement(i[1])]:(i=xe([e],t,o),o&&o.length&&S(o).remove(),S.merge([],i.childNodes)));var r,i,o},S.fn.load=function(e,t,n){var r,i,o,a=this,s=e.indexOf(" ");return-1<s&&(r=ht(e.slice(s)),e=e.slice(0,s)),m(t)?(n=t,t=void 0):t&&"object"==typeof t&&(i="POST"),0<a.length&&S.ajax({url:e,type:i||"GET",dataType:"html",data:t}).done(function(e){o=arguments,a.html(r?S("<div>").append(S.parseHTML(e)).find(r):e)}).always(n&&function(e,t){a.each(function(){n.apply(this,o||[e.responseText,t,e])})}),this},S.expr.pseudos.animated=function(t){return S.grep(S.timers,function(e){return t===e.elem}).length},S.offset={setOffset:function(e,t,n){var r,i,o,a,s,u,l=S.css(e,"position"),c=S(e),f={};"static"===l&&(e.style.position="relative"),s=c.offset(),o=S.css(e,"top"),u=S.css(e,"left"),("absolute"===l||"fixed"===l)&&-1<(o+u).indexOf("auto")?(a=(r=c.position()).top,i=r.left):(a=parseFloat(o)||0,i=parseFloat(u)||0),m(t)&&(t=t.call(e,n,S.extend({},s))),null!=t.top&&(f.top=t.top-s.top+a),null!=t.left&&(f.left=t.left-s.left+i),"using"in t?t.using.call(e,f):c.css(f)}},S.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){S.offset.setOffset(this,t,e)});var e,n,r=this[0];return r?r.getClientRects().length?(e=r.getBoundingClientRect(),n=r.ownerDocument.defaultView,{top:e.top+n.pageYOffset,left:e.left+n.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var e,t,n,r=this[0],i={top:0,left:0};if("fixed"===S.css(r,"position"))t=r.getBoundingClientRect();else{t=this.offset(),n=r.ownerDocument,e=r.offsetParent||n.documentElement;while(e&&(e===n.body||e===n.documentElement)&&"static"===S.css(e,"position"))e=e.parentNode;e&&e!==r&&1===e.nodeType&&((i=S(e).offset()).top+=S.css(e,"borderTopWidth",!0),i.left+=S.css(e,"borderLeftWidth",!0))}return{top:t.top-i.top-S.css(r,"marginTop",!0),left:t.left-i.left-S.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var e=this.offsetParent;while(e&&"static"===S.css(e,"position"))e=e.offsetParent;return e||re})}}),S.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,i){var o="pageYOffset"===i;S.fn[t]=function(e){return $(this,function(e,t,n){var r;if(x(e)?r=e:9===e.nodeType&&(r=e.defaultView),void 0===n)return r?r[i]:e[t];r?r.scrollTo(o?r.pageXOffset:n,o?n:r.pageYOffset):e[t]=n},t,e,arguments.length)}}),S.each(["top","left"],function(e,n){S.cssHooks[n]=Fe(y.pixelPosition,function(e,t){if(t)return t=We(e,n),Pe.test(t)?S(e).position()[n]+"px":t})}),S.each({Height:"height",Width:"width"},function(a,s){S.each({padding:"inner"+a,content:s,"":"outer"+a},function(r,o){S.fn[o]=function(e,t){var n=arguments.length&&(r||"boolean"!=typeof e),i=r||(!0===e||!0===t?"margin":"border");return $(this,function(e,t,n){var r;return x(e)?0===o.indexOf("outer")?e["inner"+a]:e.document.documentElement["client"+a]:9===e.nodeType?(r=e.documentElement,Math.max(e.body["scroll"+a],r["scroll"+a],e.body["offset"+a],r["offset"+a],r["client"+a])):void 0===n?S.css(e,t,i):S.style(e,t,n,i)},s,n?e:void 0,n)}})}),S.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){S.fn[t]=function(e){return this.on(t,e)}}),S.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),S.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(e,n){S.fn[n]=function(e,t){return 0<arguments.length?this.on(n,null,e,t):this.trigger(n)}});var Xt=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;S.proxy=function(e,t){var n,r,i;if("string"==typeof t&&(n=e[t],t=e,e=n),m(e))return r=s.call(arguments,2),(i=function(){return e.apply(t||this,r.concat(s.call(arguments)))}).guid=e.guid=e.guid||S.guid++,i},S.holdReady=function(e){e?S.readyWait++:S.ready(!0)},S.isArray=Array.isArray,S.parseJSON=JSON.parse,S.nodeName=A,S.isFunction=m,S.isWindow=x,S.camelCase=X,S.type=w,S.now=Date.now,S.isNumeric=function(e){var t=S.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},S.trim=function(e){return null==e?"":(e+"").replace(Xt,"")},"function"==typeof define&&define.amd&&define("jquery",[],function(){return S});var Vt=C.jQuery,Gt=C.$;return S.noConflict=function(e){return C.$===S&&(C.$=Gt),e&&C.jQuery===S&&(C.jQuery=Vt),S},"undefined"==typeof e&&(C.jQuery=C.$=S),S});
/*
 * jQuery throttle / debounce - v1.1 - 3/7/2010
 * http://benalman.com/projects/jquery-throttle-debounce-plugin/
 * 
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */
(function(b,c){var $=b.jQuery||b.Cowboy||(b.Cowboy={}),a;$.throttle=a=function(e,f,j,i){var h,d=0;if(typeof f!=="boolean"){i=j;j=f;f=c}function g(){var o=this,m=+new Date()-d,n=arguments;function l(){d=+new Date();j.apply(o,n)}function k(){h=c}if(i&&!h){l()}h&&clearTimeout(h);if(i===c&&m>e){l()}else{if(f!==true){h=setTimeout(i?k:l,i===c?e-m:e)}}}if($.guid){g.guid=j.guid=j.guid||$.guid++}return g};$.debounce=function(d,e,f){return f===c?a(d,e,false):a(d,f,e!==false)}})(this);
/*!
 * imagesLoaded PACKAGED v4.1.4
 * JavaScript is all like "You images are done yet or what?"
 * MIT License
 */
!function(e,t){"function"==typeof define&&define.amd?define("ev-emitter/ev-emitter",t):"object"==typeof module&&module.exports?module.exports=t():e.EvEmitter=t()}("undefined"!=typeof window?window:this,function(){function e(){}var t=e.prototype;return t.on=function(e,t){if(e&&t){var i=this._events=this._events||{},n=i[e]=i[e]||[];return n.indexOf(t)==-1&&n.push(t),this}},t.once=function(e,t){if(e&&t){this.on(e,t);var i=this._onceEvents=this._onceEvents||{},n=i[e]=i[e]||{};return n[t]=!0,this}},t.off=function(e,t){var i=this._events&&this._events[e];if(i&&i.length){var n=i.indexOf(t);return n!=-1&&i.splice(n,1),this}},t.emitEvent=function(e,t){var i=this._events&&this._events[e];if(i&&i.length){i=i.slice(0),t=t||[];for(var n=this._onceEvents&&this._onceEvents[e],o=0;o<i.length;o++){var r=i[o],s=n&&n[r];s&&(this.off(e,r),delete n[r]),r.apply(this,t)}return this}},t.allOff=function(){delete this._events,delete this._onceEvents},e}),function(e,t){"use strict";"function"==typeof define&&define.amd?define(["ev-emitter/ev-emitter"],function(i){return t(e,i)}):"object"==typeof module&&module.exports?module.exports=t(e,require("ev-emitter")):e.imagesLoaded=t(e,e.EvEmitter)}("undefined"!=typeof window?window:this,function(e,t){function i(e,t){for(var i in t)e[i]=t[i];return e}function n(e){if(Array.isArray(e))return e;var t="object"==typeof e&&"number"==typeof e.length;return t?d.call(e):[e]}function o(e,t,r){if(!(this instanceof o))return new o(e,t,r);var s=e;return"string"==typeof e&&(s=document.querySelectorAll(e)),s?(this.elements=n(s),this.options=i({},this.options),"function"==typeof t?r=t:i(this.options,t),r&&this.on("always",r),this.getImages(),h&&(this.jqDeferred=new h.Deferred),void setTimeout(this.check.bind(this))):void a.error("Bad element for imagesLoaded "+(s||e))}function r(e){this.img=e}function s(e,t){this.url=e,this.element=t,this.img=new Image}var h=e.jQuery,a=e.console,d=Array.prototype.slice;o.prototype=Object.create(t.prototype),o.prototype.options={},o.prototype.getImages=function(){this.images=[],this.elements.forEach(this.addElementImages,this)},o.prototype.addElementImages=function(e){"IMG"==e.nodeName&&this.addImage(e),this.options.background===!0&&this.addElementBackgroundImages(e);var t=e.nodeType;if(t&&u[t]){for(var i=e.querySelectorAll("img"),n=0;n<i.length;n++){var o=i[n];this.addImage(o)}if("string"==typeof this.options.background){var r=e.querySelectorAll(this.options.background);for(n=0;n<r.length;n++){var s=r[n];this.addElementBackgroundImages(s)}}}};var u={1:!0,9:!0,11:!0};return o.prototype.addElementBackgroundImages=function(e){var t=getComputedStyle(e);if(t)for(var i=/url\((['"])?(.*?)\1\)/gi,n=i.exec(t.backgroundImage);null!==n;){var o=n&&n[2];o&&this.addBackground(o,e),n=i.exec(t.backgroundImage)}},o.prototype.addImage=function(e){var t=new r(e);this.images.push(t)},o.prototype.addBackground=function(e,t){var i=new s(e,t);this.images.push(i)},o.prototype.check=function(){function e(e,i,n){setTimeout(function(){t.progress(e,i,n)})}var t=this;return this.progressedCount=0,this.hasAnyBroken=!1,this.images.length?void this.images.forEach(function(t){t.once("progress",e),t.check()}):void this.complete()},o.prototype.progress=function(e,t,i){this.progressedCount++,this.hasAnyBroken=this.hasAnyBroken||!e.isLoaded,this.emitEvent("progress",[this,e,t]),this.jqDeferred&&this.jqDeferred.notify&&this.jqDeferred.notify(this,e),this.progressedCount==this.images.length&&this.complete(),this.options.debug&&a&&a.log("progress: "+i,e,t)},o.prototype.complete=function(){var e=this.hasAnyBroken?"fail":"done";if(this.isComplete=!0,this.emitEvent(e,[this]),this.emitEvent("always",[this]),this.jqDeferred){var t=this.hasAnyBroken?"reject":"resolve";this.jqDeferred[t](this)}},r.prototype=Object.create(t.prototype),r.prototype.check=function(){var e=this.getIsImageComplete();return e?void this.confirm(0!==this.img.naturalWidth,"naturalWidth"):(this.proxyImage=new Image,this.proxyImage.addEventListener("load",this),this.proxyImage.addEventListener("error",this),this.img.addEventListener("load",this),this.img.addEventListener("error",this),void(this.proxyImage.src=this.img.src))},r.prototype.getIsImageComplete=function(){return this.img.complete&&this.img.naturalWidth},r.prototype.confirm=function(e,t){this.isLoaded=e,this.emitEvent("progress",[this,this.img,t])},r.prototype.handleEvent=function(e){var t="on"+e.type;this[t]&&this[t](e)},r.prototype.onload=function(){this.confirm(!0,"onload"),this.unbindEvents()},r.prototype.onerror=function(){this.confirm(!1,"onerror"),this.unbindEvents()},r.prototype.unbindEvents=function(){this.proxyImage.removeEventListener("load",this),this.proxyImage.removeEventListener("error",this),this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},s.prototype=Object.create(r.prototype),s.prototype.check=function(){this.img.addEventListener("load",this),this.img.addEventListener("error",this),this.img.src=this.url;var e=this.getIsImageComplete();e&&(this.confirm(0!==this.img.naturalWidth,"naturalWidth"),this.unbindEvents())},s.prototype.unbindEvents=function(){this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},s.prototype.confirm=function(e,t){this.isLoaded=e,this.emitEvent("progress",[this,this.element,t])},o.makeJQueryPlugin=function(t){t=t||e.jQuery,t&&(h=t,h.fn.imagesLoaded=function(e,t){var i=new o(this,e,t);return i.jqDeferred.promise(h(this))})},o.makeJQueryPlugin(),o});
/*! lz-string-1.3.3-min.js | (c) 2013 Pieroxy | Licensed under a WTFPL license */
var LZString={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_f:String.fromCharCode,compressToBase64:function(e){if(e==null)return"";var t="";var n,r,i,s,o,u,a;var f=0;e=LZString.compress(e);while(f<e.length*2){if(f%2==0){n=e.charCodeAt(f/2)>>8;r=e.charCodeAt(f/2)&255;if(f/2+1<e.length)i=e.charCodeAt(f/2+1)>>8;else i=NaN}else{n=e.charCodeAt((f-1)/2)&255;if((f+1)/2<e.length){r=e.charCodeAt((f+1)/2)>>8;i=e.charCodeAt((f+1)/2)&255}else r=i=NaN}f+=3;s=n>>2;o=(n&3)<<4|r>>4;u=(r&15)<<2|i>>6;a=i&63;if(isNaN(r)){u=a=64}else if(isNaN(i)){a=64}t=t+LZString._keyStr.charAt(s)+LZString._keyStr.charAt(o)+LZString._keyStr.charAt(u)+LZString._keyStr.charAt(a)}return t},decompressFromBase64:function(e){if(e==null)return"";var t="",n=0,r,i,s,o,u,a,f,l,c=0,h=LZString._f;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(c<e.length){u=LZString._keyStr.indexOf(e.charAt(c++));a=LZString._keyStr.indexOf(e.charAt(c++));f=LZString._keyStr.indexOf(e.charAt(c++));l=LZString._keyStr.indexOf(e.charAt(c++));i=u<<2|a>>4;s=(a&15)<<4|f>>2;o=(f&3)<<6|l;if(n%2==0){r=i<<8;if(f!=64){t+=h(r|s)}if(l!=64){r=o<<8}}else{t=t+h(r|i);if(f!=64){r=s<<8}if(l!=64){t+=h(r|o)}}n+=3}return LZString.decompress(t)},compressToUTF16:function(e){if(e==null)return"";var t="",n,r,i,s=0,o=LZString._f;e=LZString.compress(e);for(n=0;n<e.length;n++){r=e.charCodeAt(n);switch(s++){case 0:t+=o((r>>1)+32);i=(r&1)<<14;break;case 1:t+=o(i+(r>>2)+32);i=(r&3)<<13;break;case 2:t+=o(i+(r>>3)+32);i=(r&7)<<12;break;case 3:t+=o(i+(r>>4)+32);i=(r&15)<<11;break;case 4:t+=o(i+(r>>5)+32);i=(r&31)<<10;break;case 5:t+=o(i+(r>>6)+32);i=(r&63)<<9;break;case 6:t+=o(i+(r>>7)+32);i=(r&127)<<8;break;case 7:t+=o(i+(r>>8)+32);i=(r&255)<<7;break;case 8:t+=o(i+(r>>9)+32);i=(r&511)<<6;break;case 9:t+=o(i+(r>>10)+32);i=(r&1023)<<5;break;case 10:t+=o(i+(r>>11)+32);i=(r&2047)<<4;break;case 11:t+=o(i+(r>>12)+32);i=(r&4095)<<3;break;case 12:t+=o(i+(r>>13)+32);i=(r&8191)<<2;break;case 13:t+=o(i+(r>>14)+32);i=(r&16383)<<1;break;case 14:t+=o(i+(r>>15)+32,(r&32767)+32);s=0;break}}return t+o(i+32)},decompressFromUTF16:function(e){if(e==null)return"";var t="",n,r,i=0,s=0,o=LZString._f;while(s<e.length){r=e.charCodeAt(s)-32;switch(i++){case 0:n=r<<1;break;case 1:t+=o(n|r>>14);n=(r&16383)<<2;break;case 2:t+=o(n|r>>13);n=(r&8191)<<3;break;case 3:t+=o(n|r>>12);n=(r&4095)<<4;break;case 4:t+=o(n|r>>11);n=(r&2047)<<5;break;case 5:t+=o(n|r>>10);n=(r&1023)<<6;break;case 6:t+=o(n|r>>9);n=(r&511)<<7;break;case 7:t+=o(n|r>>8);n=(r&255)<<8;break;case 8:t+=o(n|r>>7);n=(r&127)<<9;break;case 9:t+=o(n|r>>6);n=(r&63)<<10;break;case 10:t+=o(n|r>>5);n=(r&31)<<11;break;case 11:t+=o(n|r>>4);n=(r&15)<<12;break;case 12:t+=o(n|r>>3);n=(r&7)<<13;break;case 13:t+=o(n|r>>2);n=(r&3)<<14;break;case 14:t+=o(n|r>>1);n=(r&1)<<15;break;case 15:t+=o(n|r);i=0;break}s++}return LZString.decompress(t)},compress:function(e){if(e==null)return"";var t,n,r={},i={},s="",o="",u="",a=2,f=3,l=2,c="",h=0,p=0,d,v=LZString._f;for(d=0;d<e.length;d+=1){s=e.charAt(d);if(!Object.prototype.hasOwnProperty.call(r,s)){r[s]=f++;i[s]=true}o=u+s;if(Object.prototype.hasOwnProperty.call(r,o)){u=o}else{if(Object.prototype.hasOwnProperty.call(i,u)){if(u.charCodeAt(0)<256){for(t=0;t<l;t++){h=h<<1;if(p==15){p=0;c+=v(h);h=0}else{p++}}n=u.charCodeAt(0);for(t=0;t<8;t++){h=h<<1|n&1;if(p==15){p=0;c+=v(h);h=0}else{p++}n=n>>1}}else{n=1;for(t=0;t<l;t++){h=h<<1|n;if(p==15){p=0;c+=v(h);h=0}else{p++}n=0}n=u.charCodeAt(0);for(t=0;t<16;t++){h=h<<1|n&1;if(p==15){p=0;c+=v(h);h=0}else{p++}n=n>>1}}a--;if(a==0){a=Math.pow(2,l);l++}delete i[u]}else{n=r[u];for(t=0;t<l;t++){h=h<<1|n&1;if(p==15){p=0;c+=v(h);h=0}else{p++}n=n>>1}}a--;if(a==0){a=Math.pow(2,l);l++}r[o]=f++;u=String(s)}}if(u!==""){if(Object.prototype.hasOwnProperty.call(i,u)){if(u.charCodeAt(0)<256){for(t=0;t<l;t++){h=h<<1;if(p==15){p=0;c+=v(h);h=0}else{p++}}n=u.charCodeAt(0);for(t=0;t<8;t++){h=h<<1|n&1;if(p==15){p=0;c+=v(h);h=0}else{p++}n=n>>1}}else{n=1;for(t=0;t<l;t++){h=h<<1|n;if(p==15){p=0;c+=v(h);h=0}else{p++}n=0}n=u.charCodeAt(0);for(t=0;t<16;t++){h=h<<1|n&1;if(p==15){p=0;c+=v(h);h=0}else{p++}n=n>>1}}a--;if(a==0){a=Math.pow(2,l);l++}delete i[u]}else{n=r[u];for(t=0;t<l;t++){h=h<<1|n&1;if(p==15){p=0;c+=v(h);h=0}else{p++}n=n>>1}}a--;if(a==0){a=Math.pow(2,l);l++}}n=2;for(t=0;t<l;t++){h=h<<1|n&1;if(p==15){p=0;c+=v(h);h=0}else{p++}n=n>>1}while(true){h=h<<1;if(p==15){c+=v(h);break}else p++}return c},decompress:function(e){if(e==null)return"";if(e=="")return null;var t=[],n,r=4,i=4,s=3,o="",u="",a,f,l,c,h,p,d,v=LZString._f,m={string:e,val:e.charCodeAt(0),position:32768,index:1};for(a=0;a<3;a+=1){t[a]=a}l=0;h=Math.pow(2,2);p=1;while(p!=h){c=m.val&m.position;m.position>>=1;if(m.position==0){m.position=32768;m.val=m.string.charCodeAt(m.index++)}l|=(c>0?1:0)*p;p<<=1}switch(n=l){case 0:l=0;h=Math.pow(2,8);p=1;while(p!=h){c=m.val&m.position;m.position>>=1;if(m.position==0){m.position=32768;m.val=m.string.charCodeAt(m.index++)}l|=(c>0?1:0)*p;p<<=1}d=v(l);break;case 1:l=0;h=Math.pow(2,16);p=1;while(p!=h){c=m.val&m.position;m.position>>=1;if(m.position==0){m.position=32768;m.val=m.string.charCodeAt(m.index++)}l|=(c>0?1:0)*p;p<<=1}d=v(l);break;case 2:return""}t[3]=d;f=u=d;while(true){if(m.index>m.string.length){return""}l=0;h=Math.pow(2,s);p=1;while(p!=h){c=m.val&m.position;m.position>>=1;if(m.position==0){m.position=32768;m.val=m.string.charCodeAt(m.index++)}l|=(c>0?1:0)*p;p<<=1}switch(d=l){case 0:l=0;h=Math.pow(2,8);p=1;while(p!=h){c=m.val&m.position;m.position>>=1;if(m.position==0){m.position=32768;m.val=m.string.charCodeAt(m.index++)}l|=(c>0?1:0)*p;p<<=1}t[i++]=v(l);d=i-1;r--;break;case 1:l=0;h=Math.pow(2,16);p=1;while(p!=h){c=m.val&m.position;m.position>>=1;if(m.position==0){m.position=32768;m.val=m.string.charCodeAt(m.index++)}l|=(c>0?1:0)*p;p<<=1}t[i++]=v(l);d=i-1;r--;break;case 2:return u}if(r==0){r=Math.pow(2,s);s++}if(t[d]){o=t[d]}else{if(d===i){o=f+f.charAt(0)}else{return null}}u+=o;t[i++]=f+o.charAt(0);r--;f=o;if(r==0){r=Math.pow(2,s);s++}}}};if(typeof module!=="undefined"&&module!=null){module.exports=LZString}
/*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/dist/FileSaver.js */
(function(a,b){if("function"==typeof define&&define.amd)define([],b);else if("undefined"!=typeof exports)b();else{b(),a.FileSaver={exports:{}}.exports}})(this,function(){"use strict";function b(a,b){return"undefined"==typeof b?b={autoBom:!1}:"object"!=typeof b&&(console.warn("Deprecated: Expected third argument to be a object"),b={autoBom:!b}),b.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\uFEFF",a],{type:a.type}):a}function c(a,b,c){var d=new XMLHttpRequest;d.open("GET",a),d.responseType="blob",d.onload=function(){g(d.response,b,c)},d.onerror=function(){console.error("could not download file")},d.send()}function d(a){var b=new XMLHttpRequest;b.open("HEAD",a,!1);try{b.send()}catch(a){}return 200<=b.status&&299>=b.status}function e(a){try{a.dispatchEvent(new MouseEvent("click"))}catch(c){var b=document.createEvent("MouseEvents");b.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),a.dispatchEvent(b)}}var f="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,a=/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),g=f.saveAs||("object"!=typeof window||window!==f?function(){}:"download"in HTMLAnchorElement.prototype&&!a?function(b,g,h){var i=f.URL||f.webkitURL,j=document.createElement("a");g=g||b.name||"download",j.download=g,j.rel="noopener","string"==typeof b?(j.href=b,j.origin===location.origin?e(j):d(j.href)?c(b,g,h):e(j,j.target="_blank")):(j.href=i.createObjectURL(b),setTimeout(function(){i.revokeObjectURL(j.href)},4E4),setTimeout(function(){e(j)},0))}:"msSaveOrOpenBlob"in navigator?function(f,g,h){if(g=g||f.name||"download","string"!=typeof f)navigator.msSaveOrOpenBlob(b(f,h),g);else if(d(f))c(f,g,h);else{var i=document.createElement("a");i.href=f,i.target="_blank",setTimeout(function(){e(i)})}}:function(b,d,e,g){if(g=g||open("","_blank"),g&&(g.document.title=g.document.body.innerText="downloading..."),"string"==typeof b)return c(b,d,e);var h="application/octet-stream"===b.type,i=/constructor/i.test(f.HTMLElement)||f.safari,j=/CriOS\/[\d]+/.test(navigator.userAgent);if((j||h&&i||a)&&"undefined"!=typeof FileReader){var k=new FileReader;k.onloadend=function(){var a=k.result;a=j?a:a.replace(/^data:[^;]*;/,"data:attachment/file;"),g?g.location.href=a:location=a,g=null},k.readAsDataURL(b)}else{var l=f.URL||f.webkitURL,m=l.createObjectURL(b);g?g.location=m:location.href=m,g=null,setTimeout(function(){l.revokeObjectURL(m)},4E4)}});f.saveAs=g.saveAs=g,"undefined"!=typeof module&&(module.exports=g)});
/*! seedrandom.js v2.3.3 | (c) 2013 David Bau, all rights reserved. | Licensed under a BSD-style license */
!function(a,b,c,d,e,f,g,h,i){function j(a){var b,c=a.length,e=this,f=0,g=e.i=e.j=0,h=e.S=[];for(c||(a=[c++]);d>f;)h[f]=f++;for(f=0;d>f;f++)h[f]=h[g=r&g+a[f%c]+(b=h[f])],h[g]=b;(e.g=function(a){for(var b,c=0,f=e.i,g=e.j,h=e.S;a--;)b=h[f=r&f+1],c=c*d+h[r&(h[f]=h[g=r&g+b])+(h[g]=b)];return e.i=f,e.j=g,c})(d)}function k(a,b){var c,d=[],e=typeof a;if(b&&"object"==e)for(c in a)try{d.push(k(a[c],b-1))}catch(f){}return d.length?d:"string"==e?a:a+"\0"}function l(a,b){for(var c,d=a+"",e=0;e<d.length;)b[r&e]=r&(c^=19*b[r&e])+d.charCodeAt(e++);return n(b)}function m(c){try{return a.crypto.getRandomValues(c=new Uint8Array(d)),n(c)}catch(e){return[+new Date,a,(c=a.navigator)&&c.plugins,a.screen,n(b)]}}function n(a){return String.fromCharCode.apply(0,a)}var o=c.pow(d,e),p=c.pow(2,f),q=2*p,r=d-1,s=c["seed"+i]=function(a,f,g){var h=[],r=l(k(f?[a,n(b)]:null==a?m():a,3),h),s=new j(h);return l(n(s.S),b),(g||function(a,b,d){return d?(c[i]=a,b):a})(function(){for(var a=s.g(e),b=o,c=0;p>a;)a=(a+c)*d,b*=d,c=s.g(1);for(;a>=q;)a/=2,b/=2,c>>>=1;return(a+c)/b},r,this==c)};l(c[i](),b),g&&g.exports?g.exports=s:h&&h.amd&&h(function(){return s})}(this,[],Math,256,6,52,"object"==typeof module&&module,"function"==typeof define&&define,"random");
/*! console_hack.js | (c) 2015 Thomas Michael Edwards | Licensed under SugarCube's Simple BSD license */
!function(){for(var methods=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeline","timelineEnd","timeStamp","trace","warn"],length=methods.length,noop=function(){},console=window.console=window.console||{};length--;){var method=methods[length];console[method]||(console[method]=noop)}}();
}else{document.documentElement.setAttribute("data-init", "lacking");}
</script>
<style id="style-normalize" type="text/css">/*! normalize.css v3.0.3 | MIT License | github.com/necolas/normalize.css */html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,hgroup,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block;vertical-align:baseline}audio:not([controls]){display:none;height:0}[hidden],template{display:none}a{background-color:transparent}a:active,a:hover{outline:0}abbr[title]{border-bottom:1px dotted}b,strong{font-weight:700}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sup{top:-.5em}sub{bottom:-.25em}img{border:0}svg:not(:root){overflow:hidden}figure{margin:1em 40px}hr{box-sizing:content-box;height:0}pre{overflow:auto}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}button,input,optgroup,select,textarea{color:inherit;font:inherit;margin:0}button{overflow:visible}button,select{text-transform:none}button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}button[disabled],html input[disabled]{cursor:default}button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}input{line-height:normal}input[type=checkbox],input[type=radio]{box-sizing:border-box;padding:0}input[type=number]::-webkit-inner-spin-button,input[type=number]::-webkit-outer-spin-button{height:auto}input[type=search]{-webkit-appearance:textfield;box-sizing:content-box}input[type=search]::-webkit-search-cancel-button,input[type=search]::-webkit-search-decoration{-webkit-appearance:none}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{border:0;padding:0}textarea{overflow:auto}optgroup{font-weight:700}table{border-collapse:collapse;border-spacing:0}td,th{padding:0}</style>
<style id="style-init-screen" type="text/css">@-webkit-keyframes init-loading-spin{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-o-keyframes init-loading-spin{0%{-o-transform:rotate(0);transform:rotate(0)}100%{-o-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes init-loading-spin{0%{-webkit-transform:rotate(0);-o-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);-o-transform:rotate(360deg);transform:rotate(360deg)}}#init-screen{display:none;z-index:500000;position:fixed;top:0;left:0;height:100%;width:100%;font:28px/1 Helmet,Freesans,sans-serif;font-weight:700;color:#eee;background-color:#111;text-align:center}#init-screen>div{display:none;position:relative;margin:0 auto;max-width:1136px;top:25%}html[data-init=lacking] #init-screen,html[data-init=loading] #init-screen,html[data-init=no-js] #init-screen{display:block}html[data-init=lacking] #init-lacking,html[data-init=no-js] #init-no-js{display:block;padding:0 1em}html[data-init=no-js] #init-no-js{color:red}html[data-init=loading] #init-loading{display:block;border:24px solid transparent;border-radius:50%;border-top-color:#7f7f7f;border-bottom-color:#7f7f7f;width:100px;height:100px;-webkit-animation:init-loading-spin 2s linear infinite;-o-animation:init-loading-spin 2s linear infinite;animation:init-loading-spin 2s linear infinite}html[data-init=loading] #init-loading>div{text-indent:9999em;overflow:hidden;white-space:nowrap}html[data-init=loading] #passages,html[data-init=loading] #ui-bar{display:none}</style>
<style id="style-font" type="text/css">@font-face{font-family:tme-fa-icons;src:url('data:application/octet-stream;base64,d09GRgABAAAAADLAAA8AAAAAWHgAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABHU1VCAAABWAAAADsAAABUIIslek9TLzIAAAGUAAAAQwAAAFY+IEkIY21hcAAAAdgAAAG8AAAF3rob9jFjdnQgAAADlAAAABMAAAAgBtX/BGZwZ20AAAOoAAAFkAAAC3CKkZBZZ2FzcAAACTgAAAAIAAAACAAAABBnbHlmAAAJQAAAI6gAADv+gJOpzGhlYWQAACzoAAAAMwAAADYY1IZaaGhlYQAALRwAAAAgAAAAJAfCBClobXR4AAAtPAAAAJEAAAFMBfb/0WxvY2EAAC3QAAAAqAAAAKhjiHI5bWF4cAAALngAAAAgAAAAIAFjDA9uYW1lAAAumAAAAY0AAAL94+zEpHBvc3QAADAoAAACHAAAA11cG/YjcHJlcAAAMkQAAAB6AAAAhuVBK7x4nGNgZGBg4GIwYLBjYHJx8wlh4MtJLMljkGJgYYAAkDwymzEnMz2RgQPGA8qxgGkOIGaDiAIAJjsFSAB4nGNgZNZgnMDAysDAVMW0h4GBoQdCMz5gMGRkAooysDIzYAUBaa4pDA4vGF4EMgf9z2KIYg5imAYUZgTJAQDSIQumAHic7dTVbltRAETR7dpNCikzQ8rMzMxt/M39mHnsU1/TfZz5jFpaV7pXJunMDLAZmOqaZjD5y4Tx+uPTyeL5lG2L5zN+L94zG8+ztr7ulXH1fra4bvK9M79xiWW2sNXPbWeFHexkF7vZw172sZ8DHOQQhznCUY5xnBOc5BSnOcNZVjnHeS5wkUtc5gpX/f3r3OAmt7jNHe5yj/s84CGPeMwTnvKM57zgJa94zRve8o73fOAjn/jMF77yje/84Ce/WGPun1zi/2tlXKbp3Xyc44bFyZanSWokJDXOOjXSk/LUSXn+pEwCKTNBaqQqZU5IjX+XMjukTBEp80TKZJEyY6RMGylzR8oEkjKLpEwlKfNJyqSSMrOkTC8pc0zKRJMy26RMOSnzTsrkk7IDpGwDKXtByoaQsiukbA0p+0PKJpGyU6RsFyl7RmosQcrukbKFpOwjKZtJyo6Ssq2k7C0pG0zKLpOy1aTsNymbTsrOk7L9pNwBUi4CKbeBlCtByr0g5XKQckNIuSak3BVSLgwpt4aUq0PK/SHlEpFyk0i5TqTcKVIuFim3i5QrRso9I+WykXLjXOYNzP8BuAPUwHicY2BAAxIQyBz0PwuEARJsA90AeJytVml300YUHXlJnIQsJQstamHExGmwRiZswYAJQbJjIF2crZWgixQ76b7xid/gX/Nk2nPoN35a7xsvJJC053Cak6N3583VzNtlElqS2AvrkZSbL8XU1iaN7DwJ6YZNy1F8KDt7IWWKyd8FURCtltq3HYdERCJQta6wRBD7HlmaZHzoUUbLtqRXTcotPekuW+NBvVXffho6yrE7oaRmM3RoPbIlVRhVokimPVLSpmWo+itJK7y/wsxXzVDCiE4iabwZxtBI3htntMpoNbbjKIpsstwoUiSa4UEUeZTVEufkigkMygfNkPLKpxHlw/yIrNijnFawS7bT/L4vead3OT+xX29RtuRAH8iO7ODsdCVfhFtbYdy0k+0oVBF213dCbNnsVP9mj/KaRgO3KzK90IxgqXyFECs/ocz+IVktnE/5kkejWrKRE0HrZU7sSz6B1uOIKXHNGFnQ3dEJEdT9kjMM9pg+Hvzx3imWCxMCeBzLekclnAgTKWFzNEnaMHJgJWWLKqn1rpg45XVaxFvCfu3a0ZfOaONQd2I8Ww8dWzlRyfFoUqeZTJ3aSc2jKQ2ilHQmeMyvAyg/oklebWM1iZVH0zhmxoREIgIt3EtTQSw7saQpBM2jGb25G6a5di1apMkD9dyj9/TmVri501PaDvSzRn9Wp2I62AvT6WnkL/Fp2uUiRen66Rl+TOJB1gIykS02w5SDB2/9DtLL15YchdcG2O7t8yuofdZE8KQB+xvQHk/VKQlMhZhViFZAYq1rWZbJ1awWqcjUd0OaVr6s0wSKchwXx76Mcf1fMzOWmBK+34nTsyMuPXPtSwjTHHybdT2a16nFcgFxZnlOp1mW7+s0x/IDneZZntfpCEtbp6MsP9RpgeVHOh1jeUELmnTfwZCLMOQCDpAwhKUDQ1hegiEsFQxhuQhDWBZhCMslGMLyYxjCchmGsLysZdXUU0nj2plYBmxCYGKOHrnMReVqKrlUQrtoVGpDnhJulVQUz6p/ZaBePPKGObAWSJfIml8xzpWPRuX41hUtbxo7V8Cx6m8fjvY58VLWi4U/Bf/V1lQlvWLNw5Or8BuGnmwnqjapeHRNl89VPbr+X1RUWAv0G0iFWCjKsmxwZyKEjzqdhmqglUPMbMw8tOt1y5qfw/03MUIWUP34NxQaC9yDTllJWe3grNXX27LcO4NyOBMsSTE38/pW+CIjs9J+kVnKno98HnAFjEpl2GoDrRW82ScxD5neJM8EcVtRNkja2M4EiQ0c84B5850EJmHqqg3kTuGGDfgFYW7BeSdconqjLIfuRezzKKT8W6fiRPaoaIzAs9kbYa/vQspvcQwkNPmlfgxUFaGpGDUV0DRSbqgGX8bZum1Cxg70Iyp2w7Ks4sPHFveVkm0ZhHykiNWjo5/WXqJOqtx+ZhSX752+BcEgNTF/e990cZDKu1rJMkdtA1O3GpVT15pD41WH6uZR9b3j7BM5a5puuiceel/TqtvBxVwssPZtDtJSJhfU9WGFDaLLxaVQ6mU0Se+4BxgWGNDvUIqN/6v62HyeK1WF0XEk307Ut9HnYAz8D9h/R/UD0Pdj6HINLs/3mhOfbvThbJmuohfrp+g3MGutuVm6BtzQdAPiIUetjrjKDXynBnF6pLkc6SHgY90V4gHAJoDF4BPdtYzmUwCj+Yw5PsDnzGHQZA6DLeYw2GbOGsAOcxjsMofBHnMYfMGcdYAvmcMgZA6DiDkMnjAnAHjKHAZfMYfB18xh8A1z7gN8yxwGMXMYJMxhsK/p1jDMLV7QXaC2QVWgA1NPWNzD4lBTZcj+jheG/b1BzP7BIKb+qOn2kPoTLwz1Z4OY+otBTP1V050h9TdeGOrvBjH1D4OY+ky/GMtlBr+MfJcKB5RdbD7n74n3D9vFQLkAAQAB//8AD3icrXsLcFzlleZ//v+++nb37dfte/VotVrdrW5JltuKpO6WJVluPyXbsmOEbGRjO4KVjWPZlsM4QIU4IYGlgCE2yxqKIQkJg2GreKQCTCZb1CZkiswjzOwOmSTATNVWTZLdDUwSMrVDsomD23vOf69assFAqgbk+773P4//nPOdc/5mwNjFl8WjosbaWblmxiOmIlTGYXzb11M7Z2ohAMbZCcZ5iG9prZl4whfwGju05xtttitUdwXYEUgkbQtWga5lC+XBaqJI285qpb8dVEc8Gnm5L5QM/f58yAlB399a7dD0mWAmdAqaMvBmKPKX9TdDwSjod9yhx03FAPcvI6Gk2lV33XoXUtKgL8C6Wa0WSzXbVjhg6JoqIPShCK0FOvOuE48K1V4B1VUQAVevugmP7Fz2CmTzW5/8+ZGP/+Kp7h/8oI4MuOZ7M5B9IvujH2Wf+PnCAjzn8ZK6AieMKRcvXnxWWSWCzGARlPcqtqs21WZzEBFgYIVDAYWzVJIrXBlH+hXGlWNM00GAJmYZ8sKBzTJFVZVppijqDFMVdTIWLa0o5JrdaHusPZGIG1IjFhQGK2mAZEe56kJnR1bTY7ZT7eivFGODBTdma3pHtlCNDVbwmgMHx/aO4R8ffeet5/ZCG6TfuV03IaSJU3oIzKsGO9+5PV+BwU5xqnOQx1aO8fW71yvD9fPn55/fA22PmsaFvfSgwZ8wzPiFvZ2DUMnzJ2hHVDMmHucPsSRrq7UQo4DMAV/AW7CANw/Zru3NIx20bBEpXwukArlxxOPReibaG63/SyQyiftzcBy3k1HuOHgjEgFHnkYfh4VodDJC4138Ff8hv5PlWbrWmm2O6grNEgGNCWGnbFtRm1Z04gzQPPWvkqMWF4eWU8DB267Df+gNe84bBvfRpfNI5Ny5yAmHDh5/PPLuByMlekDS9DsRR73nWHetwBShSO5PqCBQONO4E2wGlSvYZG6gMzeQ09SWFZC0tWION3oOVVXGTbGM+hrAzQj0O25yoN8R8YzzRsaZdzLwhpsGPEm783hAJ9+kq286eDX5pn/VydDjvk7i8EuchU21JJ3DNOqFzeABmywPcNXxhu/wB+3whrqwVw7Cn1j8vPfdDH6O7PR3fDV/Cb85wua/waSit309grZJHHOhHEQ9CA7zTGVCUb0ZvXzc1lrRe5Af+4An0aSL9op0IU9y6vRFtAYGKy7KJGFbQrdg2dXqGAwWilld0zUy9xLqd6A/zeFuy7gzYFmBOwOhZ6NNhZakm8YTI7S1pyM1mM032V26qevXGlzZ8+TKvROlB/BBkO9ACDalB7OZuBnuC5tRcAItpalENNOfhajVH1A2a1HjbHZ4N4r54oWLz4qPoe4jrMo2sonapm5QRQBQ3XycKVxwRRxjQuVCnWc6mrzOZ5FvBiraOmia5FubYRpok8n0ioRTKOQMNbWiszxYWAFZrQ1sB+dDJTFYghzyiBN3oB857ndIAha4Se/+YGUtjAkXXUO2xPE2eoe3TWPeMOXmzNi+j9w1HghvVbSAmu4c6nFac6MgbzXFU2baDr1241+98TfHtU/9t7df+MzU4msmfPYj06Wbw8Gqohda0/FkSyiyvtPGG/FsMKq1pLqmPvndkye/+y+08eYIHEJZpFmJra2Nop/VWuKcCwPvgRhnGlOFps6iIdAEmFVAKh53jblZyBU6nAFdbfX03tGwioZ9oGnEyDSWTQCyFzhoR+s/jdjgWLmc3L2K21zEmXCsM5aDm4g9Ny5v0PZVb+dY9Rcd/sl5eTiPj0nTaeiU+BhhW2qbuzJcUy2Nc2gCrjBkxWCqZiArGgOuwSzjAlDb5L91XfpvfYbpij6ZRIUWYoVcLqC2+UqNLddsMrekY3GZztVl2uQjpl4xjedIM+Uybc/r5viShuHgcgXuwQtpuoMHz8utCe/s8S+Y/7xMaYu2DX1yDrez3lp3cyyKdop+HLcLi878Uh9SKOSlj73cOIUFRVKVKHhaSS9JP452RCcYoJ3w85bz8Ckp9VN4xeZj9atpH4FnPCV4OtiDNIVYCrWwsbauK81VxUlaQnA+riFBisoUsiU0LbQpASCmmRAwg1MNJoH19uQ6WpriUV1jIQjphA5QjosiTfiy1tF+kPJKMTFYpAu6lkx40odnTv7VjYtC/QtTJyGH9HmMnKamGrcaqmaagRsMUwR9WeLmwsQREvIRevSvYa8uVFXo9Sc0w5A8/Rp5+jcxhXLuYAOIx/pbY+ggFp0FV8lNoLNAEQvyDkwBZR9T1ZC6xR0qFgsybix3DJcR7iIGwCsCHHQM0nYKVSBXQZPnqG7KDZiqrn8K524gpN9ghAx42k4GsvF3nohnA0kbnglkC9mrl7h4Db2TommKcVE1QOPRd97K5WJxsKO5nIjHbHtx/og3kK8iWys1he/EkKlqCbFOB6iKQp5Q5Yp6DB0AsjmPvHEFSGsoFraPaVpI2zLc2lmudErjJ/eeQwbKPoRBZulcwhwXYc6i1SdiEpiCF+KrFOIrAzKaHdhQ79tw4MAGuJv4rt8sQQu80jloGnnDfNVJBa+vn1WjSg1d8NHrg44FbTgdJ5+T77yy/gDI5wY7633yTbI7+CdyMDyEL2paDd0BvZjyfIYXH2/H+aqjDfXUisgnk3rFYMePoyZBegWanQpM5hKdlUSU1JnoQH2iG1d90IYADi0JPV2/oxMEeB7apm+aBngFw/ObMjzHzv7dgzyOh48fHZnmO9c8Wv+2RAGwHiP20UNnzx46mvYxyaMixDpZX22lQqQgRDqG4kYcMo92cpypAOo0Ti+iSYXJRGc5l8wvQhPfqpE0SYa7nDwkeQyh26OOlbecqVumoCwJ8+mDm+9/5T4eOyOt+4wk8WjavYTIG+7nD5Li2cWv8zGkMYoz51q2u3Y1JQSwfcumSn9JUxW0CZIWQ5isqKCo8zoGFPybx/lyHD2w4AaCBw7Ap1HIxAaHyZlr1tXG1owMt7h5Ox5QmxF4Iv6vDhaQoTFAYADuYIlnLa7b7RwtiOBDtVK1dbyCMXXxn5azOIIKfLFKaQP9K3HKIMYEQosvhkIWH23TQ9wIpCq9M4WxycnJsQIUYrEJ/bPGuOZohfHVzdmMaAmHm418c7DU3xdoyYPebFktPJtpHu7fefjw4R0VHiNTa06ZUTPe09a1sdTUVNrYtbo3nth11VW7tBa1d/U1a1t71rdG2u1IJNkWDYdbUs0pnnFT+OloWzISsdsjqVpvy9prqrNjed41POfPx2+J7TIXaWP5Wgf5bvToBEvpppQYOXPOJoda4gTQE6TsNK8sAvUSSHBFygfnfM9wL+8aK/Bddv0tZ8SufyKZ7ml7s20iCWdsPpPu4YVaXuur/2M6WX8riReTE21vtPUAnn4iyTxdf0vJ+/QM0pwsUL4D5BmUBQEeXpaU4W6RtExzN1In7eT9qHPpIoUdqAzSrdyHIPo1JNRps1uioCWJyIm2U/JG8oO4aZMXozF8b4RupRd5JJv7Nn8ZeUyxjlrakhJHcwO2gHMUDgGLR0MmS0GrIoMRWos0K81LUnPZYgmkw6sM8HtCoQTaT9y0Wu3f/MZuCYfijhMPhUVQNdL2hY8kMroS/8UvEqqeSfC/xzPV07k3vsqyrL+2ykYnhJjEz45OLIdbu4ncrbrWhImzltU7oqqaXAEdMWiHxPsSdvuF70K6/xf6FejjL13YBvFVP+UXrkwnyelZjBcltoLypQIoEmsoiDUw4C2QFS/I/J6yx5ybWOOqaMad0kJlKo+ElAdLqvRTMqOsgucuM64j3hgHU1H1mIkQ084Oje3eXT1lZwL1nwaD0BZMNfFTcHpv+sf7v6LEo4oZMlRbFNqH9tb60nEN0UkQ0mYawZNpR878eFuD1lWsl/Jb9J5iMbPlDKnkh3raBmS66U1M9Jm5rKUmMel1dKLOcxrVSgf5dJqU4o0g0pJyTlV37x4bytpCATOG8VUT4+m9cPoURiakE34ZMes/wbB0Roun+2p7h9oLSlwzQqZq2eIr+xe2/Rhp5QF8hHn5Hh/FfM9ibs32UrNG+l22ZbrnJ8N+fERAcD6YCp6nuPc2Aq/vWXiMfzKaye/BDfzTLPwe33MT8ns4P/y0uiLBdyZw3qRvNvGZegjF6H+escXvreOnkD7zm7IkADTbJEkU4sdw1jmwzpTj42smHLB82ijenjfx9YsXkccR+B5+I1azGtQk+4maTpnLlsBL75E7O1IPea+mzfPmUwQt00FJoG+nPxN/zruZzZprTljyx2GpXiHdYWBZtcINeB+2xVP16/GT9euDwf00TbqgK5gK7QvCmfp/wPn15WDa3BcM1l/Hy8F9wZQ31nf4Q2IjjrXyG+BnzXnMmqXiTuB5CLa01gINjvb8mesSTwHuSAEtzm8anp+uvwbdprkfhUs0wCNIxH6TP1l/vf6aPDThK0TXI5I+tjj+SX/8wIcaPxWX4y+CqsCiEIiAIzhsKrgfh+6qv+4L4RETPl6/zqMKukki9AA96OseZb3Zk7UKVKxZKt65tpR1J9p1sTGgP5Z4ah+KEzl73R/xEfr+I8H5fchlN/Jr0n0c3fSGkrz+vbhd5m2ZWltThDeKUaKh3WTZXWauS+WomBdMkjGvOCRuT9YfcIZxk0x24/5cT3q8redxe8TpTsLn03b9LIaFo/I0eQ7uxtjQm6rffI4elnTcJfbwX/qRFyG+Vw+SaJdyFIpugk0WXCcnaZFo1323viNAWHZPvk1+ugfjTf2sbcPR5LDT442bhwPj6Z5z9qi9wr8B85Ji51yXb3tISxlpSUtaZEYnFX8ZbHI6C8vk4ll2h5/YdRQbM0CUbSmXHsd5rH5zWz7fBnc/5iA1NLANwyQZ2+5JjiYfQ4mle+BxJA1prT9g+770dv4zTz9RnTPp+JlY4DJKoroOucmyT4fnsGIeFC3H9EtmB+qnGyP6413tPvs4BhIwipskDKakeIg+KKTgbl92JBkkHn1J3c8t+9ia2vBKhMFkGBJtEjrGDIzKE1SeAgTJiDAVRYpKmSGwMlksJor5gUWgjKlXYS0gurS4neaYflXJnaWBUjDKNAVhkWoF1WhHz7uJ2PapE8NHJkulySPD62/qVmLapMq10a997JqvnphQarc8dO3UQ2smYr38pfOWszK6fTs+eBKfHy4j8t2uWNrWnbDx5CNfe+TkxrHVE/EEW4ynxM9H2FhtpAeE2tnGFUH1J4xXChxD5hACLNXbLgOA3WU353rI37Y44SipbwdxwED/mEC0rOmuIzmlGkw7SBzNxZ6NN3519+zXRhV1Uosp3TdtGD68s4eXJo8uzHVtjyXc85gC9MYmRh+euuaRk+vhAG43Tm3RLGW7Clp52Oesq3N7dKVjnW9KxCdWjyFvi/nUs+Ja5CnPxtn+2t4NnVwLrELw76JqDMz1MacMGJoR0I5RVsA1lR/DLEdonLJLQWnOMcSamKlrszLnWWZ3mzcVOjsrnYWynTfVNmQ6aQFxrWtL9SQtgjqsojbxf5lp+qquSF1rVGyk02qZZEEKRkPdlv9ff3LVQ6MTFMas8xSft3fNVbd+vqg1KaF5w7RwBsirUye24UVXDS3oIcj/nz+56mF6qQlUAQ++gGoNytcxFG7P98DWMXMoHIL/6l/Z7p1riv8ko2oiyiru129WsSrmUjO1XdtWc0Pr7miOoWOV9YUQ07WQPmsCisWYDge5puAUAI3NIk6EQACmaQ+BGRaAwOSemV1TH90+vnlDrZBNFOi/nEUlLL96lYx5VZLqB5zDQLFQzGm6KuUX89L6YqxRuaPsCwXYTlJE1EVJt9ycWTo8bereoW7Wv38ewfOzmgI/N42Kn53LatjTxUCv85zbEyg+Y5hTcDddq99M2ysc8/51lABfjZ++8KvSxvUlnpCj7U+mIG3vR8yhXSbXEbaB3cDmatdds4lrhi9Z8hskNo2hkI+RQHWN6fMIUwKGFZiNhDmCNq6BoR1gejCoTzNdD86woB6cPDh33YFr91w99dHJLePr1tp525NylKZkzJtthLplN+ADzhOxjpiN1trRPwb/vhKfqIcMg8Mr3DDqd38o4cM36y9KWa+Tsn7v4/ocj134Vcg2TZsf/ABFKH4tYwrtObZYYxoF3QiQC+PjATwUho5+W8MkQlOOqUDxnlMNjZpsfB8zjJCxZe2afKeTjXeuboqT2XcOlsACB6XROFhWch7AeNy/VsZfx4fO5Aj8EjTVRPjLdtrmTS1NX7Azce6kmjZnnHf+1iuBiG0duzsmQTiZPzfjEoTGAqZ7xqt/nmmai8gXOWb0/sG9z8vyyPNOZjKDf9DlRgmQR93keVlHOU/9RTkfH8W8ieTQzWpsc21DGRM0Xw4soAUWDEDPtMB0oS9I5qeXC0PhMySPyTWjuYFctn9JEgWLp6FSXdz71TeSgzuQBmnXVHPXGqWhIhXkF+H2lQXxVqiSO5OthN9CQQSazmBOhdycwSgoZRJvQ28Yz8SVltDiwd3PUxMLN9De1dWehinH5783RvA9xhpyoHgnWAfGvE3sqtqOFT25rGIoMB4GBa0NAaepg2KYyiwVijQqFKGtopEeUFFYgQCboj0jZ8cCk7U1Q2W3MBBLjMRi0SCKxO0od6gD6Muon6Q35JGLDZS9DEpfLNZTA4aqrmrD0rwHCAO8Cs/Ur4a3J0Lql9WU4RfBJiYySfg+cviqaczLvipt59LuhbjXflPdSuRLUUd/9VV422jRv6SF/NbehYrcQ1p2AZ6jd80L5+kSRwE3WV+OVGTs9GvnU6yLDbJsrZ2aE+iijskqPtuHgTAktgz0r+xtaUaslZRRH6FKlRJrBwO9bK+lef8YXipg7j8GSJjM+GRPmSApRv6n//T4VrH3qqbRaNxoqoxSNMfwD6MV18yPulftrX+xZ7gXeka7vMCPgf2aQ8+N4bPuaKz7lg2LIGjjTT3x4T4jvubPYKL+cFtPTxscwm0DA+yVNaMjbFNt/cE9k+sUpoxgas8Gu1qjhG7GqUu+oAFel8B2gTDcgt+54If2XXv1VVsmVvRkM4m4TnnrYCGLtt5foc4F2rWO/NrIbxENvBHUy0WJBYqEg8hbyklAxoATvupfHMCZ3wAHaASEAFz/Y7pUPh+ZumWK7z65G1KGftgMJro0NbIzrOvbm1sCuhL9tBGKtrof1aLaZkdRjS4zYhzSDTDVw4bldnrPGtubWgKGiH0adR1JuR9VI/qErSgB72HMk0emp2+anr6F7kfTydZ+zdKSO0EdDRuTqaip3xAIjapaLa1aWqg/kmqNQEiXzza3ZFbqId3euezR4Iiqbkj5j7ZEIeTX7X4n9vLvLmKL2mAXILVUp0WPoyLCVJVGQ+/yNlGhjP8PNLq4y9vNy9rPrn+eW36OaPmdX0nTF7EIpu9XPlvW1XMgOiHbSHIL1ji1nsbpBdbAyXtlTRwjSHuCqyJvkjfAVEiMe317oeLEURlNKa/CI7tfVLxLp5qb4tFwUFVYJ3R6/STHqy1Xi1R9RLvvd6lSPIba14rZoo6zwa3w/7L18OGzRwC+N7B52+HD2zYPfA8OP3iIH9kyjkd4Fdwj9x85skUPzfXhQd9cSN96mB+97yjgoYUXvZ7kxYu/UW7mL7Eo+rwKK9byTKWsSWWz6N8VBaZxB5ShgDJZHerscm0J6L1at2fNGPH4CqQNZ+gAGTeaPZVNBB52IJ7nt/uI3N/B0707Do+8vmEH37rpdTLX8eEDd47Xr564Y3aIj+67azM8Q4dwYHjpHbJoOu1/8OkH++lk4s59Y2Lo+tsevG1ukA/N3uHb9f9TbkFebNRET61I/GEuOEtdCkxKcdfISpPptmSn01kdVNF4Y4NjHF1rWnh0cxWZKImsJdKcKPPIkZR5RIoYkcJ7dh665dDOHqV/4jgc2ILXkYz77zgwypGsH1zKst/L+ir6nJVsPdtR2zaC4aQTZC9CR4p0jigDQ6gmexJcUeeXdbS0xY7WslzDdpPF8uryAPX0L+tqoVNFD5QrFi7rbKGXwYnkJGCpwra4XMZe1th6JZcOCL0VgV445HepqL+l5jVdKMHP1VeH89a/WtYaK2/9Z/g4noyFYduzjf6WpSS0FIKDRovrC4aaQ9ZArQ9b1r/K58P0Yhi/4Msl4WPhFbUuzCTBb1OitsjmCVsAn+Qs3eokTJ1FeEQlI1nGXNlfnbS8tcc/sYz4wU8vsbd+lr/UII5u7mncOYBJ+WKc+5jsETe/L03AXCfmN4IlTVnCOYiVSxyWr5h45up7d/Lpu568c7ey4zRcu6yjzk9P3Xvu3im5qb9yaf98ab2AwZIsy0Zrq6nXxkG22zi121ScGiC71IoiZwcZqlAmzUCmvaU5GgkkzaQfoNCjlKimWnxvGhtR5b4r0roYFX59BZLFsvVB5NMRIVAGQ65bJoBsRuaFbLJM/0n3nZCLlZaWYKj+efWy88WezKv+yiG5dKnN23mX2uUJbi5bY+Rc4XgxBrHXGnlYb637gwLPEuXVBmD1ViiIyzgRfl5f9NddvfoB9NDxw0clWD9KV0FbdhMMjzfc+H7uJXEG8fo6Ns4O1q5fU+KCCq16PhXG3JuJcczFw6GwEaLSBXkQwNwF4DgLs1AgHDqA2FToAXEgCDpj+jTudDaDgUmnGsaG9bWx1UOVctJGzBlDf2HJWgZyh1HHkeV53RK5WC6Gc8fr45AzKSByxwlWHShTsxydSgfVLhALUZsXOiS8w0TlVOdJ006bC4ZayA43j7cN9WCqeCgYDTvGJzKnKG0Jn7ou6KSC18Frs8FUk2Jch1frv65/kWLdMMbf2fWfDKac4HFdaYpb8HY9ZDXZhnEylEgHP7t2L6YMcO46M22b111HA113zoFBDJQUpy/WLx6B36K+MxQdmlHBKerm0BIJKqUu68GgoLY0VSpexdChJiDC1WpC9qwK1cQYpS7U0BW0JAzeMrX6P+hRI2Dy4z/hqqmb4gS3jG8GLT77P1Ue5E4wfOFTFoioAS8NYVYZhv9umJapaPV6hct6wHdkHiowcqVYnvUivt5Qa+3vK/X2dBXy2Uy6pclBE4pR4XkwxWHTtq93vH+tv0l2U6pFvbNRePWrv51uBFbBWmgHbw/upXv+0LnRc1AxL/RjLrVgmvx/yP0Fq1KJxarV2A+PHct2HDvWwbvxJIYX60/THfzHrcdGH7shQm/iC2l6E/fXRumtaPU/ybeyx+p34UkVL0LJv9PAUHOomzL1w8q9uZaYoV3SIOoujHBKKii60eKMxhJHXUMgTQW0InVqqErq22AbYN6BHOMkFCMtlpWLDDc/0NM23tYLZ1uGMX5ZrWfPtkQj+chQ61lZiH+gZSiai0Sbz4JhDbeswXd2PSVr8E/twqtr8KXdu690Q2KpI6jHMMuhBjdRdbG9iQslEae6YVhDV7gBdOiHgK4iKtSERkv4yOpAP8ZMpimmNqtSRuUFG50FDD2AeaYRNrasGS0P2LTwuGDncpRJNtZ5Fpev85SVhMY6T3ewBJrtjAFIs8XZi95eSXOXLJkW75wKaXmE7afkst1TsjBDJxP3v3I//kG6Z9R+ce7WnfcfrvHRo6fPnT46CpteTMJZ7yXKMb2XTlHieMpspgUYLz+k3UsJV/LFTWNH7vvT08eHlfWHHtx+69yLSbZMRhHWhDn2SG0oYCC3qE/B0qAKuZqPg+b5XkErlwWmYkKlMkNY2eLmUAqF3OJinmKjrPIhuK1/W/IJ6z8kh5K1D2aK+/UTWqOzkz1fC4xVOgKKKqgjZqKV9nhTGGOgUGnZjiK4Mq8jJFKOMwJ0UxSLdlO/Ymvrtq8H3/UG+nBNcG0e7Vh79xt/yOf37KklDMPYaeyc3LZ1y8hwT671KoP8BApooL9agOqYUm2FATeRptTcdeQGxexmC3pWyw2u5ZSr4l9xsLCKW+DaaeqxVskXZql+XdTggY9NDrcHk331MoTzqZSj3fGlCe3GxJQT6IsGjeBkQOGQO53v+VKSb9E1EVMQ5vKs2/R7axiimWAmiVCh4/MZ1eYrecvvMWx9oa71KppmNkVhBs6G6m+veHkw8amOFi0QFY4pTI7RrikRxSd1jgBaCeytDEHmYSsUN/HTEEyqQVQ6ppY4937ER/nPmMXaWK6W8TvQy1cj+s28wcIlS70LHqQsSoS5rB18abP70ubwv0VMqrRhJALnb2SJXZ76vg7pAPc9++oF2+s8XzLyZUMt/3ajhy35encPGy4n+lIy4Xvvou1JERMJFmTa8zqHldSwlaBa9k6VC63heDzM/3cYttfndDMiKlbIwCN7eV2F8FS61toUNZhCzHltUoKChwg/yah6WVnr8jIXJer+ultoizj14CWn/GfvvEU5uIjTdtnx8nw86K1TlzWF5QsXBhYXGlw+3rLk/5IB/G8+gzZuYUagPa8ByoUaWfiRIuA35I4CrJOMVariLtOCaKD+Ryq3gvWTwSDci1AAfVtQi7zzsmWE4F5Vq/+RPKDe8714vX5SVSVGuXjxa2K/iCyN42qyOkbLkXwt6FIjmt5sRsHC11VB2yANZQl1HL+GWjFC9Em4Vx7Q2oKTeB2+oKkeL3xEkBU015zWlri4VEBrpICIlwZ7Eso2mgSVKs8GLeJN5YsLnmn7Lh7/45KS6ncSg5I/Por8NcaWi7UW27Te2JeyTGPqPg3VS9j2CzJyeznjn1qaGXCrpsq8ro655n7+1zi3WwkBRkGuRl5e3eMyi6L0TvDJcnYwTnM14fWG5Xyh5nXVLya56BmNJRUi25oYoiGRJBGXdaO+Rb1Y9R861mlZYzodsf21K8/wZ1mC8I75Hr9viTsF+fsW5BzxTSO1IFQNz6DJvnC/lPv9L6Ab4KcvfJU6gC94y9NfMP31s7i5XY5RIn6LJqKRxjAKDuOVppiQA65ycUhaEvVeQya8dVuF6uCYKClVFADVGd5FyGt9RTWAAgg50ahiNFm2YkcCarHv3QTW/6Jna0TY0VA0FEpnMkbciKJ0RGSrrMN/XzzKfy7p3saOsq21cUl7FVQ2Dboqxg8D38S4hnxooL2bGRU1qurqAtP1Q1M7xzd3Sd4MKlx9aN7cxtWq/1OQAi25ohrK0s0ilVHwbgmKVNGWD1T/IMmcmd2u68h5MhPsLpW6Mf7ZEUPfceC+0zfhdXy9uTm5cQffujnZrMQFzmZdv+n0HyDOnl33Z4RjOcFoIL338N50IIpBxBEd9+2+7fV+vGGHQ5Y18NCTDw1EwkITYRu/JwZe9fPMI+IfxFUsyjbSqvKhAcwt168pdedsTBbTzZxTnRzRxQyV/if8uggP8y2VcpqWw7iyTmgJOy3GuEu5oK35P5xC0L6GZFag308hopD9/6r3KyoE7rKG5Tqi3D9z8s6TM/3+7mEeeCxiPDanxdWDjxmRxwKIeebmVFVePajGtTl5VaWLcGDdLdMVpbTvxD0n9pWUyvQtew1RfioQFOU/1vU/Lotg4KmyMEz9nnuM2OINTVu8ETPuuUeXPuNZUcFYEmd9rFRbYSxfVUjLiN9dFerqyvd2yKWFBEEB548Fup3m1PWnBQHUERnjyKYur0O1v1pBfvl30u2Hnj4EwydOw/CBOyd23vd4+YefpuUbvHb84elmO9HXD1P3Tq1f48YM5VZ17msH5/d1fPtmWQndeOwTd1EnZNeXbtwsoBRbcbJ29T3T0GbGDO+3J95aen6KxViWDVCHL8i5wsPAxPLfE1FDb55RmQnmCYgrEoijOyX+6KeDoE66Tt5ONjkSgheKBA9LqL6qpqchU0E7QaSYtJ3+irSVimrrmpLJU3ej0gsK6vTRXbdlEXtnb9u17Z9B+Un9m9Hg5rmoE93YF4zCPwZ31H9b/6f6b3cEgzvAgAIYO4IwfMe64Q03nOX3fXzD8Lo7brzrLtiCz85tCkajwb6N0b9LJD738MOfSxTs2x7mj3yGsEgjzzBYB9Xw2hGCYAZOzYWG2uR6nFlvxlJeEZfO732ziNsX84be4ffMGz7/gRmQb1dyTX8Q/dtArU8Hb8Wybmgod53NBlQOilxbg9mPCIstK3sTAzE7O5BMJuTKkvJgwfulBskXM0CBMymXLQrpkSoDMVmJ6aA2QjGG4SJkRk38g5sd61dtYGoQ4St+jHY+U23r4aVWOEjtseoMnDgvfwCEm2+hp6r/X91AK4zYkU3HMVEaxnR3qBfqPzn+/wHPnsOreJxjYGRgYABi1vIsoXh+m68M3MwvgCIMt5YoxkDp2P9f/2exVDAHAbkcDEwgUQAz1Qu/AHicY2BkYGAO+p/FwMBS9v/r/68sFQxAERQQDACh8QbyeJxdT0sVwzAMy49AkAxAkbT3UQiAITGAISmAYQiA9th4ttUs7Q568UeSlVidiwSkB3PUPg+ESd6ZD/+8v7HyrtzwghY89ZB6BcyrYqc6RZhw48YhaA1Wc/v1PQtdeXJ/HppUmFM597nvBVK7D+Z+E8/uQZLBgDyaz3Llvxx02S3c/Hv813JrznryZP4F+6lSfQAAAAAAAAAAUAC2ATABaAGyAfoCJAKwAzYDmgQSBFwExgUyBbQF/AZOBvwHRAe2B/YISgigCPIJGglCCWQJignACgAKQAp2CroLAAtGC4oL8gxcDPINng5iDuYPag/6EF4RIBGGEeQSShKYEyQTbhOyFAoUYhS+FVoVphYoFooXHBeGGFoYnhjGGOwZChlOGXgZrBneGhwaWhqgGtIbLhvyHHQc2B1QHZ4d/wABAAAAUwBtAAYAAAAAAAIAIAAwAHMAAAB2C3AAAAAAeJx1kN9q2zAUh39q0441YxcbjN3tXJWWEcc1lEGvWkLbXZeSu8JUV/6T2VKQlY48w95ifYa9zt6jd/vFESUUYiP5O5/O8ZEE4AP+QWH9nHKsWeEdozXv4A0uIu/Sf488IN9G3sMQPyLv0/+MfICv+BV5iI/4wz+owVtGM/yNrPBZfYm8g/fqW+Rd+svIA/Jd5D18UovI+/S/Ix9gqp4iD3GoniduvvR1WQU5mhxLlmap3C/FUdVWN6IXoXK+k3MpnA2maVySuza0ZlToUZ07292YctFov6k2eWp8VzsrJ0m6qa+NNV4H87Dq1j2WWQiFFN61chX7yNy7mclDUoUwPxuPN/tjAoc5lvCoUaJCgOCI9pjfDGk/BPfMEGaus2pYaDQ0GgtWVP1Kx/ico2BkaQ0zGnKCnHNL09KNuK451721rLqhLfmfht5vzdrmp7Sr3nUfC07YL92afU1r+wrd7/Dh5WwdHrmLjDawanUK3+9acPXqPML7Wq3NaHL6pL+1QHuGMd8t5/8PvPGO3QAAAHicbZLnlpswEIV9DRiwvZtseu89Ib333vvmBWRZYMVC0pHEEufpg8BO/kTncOfTaLgMOtPr97o17P1/baKPACEiDBAjQYohRhhjDevYhu3YwA7sxC7sxh7sxT7sxwEcxCEcxhEcxTEcxwmcxCmcxhmcxTmcxwVcxCVkuIwruIpruI4buIlbuI07uIt7uI8HeIhHeIwneIpneI4XeIlXeI03eIt3eI8P+IhP+Iwv+Ipv+I5N/OiF1hEz9JKxUrtFrDl1lWF9NR9QIikToRaVjUouKxvOmNBjLxnlhgo2DbnM1djLKrNGnGPScSUzItzGv93yPP2bSQSX84z9cqFQdJ56yZRmMhW8mLlJJSaBI0XYPDaZKDUviZmvr6DrNjJMi0WcK1MTM02mqpbZlJtEsNx5SI238jSodJtoS7qv+BpPw67IY9xU+dg5TXjROTWwdGrIOzWhT+uA0jolxqjaZrSOnCF2Nmq16651EYpMm1fakAul9SJQeR5QVYQlk1VkZ8SwoVNFIVjWnKQrlBGdMToftdoZjrs77DajqXKrS02YEFxbbtdWkG0x44JJVUS5aBqKSlJwmhDrmOF2Hv9Wqsy4TNqoKhfmSrrQKuNSL5nvPG6p0s0AkEWkSWVZMy1Kx3ljk03qLuZ14lTmB8gNGmByGrGfjLrhlhJV2f7SaIneNF1ypQNbybBUSgZswQaWEUNngeay1/sD4l/60HicY/DewXAiKGIjI2Nf5AbGnRwMHAzJBRsZWJ02MTAyaIEYm7mYGDkgLD4GMIvNaRfTAaA0J5DN7rSLwQHCZmZw2ajC2BEYscGhI2Ijc4rLRjUQbxdHAwMji0NHckgESEkkEGzmYWLk0drB+L91A0vvRiYGFwAMdiP0AAA=') format('woff')}</style>
<style id="style-core" type="text/css">html{font:16px/1 Helmet,Freesans,sans-serif}#store-area,tw-storydata{display:none!important;z-index:0}.no-transition{-webkit-transition:none!important;-o-transition:none!important;transition:none!important}:-webkit-full-screen{height:100%;width:100%}:-ms-fullscreen{height:100%;width:100%}:fullscreen{height:100%;width:100%}body::-ms-backdrop{background:0 0}:focus{outline:thin dotted}:disabled{cursor:not-allowed!important}body{color:#eee;background-color:#111;overflow:auto}a{cursor:pointer;color:#68d;text-decoration:none;-webkit-transition-duration:.2s;-o-transition-duration:.2s;transition-duration:.2s}a:hover{color:#8af;text-decoration:underline}a.link-broken{color:#c22}a.link-broken:hover{color:#e44}a[disabled],span.link-disabled{color:#aaa;cursor:not-allowed!important;text-decoration:none}area{cursor:pointer}button{cursor:pointer;color:#eee;background-color:#35a;border:1px solid #57c;line-height:normal;padding:.4em;-webkit-transition-duration:.2s;-o-transition-duration:.2s;transition-duration:.2s;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}button:hover{background-color:#57c;border-color:#79e}button:disabled{background-color:#444;border:1px solid #666}input,select,textarea{color:#eee;background-color:transparent;border:1px solid #444;padding:.4em}select{padding:.34em .4em}input[type=text]{min-width:18em}textarea{min-width:30em;resize:vertical}input[type=checkbox],input[type=file],input[type=radio],select{cursor:pointer}input[type=range]{-webkit-appearance:none;min-height:1.2em}input[type=range]:focus{outline:0}input[type=range]::-webkit-slider-runnable-track{background:#222;border:1px solid #444;border-radius:0;cursor:pointer;height:10px;width:100%}input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;background:#35a;border:1px solid #57c;border-radius:0;cursor:pointer;height:18px;margin-top:-5px;width:33px}input[type=range]:focus::-webkit-slider-runnable-track{background:#222}input[type=range]::-moz-range-track{background:#222;border:1px solid #444;border-radius:0;cursor:pointer;height:10px;width:100%}input[type=range]::-moz-range-thumb{background:#35a;border:1px solid #57c;border-radius:0;cursor:pointer;height:18px;width:33px}input[type=range]::-ms-track{background:0 0;border-color:transparent;color:transparent;cursor:pointer;height:10px;width:calc(100% - 1px)}input[type=range]::-ms-fill-lower{background:#222;border:1px solid #444;border-radius:0}input[type=range]::-ms-fill-upper{background:#222;border:1px solid #444;border-radius:0}input[type=range]::-ms-thumb{background:#35a;border:1px solid #57c;border-radius:0;cursor:pointer;height:16px;width:33px}input:not(:disabled):focus,input:not(:disabled):hover,select:not(:disabled):focus,select:not(:disabled):hover,textarea:not(:disabled):focus,textarea:not(:disabled):hover{background-color:#333;border-color:#eee}hr{display:block;height:1px;border:none;border-top:1px solid #eee;margin:1em 0;padding:0}audio,canvas,progress,video{max-width:100%;vertical-align:middle}.error-view{background-color:#511;border-left:.5em solid #c22;display:inline-block;margin:.1em;max-width:100%;padding:0 .25em;position:relative}.error-view>.error-toggle{background-color:transparent;border:none;line-height:inherit;left:0;padding:0;position:absolute;top:0;width:1.75em}.error-view>.error{display:inline-block;margin-left:.25em}.error-view>.error-toggle+.error{margin-left:1.5em}.error-view>.error-source[hidden]{display:none}.error-view>.error-source:not([hidden]){background-color:rgba(0,0,0,.2);display:block;margin:0 0 .25em;overflow-x:auto;padding:.25em}.highlight,.marked{color:#ff0;font-weight:700;font-style:italic}.nobr{white-space:nowrap}.error-view>.error-toggle:before,.error-view>.error:before,[data-icon-after]:after,[data-icon-before]:before,[data-icon]:before,a.link-external:after{font-family:tme-fa-icons!important;font-style:normal;font-weight:900;font-variant:normal;line-height:1;speak:never;text-rendering:auto;text-transform:none;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}[data-icon]:before{content:attr(data-icon)}[data-icon-before]:before{content:attr(data-icon-before) "\00a0\00a0"}[data-icon-after]:after{content:"\00a0\00a0" attr(data-icon-after)}.error-view>.error-toggle:before{content:"\e81a"}.error-view>.error-toggle.enabled:before{content:"\e818"}.error-view>.error:before{content:"\e80d\00a0\00a0"}a.link-external:after{content:"\00a0\e80e"}</style>
<style id="style-core-display" type="text/css">#story{z-index:10;margin:2.5em}@media screen and (max-width:1136px){#story{margin-right:1.5em}}#passages{max-width:54em;margin:0 auto}</style>
<style id="style-core-passage" type="text/css">.passage{line-height:1.75;text-align:left;-webkit-transition:opacity .4s ease-in;-o-transition:opacity .4s ease-in;transition:opacity .4s ease-in}.passage-in{opacity:0}.passage ol,.passage ul{margin-left:.5em;padding-left:1.5em}.passage table{margin:1em 0;border-collapse:collapse;font-size:100%}.passage caption,.passage td,.passage th,.passage tr{padding:3px}@media (prefers-reduced-motion:reduce){.passage{-webkit-transition:opacity 0s;-o-transition:opacity 0s;transition:opacity 0s}}</style>
<style id="style-core-macro" type="text/css">@-webkit-keyframes cursor-blink{0%{opacity:1}50%{opacity:0}100%{opacity:1}}@-o-keyframes cursor-blink{0%{opacity:1}50%{opacity:0}100%{opacity:1}}@keyframes cursor-blink{0%{opacity:1}50%{opacity:0}100%{opacity:1}}.macro-append-insert,.macro-linkappend-insert,.macro-linkprepend-insert,.macro-linkreplace-insert,.macro-prepend-insert,.macro-repeat-insert,.macro-replace-insert,.macro-timed-insert{-webkit-transition:opacity .4s ease-in;-o-transition:opacity .4s ease-in;transition:opacity .4s ease-in}.macro-append-in,.macro-linkappend-in,.macro-linkprepend-in,.macro-linkreplace-in,.macro-prepend-in,.macro-repeat-in,.macro-replace-in,.macro-timed-in{opacity:0}.macro-type-cursor:after{-webkit-animation:cursor-blink 1s infinite;-o-animation:cursor-blink 1s infinite;animation:cursor-blink 1s infinite;content:"\2590";opacity:1}</style>
<style id="style-ui-dialog" type="text/css">html[data-dialog] body{overflow:hidden}#ui-overlay.open{visibility:visible;-webkit-transition:opacity .2s ease-in;-o-transition:opacity .2s ease-in;transition:opacity .2s ease-in}#ui-overlay:not(.open){-webkit-transition:visibility .2s step-end,opacity .2s ease-in;-o-transition:visibility .2s step-end,opacity .2s ease-in;transition:visibility .2s step-end,opacity .2s ease-in}#ui-overlay{visibility:hidden;opacity:0;z-index:100000;position:fixed;top:-50%;left:-50%;height:200%;width:200%}#ui-dialog.open{display:block;-webkit-transition:opacity .2s ease-in;-o-transition:opacity .2s ease-in;transition:opacity .2s ease-in}#ui-dialog{display:none;opacity:0;z-index:100100;position:fixed;top:50px;margin:0;padding:0}#ui-dialog>*{-webkit-box-sizing:border-box;box-sizing:border-box}#ui-dialog-titlebar{position:relative}#ui-dialog-close{display:block;position:absolute;right:0;top:0;white-space:nowrap}#ui-dialog-body{overflow:auto;min-width:280px;height:92%;height:calc(100% - 2.1em)}@media (prefers-reduced-motion:reduce){#ui-overlay.open{-webkit-transition:opacity 0s;-o-transition:opacity 0s;transition:opacity 0s}#ui-overlay:not(.open){-webkit-transition:opacity 0s;-o-transition:opacity 0s;transition:opacity 0s}#ui-dialog.open{-webkit-transition:opacity 0s;-o-transition:opacity 0s;transition:opacity 0s}}#ui-overlay{background-color:#000}#ui-overlay.open{opacity:.8}#ui-dialog{max-width:66em}#ui-dialog.open{opacity:1}#ui-dialog-titlebar{background-color:#444;min-height:24px}#ui-dialog-title{margin:0;padding:.2em 3.5em .2em .5em;font-size:1.5em;text-align:center;text-transform:uppercase}#ui-dialog-close{cursor:pointer;font-size:120%;margin:0;padding:0;width:3.6em;height:92%;background-color:transparent;border:1px solid transparent;-webkit-transition-duration:.2s;-o-transition-duration:.2s;transition-duration:.2s}#ui-dialog-close:hover{background-color:#b44;border-color:#d66}#ui-dialog-body{background-color:#111;border:1px solid #444;text-align:left;line-height:1.5;padding:1em}#ui-dialog-body>:first-child{margin-top:0}#ui-dialog-body hr{background-color:#444}#ui-dialog-body ul.buttons{margin:0;padding:0;list-style:none}#ui-dialog-body ul.buttons li{display:inline-block;margin:0;padding:.4em .4em 0 0}#ui-dialog-body ul.buttons>li+li>button{margin-left:1em}#ui-dialog-close{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}#ui-dialog-close{font-family:tme-fa-icons!important;font-style:normal;font-weight:900;font-variant:normal;line-height:1;speak:never;text-rendering:auto;text-transform:none;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}</style>
<style id="style-ui" type="text/css">#ui-dialog-body.settings [id|=setting-body]>div:first-child{display:table;width:100%}#ui-dialog-body.settings [id|=setting-label]{display:table-cell;padding:.4em 2em .4em 0}#ui-dialog-body.settings [id|=setting-label]+div{display:table-cell;min-width:8em;text-align:right;vertical-align:middle;white-space:nowrap}#ui-dialog-body.list{padding:0}#ui-dialog-body.list ul{margin:0;padding:0;list-style:none;border:1px solid transparent}#ui-dialog-body.list li{margin:0}#ui-dialog-body.list li:not(:first-child){border-top:1px solid #444}#ui-dialog-body.list li a{display:block;padding:.25em .75em;border:1px solid transparent;color:#eee;text-decoration:none}#ui-dialog-body.list li a:hover{background-color:#333;border-color:#eee}#ui-dialog-body.saves{padding:0 0 1px}#ui-dialog-body.saves>:not(:first-child){border-top:1px solid #444}#ui-dialog-body.saves table{border-spacing:0;width:100%}#ui-dialog-body.saves tr:not(:first-child){border-top:1px solid #444}#ui-dialog-body.saves td{padding:.33em .33em}#ui-dialog-body.saves td:first-child{min-width:1.5em;text-align:center}#ui-dialog-body.saves td:nth-child(3){line-height:1.2}#ui-dialog-body.saves td:last-child{text-align:right}#ui-dialog-body.saves .empty{color:#999;speak:none;text-align:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}#ui-dialog-body.saves .datestamp{font-size:75%;margin-left:1em}#ui-dialog-body.saves ul.buttons li{padding:.4em}#ui-dialog-body.saves ul.buttons>li+li>button{margin-left:.2em}#ui-dialog-body.saves ul.buttons li:last-child{float:right}#ui-dialog-body.settings div[id|=header-body]{margin:1em 0}#ui-dialog-body.settings div[id|=header-body]:first-child{margin-top:0}#ui-dialog-body.settings div[id|=header-body]:not(:first-child){border-top:1px solid #444;padding-top:1em}#ui-dialog-body.settings div[id|=header-body]>*{margin:0}#ui-dialog-body.settings h2[id|=header-heading]{font-size:1.375em}#ui-dialog-body.settings p[id|=header-desc],#ui-dialog-body.settings p[id|=setting-desc]{font-size:87.5%;margin:0 0 0 .5em}#ui-dialog-body.settings div[id|=setting-body]+div[id|=setting-body]{margin:1em 0}#ui-dialog-body.settings [id|=setting-control]{white-space:nowrap}#ui-dialog-body.settings button[id|=setting-control]{color:#eee;background-color:transparent;border:1px solid #444;padding:.4em}#ui-dialog-body.settings button[id|=setting-control]:hover{background-color:#333;border-color:#eee}#ui-dialog-body.settings button[id|=setting-control].enabled{background-color:#282;border-color:#4a4}#ui-dialog-body.settings button[id|=setting-control].enabled:hover{background-color:#4a4;border-color:#6c6}#ui-dialog-body.settings input[type=range][id|=setting-control]{max-width:35vw}#ui-dialog-body.list a,#ui-dialog-body.settings span[id|=setting-input]{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}#ui-dialog-body.saves button[id=saves-clear]:before,#ui-dialog-body.saves button[id=saves-export]:before,#ui-dialog-body.saves button[id=saves-import]:before,#ui-dialog-body.settings button[id|=setting-control].enabled:after,#ui-dialog-body.settings button[id|=setting-control]:after{font-family:tme-fa-icons!important;font-style:normal;font-weight:900;font-variant:normal;line-height:1;speak:never;text-rendering:auto;text-transform:none;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}#ui-dialog-body.saves button[id=saves-export]:before{content:"\e829\00a0"}#ui-dialog-body.saves button[id=saves-import]:before{content:"\e82a\00a0"}#ui-dialog-body.saves button[id=saves-clear]:before{content:"\e827\00a0"}#ui-dialog-body.settings button[id|=setting-control]:after{content:"\00a0\00a0\e830"}#ui-dialog-body.settings button[id|=setting-control].enabled:after{content:"\00a0\00a0\e831"}</style>
<style id="style-ui-bar" type="text/css">#story{margin-left:20em;-webkit-transition:margin-left .2s ease-in;-o-transition:margin-left .2s ease-in;transition:margin-left .2s ease-in}#ui-bar.stowed~#story{margin-left:4.5em}@media screen and (max-width:1136px){#story{margin-left:19em}#ui-bar.stowed~#story{margin-left:3.5em}}@media screen and (max-width:768px){#story{margin-left:3.5em}}#ui-bar{position:fixed;z-index:50;top:0;left:0;width:17.5em;height:100%;margin:0;padding:0;-webkit-transition:left .2s ease-in;-o-transition:left .2s ease-in;transition:left .2s ease-in}#ui-bar.stowed{left:-15.5em}#ui-bar-tray{position:absolute;top:.2em;left:0;right:0}#ui-bar-body{height:90%;height:calc(100% - 2.5em);margin:2.5em 0;padding:0 1.5em}#ui-bar.stowed #ui-bar-body,#ui-bar.stowed #ui-bar-history{visibility:hidden;-webkit-transition:visibility .2s step-end;-o-transition:visibility .2s step-end;transition:visibility .2s step-end}@media (prefers-reduced-motion:reduce){#story{-webkit-transition:margin-left 0s;-o-transition:margin-left 0s;transition:margin-left 0s}#ui-bar{-webkit-transition:left 0s;-o-transition:left 0s;transition:left 0s}}#ui-bar{background-color:#222;border-right:1px solid #444;text-align:center}#ui-bar a{text-decoration:none}#ui-bar hr{border-color:#444}#ui-bar-history [id|=history],#ui-bar-toggle{font-size:1.2em;line-height:inherit;color:#eee;background-color:transparent;border:1px solid #444}#ui-bar-toggle{display:block;position:absolute;top:0;right:0;border-right:none;padding:.3em .45em .25em}#ui-bar.stowed #ui-bar-toggle{padding:.3em .35em .25em .55em}#ui-bar-toggle:hover{background-color:#444;border-color:#eee}#ui-bar-history{margin:0 auto}#ui-bar-history [id|=history]{padding:.2em .45em .35em}#ui-bar-history #history-jumpto{padding:.2em .665em .35em}#ui-bar-history [id|=history]:not(:first-child){margin-left:1.2em}#ui-bar-history [id|=history]:hover{background-color:#444;border-color:#eee}#ui-bar-history [id|=history]:disabled{color:#444;background-color:transparent;border-color:#444}#ui-bar-body{line-height:1.5;overflow:auto}#ui-bar-body>:not(:first-child){margin-top:2em}#story-title{margin:0;font-size:162.5%}#story-author{margin-top:2em;font-weight:700}#menu ul{margin:1em 0 0;padding:0;list-style:none;border:1px solid #444}#menu ul:empty{display:none}#menu li{margin:0}#menu li:not(:first-child){border-top:1px solid #444}#menu li a{display:block;padding:.25em .75em;border:1px solid transparent;color:#eee;text-transform:uppercase}#menu li a:hover{background-color:#444;border-color:#eee}#menu a,#ui-bar-history [id|=history],#ui-bar-toggle{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}#menu-core li[id|=menu-item] a:before,#ui-bar-history [id|=history],#ui-bar-toggle:before{font-family:tme-fa-icons!important;font-style:normal;font-weight:900;font-variant:normal;line-height:1;speak:never;text-rendering:auto;text-transform:none;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}#ui-bar-toggle:before{content:"\e81d"}#ui-bar.stowed #ui-bar-toggle:before{content:"\e81e"}#menu-item-saves a:before{content:"\e82b\00a0"}#menu-item-settings a:before{content:"\e82d\00a0"}#menu-item-restart a:before{content:"\e82c\00a0"}#menu-item-share a:before{content:"\e82f\00a0"}</style>
<style id="style-ui-debug" type="text/css">#debug-bar{background-color:#222;border-left:1px solid #444;border-top:1px solid #444;bottom:0;margin:0;max-height:75%;padding:.5em;position:fixed;right:0;z-index:99900}#debug-bar>div:not([id])+div{margin-top:.5em}#debug-bar>div>label{margin-right:.5em}#debug-bar>div>input[type=text]{min-width:0;width:8em}#debug-bar>div>select{width:15em}#debug-bar-toggle{color:#eee;background-color:#222;border:1px solid #444;height:101%;height:calc(100% + 1px);left:-2em;left:calc(-2em - 1px);position:absolute;top:-1px;width:2em}#debug-bar-toggle:hover{background-color:#333;border-color:#eee}#debug-bar-hint{bottom:.175em;font-size:4.5em;opacity:.33;pointer-events:none;position:fixed;right:.6em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;white-space:nowrap}#debug-bar-watch{background-color:#222;border-left:1px solid #444;border-top:1px solid #444;bottom:102%;bottom:calc(100% + 1px);font-size:.9em;left:-1px;max-height:650%;max-height:65vh;position:absolute;overflow-x:hidden;overflow-y:scroll;right:0;z-index:99800}#debug-bar-watch[hidden]{display:none}#debug-bar-watch div{color:#999;font-style:italic;margin:1em auto;text-align:center}#debug-bar-watch table{width:100%}#debug-bar-watch tr:nth-child(2n){background-color:rgba(127,127,127,.15)}#debug-bar-watch td{padding:.2em 0}#debug-bar-watch td:first-child+td{padding:.2em .3em .2em .1em}#debug-bar-watch .watch-delete{background-color:transparent;border:none;color:#c00}#debug-bar-watch-all,#debug-bar-watch-none{margin-left:.5em}#debug-bar-views-toggle,#debug-bar-watch-toggle{color:#eee;background-color:transparent;border:1px solid #444;margin-right:1em;padding:.4em}#debug-bar-views-toggle:hover,#debug-bar-watch-toggle:hover{background-color:#333;border-color:#eee}#debug-bar-watch:not([hidden])~div #debug-bar-watch-toggle,html[data-debug-view] #debug-bar-views-toggle{background-color:#282;border-color:#4a4}#debug-bar-watch:not([hidden])~div #debug-bar-watch-toggle:hover,html[data-debug-view] #debug-bar-views-toggle:hover{background-color:#4a4;border-color:#6c6}#debug-bar-hint:after,#debug-bar-toggle:before,#debug-bar-views-toggle:after,#debug-bar-watch .watch-delete:before,#debug-bar-watch-add:before,#debug-bar-watch-all:before,#debug-bar-watch-none:before,#debug-bar-watch-toggle:after{font-family:tme-fa-icons!important;font-style:normal;font-weight:900;font-variant:normal;line-height:1;speak:never;text-rendering:auto;text-transform:none;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}#debug-bar-toggle:before{content:"\e838"}#debug-bar-hint:after{content:"\e838\202f\e822"}#debug-bar-watch .watch-delete:before{content:"\e804"}#debug-bar-watch-add:before{content:"\e805"}#debug-bar-watch-all:before{content:"\e83a"}#debug-bar-watch-none:before{content:"\e827"}#debug-bar-views-toggle:after,#debug-bar-watch-toggle:after{content:"\00a0\00a0\e830"}#debug-bar-watch:not([hidden])~div #debug-bar-watch-toggle:after,html[data-debug-view] #debug-bar-views-toggle:after{content:"\00a0\00a0\e831"}html[data-debug-view] .debug{padding:.25em;background-color:#234}html[data-debug-view] .debug[title]{cursor:help}html[data-debug-view] .debug.block{display:inline-block;vertical-align:middle}html[data-debug-view] .debug.invalid{text-decoration:line-through}html[data-debug-view] .debug.hidden,html[data-debug-view] .debug.hidden .debug{background-color:#555}html:not([data-debug-view]) .debug.hidden{display:none}html[data-debug-view] .debug[data-name][data-type].nonvoid:after,html[data-debug-view] .debug[data-name][data-type]:before{background-color:rgba(0,0,0,.25);font-family:monospace,monospace;white-space:pre}html[data-debug-view] .debug[data-name][data-type]:before{content:attr(data-name)}html[data-debug-view] .debug[data-name][data-type|=macro]:before{content:"<<" attr(data-name) ">>"}html[data-debug-view] .debug[data-name][data-type|=macro].nonvoid:after{content:"<</" attr(data-name) ">>"}html[data-debug-view] .debug[data-name][data-type|=html]:before{content:"<" attr(data-name) ">"}html[data-debug-view] .debug[data-name][data-type|=html].nonvoid:after{content:"</" attr(data-name) ">"}html[data-debug-view] .debug[data-name][data-type]:not(:empty):before{margin-right:.25em}html[data-debug-view] .debug[data-name][data-type].nonvoid:not(:empty):after{margin-left:.25em}html[data-debug-view] .debug[data-name][data-type|=special],html[data-debug-view] .debug[data-name][data-type|=special]:before{display:block}</style>
</head>
<body>
	<div id="init-screen">
		<div id="init-no-js"><noscript>JavaScript must be enabled to play.</noscript></div>
		<div id="init-lacking"><p>Browser lacks capabilities required to play.</p><p>Upgrade or switch to another browser.</p></div>
		<div id="init-loading"><div>Loading&hellip;</div></div>
	</div>
	<!-- UUID://F420476E-098A-46C9-9EFF-9652F277776A// --><tw-storydata name="The Mage&#39;s Tower" startnode="169" creator="Tweego" creator-version="2.1.1+81d1d71" ifid="F420476E-098A-46C9-9EFF-9652F277776A" zoom="0.6" format="SugarCube" format-version="2.36.1" options="" hidden><style role="stylesheet" id="twine-user-stylesheet" type="text/twine-css">/* Title Screen - Start */
.title-container {
  position: relative;
  /* #story has 2.5em top margin */
  top: -2.5em;
  /* sugarcube html structure makes it hard to use display:grid */
}
.title-character {
  position: absolute;
  z-index: 0;
  max-width: 100%;
  /* try to keep Ivex's feet on screen, but don't make his face too small */
  max-height: max(100vh, 60vw);
}

.title-logo {
  position: relative;
  display: block;
  margin-left: auto;
  z-index: 1;
  max-width: 50%;
}

.title-options {
  z-index: 2;
  position: absolute;
  right: 10%;
  display: inline-block;
  background-color: #222;
  padding: 30px;
  border: 1px solid #aaa;
  border-radius: 15px;
}

.title-options a {
  font-size: 2em;
  font-family: fantasy;
  color: #c78f28;
}

/* on narrow screens */
@media(max-width: 30rem) {
  /* move logo down */
  .title-logo {
    top: 25vw;
  }
  
  /* center menu below Ivex */
  .title-options {
    position: relative;
    right: -50%;
    text-align: center;
    top: 40vw;
    translate: -50%;
  }
}

#ui-dialog-body button {
  color: #000;
  border: 1px solid #ab852d;
  background-color: #cb9b32;
}

#menu {
  /* make some clear space, since footer is on top */
  margin-bottom: 50px;
}

#menu ul {
  border-radius: 15px;
}

#menu li a { 
  border-radius: 15px;  
  color: #e7c440;
}

/* Title Screen - End */

.bad-ending {
  color: red;
}

.good-ending {
  color: green;
}

.handwriting {
  font-family: Snell Roundhand, cursive;
}

.mild-handwriting {
  font-family: Apple Chancery, cursive;
}

.crude-handwriting {
  font-family: cursive;
}

.disabled {
  pointer-events: none;
  opacity: 0.4;
}

.helper-container {
  line-height: 1;
  display: inline-grid;  
}

.helper-text {
  opacity: 0.8;
}

.imp-info {
  color: #eaf54c;
}

/* Sidebar - Start */

#story-title {
  display: none;
}

#story-version {
  color: rgb(90 90 90);
  font-size: 12px;
  font-weight: normal;
  line-height: 1;
}

#story-caption {
  margin-bottom: 6.5em;
}

#ui-bar-footer {
  position: absolute;
  background-color: rgb(34, 34, 34);
  bottom: 0;
  padding: 0.5em 1.5em 0 1.5em;
  text-align: center;
}

#ui-bar-footer span {
  display: inline-block;
}

a.footer-element {
  margin: 0 0.4em;
}

/* Dividers - Start */
.divider
{
  position: relative;
  /*margin-top: 90px;*/
  height: 1px;
}

.div-transparent:before
{
  content: "";
  position: absolute;
  top: 0;
  left: 5%;
  right: 5%;
  width: 90%;
  height: 1px;
  background-image: linear-gradient(to right, transparent, rgb(255,255,255), transparent);
}

.div-arrow-down:after
{
  content: "";
  position: absolute;
  z-index: 1;
  top: -7px;
  left: calc(50% - 7px);
  width: 14px;
  height: 14px;
  transform: rotate(45deg);
  background-color: #222;
  border-bottom: 1px solid rgb(255,255,255);
  border-right: 1px solid rgb(255,255,255);
}

.div-dot:after
{
  content: "";
  position: absolute;
  z-index: 1;
  top: -9px;
  left: calc(50% - 9px);
  width: 18px;
  height: 18px;
  background-color: goldenrod;
  border: 1px solid rgb(48,49,51);
  border-radius: 50%;
  box-shadow: inset 0 0 0 2px #222,
          0 0 0 4px #222;
}
/* Dividers - End */

/* Sidebar - End */

/* Link Styles - Start */
a {
  color: #ffa000;
  background-color: transparent;
  text-decoration: none;
}

a:hover {
  color: #c67100;
  background-color: transparent;
  text-decoration: none;
}

/* Link Styles - End */

/* Action Box - Start */
div.action-box {
  border-style: none none none none;
  border-color: #989899;
  /*margin: 0px -20px 0 -20px;*/
}

ul.actions {
  padding-left: 0.5em;
}

ul.actions li {
  padding: 10px 0 10px 25px;
  list-style: none;
  background-image: url("images/quote.png");
  background-repeat: no-repeat;
  background-position: left center;
  background-size: 15px;
}

/* fixup for debug/test mode */
.debugging ul.actions li {
  background-image: url("https://magestower.slethstories.com/images/quote.png");
}

/* Action Box - End */


/* Horizontal Health Bar - Start */
.hzbarbkg {  /* default class for all horizontal bar backgrounds */
    position: relative;
    height: 15px;
    width: 50%;
    background-color: #111;
    background-image: linear-gradient(to right, rgba(68, 68, 68, 0.5), rgba(34, 34, 34, 0.5) 5px), linear-gradient(to bottom, rgba(68, 68, 68, 0.5), rgba(0, 0, 0, 0) 5px), linear-gradient(to left, rgba(255, 255, 255, 0.5), rgba(255, 255, 255, 0) 5px), linear-gradient(to top, rgba(255, 255, 255, 0.5), rgba(255, 255, 255, 0) 5px);
    border-radius: 10px;
    z-index: 10;
    visibility: visible;
}
.hzbar {  /* default class for all horizontal bars */
    position: absolute;
    bottom: 0px;
    left: 0px;
    height: 15px;
    border-radius: 10px;
    background-color: transparent;
    background-image: linear-gradient(to left, rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0) 5px), linear-gradient(to top, rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0) 5px), linear-gradient(to right, rgba(255, 255, 255, 0.5), rgba(255, 255, 255, 0) 5px), linear-gradient(to bottom, rgba(255, 255, 255, 0.5), rgba(255, 255, 255, 0) 5px);
    z-index: 20;
    transition: width ease 1s, background-color ease 1s;
}
#horizontalhealthbar {  /* colors for specific fixed-color horizontal bars */
    background-image: linear-gradient(to left, rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0) 5px), linear-gradient(to top, rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0) 5px), linear-gradient(to right, rgba(255, 255, 255, 0.5), rgba(255, 255, 255, 0) 5px), linear-gradient(to bottom, rgba(255, 255, 255, 0.5), rgba(255, 255, 255, 0) 5px), radial-gradient( circle at bottom right, #a1001e, #a1001e 60% );
}
.pulsingbar {
  box-shadow: 0 0 0 0 rgba(0, 0, 0, 1);
  transform: scale(1);
  animation: pulse 1.5s infinite;
}

@keyframes pulse {
    0% {
        transform: scale(1.05);
        box-shadow: 0 0 0 0 rgba(0, 0, 0, 0.7);
    }

    70% {
        transform: scale(1);
        box-shadow: 0 0 0 10px rgba(0, 0, 0, 0);
    }

    100% {
        transform: scale(1.05);
        box-shadow: 0 0 0 0 rgba(0, 0, 0, 0);
    }
}
/* Horizontal Health Bar - End */

/**
 * ==============================================
 * Dot Flashing
 * ==============================================
 */
.dot-flashing {
  position: relative;
  margin-left: 6.5px;
  width: 4px;
  height: 4px;
  border-radius: 5px;
  background-color: #ffa000;
  color: #ffa000;
  animation: dotFlashing 1s infinite linear alternate;
  animation-delay: .5s;
}

.dot-flashing::before, .dot-flashing::after {
  content: '';
  display: inline-block;
  position: absolute;
  top: 0;
}

.dot-flashing::before {
  left: -6.5px;
  width: 4px;
  height: 4px;
  border-radius: 5px;
  background-color: #ffa000;
  color: #ffa000;
  animation: dotFlashing 1s infinite alternate;
  animation-delay: 0s;
}

.dot-flashing::after {
  left: 6.5px;
  width: 4px;
  height: 4px;
  border-radius: 5px;
  background-color: #ffa000;
  color: #ffa000;
  animation: dotFlashing 1s infinite alternate;
  animation-delay: 1s;
}

@keyframes dotFlashing {
  0% {
    background-color: #ffa000;
  }
  50%,
  100% {
    background-color: #ebe6ff;
  }
}</style><script role="script" id="twine-user-script" type="text/twine-javascript">Config.ui.stowBarInitially = true;

if (!Config.debug) {
  Config.history.controls = false;
}

if (Config.debug) {
  // set flag for StoryMenu (can't use Config.debug; it's always false for StoryMenu)
  setup.enableDebugMenu = true;

  // set base url for html images (this happens too late for css images)
  $('head').prepend('<base href="https://magestower.slethstories.com/">');

  // add debugging class for css
  $('html').addClass('debugging');

  // start with debugview off
  setTimeout(() => DebugView.disable());
}

l10nStrings.restartTitle = "Restart";
l10nStrings.restartPrompt =
  "Restart will return you to the beginning of the story."
  + "<br><br>"
  + "Your unlocked endings will remain unlocked."
  + "<br><br>"
  + "Are you sure you want to restart?";
l10nStrings.restartOk = "Restart";
l10nStrings.restartCancel = "Cancel";

$(document.head).append("<link rel='icon' href='images/mt_icon_tr.png'>");

$(document).on(':passagestart', function (ev) {
    if (! ev.passage.tags.contains("noreturn")) {
        State.variables.return = ev.passage.title;
    }
});

/** Stow the sidebar on narrow screens. */
Macro.add("sidebar-auto-stow", {
  handler: function() {
    // sugarcube css overlaps the sidebar at max-width:768px
    if (document.body.offsetWidth <= 768) {
      UIBar.stow();
    }
  }
});

/* Health Bar code - Start */
window.Health = function (CurHP, MaxHP, BarID, Horizontal, Container) {
    if (Container == undefined) {
        console.log("Container undefined!!");
        Container = document;
    }
    var HP = parseInt((CurHP / MaxHP) * 100).clamp(0, 100);
    var BarElement = $(Container).find("#" + BarID);
    if (Horizontal) {
        BarElement.css({ width: HP + "%" });
    } else {
        BarElement.css({ height: HP + "%" });
    }
    //BarElement.attr("title", CurHP + "/" + MaxHP);
    //$(Container).find("#" + BarID + "bkg").attr("title", CurHP + "/" + MaxHP + " HP");
};
/* Health Bar code - End */

/* Arousal Bar Macro - Start */
macros.arousalbar = {
    handler: function(place, macroName, params, parser) {
        var CurArousal = params[0];
        var MaxArousal = params[1];
        
        $(document).one(':passagerender', function (ev) {
            Health(CurArousal, MaxArousal, "horizontalhealthbar", true, ev.content);
        });
        
        new Wikifier(place, "<div id=\"horizontalhealthbarbkg\" class=\"hzbarbkg\"><div id=\"horizontalhealthbar\" class=\"hzbar\"></div></div>");
    }
}
/* Arousal Bar Macro - End */</script><tw-tag name="done" color="purple"></tw-tag><tw-tag name="init" color="blue"></tw-tag><tw-tag name="key" color="orange"></tw-tag><tw-tag name="text" color="blue"></tw-tag><tw-tag name="noreturn" color="yellow"></tw-tag><tw-tag name="restart" color="green"></tw-tag><tw-tag name="end" color="red"></tw-tag><tw-tag name="has-hole" color="yellow"></tw-tag><tw-tag name="incomplete" color="red"></tw-tag><tw-tag name="maybe-password" color="blue"></tw-tag><tw-tag name="must-fix" color="orange"></tw-tag><tw-passagedata pid="1" name="Bound" tags="" position="2500,175" size="100,100">&lt;&lt;set $passedContentWarning = true&gt;&gt;\
The sound of snapping fingers feels distant at first. As consciousness returns, it grows closer and closer until it starts becoming loud.

The snapping comes from right beside his ear. The adventurer frowns, but consciousness has not returned in its entirety just yet. He feels as if... as if he had fallen down a well. At least that&#39;s all he can remember, sort of. It was bright, it was sudden, and now...

&quot;Wakey wakey...&quot; a voice calls from nearby. An unfamiliar voice with a tone of mockery.

The bound wolf only lets out a pained groan at first. Everything hurts. Slowly but surely, memories start to return. Memories of who he is...

[[Continue|Drekkar Start]]</tw-passagedata><tw-passagedata pid="2" name="StoryAuthor" tags="" position="1825,150" size="100,100">by &lt;a href=&quot;http://www.slethstories.com/&quot; target=&quot;_blank&quot;&gt;Sleth&lt;/a&gt;\
&lt;div id=&quot;story-version&quot;&gt;
  v1.20230612.0
&lt;/div&gt;</tw-passagedata><tw-passagedata pid="3" name="StoryBanner" tags="" position="2075,150" size="100,100">&lt;img src=&quot;images/logo_tr.png&quot; width=&quot;220&quot;&gt;\
&lt;div class=&quot;divider div-transparent div-arrow-down&quot;&gt;&lt;/div&gt;</tw-passagedata><tw-passagedata pid="4" name="StoryDisplayTitle" tags="" position="1950,150" size="100,100">The Mage&#39;s Tower</tw-passagedata><tw-passagedata pid="5" name="StoryMenu" tags="" position="2500,500" size="100,100">[[Archives]]
[[Credits]]
&lt;&lt;if setup.enableDebugMenu&gt;&gt;
    [[Debug: Goto Title|Title Screen]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="6" name="Soft Awakening" tags="" position="900,625" size="100,100">&lt;&lt;set $warrior = true&gt;&gt;\
It takes some effort, but the wolf opens his eyes. It takes a few seconds to regain their focus. At the same time, the stiffness of his body feels worse than ever. This nap was anything but comfortable.

As his vision clears, $name realizes that he&#39;s not quite lying down. In fact, he&#39;s pretty much standing up. The feeling of the leather wrappings around his wrists, ankles, and mid-section becomes obvious upon his first attempts to move with a groan. \
&lt;&lt;if $warrior&gt;&gt;\
In fact, the warrior&#39;s powerful frame barely fits on the cross with the wrapping feeling tight, especially the one around his broad chest. \
&lt;&lt;/if&gt;&gt;\
\
They were what was keeping him propped up on the vertical cross he&#39;s bound to, but now they are what keeps him trapped to it.

Panic starts settling in. The adrenaline makes the waking process faster. What&#39;s going on?

&quot;There we go. We&#39;re off to a good start,&quot; the voice says with amusement.

Shifting his eyes to the left, the wolf sees &lt;b&gt;him&lt;/b&gt; standing there. 

He&#39;s a panther. And he&#39;s the mage whose face the wolf had seen in the bounty posters. 

He is also smirking triumphantly.

[[Continue|Awakened]]</tw-passagedata><tw-passagedata pid="7" name="Rough Awakening" tags="" position="1025,625" size="100,100">&lt;&lt;set $rough_awakening = true&gt;&gt;\
\
Sleeping is easier. The wolf groans, but goes limp again. The sweet embrace of darkness feels good. Maybe just for a little while longer...

&quot;I said &#39;wakey wakey&#39;...&quot; the voice says again, but it seems to be growing distant once more...

And then the wolf feels something different. A grab, right above his clothes, clutching a part no one should be allowed to touch. His balls. That alone spurs him awake with a sense of urgency, but what follows...

The grip on the wolf&#39;s balls tightens suddenly. It becomes a hard squeeze, pressing on the sensitive nuts from all sides and pulling the lupine from the comfort of sleep in a fast and rough manner. With a gasp, the wolf&#39;s eyes snap open, his mind reeling to make sense of things while processing the pain at the same time.

His eyes take a while to focus, but is it because of the drowsiness or because of the tearing up from the pain?

The pain in his balls does not subside. It echoes, traveling up from his groin through his whole body. His first instinct is to move to stop it, but as he tries that, he quickly becomes aware of the leather bindings around his wrists, ankle and mid-section.

It also becomes obvious that the wolf is not lying down, but rather standing. The very bindings that kept him propped up before now keep him from being able to make the pain go away.

As the wolf&#39;s vision focuses, he lets out a yelp. His balls feel crushed. When he does, though, the grip finally loosens. There&#39;s another playful squeeze there that is very much felt, before the hand gripping his crotch finally lets go.

&quot;There we go. We&#39;re off to a fun start,&quot; the voice says in mockery.

Shifting his teary eyes to the left, the wolf sees &lt;b&gt;him&lt;/b&gt; standing there. 

He&#39;s a panther. And he&#39;s the mage whose face the wolf had seen in the bounty posters. 

He is also smirking triumphantly.

[[Continue|Awakened]]</tw-passagedata><tw-passagedata pid="8" name="Ivex Description" tags="" position="750,825" size="100,100">As advertised, Ivex is a black panther.

The wolf had never seen the mage outside of the drawings in his wanted poster, but on those he looked to be more on the slim side, as most magic users are. The mage that stands before the bound adventurer, however, is not slim at all. Though not extremely muscular, there are clear outlines of them on the visible parts of his arms and legs. His chest is broad, and the panther is remarkably tall for a feline.

With a sleek, typically feline muzzle that displays the whitest teeth and fangs as he smiles, Ivex has an impressive figure, especially for a mage.

Unlike most mages as well, Ivex doesn&#39;t wear robes, but rather regular clothing that seems to be of very noble quality. A white shirt, complete with a brown vest accompanied by a set of black pants that go well with his dark fur. Just like most, the feline does not wear any footwear, instead letting his feline paws free and bare on the floor. The thing that draws the most attention, however, is the red cape the mage has draped over his shoulders. It is something he clearly wears for show rather than utility, although the clip holding the cloak close to his neck glows with an expensive-looking purple gemstone embedded into it.

[[Return|Awakened]]</tw-passagedata><tw-passagedata pid="9" name="Office Description" tags="" position="750,700" size="100,100">The mage&#39;s office does not look special in itself, but it is rather curious.

The office is sleek and fancy with luxurious furniture. Strange objects adorn the cabinets here or there, but most of all the wolf can see bookcases filled with books about magic. At its center and off to the wolf&#39;s side, a large desk with the basics can be seen: parchment, ink, quill and stacks of papers and letters spread over the table.

The place looks like a very regular office, so perhaps what stands out the most is the bondage equipment the wolf is tied to at its very center. Not something you&#39;d expect to see in an office, but who knows what goes inside a crazy mage&#39;s head?

Another curious aspect to the wolf is that, off to the side, he can see a window if he cranes his neck just enough. Outside, however, there is nothing but a blue sky, hinting that the office might be up high. Where did the mage bring him?

[[Return|Awakened]]</tw-passagedata><tw-passagedata pid="10" name="Awakened" tags="" position="950,750" size="100,100">&quot;Finally awake,&quot; the panther continues, &quot;most people put up more of a fight when they are foolish enough to hunt me.&quot;

The wolf&#39;s eyes follow the panther, still having trouble focusing properly, but slowly the $class regains his proper sight. For the first time, the wolf is able to see that the cross he&#39;s bound to looks out of place in some kind of [[office|Office Description]].

&lt;&lt;print $name&gt;&gt;&#39;s eyes do narrow, however, when the mage casually pulls up the wolf&#39;s worn travel bag. After shoving his paw into it and rummaging through the wolf&#39;s backpack for a moment, the panther pulls out a piece of paper.

The wolf&#39;s ears fold back for a moment as he recognizes it. The panther is holding out the bounty poster with his own face on it. The writing on it is clear, too:

WANTED: DEAD OR ALIVE

IVEX THE MAGE
3,000 GOLD REWARD

The panther then lets go of the piece of paper, but instead of falling down... it hovers in the air for a moment. Then a movement of the hand above it makes it suddenly burst on fire. The wolf recoils from it and within a split second, only small ashes of what was once the bounty information remain.

For the first time, the wolf is able to take a good look at the feline mage, [[Ivex|Ivex Description]].

&quot;At first I wasn&#39;t a fan of these bounties, you know,&quot; Ivex continues, &quot;but as time went on, I found that it is in fact quite useful. Every now and then it delivers a free adventurer of the likes of you, right to my paws.&quot;

The panther opens a cocky grin.

&quot;The reward, however, is quite substantial. I do wonder who exactly hired you to find me, and how you managed to reach my location. I&#39;d very much like to know that before I decide what to do with you.&quot;

The wolf&#39;s narrow eyes focus on the panther. Bound in an unknown location and at the wizard&#39;s mercy, the lupine $class knows that the situation isn&#39;t good. Still, to just give out the name and location of the Wayward Adventurer Guild would put all of them in danger, to say the least...

The panther stares at the wolf expecting an answer.

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
    &lt;li&gt;[[&#39;&quot;You won\&#39;t get anything out of me!&quot;&#39;|Refusal]]&lt;/li&gt;
    &lt;li&gt;[[&#39;&quot;...If I tell you what you want to know, then what?&quot;&#39;|Consideration]]	  &lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;</tw-passagedata><tw-passagedata pid="11" name="Drekkar Start" tags="" position="950,500" size="100,100">&lt;&lt;set $name = &quot;Drekkar&quot;&gt;&gt;\
&lt;&lt;set $class = &quot;warrior&quot;&gt;&gt;\
&lt;&lt;set $warrior = true&gt;&gt;\
&lt;&lt;set $mage = false&gt;&gt;\
&lt;&lt;set $rough_awakening = false&gt;&gt;\
A seasoned fighter, a large wolf that takes pride in his strength. He goes by the name of Drekkar, with his older name being more complex and difficult to pronounce. Hailing from the less advanced wolven tribes from the north, Drekkar left his kind early and adapted well to the wider world. He&#39;s known among his friends at the Wayward Adventurers Guild as &quot;that crazy bastard who took down the Mad Wizard of Carcenvellathrop by punching him in the face&quot;. With a sword in hand, there&#39;s little Drekkar cannot accomplish. Now, however...

Drekkar&#39;s muscles, usually his most powerful weapon, ache. They feel stiff. An aching to stretch them comes upon the big wolf, but his body is only just recovering its proper responses. Drekkar lets out another tired groan. This feels worse than his last hangover...

&quot;Last chance, buddy. Wake up, or else...&quot; the voice says again. The wolf can hear a mix of amusement and impatience in it...

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
    &lt;li&gt;[[Make an effort to wake up.|Soft Awakening]]&lt;/li&gt;
    &lt;li&gt;[[...Cling to the comfort of sleep.|Rough Awakening]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;</tw-passagedata><tw-passagedata pid="12" name="Refusal" tags="" position="900,875" size="100,100">Much to &lt;&lt;print $name&gt;&gt;&#39;s delight, the reaction at least seems to wipe that smirk out of the panther&#39;s face for a second. Only for a second, though, as a different kind of smile opens up. A smile that makes the wolf&#39;s ears lower themselves even if just a little.

&quot;I was kind of hoping you would say that. I enjoy the brave types very much.&quot; The panther approaches, closing in the last distance between him and the wolf.

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
    &lt;li&gt;[[Growl at Ivex.|Molesting]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;</tw-passagedata><tw-passagedata pid="13" name="Consideration" tags="" position="1025,875" size="100,100">&quot;Aahh... the good boy type,&quot; the panther muses. &quot;I am ever so glad. Or am I? Perhaps we won&#39;t have too much trouble here after all.&quot;

The panther took a step forward and opened a sinister smile. &quot;Unfortunately, I regret to say that regardless of your collaboration, you won&#39;t be getting out of here. I have plans for you.&quot;

The wolf&#39;s eyes narrow towards the mage.

&quot;Don&#39;t get me wrong, though! Collaborating with me is still very much in your best interest. It will reduce the hardship you will go through significantly.&quot;

With a spring to his step, the panther approaches, closing in the last distance between him and the wolf.

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
    &lt;li&gt;[[Growl at Ivex.|Molesting]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;</tw-passagedata><tw-passagedata pid="14" name="StoryInit" tags="" position="2200,150" size="100,100">&lt;&lt;script&gt;&gt;
  /** Mage&#39;s Tower namespace */
  window.MT = {};
&lt;&lt;/script&gt;&gt;

&lt;&lt;include [[g0boot Metadata]]&gt;&gt;
&lt;&lt;include [[g0init Saved Games]]&gt;&gt;

&lt;&lt;script&gt;&gt;
const v = variables();
v.name = &quot;Drekkar&quot;;
v.class = &quot;warrior&quot;;
v.warrior = true;
v.mage = false;

v.rough_awakening = true;
v.FurtherDefiance = false;

v.CurArousal = 10;
v.MaxArousal = 100;

v.candleTimer = &quot;2s&quot;;
v.window = false;
v.office = false;
v.door = false;

v.lionwatch1 = 40;
v.lionwatch2 = 20;
v.lionwatch3 = 20;
v.lionwatch4 = 40;
v.lionwatch5 = 50;
v.lionwatch6 = 60;
v.lionwatch7 = 90;
v.lionwatchFinal = v.lionwatch1 + v.lionwatch2 + v.lionwatch3 +
  v.lionwatch4 + v.lionwatch5 + v.lionwatch6 + v.lionwatch7;

MT.drekkarEndings = [];

/* 1F endings */

v.interrogationEndingUnlock = false;
v.interrogationEndingShockUnlock = false;
v.interrogationEndingFreezeUnlock = false;
v.interrogationEndingMildUnlock = false;
v.interrogationEndingRoughUnlock = false;

MT.drekkarEndings.push(&quot;interrogationEnding&quot;);
MT.drekkarEndings.push(&quot;interrogationEndingShock&quot;);
MT.drekkarEndings.push(&quot;interrogationEndingFreeze&quot;);
MT.drekkarEndings.push(&quot;interrogationEndingMild&quot;);
MT.drekkarEndings.push(&quot;interrogationEndingRough&quot;);

/* 2F endings */

v.enthrallmentEndingUnlock = false;
v.enthrallmentLionUnlock = false;

MT.drekkarEndings.push(&quot;enthrallmentEnding&quot;);
MT.drekkarEndings.push(&quot;enthrallmentLion&quot;);

v.extractionEndingUnlock = false;
v.extractionForcefulEndUnlock = false;
v.extractionGentleEndUnlock = false;

MT.drekkarEndings.push(&quot;extractionEnding&quot;);
MT.drekkarEndings.push(&quot;extractionForcefulEnd&quot;);
MT.drekkarEndings.push(&quot;extractionGentleEnd&quot;);

/* Escape endings */

v.enthralmentIvexEndingUnlock = false;
MT.drekkarEndings.push(&quot;enthralmentIvexEnding&quot;);

v.extractionIvexEndingUnlock = false;
MT.drekkarEndings.push(&quot;extractionIvexEnding&quot;);

v.personalEndingUnlock = false;
MT.drekkarEndings.push(&quot;personalEnding&quot;);

/* declare metadata */

for (const key of MT.drekkarEndings) {
  MT.mdDefSaved(key);
}

MT.mdDefPreserved(&quot;sawTitle&quot;);
MT.mdDefPreserved(&quot;passedContentWarning&quot;);

&lt;&lt;/script&gt;&gt;\
\
&lt;&lt;nobr&gt;&gt;

&lt;&lt;append &quot;#ui-bar-body&quot;&gt;&gt;
  &lt;div id=&quot;ui-bar-footer&quot;&gt;
    &lt;span&gt;
      &lt;a class=&quot;footer-element&quot; target=&quot;_blank&quot; href=&quot;https://www.patreon.com/sleth&quot;&gt;&lt;img alt=&quot;Patreon&quot; src=&quot;images/pa_logo.png&quot; height=&quot;30&quot;&gt;&lt;/a&gt;

      &lt;a class=&quot;footer-element&quot; target=&quot;_blank&quot; href=&quot;https://twitter.com/slethwulf&quot;&gt;&lt;img alt=&quot;Twitter&quot; src=&quot;images/tw_logo.png&quot; height=&quot;30&quot;&gt;&lt;/a&gt;

      &lt;a class=&quot;footer-element&quot; target=&quot;_blank&quot; href=&quot;https://www.furaffinity.net/user/sleth/&quot;&gt;&lt;img alt=&quot;FurAffinity&quot; src=&quot;images/fa_logo.png&quot; height=&quot;30&quot;&gt;&lt;/a&gt;

      &lt;a class=&quot;footer-element&quot; target=&quot;_blank&quot; href=&quot;https://sleth.sofurry.com/&quot;&gt;&lt;img alt=&quot;SoFurry&quot; src=&quot;images/sf_logo.png&quot; height=&quot;30&quot;&gt;&lt;/a&gt;
    &lt;/span&gt;
  &lt;/div&gt;
&lt;&lt;/append&gt;&gt;
&lt;&lt;/nobr&gt;&gt;\</tw-passagedata><tw-passagedata pid="15" name="Molesting" tags="" position="950,1000" size="100,100">&lt;&lt;print $name&gt;&gt; opens a warning growl, but even though the wolf tugs against the restraints of the cross he&#39;s bound to, there is nothing that can be done against the feeling of extreme vulnerability. The panther, the enemy, stands right there, well within the range of touch, and all the wolf can do is remain there with his limbs spread wide.

&quot;Look at you, wolf. Such a powerful &lt;&lt;print $class&gt;&gt;...&quot; The panther licks his lips. His hand comes to the wolf&#39;s chest. His touch feels invasive as he places his hand upon &lt;&lt;print $name&gt;&gt;&#39;s broad pectorals and feels it up. All $name can do is snarl once more, but the wolf knows that his growling is nothing but a fake threat at that moment. There has to be a way to turn the tables on that damned mage, but how...?

&lt;&lt;if $warrior&gt;&gt;\
The panther&#39;s hand trails up over the warrior&#39;s plain shirt towards the bound wolf&#39;s biceps. Those being uncovered, given his short sleeves, the mage has full liberty to feel Drekkar&#39;s fur alongside the hardened muscles beneath. The wolf ups his growling and shows some teeth, but the panther all but ignores it, not intimidated in the least.

&quot;Such a strong warrior. You are my favorite kind to keep around. I do so love the sight of your well-trained bodies...&quot; the panther says all too suggestively.

&quot;Get your dirty paws off me!&quot; Drekkar growls. &quot;When I break out of here, I&#39;m gonna make you eat dirt! I&#39;ll fucking break you like a twig!&quot;

Ivex only smiles. He doesn&#39;t even retract his damned hand from the wolf&#39;s arm, instead taking a moment to feel his muscles one more time before he finally does.
&lt;&lt;elseif $mage&gt;&gt;\
The panther&#39;s hand traces down around the lean wolf&#39;s hips. The long robes Nero wears don&#39;t feel like enough to ward off the panther&#39;s hands. Nero&#39;s first reflex is to attempt some kind of incantation. Though he would need his hands to perform the proper gestures for any kind of significant magic, one hand can be enough to at least ward the panther off, but upon attempting it...

Nothing happens.

It&#39;s as if magic does not exist in this place, even though, at the same time, it is clearly surrounding them in its entirety. What is this place?

&quot;A powerful mage like you, full of knowledge and yet completely disarmed. It must be frustrating, no? Yet you don&#39;t have to worry. I have means to make great use of your trained mastery over magic.&quot;

((continue mage section))
&lt;&lt;/if&gt;&gt;\

&quot;That&#39;s cute. Thinking you can pull off threats when you&#39;re in my domain. In my own creation.&quot; The panther let out a small laugh. &quot;Why don&#39;t I show you some of my power? That way you&#39;ll have a better idea of just how much more than you can chew you tried to bite with that little wolf maw of yours.&quot;

Sounding arrogant and cocky as always, the mage takes a step back. $name feels some relief at that, at least, until the panther raises one of his hands...

And simply snaps his fingers.

[[Continue|Naked]]</tw-passagedata><tw-passagedata pid="16" name="Naked" tags="" position="1075,1000" size="100,100">In an instant, all the wolf feels is... bare.

With an urgent look, $name looks down and realizes that, just like that, without moving an inch from his bound state, he now stands there not only bound, but also completely and entirely &lt;b&gt;naked&lt;/b&gt;.

&quot;What the-?!&quot; the wolf exclaims. In a shameful reflex, his tail tries to curl between his legs to hide his modesty, but even that is hard with his back pressed against the cross he&#39;s bound to.

&quot;There we go. I like the sight,&quot; Ivex comments. The damned panther licks his lips again while his eyes shamelessly move downward.

&lt;&lt;print $name&gt;&gt;&#39;s eyes can&#39;t help but follow. His entire body lays exposed, with the highlight of this indecency being the hefty sheath and low-hanging furry balls between his legs. With his limbs spread as they are, it&#39;s as if he&#39;s showing them off without meaning to. As an adventurer of renown, $name is definitely not used to finding himself in such a humiliating situation, and it shows. The wolf&#39;s ears can&#39;t help but grow hot as they lower themselves despite his best efforts.

&lt;&lt;if $mage&gt;&gt;\

How did Ivex do that, though?! There was no incantation cast, no magic flowing through. Magic can achieve much, but blinking things out of existence just like that? Nero knows damn well that even a teleportation spell would have to be extremely precise to target nothing but his clothes! And done in a heartbeat just like that? Did he use arcane circles? Illusion? No, impossible to use those with just the snap of a finger. The process doesn&#39;t seem to tax Ivex either.

It&#39;s as if... as if reality itself bends to his will.

Is he really that powerful of a mage?\
&lt;&lt;/if&gt;&gt;\
&quot;I like things much better this way,&quot; the depraved panther says. &quot;You are going to tell me everything I want to know one way or another, but I figure we might as well make it fun, right?&quot;

The panther then turns away, thankfully, but to reach into one of the cabinets surrounding them to pull out...

[[Continue|Candle]]</tw-passagedata><tw-passagedata pid="17" name="Candle" tags="" position="1200,1000" size="100,100">&lt;&lt;set $FurtherDefiance = false&gt;&gt;\
...a candle.

It doesn&#39;t look like an ordinary candle, though. Instead of white, it is of a bright red color, and its high craftsmanship shows. The candle is adorned with ridges and ledges across its length. It also glistens, as if it was covered in a thin layer of something shiny all the way to its wick.

Ivex handles it with care, pulling out a candleholder and throwing a smirk towards the bound wolf. After settling the candle down on the desk nearby, the mage then waves his hand over his face, and, out of nowhere again, a piece of cloth appears to cover his mouth and nose. From his eyes alone, $name can see his grin remains, however.

From the tip of Ivex&#39;s finger, a small flame appears.

&quot;This simple candle, my adventuring friend, will be your downfall. Over the years I have refined many methods of torture over my subjects and I have found that the simplest, most base desires are the ones that work best.&quot; The mage&#39;s voice is dripping with a twisted excitement as he says that. No wonder he was deemed so dangerous!

The wolf&#39;s paws curl into fists in its bonds as Ivex&#39;s flame approaches the candle. When it lights up, $name flinches, almost expecting something grand to happen, but... there is nothing. At least there is nothing at first.

With how sensitive the wolf&#39;s nose is, it doesn&#39;t take long for it to pick it up. The candle&#39;s scent hovers around the air and it smells... delightful. A flowery scent that, as it penetrates the wolf&#39;s nose, almost feels somehow... spicy?

Noticing how Ivex adjusts the cloth over his nose, however, $name quickly realizes the truth. The mage is trying not to breathe it, which means...

$name quickly holds his breath, but Ivex just laughs at that.

&quot;Adorable. You can try to hold on to your breath, but eventually, you will breathe it in. Then, slowly but surely...&quot;

The panther approaches again.

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
    &lt;li&gt;[[&quot;Whatever you&#39;re trying to do, it won&#39;t work!&quot; Keep holding his breath in defiance.|Hold Breath Defiantly]]&lt;/li&gt;
    &lt;li&gt;[[He has a point. Breathe out and at least give him a warning growl.|Growl Defiantly]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;</tw-passagedata><tw-passagedata pid="18" name="Hold Breath Defiantly" tags="" position="1325,1000" size="100,100">$name keeps holding his breath, but it becomes harder to do so as Ivex steps towards him again. The feeling of vulnerability towards the panther grows tenfold when he is within the range of touch. Bound to the cross in a spread position, holding his breath and now completely naked, it feels even worse than before.

&quot;You really are something else,&quot; the panther chuckles, &quot;thinking you can defy me. Most of them are regretting their actions and begging me to let them go at this point...&quot;

The panther&#39;s hand returns to &lt;&lt;print $name&gt;&gt;&#39;s chest. This time, without the protection of clothing, the panther&#39;s paw gets to feel the wolf&#39;s bare fur.

&lt;&lt;if $warrior&gt;&gt;\
That hand caresses Drekkar&#39;s powerful chest. Ivex clearly has a fascination for muscles, for the panther seems to take special delight in feeling the hardness of the wolf&#39;s pectorals, then pushing against his defined abdomen. It is hard to growl while holding his breath, but Drekkar sure as hell tries, resulting in a low rumble coming from his throat.

As always, it has no effect on the cocky mage. Bastard!
&lt;&lt;/if&gt;&gt;\

That hand, however, slowly trails down. The bound wolf tenses up and frowns with his breath still held when the mage&#39;s hand nonchalantly reaches between his legs. Ivex has no reservations about trailing his fingers over the wolf&#39;s bare sheath. With a low growl, $name tries to pull against his bonds, shifting his hips to the side to avoid the mage&#39;s touch, but the panther&#39;s fingers easily follow.

&quot;Your defiance is beyond useless,&quot; the panther says as his hand trails even lower to the wolf&#39;s balls. He closes his hand around them, holding them in a soft grip, and looks up at the wolf.

Ivex gives a single order. &quot;Breathe.&quot; 

It &lt;i&gt;is&lt;/i&gt; becoming very hard for the wolf to keep holding his breath... Ivex locks eyes with the wolf, his expression neutral and unconcerned, but his grip on the wolf&#39;s balls remains. \
&lt;&lt;if $rough_awakening&gt;&gt;\
The all too recent memory of the sadistic mage squeezing the wolf&#39;s balls earlier returns. $name recognizes the threat in Ivex&#39;s eyes as a promised consequence for not obeying. The wolf&#39;s body stiffens, his subconscious preparing for the possible pain in his most sensitive parts and a drive to do anything so that his balls stay safe, bubbles up.
&lt;&lt;/if&gt;&gt;\

&lt;&lt;if $rough_awakening &amp;&amp; $warrior&gt;&gt;\
Drekkar has years of training enduring pain, though. The thought of having his precious balls crushed makes even the powerful wolf warrior&#39;s tail curl a little, but the thought of giving in to that slimy fucking mage? That also twists the wolf&#39;s stomach.
\
&lt;&lt;/if&gt;&gt;\

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
      &lt;&lt;if $rough_awakening == false || ($rough_awakening == true &amp;&amp; $warrior == true)&gt;&gt;\
    &lt;li&gt;[[Defy Ivex and keep holding his breath.|Further Defiance]]&lt;/li&gt;
&lt;&lt;/if&gt;&gt;\
    &lt;li&gt;[[There is no choice. Breathe out and at least give him a warning growl.|Growl Defiantly]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;</tw-passagedata><tw-passagedata pid="19" name="Growl Defiantly" tags="" position="1325,1125" size="100,100">&quot;You look cute when you growl. The last defiant adventurer I had was a lion. He couldn&#39;t growl like you, but he sure as hell could roar. Oh, how he roared when he was in your place breathing in what you&#39;re breathing...&quot;

Ivex lets out a small laugh. The candle continues to burn off to the side and the spicy smell seems stronger than before. &lt;&lt;print $name&gt;&gt;&#39;s canine nose can detect even the subtleties of the smell and, indeed, it smells like nothing he has ever felt before.

&quot;Are you feeling it yet? It takes a little while to start working, but once it does... It grows stronger and stronger, and before you know it...&quot; The panther looks up at the wolf and grins. &quot;You know what? Why spoil the surprise, right?&quot;

The panther&#39;s hand dares explore and toy around the wolf&#39;s vulnerable sheath. All $name can do is helplessly pull against the bonds keeping his wrists bound.

&quot;Don&#39;t touch me!&quot; the wolf growls, but of course, it is to no avail.

Ivex touches the bound lupine anyway. The panther&#39;s fingers seem to take delight in exploring the surface of the wolf&#39;s furry sheath. His fingers trail over its surface, then much to the wolf&#39;s dismay, pull it back ever so slightly before prying inside. The wolf&#39;s dormant member feels the caress of the panther&#39;s more than invasive touch, and for some reason...

It stirs. Something inside the wolf starts... heating up. It starts with his nose. It feels as if he&#39;s breathing pepper, for a warmth- no, a &lt;b&gt;heat&lt;/b&gt; envelops his nose and, slowly but surely, starts spreading through his body. It radiates from his chest, from his stomach, and it is very much felt between his legs as well.

With Ivex teasing his sheath, it does not take very long for the wolf&#39;s member to start peaking. The panther takes absolute delight in that, pulling the helpless wolf&#39;s sheath back further to reveal more of it and tease its sensitive surface.

The heat seems to grow worse by the second. As much as he tries to deny it, &lt;&lt;print $name&gt;&gt;&#39;s cock starts rising to the occasion, growing hard. Soon the wolf is at half-mast to the panther&#39;s relentless teasing.

&quot;There we go,&quot; Ivex coos, &quot;you have no idea what I&#39;m going to put you through, wolf. When we&#39;re done, you will be begging-&quot;

The panther&#39;s words cease suddenly when Ivex turns his head back in a sudden movement. He stares towards the office&#39;s door for a moment as if seeing something unexpected, but upon following his gaze, $name sees nothing.

[[Continue|Alarm]]</tw-passagedata><tw-passagedata pid="20" name="Further Defiance" tags="" position="1450,1000" size="100,100">The seconds go by and $name makes every effort to keep holding his breath. Eyes locked, the panther seems to take notice of the active defiance. It is with much satisfaction that the wolf can see his smile fading, even if just a little, in annoyance. The thought of irritating the cocky mage is enough to bring the bound wolf some pleasure in this terrible situation.

Unfortunately, that pleasure soon becomes radiating, blinding pain. In a swift move, the panther&#39;s hand holding the wolf&#39;s balls closes in a tight grip. The wolf&#39;s sensitive nuts get squeezed inside the panther&#39;s relentless paw.

$name can no longer avoid it. With a gasp, what little air he still held is let out and the wolf is forced to breathe in a lungful of the spicy candle&#39;s air, if only to let out a silent gasp of pure agony.

Ivex&#39;s smile returns, but it is seen through the tearing up of the bound wolf&#39;s eyes as the grip on his balls does not soften even when the wolf grits his teeth and lets out sharp breaths to endure the pain. $name tries really hard to not put out a shameful display of submission, by holding out from whimpering, but the act of doing so takes a large toll on the wolf. Fuck breathing. It takes every effort of his being to endure the pain emanating from his crushed balls.

After what feels like an eternity, Ivex finally loses his grip. He does so little by little, clearly delighted in the reaction he brought, and even after he finally lets go of the wolf&#39;s bruised nuts entirely, the mage still gives them a final painful flicker with his fingers that hurts enough to make the wolf flinch again.

&quot;See how useless it is to defy me?&quot;

Blinking the tears away from his eyes, the wolf can do little more than growl. $name realizes, however, that he was left panting after the painful experience. The wolf works hard to stabilize and minimize his breathing, but how much of the mysterious candle&#39;s influence has he already taken in?
\
&lt;&lt;set $FurtherDefiance = true&gt;&gt;\

Ivex&#39;s hand returns to the wolf&#39;s thigh. The invasive touch makes the wolf grow stiff again.

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
    &lt;li&gt;[[Give him a weak warning growl...|Growl Defiantly]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;</tw-passagedata><tw-passagedata pid="21" name="Alarm" tags="" position="1325,1250" size="100,100">Thankfully, the panther then lets go of the wolf entirely. Before turning towards the door, $name can see that Ivex is frowning.

&quot;How unfortunate,&quot; the mage finally says. &quot;An interruption. Right when things were about to get interesting! What a busy day...&quot;

Despite everything, Ivex does not seem worried in the least. He glances back towards the naked, bound wolf and then his eyes trail down to the wolf&#39;s member. As much as $name tries to will it down, his erection still stands there between his legs as a shameful display.

&quot;It looks like I have no choice but to continue this after I am done dealing with the new guest.&quot; Ivex looks at the candle, then at the wolf.

&quot;Perhaps that is for the best. It might be a little while, but by the time I return, you will be more than ready for our fun. It will be interesting to see...&quot; The mage thinks for a second, then chuckles to himself. &quot;Yes, this might indeed be good. It will be fun.&quot;

The panther then pulls out a red gemstone from within his cloak. It looks oddly familiar to the wolf, but he can&#39;t remember where he could have seen one like that before. 

Ivex then raises it up in the air and whispers a word the wolf can&#39;t quite make out.

Then, poof. In the blink of an eye, the mage disappears, leaving $name alone. Bound, naked, erect and alone.

[[Continue|Alone]]</tw-passagedata><tw-passagedata pid="22" name="Alone" tags="" position="1200,1250" size="100,100">With the panther mage gone, all that remains is silence. The wolf finds himself alone in the office and bound at its center like some sort of depraved display. Looking down at himself, &lt;&lt;print $name&gt;&gt;&#39;s ears fold back a little.

Jutting from his sheath, his erection stands at full mast now. It even throbs in the air every now and then. The canine-shaped, tapered member practically glows in its bright red, veiny shape. Even the wolf&#39;s sheath starts to bulge a little as his knot threatens to start growing as well.

$name grits his teeth. Ivex is no longer there to forcefully stimulate him. Then, why does he feel even more aroused than before? As the wolf takes in another breath while pondering, the answer to that question becomes more obvious.

The smell. &lt;&lt;print $name&gt;&gt;&#39;s eyes shift towards the candle still burning off to the side. That smell, the spiciness of it... its heat that radiates from his nose... When the wolf focuses, he can feel it inside his body. The heat feels like a flame that is slowly being fed more wood, and its source...

The wolf&#39;s member throbs again in the air.

Somehow, the knowledge that that candle is somehow fostering his arousal makes it worse. A bead of pre-cum shows at the tip of the wolf&#39;s member and, with each passing minute, his arousal grows. Looking down at it, an urge to touch it, to feel something, to &lt;b&gt;fuck&lt;/b&gt; something starts growing in him, but $name shakes his head to shrug it off.

The bound wolf realizes that he&#39;s able to suppress this for now, but if he stays there, bound where he is and breathing in the candle&#39;s scent, who knows what&#39;ll happen to him? Ivex&#39;s words were cryptic, but they hinted at an outcome the lupine did not wish for.

He has to find a way to escape. Ivex being gone gives him his best chance! But... how? And can it even be done before the candle&#39;s influence becomes too much?

[[Continue|The Candle]]</tw-passagedata><tw-passagedata pid="23" name="The Candle" tags="" position="1075,1250" size="100,100">Bound and alone in the room without Ivex&#39;s cocky blabbering as a distraction, $name can feel the effects of the candle more sharply.

It burns there on the corner, innocently, yet the magically-enhanced scent that the candle produces, fills the air with, grows stronger by the minute. Every breath the wolf takes is filled with that strong scent. It heats up the canine&#39;s sensitive nose and, more than that, it heats up his very core.

As $name looks down, his ears fold back in shame. While his arousal was sparked by Ivex, it keeps getting continuously kindled by whatever is in that candle. The wolf&#39;s member stands fully hard now, protruding from his sheath and pointing upwards.

While his arousal is a physical display of how the candle affects the wolf, however, even more worrying than that is the effect the candle has on the wolf&#39;s mind. $name can feel it influencing him. Looking down at his own arousal is almost painful. The urge to touch it seems to grow stronger by the second. Though escaping is the forefront, most important matter in his mind, thoughts of lust start seeping in little by little. A need to feel pleasure, a need to &lt;i&gt;fuck&lt;/i&gt; something.

It&#39;s enough to bring a low growl of sheer lust from the wolf for a moment. As he stares down at his own erection, he almost loses himself for a moment there, focusing on the idle pleasure radiating from his sheer arousal.

But no!

$name shakes his head and growls at himself. He has to escape. It&#39;s his chance! It might be his only chance. He needs to escape...

The wolf turns his eyes towards the burning candle. So close yet so far.

He needs to escape... before the crazed mage returns and before that thing&#39;s magic overcomes him.

[[Continue|Escape Options]]</tw-passagedata><tw-passagedata pid="24" name="Escape Options" tags="restart" position="525,1625" size="100,100">&lt;&lt;silently&gt;&gt;
&lt;&lt;set $CurArousal = 10&gt;&gt;
&lt;&lt;set $observation1 = false&gt;&gt;
&lt;&lt;set $struggle1 = false&gt;&gt;
&lt;&lt;set $baseCrystal = false&gt;&gt;
&lt;&lt;set $thoughtsGathered = false&gt;&gt;
&lt;&lt;set $escapeActions = false&gt;&gt;
&lt;&lt;if $FurtherDefiance&gt;&gt;
  &lt;&lt;set $CurArousal += 10&gt;&gt;\
&lt;&lt;/if&gt;&gt;
&lt;&lt;set $CurArousal += 10&gt;&gt;
&lt;&lt;set $bound = true&gt;&gt;
&lt;&lt;set $candle = true&gt;&gt;
&lt;&lt;/silently&gt;&gt;
Candle&#39;s Influence: &lt;&lt;arousalbar $CurArousal $MaxArousal&gt;&gt;

&lt;&lt;timed 3s t8n&gt;&gt;\
The candle burns silently at the corner.

&lt;&lt;addclass &quot;#horizontalhealthbar&quot; &quot;pulsingbar&quot;&gt;&gt;\
&lt;&lt;next 3s&gt;&gt;\
If its influence grows too high...

&lt;&lt;next 3s&gt;&gt;\
&lt;hr&gt;

With a sense of urgency, the wolf&#39;s eyes scan around the room trying to find a way to escape his bondage. The leather wraps keeping the lupine standing in the middle of the room with his back pressed against the wooden cross are solid, but there must be something he can do to escape! At least that&#39;s what $name tells himself.

Taking better note of the office, the wolf realizes that, if it weren&#39;t for the bondage contraption he is bound to at its center, it would be a fairly regular, even if somewhat fancy, office room. There&#39;s a desk, books, quills, cabinets... A letter opener that looks pretty sharp rests on the main desk. It looks like it could be used to cut the leather bindings, but it is completely out of reach.

There &lt;i&gt;must&lt;/i&gt; be something he can do!

Looking down, a small wave of redness comes over the wolf&#39;s ears and face. His cock remains there, hard and twitching. Even looking at it again is kind of painful. Never before had $name felt such an undeniable urge to just reach down, wrap his paw around it and start stroking.

How good would it feel, to just...

&lt;i&gt;NO!&lt;/i&gt;

A way out. There must be a way out! There isn&#39;t much choice left, but to...

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
    &lt;li&gt;[[Keep looking around the room for a solution.|Observation 1]]&lt;/li&gt;
    &lt;li&gt;[[Try and pull at the leather bindings with vigor!|Struggle 1]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;
&lt;&lt;/timed&gt;&gt;\</tw-passagedata><tw-passagedata pid="25" name="Observation 1" tags="" position="450,1775" size="100,100">As his eyes scan the room for the tenth time, the wolf&#39;s ears drop low. His hope starts to wane, but as his vision sweeps over the left side with care, something catches his eye.

It&#39;s a mirror. A small, handheld mirror resting on its side casually against \
&lt;&lt;if $mage&gt;&gt;\
a snow \
&lt;&lt;else&gt;&gt;\
an arcane \
&lt;&lt;/if&gt;&gt;\
globe. While looking at it, the wolf can see his own reflection, but by craning his neck forward and changing the angle...

Something interesting can be seen. From that angle, $name can see the backside of the cross he&#39;s bound to. The wooden contraption stands there in the middle of the office room and, being out of place, the wolf realizes that it&#39;s not actually built in there. $name can clearly see &lt;span class=&quot;imp-info&quot;&gt;five crystals&lt;/span&gt; floating behind the cross. One larger floats at the center of the large cross right behind his back, while four others float by the edges to which his limbs are tied to. 

The cross is not attached to anything, so the crystals must somehow be what is keeping it firm and solid.

The crystals are, of course, completely unreachable to the naked wolf bound to the cross as he is, but knowing how this thing works could be useful in order to find a way to break it.
&lt;&lt;set $observation1 = true&gt;&gt;\

&lt;&lt;if $escapeActions&gt;&gt;\
&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
    &lt;li&gt;[[Reevaluate his options.|Escape Actions]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;
&lt;&lt;else&gt;&gt;\
[[Continue|Escape Actions]]
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="26" name="Struggle 1" tags="" position="600,1775" size="100,100">$name growls in frustration and tries, with more vehemence, to pull against the bindings with brute strength.

Grunting with effort, the wolf puts all of his physical prowess behind the act. It takes quite a bunch of pulling and tugging, but while the leather bands wrapped around his wrists and ankles are as unyielding as the wood the cross is made of, the wolf does notice something.

When focusing his efforts on one of his arms, the bindings don&#39;t yield, but the cross itself seems to &lt;span class=&quot;imp-info&quot;&gt;displace&lt;/span&gt; a little, even if it&#39;s not much. Pulling with his arm using a lot of effort, the wolf notices that the part of the cross holding that arm seems to lean forward a little bit while, on the opposite side of the cross at his leg, it leans back.

This wouldn&#39;t be possible if the cross was nailed to a wooden structure as it usually is. Pulling again with renewed grunts, the wolf confirms that theory. With enough effort, he seems to be able to dislocate the cross little by little.

As soon as he stops pulling, however, it is quickly pulled back to its place.

It&#39;s as if the cross is kept firm and upright by some kind of &lt;span class=&quot;imp-info&quot;&gt;gravitational force&lt;/span&gt;?

Panting, $name takes some solace in learning something new. It is still unclear how that could possibly help in his escape,  but knowing how this thing works could be useful in order to find a way to break it.

Unfortunately, all the physical effort also served to quicken the wolf&#39;s breathing. Realizing that, $name does his best to steady it again, but when he looks down at his member... his ears lower themselves, as it is clear that the damage has already been done.
&lt;&lt;set $CurArousal += 5&gt;&gt;\
&lt;&lt;set $struggle1 = true&gt;&gt;\

&lt;&lt;if $escapeActions&gt;&gt;\
&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
    &lt;li&gt;[[Reevaluate his options.|Escape Actions]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;
&lt;&lt;else&gt;&gt;\
[[Continue|Escape Actions]]
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="27" name="Escape Actions" tags="" position="475,1925" size="200,200">&lt;&lt;nobr&gt;&gt;
  &lt;&lt;set $escapeActions = true&gt;&gt;
  &lt;&lt;if $CurArousal &gt; 90 &amp;&amp; $CurArousal &lt; 100&gt;&gt;
    &lt;&lt;set $CurArousal += 4&gt;&gt;
  &lt;&lt;else&gt;&gt;
    &lt;&lt;set $CurArousal += 9&gt;&gt;
  &lt;&lt;/if&gt;&gt;
  &lt;&lt;if $CurArousal &gt;= 100&gt;&gt;
    &lt;&lt;goto &quot;Arousal Overwhelmed&quot;&gt;&gt;
  &lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
Candle&#39;s Influence: &lt;&lt;arousalbar $CurArousal $MaxArousal&gt;&gt;

&lt;&lt;timed $candleTimer t8n&gt;&gt;\
The candle still burns silently at the corner.

&lt;hr&gt;

&lt;&lt;next $candleTimer&gt;&gt;\
&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $CurArousal &lt;= 30&gt;&gt;\
The wolf&#39;s forced arousal feels... &lt;span style=&quot;color:#46bb26&quot;&gt;distracting&lt;/span&gt;.
&lt;br&gt;&lt;br&gt;
&lt;&lt;include &quot;Arousal Level 1&quot;&gt;&gt; &lt;!-- [[Arousal Level 1]] --&gt;

&lt;&lt;elseif $CurArousal &gt; 30 &amp;&amp; $CurArousal &lt;= 50&gt;&gt;
The wolf&#39;s forced arousal feels... &lt;span style=&quot;color:#e7d778&quot;&gt;gripping&lt;/span&gt;.
&lt;br&gt;&lt;br&gt;
&lt;&lt;include &quot;Arousal Level 2&quot;&gt;&gt;

&lt;&lt;elseif $CurArousal &gt; 50 &amp;&amp; $CurArousal &lt;= 70&gt;&gt;
The wolf&#39;s forced arousal feels... &lt;span style=&quot;color:#bb5e39&quot;&gt;powerful&lt;/span&gt;.
&lt;br&gt;&lt;br&gt;
&lt;&lt;include &quot;Arousal Level 3&quot;&gt;&gt;

&lt;&lt;elseif $CurArousal &gt; 70 &amp;&amp; $CurArousal &lt;= 90&gt;&gt;
&lt;&lt;addclass &quot;#horizontalhealthbar&quot; &quot;pulsingbar&quot;&gt;&gt;
The wolf&#39;s forced arousal feels... &lt;span style=&quot;color:#bf5150&quot;&gt;overpowering&lt;/span&gt;.
&lt;br&gt;&lt;br&gt;
&lt;&lt;include &quot;Arousal Level 4&quot;&gt;&gt;

&lt;&lt;elseif $CurArousal &gt; 90&gt;&gt;\
&lt;&lt;addclass &quot;#horizontalhealthbar&quot; &quot;pulsingbar&quot;&gt;&gt;
The wolf&#39;s forced arousal feels... &lt;span style=&quot;color:#e92940&quot;&gt;overwhelming&lt;/span&gt;.
&lt;br&gt;&lt;br&gt;
&lt;&lt;include &quot;Arousal Level 5&quot;&gt;&gt;

&lt;&lt;/if&gt;&gt;\
&lt;&lt;/nobr&gt;&gt;

Time is of the essence. With each passing minute, trying to find a way out, the wolf can feel the candle&#39;s influence growing on him...

There must be a way to get out of his bonds, but how?

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
    &lt;&lt;if $observation1&gt;&gt;\
      &lt;li&gt;[[Look around the room for a solution once more...|Observation 2]]&lt;/li&gt;
    &lt;&lt;else&gt;&gt;\
      &lt;li&gt;[[Look around the room for a solution.|Observation 1]]&lt;/li&gt;
    &lt;&lt;/if&gt;&gt;\
    &lt;&lt;if $struggle1&gt;&gt;\
      &lt;li&gt;[[Try harder to wear down the bindings with strength and effort!|Struggle 2]]&lt;/li&gt;
    &lt;&lt;else&gt;&gt;\
      &lt;li&gt;[[Try and pull at the leather bindings with vigor!|Struggle 1]]&lt;/li&gt;
    &lt;&lt;/if&gt;&gt;\
    or...
    &lt;li&gt;[[Take a moment to gather his thoughts about everything learned so far...|Gather Thoughts]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;
&lt;&lt;/timed&gt;&gt;</tw-passagedata><tw-passagedata pid="28" name="Arousal Level 1" tags="" position="725,1925" size="100,100">Avoiding taking deep breaths, $name just tries his best not to think about the constant distraction throbbing between his legs. He can seldom help glancing down towards it, though. It&#39;s always within his field of vision and trying to jump to the front of his mind.

The wolf&#39;s cock. It stands there, fully aroused. His knot has inflated some, although not completely, and having it still trapped inside his sheath brings the wolf some discomfort, but he tries not to think about that either.

Small jolts of pleasure keep coming from his cock, though. Every time he breathes in, the warmth spreads towards him, and his cock flexes with life by itself. Never before had $name felt so exposed, so at mercy of his own instincts, and yet...

The bead of pre-cum lingering at the very tip of his firm arousal glistens as a constant threat of how those very instincts might betray him.</tw-passagedata><tw-passagedata pid="29" name="Arousal Level 2" tags="" position="825,1925" size="100,100">It&#39;s getting harder and harder to resist. After breathing so much of the candle&#39;s foul air, the heat coursing inside the wolf now feels constant. His fur feels too warm and an urge to pant, to let his tongue loll out is always there, but he resists it to avoid breathing even more of the cursed affliction.

The wolf&#39;s cock reflects his increased state of arousal. It stands rock hard, as erect as the wolf ever remembers feeling it, and the small veins on its bright red surface bulge ever so slightly as well from how incredibly aroused he feels. It throbs more often than before, pulsing alongside the wolf&#39;s quickened heartbeat while, at the same time, serving as a beacon that promises unending pleasure to the wolf&#39;s affected mind. The urge to touch it, to feel his fingers trailing over that sensitive surface, is crushing.

The lupine&#39;s knot bulges his sheath in a very uncomfortable way being pretty much fully grown. From its very tip, a tendril of pre-cum lingers. Another droplet soon comes, then slowly falls down to the floor below his bound self. It&#39;s constant now. Every instinct the wolf has is slowly turning towards one thing and one thing alone: sex.</tw-passagedata><tw-passagedata pid="30" name="Arousal Level 3" tags="" position="925,1925" size="100,100">Panting becomes inevitable. Every breath is like a new log thrown into a bonfire of arousal burning within the wolf. It&#39;s getting harder and harder to think, to keep his eyes away from his cock. It stands there, proud, pulsing. Pleasure without end promised, if he could just touch it...!

The wolf&#39;s cock throbs constantly now. Its surface glistens against the candlelight, the wolf&#39;s length covered in his own pre-cum that now keeps oozing from his tip without pause. Some of it runs down his length and brings involuntary groans from the wolf, some of it drips down to the ground below. His knot has grown as big as it can get outside of a tie and, much to both the wolf&#39;s relief and dismay, it has managed to push his sheath back. The bulb of sensitive flesh, thick and large, pulses alongside the whole of the wolf&#39;s length just begging to be touched. To be shoved into something. Something tight, something that would-

With a shake of his head, $name tries his best to keep his focus away from his cock. It&#39;s incredibly hard to do so. Every odd thought in his head goes back to memories of him in his privacy with his paw around his member. Moving it up and down, stroking it, squeezing his knot, reaching the high of-

It takes a growl to break himself off of it. With increased urgency, $name realizes he has to find a way out soon, or else he will for sure be doomed, just as Ivex said.</tw-passagedata><tw-passagedata pid="31" name="Arousal Level 4" tags="" position="725,2025" size="100,100">Every breath is fire. $name can feel his eyes tearing up, but is it from the way his whole body burns up, or out of sheer frustration due to being unable to sate his lust?

This is the cruelest of tortures. The wolf&#39;s breathing is quick and short and, even as he actively tries to slow it down, it&#39;s impossible now. His blood feels hot, his heart races and, most of all... his cock.

It radiates pleasure without ceasing. Looking at it brings small tears to the wolf&#39;s eyes. His arms tug against the restraints constantly. An urge- no, a &lt;i&gt;need&lt;/i&gt; to reach down to it overcomes the bound wolf. Pleasure. Pleasure. He needs pleasure!

It feels impossible, but for the wolf, he swears he can feel it. It&#39;s not quite the feeling of touch, no, that still remains his sole need in life at the moment, but as his cock pulses there in the air, harder than it has ever been in his life, the wolf can swear he can feel &lt;i&gt;something&lt;/i&gt; brushing against it. It&#39;s soft, almost non-existent, but each time his cock flexes in sheer arousal, it&#39;s as if a feather-like brush passes through his length. Down to the very tip to the knot. It teases him, furthering his impossible arousal even further.

It&#39;s maddening! With bated breath, $name shakes his head and grits his teeth together trying his hardest to keep his focus away from his cock.</tw-passagedata><tw-passagedata pid="32" name="Arousal Overwhelmed" tags="end" position="925,2025" size="100,100">&lt;&lt;set $CurArousal = 110&gt;&gt;\
Candle&#39;s Influence: &lt;&lt;arousalbar $CurArousal $MaxArousal&gt;&gt;
&lt;&lt;done&gt;&gt;
  &lt;&lt;addclass &quot;#horizontalhealthbar&quot; &quot;pulsingbar&quot;&gt;&gt;
&lt;&lt;/done&gt;&gt;

&lt;&lt;timed 2s t8n&gt;&gt;\
It&#39;s too much.
&lt;&lt;next 2s&gt;&gt;\

With bloodshot eyes and drool running free down the corners of his muzzle, the wolf is more akin to a feral animal than a sentient being. His gaze is locked downwards at his cock where he can swear he can see hands. Multiple hands, tongues, real or spectral, stroking, licking, caressing his cock. Driving him to the edge of madness from sheer arousal. His cock pulses constantly, spurts of pre-cum both dribbling and launching from his throbbing malehood.

The wolf&#39;s heart races as if it would burst out of his chest. His whole body burns with a need unlike anything he has ever felt. His arms feel sore and, for a brief moment, $name realizes he has been pulling against the restraints without even noticing, in sheer need to reach down to his cock. 

He needs it. There is nothing else in his mind but arousal, sex, and the urges that come with it. With the candle still silently burning at the corner, time becomes irrelevant to the wolf. The seconds stretch into minutes, which could or not have become hours. He has no idea how much time passes. Each moment is agony, his arousal burning so bright that he feels like he could cum if so much as a breeze blew over his aching length, but no such thing happens. There is nothing but maddening stillness while he remains there: bound, teased, and desperate.

Eventually, much to the wolf&#39;s surprise, a sound comes before him. It&#39;s hard to even lift his gaze up from his cock to look, but when the wolf manages it, he sees Ivex&#39;s form there. The mage is back and done with his duties. The wolf&#39;s chances of escaping are now gone.

Still, $name doesn&#39;t care. He growls at the mage and desperately tugs at his bonds with a whine of pure need. The panther, however, just smiles...

&quot;Ah, I see my enchantment worked as expected,&quot; the panther says while bringing his cloak up to his nose to protect himself from it once more. 

Slowly, far too slowly, the panther steps towards the bound wolf. His smile only widens. The mage stops a step away from the wolf&#39;s fully hard, engorged cock.

Time slows down as the wolf sees the mage bringing his paw up. Ivex trails a single digit over the surface of the wolf&#39;s cock.

&quot;HNNNGHH!&quot; 

The simple, light touch is enough to bring a moan out of the wolf. His cock feels more sensitive than ever. His whole body does! Impossibly so.

With a laugh, Ivex withdraws his hand.

&quot;There we go. Silly wolf. I&#39;ve got you exactly where I wanted. Now... where were we?&quot;


&lt;span class=&quot;bad-ending&quot;&gt;Bad Ending: &lt;i&gt;Interrogation&lt;/i&gt;&lt;/span&gt;

[[Continue|Ivex Torture 1]]
&lt;&lt;/timed&gt;&gt;</tw-passagedata><tw-passagedata pid="33" name="Arousal Level 5" tags="" position="825,2025" size="100,100">&quot;FUCK!&quot; $name yells in a growl. It&#39;s hard to even shift his eyes away from his cock. Small veins bulge from its side as the canine-shaped length almost glows as it throbs there in the air. Untouched. No stimulation, even though the wolf needs it. He NEEDS IT!

Drool runs down the sides of &lt;&lt;print $name&gt;&gt;&#39;s muzzle, but he does not care. It doesn&#39;t matter. Nothing matters, only the constant waves of arousal his burning body feels. It radiates from his loins, from his cock, from his fucking knot, and he needs to touch it! He needs it!

The thoughts of sex are constant now. Memories, fantasies, all meshed together in his head in a whirlpool leading to the pleasure that feels absolutely unreachable because of those gods-damned bonds! With a roar of anger and frustration, $name pulls at all the bonds yet again, but it&#39;s hopeless. He can&#39;t reach his cock. He can&#39;t feel the pleasure he needs...

Those phantom feelings intensify. It feels as if an invisible force is stroking his length constantly now. Up and down, from the tip to the knot... Stroking... Stroking... The wolf swears he can almost see a hand. He pictures a feminine hand working the movements, making the feather-like feelings of pleasure feel more real, and that thought alone makes his cock flex, and a burst of pre-cum comes from his tip. It&#39;s enough to make $name moan with pleasure, but it&#39;s not enough for what he really needs. It&#39;s not nearly enough! He feels close, though. At the very edge of pleasure, but never going past it, not without touch...!

He &lt;i&gt;needs&lt;/i&gt; to get out. It&#39;s almost impossible to think now. The candle&#39;s fire keeps penetrating his nose, adding to the volcano erupting inside of him and furthering his arousal to impossible levels. Tears of sheer need stream down from the wolf&#39;s eyes and he can feel his mind slipping.

Fighting to stay conscious and absolutely desperate, $name fights to resist, but it&#39;s a battle he&#39;s about to lose.</tw-passagedata><tw-passagedata pid="34" name="Gather Thoughts" tags="" position="450,2200" size="100,100">Exercising patience despite the urgency of his situation, $name takes a moment to reevaluate everything he knows so far, in an attempt to figure out the best way to escape. Before Ivex&#39;s cursed candle overwhelms him, that is.
&lt;&lt;if $CurArousal &lt; 60&gt;&gt;\

Glancing down, the wolf can see his member there, proud and erect, but he quickly looks away. The temptation is strong, but he focuses on escaping.
&lt;&lt;/if&gt;&gt;\
&lt;&lt;if $CurArousal &gt;= 60 &amp;&amp; $CurArousal &lt; 80&gt;&gt;\
It&#39;s very hard to think. Almost impossible. All the wolf can feel is the heat of his body, the jolts of lust coming from his throbbing cock every time it pulses. It&#39;s right there, in front of him, so close yet so far. What he wouldn&#39;t give to touch it...

$name shakes his head. He must try his hardest to resist the cursed candle and focus on escaping, or there will be no hope. There will be time to take care of himself later.
&lt;&lt;/if&gt;&gt;\

Trying to keep his thoughts in place, the wolf thinks back to what he has learned about the room and the cross keeping him bound so far...
&lt;&lt;if $observation1 &amp;&amp; !$baseCrystal&gt;&gt;\

From the small mirror placed at the side, it is possible to see &lt;span class=&quot;imp-info&quot;&gt;crystals hovering behind each limb of the wooden cross&lt;/span&gt;. They float in the air firmly in place, keeping the cross still.

The cross was not built into this office. It was brought here and it stands firm through some magical means.
&lt;&lt;/if&gt;&gt;\
&lt;&lt;if $struggle1 &amp;&amp; !$baseCrystal&gt;&gt;\

When trying to force the bonds, while the leather doesn&#39;t yield, the cross itself kind of does. Applying force on all four limbs at once amounts to nothing, but &lt;span class=&quot;imp-info&quot;&gt;if enough force is applied to a single limb, the wooden cross as a whole leans forward at that limb&lt;/span&gt;, even if it still imposes great resistance against it somehow.

The cross is kept in place by some sort of gravitational force.
&lt;&lt;/if&gt;&gt;\
&lt;&lt;if ($struggle1 &amp;&amp; $observation1) &amp;&amp; !$baseCrystal&gt;&gt;\

Putting everything together...
&lt;&lt;if $CurArousal &gt; 70&gt;&gt;\

...is very hard. Sex is what is prominent in the wolf&#39;s mind. Memories of times spent in taverns, in bed, pressing someone down against the soft mattress while driving his cock deep into them are what keep coming back to the wolf&#39;s mind over and over.

His cock oozes more pre-cum down to the ground. It takes a gargantuan effort to look away and focus on the problem at hand.
&lt;&lt;/if&gt;&gt;\

The cross is kept upright by crystals. Some kind of gravitational force keeps the crystals firmly in place and, at the same time, seems to keep the cross in place. With enough force, however, it&#39;s possible to pull against them just enough to dislodge the cross just a little...

That is how the cross works. Yes! Now, there must be something that can be done to break away the crystals&#39; gravity and dislodge the cross entirely! But what...?
&lt;&lt;/if&gt;&gt;\
&lt;&lt;if $baseCrystal&gt;&gt;\

There are six crystals. One under the cross on the floor, another behind his back, and four others at the cross&#39;s edges behind his limbs. Five of them float in the air and they&#39;re all firmly held in place...

As the wolf pictures it all in his head, it all feels like the crystals are... connected?

&lt;&lt;print $name&gt;&gt;&#39;s ears perk up. If they are connected, then breaking the crystal that starts the connection could break the whole thing! And that would be the crystal on the floor!

Bound as he is, the wolf can&#39;t reach it, but if he pulls and pushes his bindings the right way, $name is pretty sure it might be possible to touch and bash at the crystal at the base with the edges of the cross his legs are bound to! It feels like a long shot, but time is running out. Something must be done...!
&lt;&lt;else&gt;&gt;\

$name grunts in frustration. It&#39;s so hard to think! There must be something the wolf can do! Maybe applying enough force would be enough now that he knows more about the whole thing? Or maybe there&#39;s more to the room and his bondage to make it worth it to study them better and figure them out...
&lt;&lt;set $thoughtsGathered = true&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;if $mage&gt;&gt;\

Crystals... crystals... crystals... They are not exactly Nero&#39;s field of work, but he has studied them before! Gravity crystals...

The wolf mage knows how they work, but how to dislodge them? Their gravitational field is unyielding, yet... Something snaps in the wolf&#39;s head!

They must be attuned to keeping the cross in place, but they can&#39;t float by themselves. The crystal at the back must be what keeps the others in place, but something has to keep the center crystal in place as well! With his heart beating fast, Nero leans back, stretching his neck to look at the mirror again at a lower angle...

Yes! Right there! On the floor beneath the whole thing, the edge of a larger crystal can be seen! It must be what&#39;s holding the entire thing together. If that crystal could somehow be dislodged, surely all the others would fall in disarray!

That can work! Now to manage that before the candle&#39;s influence grows too strong...
&lt;&lt;set $baseCrystal = true&gt;&gt;\
&lt;&lt;/if&gt;&gt;\

&lt;&lt;if $baseCrystal&gt;&gt;\
&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
    &lt;li&gt;[[Attempt to dislodge the crystal at the cross&#39; base.|Dislodge Crystal]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;
&lt;&lt;else&gt;&gt;\
The time gathering his thoughts was valuable, but the breathing never stops and, even keeping it calm and steady, the fire kindled by the candle burns yet a bit brighter...

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
    &lt;li&gt;[[Ponder on what action to take next...|Escape Actions]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="35" name="Observation 2" tags="" position="300,2000" size="100,100">The wolf&#39;s eyes scan the room again. With increasing urgency, $name attempts to focus on each thing and think about how it could possibly help get out of that damned cross.

Most things are useless or, if they would have some use, it does not matter because he cannot reach them. The sharp leather opener at the desk taunts him with its usefulness, but it is completely out of reach with him stuck to that cross.

&lt;&lt;if $thoughtsGathered&gt;&gt;\
Knowing how the crystals work, however, the wolf cranes his neck to the side in order to look at them again. All five crystals hover there firmly in place. Four smaller ones at his limbs, one slightly larger one behind his back at the center. The same thing he had seen before! Yet, by extending his neck just a little further, $name catches a glimpse of something else...

Another crystal! At the very base of the cross, the edge of what seems to be an even &lt;span class=&quot;imp-info&quot;&gt;larger crystal&lt;/span&gt; is barely visible. Bound to the cross as he is, the wolf can&#39;t look down between his legs to see it, but it is there!

...What can he do with that knowledge, however?
&lt;&lt;set $baseCrystal = true&gt;&gt;\
&lt;&lt;else&gt;&gt;\
Using the mirror, the wolf tries to find new angles so that he can see things behind and above him, but there is nothing useful at all. What a waste of time!

And the whole time, he still has to breathe. The fire inside him grows by the minute.
&lt;&lt;/if&gt;&gt;\

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
    &lt;li&gt;[[Reevaluate his options.|Escape Actions]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;</tw-passagedata><tw-passagedata pid="36" name="Struggle 2" tags="" position="600,2200" size="100,100">&lt;&lt;if $warrior &amp;&amp; $CurArousal &gt; 90&gt;&gt;\
It&#39;s too much. Drekkar pants, huffs and drools like a wild beast. Rage swells within him as he stares down at his cock. The arousal, the impossible, infinite arousal he feels fuels his anger. Those bonds... they keep him from reaching what he needs, and he cannot take it anymore.

&quot;Grrrrhhhrrhh...!&quot; 

With a growl, Drekkar&#39;s paws curl into fists and his muscles start bulging once more. He forces all four leather bindings and, as always, they don&#39;t yield, keeping him still.

Still, he needs it. As his eyes remain fixated on his large cock right there, hard, throbbing, with his arousal radiating like a basic need, the wolf&#39;s rage keeps getting fueled by it. He growls, strands of drool falling down to join the puddle of pre-cum on the floor between his legs. Like a savage beast, Drekkar roars again. His whole body strains to its limit, his muscles, a result of years and years of physical training, strain even harder. The wolf needs to touch himself, he needs it, and nothing will stop him. Nothing!

&quot;RRRRRAAAAAAAAARRRRRHHGGGHH!&quot;

With a mighty roar, Drekkar takes his body way past its regular limits, just as the candle has done to his arousal. Finally, the sound of a crack comes... followed by another, and another. His biceps burn from the effort, but it only adds to the burning that his whole body is engulfed in. With a final roar, Drekkar finally feels the cross and leather yielding to his strength, until finally...

&lt;b&gt;&lt;i&gt;CRACK!&lt;/i&gt;&lt;/b&gt;

The cross bends. The thick wood is not enough to hold the warrior&#39;s might as, finally, it bends under his strength. As the cross breaks, the crystals behind it fall down to the floor and, suddenly, Drekkar finds himself stumbling forward. Still enraged, the wolf shakes the remnants of the bonds away from his limbs, tossing the broken cross off to the sides so that he can finally...!

As his paw envelops his cock, the wolf lets out a moan of relief. At that moment, however, a glimpse of lucidity returns to him. Still huffing like a wild beast, Drekkar&#39;s savage eyes jump to the candle burning right there at the side. Its influence continues to grow on him, but pleasure without end is also at his reach. The wolf&#39;s paw squeezes his own cock and he lets out an involuntary moan. His legs tremble with weakness. The wolf wants to fall down on his knees right there and masturbate, fuck everything else! But...

&lt;&lt;set $bound = false&gt;&gt;\
&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
    &lt;li&gt;[[Fight the urges and snuff out the candle first.|Snuff Candle]]&lt;/li&gt;
    &lt;li&gt;[[Choose pleasure. Sate the needs burning within.|Jerk off]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;
&lt;&lt;else&gt;&gt;\
$name won&#39;t have it! Surely, with enough strength applied, the leather and wood are bound to weaken and break eventually! Gritting his teeth, the wolf prepares himself...

His muscles bulge with effort. The room is filled with grunts as the wolf pushes and pulls against all four of the bindings around his limbs. The leather strains hard under the wolf&#39;s strength...

But it does not yield.

By the end of it, $name is left panting again. His nose burns as much as his loins from everything he breathed in during his efforts. By the end of it, there is only his bare chest heaving and his cock throbbing...

But perhaps the leather bindings have weakened some? They can&#39;t last forever! Would it be wise to keep forcing them?

The bound lupine takes a moment to catch his breath and recover his strength.
&lt;&lt;set $CurArousal += 5&gt;&gt;\

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
    &lt;li&gt;[[Reevaluate his options.|Escape Actions]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="37" name="Dislodge Crystal" tags="" position="400,2325" size="100,100">&lt;&lt;set $finalArousal = $curArousal&gt;&gt;\
With a grunt, the wolf starts his desperate attempt to get rid of the crystals holding the cross he&#39;s bound to. Drawing from what he has learned so far, $name pulls with his right arm against the bindings with all of his strength while, at the same time, he &lt;i&gt;pushes&lt;/i&gt; back against the cross with his left leg. With the directed tension, the cross shifts to the side.

The wolf is hit with a small sense of dread as the cross turns. It takes a lot of pulling from his arm to even dislodge it a little, but with a determined growl, he keeps pushing. Again and again, until...

He can feel it!! Touching the back of the cross, a small &#39;clink&#39; as the cross touches the crystal at the right behind it! Swelling with hope, the wolf continues his precise efforts. With strong heaves that feel hot on his nose as he breathes in the candle&#39;s aroma, $name does his best to ignore the way his member aches as he continues to try and try to bash the cross against the crystal.

With each push and pull, the cross moves more. The wood bashes against the crystal until a chipping sound is heard. Gritting his teeth, the wolf continues no matter how much his muscles complain about it. This is it. It&#39;s now or never! With a determined growl, the wolf puts his strength into one powerful pull against his bonds and then...!

&lt;b&gt;&lt;i&gt;CRACK!&lt;/i&gt;&lt;/b&gt;

All of a sudden, the cracking sound makes all the crystals shake and, just like that, in disarray... they fall! Their gravitational influence disappears and, stumbling forward, the wolf finds himself with his feet on the ground!

Albeit still bound to the cross, his tail wags with relief as, with the cross no longer attached to anything, he&#39;s free to move around!

The wolf&#39;s eyes shift to the candle with urgency. It burns there on the desk, its influence threatening to overcome him. Just glancing down at his cock, a need to touch it swells within him.
&lt;&lt;if $CurArousal &gt; 80&gt;&gt;\

With its influence as high as it is and continuing to grow by the second, it&#39;s pretty much the only thing he can focus on, but...
&lt;&lt;/if&gt;&gt;\

At the same time, the letter opener sitting on the desk is well within reach now too. It would only take a few hops to grab it and hopefully cut the leather bindings easily enough to be free.

&lt;&lt;set $bound = true&gt;&gt;\
&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
    &lt;li&gt;[[Rush to the candle to put it out.|Snuff Candle]]&lt;/li&gt;
    &lt;li&gt;[[Rush to the leather opener to cut out the bonds.|Free Himself]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;</tw-passagedata><tw-passagedata pid="38" name="Snuff Candle" tags="" position="400,2500" size="100,100">&lt;&lt;set $candle = false&gt;&gt;\
&lt;&lt;if $bound&gt;&gt;\
With urgency, the wolf awkwardly stumbles and hops towards the candle, even still stuck to the loose cross. Luckily, despite its insane magical properties, the candle itself works just like a normal candle. Leaning over it and blowing at it is enough to snuff out its fire.

The moment it does, a wave of relief washes over the wolf. The next breath he takes no longer has that lingering burn that trails down his nose all the way to his loins. Though the air still clearly lingers heavy with the candle&#39;s remnants, its growing influence will surely stop.

Still, looking down at his member, the damage the candle has done is already there. His arousal still burns with unnatural strength, and his cock remains fully hard and sensitive.

Regardless, the absence of the candle&#39;s growing influence allows the wolf to finally take a deep breath and collect his thoughts despite the arousal. $name can finally think straight again.

His eyes shift to the table. The next step has to be freeing himself from these hellish bonds.

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
    &lt;li&gt;[[Finally cut the bonds away.|Free Himself]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;
&lt;&lt;else&gt;&gt;\
Now free of any restraints, it is but a matter of a few steps and a blow for that hellish candle to get snuffed out.

The moment it does, a wave of relief washes over the wolf. The next breath he takes no longer has that lingering burn that trails down his nose all the way to his loins. Though the air still clearly lingers heavy with the candle&#39;s remnants, its growing influence will surely stop.

Still, looking down at his member, the damage the candle has done is already there. His arousal still burns with unnatural strength and his cock remains fully hard and sensitive.

Regardless, the absence of the candle&#39;s growing influence allows the wolf to finally take a deep breath and collect his thoughts despite the arousal. $name can finally think straight again.

$name catches his hand going towards his cock before it reaches it. It&#39;s so hard to resist just stopping everything and jerking off right now. Still, without the candle&#39;s influence weighing on his mind and driving him towards relentless arousal, $name knows best.

No matter how horny he is, Ivex could return at any moment. The wolf does not even know exactly how to escape this place, but looking around for clues and figuring out a way to get out would be ideal.

Working hard to ignore his arousal, the wolf focuses on what really matters.

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
    &lt;li&gt;[[Start working on escaping this tower...|Escape Start]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="39" name="Jerk off" tags="end" position="800,2200" size="100,100">Fuck it! $name needs it. He needs the pleasure! After that is taken care of, then the wolf can deal with the candle and think about escaping. Only one thing matters now!

With his paw blissfully wrapped around his cock, $name lets himself fall forward to his knees. An involuntary smile comes to his muzzle and he feels himself tearing up from the sheer happiness of being able to sate the lust burning within him. Every breath is fire, and now his paw can fan the fire.

As the wolf&#39;s paw starts moving over his length, as his fingers reach his knot and give it a small squeeze...

$name moans out loud. It is heaven. Never before had the wolf imagined that he could feel such pleasure. Without hesitating, his paw speeds up and he starts jerking off furiously.

It takes but a minute. He pants, his tongue lolling out of his muzzle as he feels his pleasure reaching the sought peak. With a moan that is almost akin to a howl, $name feels the familiar waves of pleasure overcome him as his cock spasms between his fingers.

The wolf&#39;s seed arcs up. He shoots high, jet after jet of cum coming to splash against the floor as the wolf&#39;s body is overcome with pleasure. And the candle...

The candle makes it even better. As he breathes it in during his orgasm, the fire originating from his muzzle enhances his pleasure. It makes it long, drawn-out, almost everlasting as $name cums.

The wolf cannot tell when his orgasm ends. The pleasure becomes more than he can handle. His paw cannot stop, pumping his cock that feels more sensitive after shooting, but is always ready to shoot again. Before long, all $name knows is that a new orgasm is coming and, again, the wolf just smiles and moans as he rides it.

The more he breathes in, the better it feels, and he just keeps going. One orgasm after another, until his cock is spasming with nothing to shoot as his paw keeps stroking it, but the pleasure is still there! The pleasure never ends. It is the best thing he has ever felt in his life. At least, until...

The wolf has no idea how much time has passed, but just as he feels ready to reach another orgasm, the office&#39;s door opens. From it, Ivex emerges and, for a moment, the mage looks surprised to see $name free and kneeling on the floor on a puddle of his own semen. Then, the mage just grins...

&quot;It looks like you found a way to free yourself, but it didn&#39;t matter, did it?&quot;

Even as $name looks up at the panther, his goofy smile barely even fades. The candle&#39;s influence is too strong and his body still burns. All he manages is to slow down his paw just a little bit as he keeps jerking off in front of the mage. He can&#39;t move, he can&#39;t get away, he needs the pleasure!

Then, with but a snap of a finger from Ivex, the crystals around the floor start to float again. They get in position. The cross reforms by itself right behind the wolf and, with a sense of urgency, $name feels worried for just a moment before...

The wolf&#39;s paw is ripped away from his cock. A whine comes from the adventurer as his body is sent flying towards the cross and, in an instant, the leather bindings wrap themselves around his limbs. With a cry of agony, $name finds himself right back where he started...

...But the wolf does not cry because of his predicament. He whines because his paw can no longer reach his cock. The pleasure he perpetually needs is out of reach again.

Ivex approaches him and the mindless wolf can only look up at the panther.

&quot;There we go. Silly wolf. I&#39;ve got you exactly where I wanted. Now... where were we?&quot;


&lt;span class=&quot;bad-ending&quot;&gt;Bad Ending: &lt;i&gt;Interrogation&lt;/i&gt;&lt;/span&gt;

[[Continue|Ivex Torture 1]]</tw-passagedata><tw-passagedata pid="40" name="Ivex Torture 1" tags="" position="1100,2025" size="100,100">&lt;&lt;silently&gt;&gt;
&lt;&lt;set $defiance = 0&gt;&gt;
&lt;&lt;if $rough_awakening&gt;&gt;
  &lt;&lt;set $defiance += 1&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $FurtherDefiance&gt;&gt;
  &lt;&lt;set $defiance += 1&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/silently&gt;&gt;
&lt;&lt;include &quot;Ivex Torture 1 (Text)&quot;&gt;&gt;

[[Continue|Ivex Torture 2]]</tw-passagedata><tw-passagedata pid="41" name="Free Himself" tags="" position="600,2375" size="100,100">Stumbling awkwardly with the cross&#39; weight upon his back and still stuck in a spread-eagle position, the wolf hops and steps towards the desk on the side. Turning to the side and leaning in, it still takes some effort for him to be able to take hold of the letter opener with his hand, but he succeeds.

With it in hand, it&#39;s only a matter of awkwardly cutting the leather binding without harming himself in the process. It does not take too long and, with one hand free, cutting the others is a breeze.

Stepping forward, $name lets the damned cross fall back to the floor. Finally free to move his muscles properly, $name can&#39;t help but look down at his cock. Hard, begging for attention, tantalizing...

&lt;&lt;if $candle &amp;&amp; ($CurArousal &gt; 85)&gt;&gt;\
With his arousal as high as it is, it&#39;s impossible to resist. $name wraps his paw around it and the moment he does? The wolf lets out a moan of pure bliss. His nose still feels hot as he breathes the candle&#39;s effect, but that only serves to further the pleasure brought from the touch on his cock. 

A smile opens in the corner of the wolf&#39;s muzzle.

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
    &lt;li&gt;[[It&#39;s too late. It&#39;s impossible to resist. Start jerking off.|Jerk off]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;
&lt;&lt;elseif $candle&gt;&gt;\
$name catches his hand going towards his cock before it reaches it. It&#39;s so hard to resist just stopping everything and jerking off right now. The wolf&#39;s eyes trail towards the candle still burning there. Every breath still brings that hot feeling through his nose, and breathing it furthers his arousal more and more. It is wrong, but it also feels so good...

Snuffing out the candle is the safest thing to do, but looking down at his cock, the wolf&#39;s paw is held an inch away from it. It would feel so good to just jerk off under the influence of it. Just take the pleasure, one time, and then escape... probably...

The wolf&#39;s mind is torn with indecision.

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
    &lt;li&gt;[[It&#39;s too hard to resist. Start jerking off.|Jerk off]]&lt;/li&gt;
    &lt;li&gt;[[Don&#39;t yield! Go to the candle and snuff it out.|Snuff Candle]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;
&lt;&lt;else&gt;&gt;\
$name catches his hand going towards his cock before it reaches it. It&#39;s so hard to resist just stopping everything and jerking off right now. Still, without the candle&#39;s influence weighing on his mind and driving him towards relentless arousal, $name knows best.

No matter how horny he is, Ivex could return at any moment. The wolf does not even know exactly how to escape this place, but looking around for clues and figuring out a way to get out would be ideal.

Working hard to ignore his arousal, the wolf focuses on what really matters.

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
    &lt;&lt;if ($CurArousal &gt; 80)&gt;&gt;\
      &lt;li&gt;[[It&#39;s really hard to resist. Start jerking off.|Jerk off]]&lt;/li&gt;
    &lt;&lt;/if&gt;&gt;\
    &lt;li&gt;[[Start working on escaping this tower...|Escape Start]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="42" name="Escape Start" tags="restart" position="500,2650" size="100,100">&lt;&lt;silently&gt;&gt;
&lt;&lt;set $candleTimer = &quot;0s&quot;&gt;&gt;
&lt;&lt;set $window = false&gt;&gt;
&lt;&lt;set $office = false&gt;&gt;
&lt;&lt;set $jerkoff = false&gt;&gt;
&lt;&lt;set $door = false&gt;&gt;
&lt;&lt;set $secondFloor = false&gt;&gt;
&lt;&lt;set $arousalLevel = 0&gt;&gt;
&lt;&lt;if $finalArousal &gt;= 60 &amp;&amp; $finalArousal &lt;= 80&gt;&gt;
  &lt;&lt;set $arousalLevel = 1&gt;&gt;
&lt;&lt;elseif $CurArousal &gt; 80 &amp;&amp; $finalArousal &lt;= 90&gt;&gt;&gt;
  &lt;&lt;set $arousalLevel = 2&gt;&gt;
&lt;&lt;elseif $CurArousal &gt; 90&gt;&gt;
  &lt;&lt;set $arousalLevel = 3&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set $forcefulExtraction = false&gt;&gt;
&lt;&lt;set $thePlatform = false&gt;&gt;
&lt;&lt;set $extractionRoom = false&gt;&gt;
&lt;&lt;set $lionWatch = false&gt;&gt;
&lt;&lt;set $theDesk = false&gt;&gt;
&lt;&lt;set $theJournal = false&gt;&gt;

&lt;&lt;set $spellbookKnowledge = false&gt;&gt;
&lt;&lt;set $blobGemstoneKnowledge = false&gt;&gt;
&lt;&lt;set $lionGemstoneKnowledge = false&gt;&gt;
&lt;&lt;set $journalKnowledge = false&gt;&gt;
&lt;&lt;/silently&gt;&gt;
\
Taking a deep breath and refocusing his thoughts away from his lingering arousal, the wolf looks around. Without the candle burning, the fire of arousal that it lit up still remains inside the wolf, but when it was lit, it was as if log upon log kept being placed upon it. Without it, the wolf feels as if that fire was crackling and burning steadily inside him like some kind of long-running campfire. $name can&#39;t figure out a way to extinguish it, but neither does it grow anymore. With a look down at his cock, the temptation to reach down for it and jerk off is strong, but with his mind clear he knows that Ivex can return at any moment, and if he does? Everything $name has worked so hard for will be lost.

&lt;&lt;if $arousalLevel == 1&gt;&gt;\
The candle has taken its toll, though. Even with his arousal under control, the wolf&#39;s cock still twitches every now and then, and the urge to touch it is still there. $name feels like he could jerk off three times in a row and still not be satisfied, and the urge to do so is there, but the wolf growls at himself, shakes his head, and ignores it. &lt;span class=&quot;imp-info&quot;&gt;That lingering arousal might still get in the way of things in the future, though...&lt;/span&gt;
&lt;&lt;elseif $arousalLevel &gt;= 2&gt;&gt;\
The candle has taken a high toll, though. Even with his arousal under control, the wolf&#39;s cock still twitches every now and then while, at the same time, dripping down pre-cum. $name feels like he could jerk off ten times in a row and still not be satisfied, and the urge to do so is still there gnawing at him. Gritting his teeth, the wolf shakes his head and growls at himself, however, resisting it. &lt;span class=&quot;imp-info&quot;&gt;That high, lingering arousal will definitely have consequences in the future, though...&lt;/span&gt;
&lt;&lt;/if&gt;&gt;\

His clothes and gear are nowhere near. The wolf lets out a soft growl. No weapons, no armor... not even a piece of cloth to hide his modesty. Ivex simply made them vanish... And the wolf doesn&#39;t see anything nearby that could even be used to properly cover himself. Looking down, seeing his naked form with a lingering erection that won&#39;t go down makes his ears grow red for a moment, but $name shakes his head.

This is not the time to be worried about his modesty. This is the time to be worried about his freedom...

[[Continue|The Upper Office]]</tw-passagedata><tw-passagedata pid="43" name="The Upper Office" tags="" position="500,2900" size="100,100">With the freedom to move around the office space, the wolf can now properly assess what is in this room. The many desks and cabinets seem to have nothing but documents on them with the occasional thick book lying here or there.

The wolf&#39;s best bets, however, are of course the open window on one side of the wall and the simple wooden door on the opposite one.
&lt;&lt;if $arousalLevel &gt; 0&gt;&gt;\

On the other hand, as $name looks down... all the wolf can see is his member. Even without the candle, the burning arousal that built up will not go away. It drips pre-cum down to the floor every now and then and remains forcefully erect, knot out and everything, begging for some relief.

The wolf feels that, using his hand, he could bring himself to an immensely satisfying orgasm in a matter of minutes. At the same time, however, is it really wise to indulge in such frivolities when the mage could return at any point? Resisting it is getting harder and harder...

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
      &lt;&lt;if !$room&gt;&gt;\
      &lt;li&gt;[[Look around the room some more.|Room]]&lt;/li&gt;
    &lt;&lt;/if&gt;&gt;
    &lt;&lt;if !$window&gt;&gt;\
    &lt;li&gt;[[Investigate the window.|Window]]&lt;/li&gt;
    &lt;&lt;/if&gt;&gt;\
    &lt;&lt;if !$jerkoff&gt;&gt;\
    &lt;li&gt;[[...Jerk off.|Arousal Relief]]&lt;/li&gt;
    &lt;&lt;/if&gt;&gt;\
    &lt;li&gt;[[Try the door.|Door]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;
&lt;&lt;else&gt;&gt;\
&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
      &lt;&lt;if !$room&gt;&gt;\
      &lt;li&gt;[[Look around the room some more.|Room]]&lt;/li&gt;
    &lt;&lt;/if&gt;&gt;
    &lt;&lt;if !$window&gt;&gt;\
    &lt;li&gt;[[Investigate the window.|Window]]&lt;/li&gt;
    &lt;&lt;/if&gt;&gt;\
    &lt;li&gt;[[Try the door.|Door]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="44" name="Room" tags="" position="300,2925" size="100,100">With his erection bobbing between his legs, the wolf searches the room with haste.

Throwing the cabinets open, $name frowns. More papers, candles, ink and quills. Standard utilities and nothing else. The wolf doesn&#39;t waste too much time going through that stuff.

Nothing of note is found.
&lt;&lt;set $room = true&gt;&gt;\

[[Continue|The Upper Office]]</tw-passagedata><tw-passagedata pid="45" name="Window" tags="" position="300,3050" size="100,100">$name approaches the window. Maybe it&#39;s climbable?

Upon putting his paws on the window&#39;s sill, the wolf&#39;s hopes of climbing out of there vanish. Not only that, though... something is wrong.

From inside, it looked like a tall window facing a cloudless blue sky. From his position, however, the wolf can see that this place is a tower. A very, very tall, circular tower made of straight stone. Other windows can be seen adorning the tower&#39;s sides in odd locations, some further up, and many of them further down. The floor the wolf finds himself in is one of the highest ones for sure, as the ground below seems very, very far.

The wolf&#39;s eyes go wide, however, for an entirely different reason. From where he stands, the wolf can see that the sky is not quite... the sky. Surrounding the tower, a dome of clear blue that looks like some kind of barrier keeps the place fairly illuminated as if with weak sunlight. The dome, however, encircles the tower entirely, starting from the ground and arching over the top of the tower.

Frowning, $name grunts. He does not know too much about magic, but if this huge tower is surrounded by a barrier, maybe it keeps it invisible? It could explain why he had never heard of a huge tower like this anywhere, nor did anyone know or warn him that Ivex lived somewhere like this.

Regardless... there is no way out through the window. Climbing down the smooth wall would be asking to slip and fall.
&lt;&lt;set $window = true&gt;&gt;\

[[Continue|The Upper Office]]</tw-passagedata><tw-passagedata pid="46" name="Door" tags="" position="650,2900" size="100,100">Narrowing his eyes, $name heads towards the door. The wolf lets out a low growl, measuring the door&#39;s apparent sturdiness as he approaches it fully expecting to have to tackle it down.

When his paw tries the door&#39;s handle, however, it twists. The door is not locked and it just opens.

Outside of it, there&#39;s a small hallway with no other doors, but it leads to a staircase that goes down.

&lt;&lt;if $room &amp;&amp; $window&gt;&gt;\
&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
    &lt;li&gt;[[Leave the office and head down the stairs.|Head Downstairs]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;
&lt;&lt;else&gt;&gt;\
There might still be useful things to see in the office before leaving, though.

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
      &lt;li&gt;[[Close the door and keep looking.|The Upper Office]]&lt;/li&gt;
    &lt;li&gt;[[Leave the office and head down the stairs.|Head Downstairs]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="47" name="Head Downstairs" tags="" position="775,2900" size="100,100">&lt;&lt;silently&gt;&gt;\
  &lt;&lt;set $stoneDoor = false&gt;&gt;
  &lt;&lt;set $lionDoor = false&gt;&gt;
  &lt;&lt;set $extractionDoor = false&gt;&gt;
  &lt;&lt;set $lionCutscene = false&gt;&gt;
  &lt;&lt;set $end07 = false&gt;&gt;\
&lt;&lt;/silently&gt;&gt;\
Even if he couldn&#39;t find his gear, $name can at least use his paws to cover himself as he carefully opens the door, closes it behind him, and heads downstairs into the unknown. His bare paws feel the cold stone beneath his feet, and the wolf&#39;s ears can&#39;t help but lower themselves at least a little bit. With his forced erection that will not retreat after the candle&#39;s curse, the best the wolf can do is press his cock against his leg to just barely cover it. Little bits of undesired pleasure course through him as his member still feels overly sensitive. He huffs but ignores it. When he gets out, he&#39;ll find clothes, find new gear, and then find a way to make Ivex pay for all of this humiliation...

Oh, he will.

For the time being, however, the wolf just takes careful steps down the stairs. The stairs have a perpetual turn, being circular in nature, with nothing but ill-lit stone walls on each of its sides. A burning torch adorns the wall every now and then, providing just enough light for the wolf to keep going. It&#39;s hard to keep track of how many circles he does, but after going down what feels like way too many steps, the staircase finally ends in a hallway.

Unfortunately, in that hallway, there is also nothing but a single door. No exit, no stairs leading further down. The wolf tries to keep track of what this place&#39;s construction might look like, but it feels like it doesn&#39;t make sense...

There is little choice but to proceed, though.

[[Continue|Second Floor]]</tw-passagedata><tw-passagedata pid="48" name="Interrogation End" tags="end" position="2300,1800" size="100,100">$name fell into Ivex&#39;s hands.

&lt;&lt;if $interrogationEndingUnlock&gt;&gt;\
&lt;&lt;set MT.mdSet(&quot;interrogationEnding&quot;, true)&gt;&gt;\
&lt;&lt;set $interrogationEndingUnlock = false&gt;&gt;\
The &lt;span class=&quot;imp-info&quot;&gt;Bad Ending: Interrogation&lt;/span&gt; is unlocked in the Archive!
&lt;&lt;/if&gt;&gt;\
&lt;&lt;if $interrogationEndingShockUnlock&gt;&gt;\
&lt;&lt;set MT.mdSet(&quot;interrogationEndingShock&quot;, true)&gt;&gt;\
&lt;&lt;set $interrogationEndingShockUnlock = false&gt;&gt;\
The &lt;span class=&quot;imp-info&quot;&gt;Shock variant&lt;/span&gt; for Bad Ending: Interrogation is unlocked in the Archive!
&lt;&lt;/if&gt;&gt;\
&lt;&lt;if $interrogationEndingFreezeUnlock&gt;&gt;\
&lt;&lt;set MT.mdSet(&quot;interrogationEndingFreeze&quot;, true)&gt;&gt;\
&lt;&lt;set $interrogationEndingFreezeUnlock = false&gt;&gt;\
The &lt;span class=&quot;imp-info&quot;&gt;Freeze variant&lt;/span&gt; for Bad Ending: Interrogation is unlocked in the Archive!
&lt;&lt;/if&gt;&gt;\
&lt;&lt;if $interrogationEndingMildUnlock&gt;&gt;\
&lt;&lt;set MT.mdSet(&quot;interrogationEndingMild&quot;, true)&gt;&gt;\
&lt;&lt;set $interrogationEndingMildUnlock = false&gt;&gt;\
The &lt;span class=&quot;imp-info&quot;&gt;Mild variant&lt;/span&gt; for Bad Ending: Interrogation is unlocked in the Archive!
&lt;&lt;/if&gt;&gt;\
&lt;&lt;if $interrogationEndingRoughUnlock&gt;&gt;\
&lt;&lt;set MT.mdSet(&quot;interrogationEndingRough&quot;, true)&gt;&gt;\
&lt;&lt;set $interrogationEndingRoughUnlock = false&gt;&gt;\
The &lt;span class=&quot;imp-info&quot;&gt;Rough variant&lt;/span&gt; for Bad Ending: Interrogation is unlocked in the Archive!
&lt;&lt;/if&gt;&gt;\

To change the adventurer&#39;s fate, you can...

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\  
      &lt;li&gt;[[Attempt to escape again.|Escape Options]]&lt;/li&gt;
      &lt;li&gt;&lt;&lt;link &quot;Return to the beginning of the game&quot;&gt;&gt;
        &lt;&lt;run Engine.restart()&gt;&gt;
      &lt;&lt;/link&gt;&gt;&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;</tw-passagedata><tw-passagedata pid="49" name="Easy Way" tags="" position="1375,1975" size="100,100">&lt;&lt;include &quot;Easy Way (Text)&quot;&gt;&gt;

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
    &lt;li&gt;[[Stay silent and growl.|Resistance]]&lt;/li&gt;
    &lt;li&gt;[[Spit towards Ivex to show his distaste.|Defiance]]&lt;/li&gt;	
  &lt;/ul&gt;\
&lt;/div&gt;</tw-passagedata><tw-passagedata pid="50" name="Hard Way" tags="" position="1375,2100" size="100,100">&lt;&lt;include &quot;Hard Way (Text)&quot;&gt;&gt;
&lt;&lt;set $defiance += 1&gt;&gt;\

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
    &lt;li&gt;[[Stay silent and growl.|Resistance]]&lt;/li&gt;
    &lt;li&gt;[[Spit towards Ivex to show his distaste.|Defiance]]&lt;/li&gt;	
  &lt;/ul&gt;\
&lt;/div&gt;</tw-passagedata><tw-passagedata pid="51" name="Ivex Torture 2" tags="" position="1225,2025" size="100,100">&lt;&lt;include &quot;Ivex Torture 2 (Text)&quot;&gt;&gt;

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
    &lt;li&gt;[[Splay ears in submission.|Easy Way]]&lt;/li&gt;
    &lt;li&gt;[[Growl in defiance.|Hard Way]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;</tw-passagedata><tw-passagedata pid="52" name="Arousal Relief" tags="" position="300,2800" size="100,100">Fuck it. It will be quick and it will feel great! With a glance towards the door and a growl coming from his throat, $name wraps his paw around his cock and that alone brings a groan of relief.

Closing his eyes, he starts pumping it. In fast, quick motions, the wolf lets his hand glide over the surface of his cock, stimulating it, pleasuring it. Nobody knows his own dick better than his own hand, so with dexterity, his paw strokes his cock up and down. It teases the tip, then when it reaches the base, the wolf opens his grip just lightly to give his knot a squeeze before it keeps going...

&lt;&lt;print $name&gt;&gt;&#39;s knees grow a bit weak. Whatever the hell was in that candle certainly does enhance his pleasure. As he predicted, within a few short minutes, the wolf&#39;s growling has already reached a new peak. His hand speeds up, his cock hardens in his grip, until, finally...!

&quot;Hnngh...! Yeah...&quot; the wolf groans. He doesn&#39;t care that his seed goes flying up, splattering on the office&#39;s floor and on the mage&#39;s possessions. All he cares about is the pleasure, the overwhelming pleasure of climax that overcomes him for those sweet, sweet seconds of release.

It lasts longer than usual, but eventually, &lt;&lt;print $name&gt;&gt;&#39;s orgasm starts subsiding. His paw keeps stroking his cock, but slows down, and his member still throbs. Even not tying his knot into anything, his member remains hard and his knot fully engorged. It won&#39;t go down for a while. Strangely enough, though...

$name finds that he doesn&#39;t quite feel satisfied. While usually there would be a refractory period, that known period of oversensitivity and bliss that any male knows well, this time... there isn&#39;t. When $name lets go of his cock, it remains hard. It still drips pre-cum. And, if anything, he feels a small urge to grab it again and jerk off once more. A little less so than before, but still...

With a frown, the wolf tries to push such thoughts away from his mind. Still, his endeavor proved fruitless. He got some relief, but the need did not leave him and his erection does not subside in the least. Definitely another effect of that cursed candle...

With a growl of frustration, all $name can do is try to ignore his erection again and focus on what really matters. At least the grip of his arousal in his mind has &lt;span class=&quot;imp-info&quot;&gt;subsided a little&lt;/span&gt; with this brief relief.
&lt;&lt;set $arousalLevel = 1&gt;&gt;\
&lt;&lt;set $jerkoff = true&gt;&gt;\

[[Continue|The Upper Office]]</tw-passagedata><tw-passagedata pid="53" name="Resistance" tags="" position="1525,2100" size="100,100">&lt;&lt;include &quot;Resistance (Text)&quot;&gt;&gt;

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
    &lt;li&gt;[[&#39;&quot;Yes, I come from the far north, so what?&quot;&#39;|Ice]]&lt;/li&gt;
    &lt;li&gt;[[&#39;&quot;No, I come from the south, so what?&quot;&#39;|Shock]]&lt;/li&gt;
    &lt;li&gt;[[&quot;Stay silent.&quot;|Random Punishment]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;</tw-passagedata><tw-passagedata pid="54" name="Ice" tags="" position="1675,2200" size="100,100">&lt;&lt;include &quot;Ice (Text)&quot;&gt;&gt;

[[Continue|Ice 2]]</tw-passagedata><tw-passagedata pid="55" name="Shock" tags="" position="1675,1900" size="100,100">&lt;&lt;include &quot;Shock (Text)&quot;&gt;&gt;

[[Continue|Shock 2]]</tw-passagedata><tw-passagedata pid="56" name="Random Punishment" tags="" position="1675,2050" size="100,100">&lt;&lt;silently&gt;&gt;
&lt;&lt;set $defiance += 2&gt;&gt;\
&lt;&lt;set $punishment to random(1, 2)&gt;&gt;
&lt;&lt;/silently&gt;&gt;
&quot;Going to remain stubborn, hmm? It&#39;s a shame you don&#39;t want to play my little game with me... I&#39;ll remember that.&quot; The panther&#39;s smile does diminish with the lack of response. Nevertheless, his hand does not stop teasing the wolf&#39;s member. If anything, it moves a little faster, making it even harder for $name to suppress the unnaturally immense pleasure that comes even from such soft movements.

&quot;Very well, then. If you won&#39;t play with me, I&#39;ll play alone.&quot; Ivex goes back to smiling.

&lt;&lt;if $punishment == 1&gt;&gt;\
&quot;You look like... a northern wolf. Your fur is thick and you&#39;re oh-so-big... I&#39;m sure you probably grew up playing in the snow. Cold is like second nature to you. It doesn&#39;t penetrate that thick pelt, right? But then again...&quot;

The mage grins.

[[Continue|Ice]]
&lt;&lt;else&gt;&gt;\
&quot;You look like... a southern wolf. So big, so muscular, I can imagine you growing up in the woods. Hunting, honing those skills, sweating... Oh, yes. You&#39;re so strong, so resistant to pain, right? But then again...&quot;

The mage grins.

[[Continue|Shock]]
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="57" name="Ice 2" tags="" position="1800,2200" size="100,100">&lt;&lt;include &quot;Ice 2 (Text)&quot;&gt;&gt;

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
    &lt;li&gt;[[&#39;&quot;I w-&quot;&#39;|Ice 3]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;</tw-passagedata><tw-passagedata pid="58" name="Ice 3" tags="" position="1925,2200" size="100,100">&lt;&lt;if !$interrogationEndingFreeze&gt;&gt;\
&lt;&lt;set $interrogationEndingFreezeUnlock = true&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;include &quot;Ice 3 (Text)&quot;&gt;&gt;

[[Continue|Extra Torture]]</tw-passagedata><tw-passagedata pid="59" name="Extra Torture" tags="" position="2050,2025" size="100,100">&lt;&lt;include &quot;Extra Torture (Text)&quot;&gt;&gt;

&lt;&lt;if $defiance &gt; 3&gt;&gt;\
&quot;You thought you could fight me. You thought you had a chance of escaping. Of beating me. Hah! How wrong were you, hmm?&quot; the mage laughs. He grips the wolf&#39;s knot and gives it a painful squeeze. Enough to force a muffled whine. &quot;I did not forget your defiance, though. You will now see what your hopeless fighting and bravery brings upon you...&quot;

[[Continue|Defiant End]]
&lt;&lt;else&gt;&gt;\
&quot;You&#39;ve been such a good boy, all things considered...&quot; the panther muses, caressing the wolf&#39;s knot. His hand grips the wolf&#39;s member more firmly, starting to stroke it in a pleasurable way. &quot;I&#39;ll be pleased to have someone like you by my side. I&#39;ve been needing more thralls, and I only accept handsome ones. Oh, the pleasures you will feel... too bad you won&#39;t be quite as aware of them...&quot;

[[Continue|Compliant End]]
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="60" name="Defiant End" tags="" position="2225,2025" size="100,100">&lt;&lt;if !$interrogationEnding&gt;&gt;\
&lt;&lt;set $interrogationEndingUnlock = true&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;if !$interrogationEndingRough&gt;&gt;\
&lt;&lt;set $interrogationEndingRoughUnlock = true&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;include &quot;Defiant End (Text)&quot;&gt;&gt;

&lt;span class=&quot;bad-ending&quot;&gt;Bad Ending: &lt;i&gt;Interrogation&lt;/i&gt;&lt;/span&gt;

[[Continue|Interrogation End]]</tw-passagedata><tw-passagedata pid="61" name="Compliant End" tags="" position="2125,1900" size="100,100">&lt;&lt;if !$interrogationEnding&gt;&gt;\
&lt;&lt;set $interrogationEndingUnlock = true&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;if !$interrogationEndingMild&gt;&gt;\
&lt;&lt;set $interrogationEndingMildUnlock = true&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;include &quot;Compliant End (Text)&quot;&gt;&gt;

&lt;span class=&quot;bad-ending&quot;&gt;Bad Ending: &lt;i&gt;Interrogation&lt;/i&gt;&lt;/span&gt;

[[Continue|Interrogation End]]</tw-passagedata><tw-passagedata pid="62" name="Defiance" tags="" position="1525,1975" size="100,100">&lt;&lt;include &quot;Defiance (Text)&quot;&gt;&gt;
&lt;&lt;set $defiance += 1&gt;&gt;\

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
    &lt;li&gt;[[&#39;&quot;Yes, I come from the far north, so what?&quot;&#39;|Ice]]&lt;/li&gt;
    &lt;li&gt;[[&#39;&quot;No, I come from the south, so what?&quot;&#39;|Shock]]&lt;/li&gt;
    &lt;li&gt;[[&quot;Stay silent.&quot;|Random Punishment]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;</tw-passagedata><tw-passagedata pid="63" name="Shock 2" tags="" position="1800,1900" size="100,100">&lt;&lt;include &quot;Shock 2 (Text)&quot;&gt;&gt;

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
    &lt;li&gt;[[&#39;&quot;I w-&quot;&#39;|Shock 3]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;</tw-passagedata><tw-passagedata pid="64" name="Shock 3" tags="" position="1925,1900" size="100,100">&lt;&lt;if !$interrogationEndingShock&gt;&gt;\
&lt;&lt;set $interrogationEndingShockUnlock = true&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;include &quot;Shock 3 (Text)&quot;&gt;&gt;

[[Continue|Extra Torture]]</tw-passagedata><tw-passagedata pid="65" name="Second Floor" tags="" position="675,3100" size="200,200">&lt;&lt;if $end07&gt;&gt;\
  &lt;&lt;goto &quot;To Be Continued 2&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;\
&lt;&lt;if $secondFloor&gt;&gt;\
Back in the hallway, nothing seems to have changed. Two doors, one on each side of the hallway.

Where to try next?
&lt;&lt;else&gt;&gt;\
Upon opening the door, the wolf&#39;s eyes go wide.

What lies beyond him is another hallway, but this one is much, much larger.

The ceiling above is tall, impossibly so for a circular tower, and the hallway is wide with a red carpet and luxurious couches adorning its sides. The walls surrounding it have two doors, one closed, and one semi-open. What really draws the wolf&#39;s eyes is how impossible the architecture of this place is.

Before the wolf can take time to properly study the new hallway, however, a sound makes $name pause immediately.

It&#39;s a grunt of some sort. And it&#39;s coming from the semi-open door. The wolf minds his steps, growing cautious and keeping them silent, and then approaches the door to peek inside.

He&#39;d have to pry it open a little more to properly see, but his ears twitch and there is no doubt. There&#39;s someone inside. Another grunt comes, then the idle sound of steps moving around.

Could it be Ivex? Perhaps one of his minions or allies, if he has any? Getting caught could undo all of the wolf&#39;s work to escape so far.

There is also the closed door on the other side of the wall. That one looks normal, made of wood and with a handle. No sounds seem to be coming from it, at least not that the wolf can hear from where he is, so it might be safer.

Now the question is... where to go?
&lt;&lt;set $secondFloor = true&gt;&gt;\
&lt;&lt;/if&gt;&gt;\

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
    &lt;&lt;if !$extractionRoom&gt;&gt;\
        &lt;li&gt;[[Try the closed door.|Extraction Room Intro]]&lt;/li&gt;
    &lt;&lt;else&gt;&gt;\
      &lt;li&gt;[[Try the large hall.|Extraction Room]]&lt;/li&gt;
    &lt;&lt;/if&gt;&gt;\
    &lt;&lt;if !$lionGemstoneKnowledge&gt;&gt;\
      &lt;&lt;if $lionWatch&gt;&gt;\
        &lt;li&gt;[[Try the door with the lion inside.|Lion Watch]]&lt;/li&gt;
      &lt;&lt;else&gt;&gt;\
        &lt;li&gt;[[Pry open the door with someone inside.|Lion Room Intro]]&lt;/li&gt;	
      &lt;&lt;/if&gt;&gt;\
    &lt;&lt;/if&gt;&gt;\
  &lt;/ul&gt;\
&lt;/div&gt;</tw-passagedata><tw-passagedata pid="66" name="Extraction Room Intro" tags="" position="725,3775" size="100,100">&lt;&lt;if !$extractionDoor&gt;&gt;\
With care, the wolf approaches the closed door. Taking a couple of reflexive sniffs towards it, the smells coming from it seem... varied, but also stale. With his ears perked up, $name tries to listen in to see if there&#39;s movement inside, but not a sound comes from it.

An attempt to turn the door handle shows that it is indeed not locked. With care, the wolf pries it open just enough to peer inside...

What he sees makes his eyes widen. The room is large- no, &#39;large&#39; doesn&#39;t even begin to cover it. It&#39;s grand. A circular room with a tall ceiling and long walls with what seems to be small closed numbered alcoves lining it. It proves once and for all that this place defies the laws of space, as there is no way a room this large would fit on this side of the building.

By the center of the large hall, the wolf can see what looks like an altar of some sort with an unidentified, gooey thing resting on it. Not too far from it, there&#39;s a desk with a chair and some books spread all over it.

There doesn&#39;t seem to be anyone in the room, at least not at first glance.

Maybe it would be good to go in and take a closer look... or maybe trying something else first would be wiser.
&lt;&lt;set $extractionDoor = true&gt;&gt;\

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
      &lt;li&gt;[[Pry further and investigate the room.|Extraction Room]]&lt;/li&gt;
    &lt;li&gt;[[Return to the hallway.|Second Floor]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;\
&lt;&lt;else&gt;&gt;\
Prying into the oversized room again, nothing has changed. The tall walls are littered with strange alcoves and the mysterious altar at the center of the room hasn&#39;t changed. It&#39;s quiet.

Maybe it would be good to go in and take a closer look... or maybe trying something else first would be wiser.

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
      &lt;li&gt;[[Pry further and investigate the room.|Extraction Room]]&lt;/li&gt;
    &lt;li&gt;[[Return to the hallway.|Second Floor]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="67" name="Lion Room Intro" tags="" position="950,3100" size="100,100">&lt;&lt;if !$lionDoor&gt;&gt;\
Silently approaching the half-open door, the wolf carefully places his paw upon it and slides it open just a tad bit more so that he can peer inside.

It&#39;s a strange room. A large counter with a plenitude of vials adorns its left side, the only side of the room the wolf can see from that viewpoint, with shelves of instruments, materials, and more empty vials above it. That&#39;s not what surprises the wolf, however. Near the center of the room, turned towards the counter and with several jars of strange herbs surrounding him stands... a [[lion|Lion Description]].

His face is not visible from the door where the wolf stands, but the lion works with a mortar and pestle, grinding herbs in what seems to be a dull, repetitive process. He seems completely engrossed in his work to the point where he barely moves.

At least it&#39;s not Ivex, but who is he? From his body alone, $name can tell he&#39;s some kind of warrior. Upon further inspection, scars can be seen here or there under his fur upon his legs, back, arms...

Perhaps observing him for a little while longer could be useful. Getting discovered by him, however, could be dangerous...
&lt;&lt;set $lionDoor = true&gt;&gt;\

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
      &lt;li&gt;[[Pry further and watch the lion.|Lion Watch]]&lt;/li&gt;
    &lt;li&gt;[[Return to the hallway.|Second Floor]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;\
&lt;&lt;else&gt;&gt;\
Prying through the door once more, nothing has changed. The semi-naked, muscular [[lion|Lion Description]] is still there engrossed in his work with the mortar and pestle. In fact, he has barely moved an inch, just continuing to grind herbs and setting them onto vials.

&lt;&lt;if !$lionCutscene&gt;&gt;\
Observing him a little closer could be useful. Getting discovered by him, however, could be dangerous...
&lt;&lt;else&gt;&gt;\
Approaching him for more information could be useful, even if risky...
&lt;&lt;/if&gt;&gt;\

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
      &lt;li&gt;[[Pry further and watch the lion.|Lion Watch]]&lt;/li&gt;
    &lt;li&gt;[[Return to the hallway.|Second Floor]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;\
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="68" name="Lion Watch" tags="" position="950,3225" size="100,100">&lt;&lt;set $lionWatch = true&gt;&gt;\
&lt;&lt;set $lionwatchFinal = ($lionwatch1 + $lionwatch2 + $lionwatch3 + $lionwatch4+ $lionwatch5 + $lionwatch6 + $lionwatch7)&gt;&gt;
With care, the wolf pries the door open just a little more so that he can slide his head inside to watch. &lt;&lt;print $name&gt;&gt;&#39;s erection grinds uncomfortably against the wooden door, reminding him of its presence, but he does his best to ignore it.

With a better view, it is plain to see that the lion is not only naked but also... erect himself. His member is pressed between the counter&#39;s wood and his leg down to the side, forgotten but remaining hard as he works. His hands make the same motion to grind herbs without ceasing. From this new vantage point, the wolf can also see his eyes. They seem... vacant?

Expressionless. 

The lion works with a constant, unmoving straight face. The only other thing of note that the wolf can now see is that this lion also wears, alongside the leather harness, a pendant around his neck. It has a blue gemstone attached to it that lets out a soft glow.

Other than that, the lion just continues to grind herbs like before. Never stopping and barely moving. The wolf continues to watch him quietly. Judging by the lion&#39;s stillness, it might take some &lt;span class=&quot;imp-info&quot;&gt;time&lt;/span&gt; before he does something interesting.

&lt;span id=&quot;timer1&quot;&gt;\

&lt;div class=&quot;dot-flashing&quot;&gt;&lt;/div&gt;
&lt;/span&gt;\
&lt;&lt;timed `$lionwatch1 + &quot;s&quot;` t8n&gt;&gt;\
&lt;&lt;replace &quot;#timer1&quot;&gt;&gt;&lt;&lt;/replace&gt;&gt;\
Upon spending some time observing him, the wolf can see that the lion&#39;s motions feel... unnatural. His vague expression remains unchanged as well. Something is off about him.

&lt;span id=&quot;timer2&quot;&gt;\

&lt;div class=&quot;dot-flashing&quot;&gt;&lt;/div&gt;
&lt;/span&gt;\
&lt;&lt;set $lionwatch1 = 0&gt;&gt;\
&lt;&lt;next `$lionwatch2 + &quot;s&quot;`&gt;&gt;\
&lt;&lt;replace &quot;#timer2&quot;&gt;&gt;&lt;&lt;/replace&gt;&gt;\
The gleam of his pendant is more than just a reflection of the low light of the burning lanterns that illuminate the room. When the wolf focuses his eyes on it it feels as if... there&#39;s something... swirling inside it? It&#39;s definitely magical in some way.

&lt;span id=&quot;timer3&quot;&gt;\

&lt;div class=&quot;dot-flashing&quot;&gt;&lt;/div&gt;
&lt;/span&gt;\
&lt;&lt;set $lionwatch2 = 0&gt;&gt;\
&lt;&lt;next `$lionwatch3 + &quot;s&quot;`&gt;&gt;\
&lt;&lt;replace &quot;#timer3&quot;&gt;&gt;&lt;&lt;/replace&gt;&gt;\
When the lion finishes grinding the current herbs, he reaches for a new bowl of them without even looking. Shoving his large hand inside, he grabs a handful and just shoves them into the mixture to grind them. His eyes don&#39;t shift one inch as he continues.

...Yet at the same time, the wolf can see one reaction in him. His member had been erect before, but it seems to harden yet a little more even though nothing has touched it. Maybe the lion thought about something arousing? $name frowns at the sight. This can&#39;t be a proud warrior like he thought...

All the lion does is continue to grind herbs.

&lt;span id=&quot;timer4&quot;&gt;\

&lt;div class=&quot;dot-flashing&quot;&gt;&lt;/div&gt;
&lt;/span&gt;\
&lt;&lt;set $lionwatch3 = 0&gt;&gt;\
&lt;&lt;next `$lionwatch4 + &quot;s&quot;`&gt;&gt;\
&lt;&lt;replace &quot;#timer4&quot;&gt;&gt;&lt;&lt;/replace&gt;&gt;\
It takes a while for the lion to grind the new herbs to what might be an acceptable level. Nothing of them remains in the mortar and then, finally, the lion puts it down. The wolf&#39;s ears perk up. It&#39;s the first time he&#39;s done that.

The lion takes a step back from his work. $name retreats a little thinking he might head or look towards the door, but he doesn&#39;t. Instead, the lion simply takes hold of his cock with his big paw and, without even looking down at it... starts stroking it.

The wolf&#39;s eyes go wide. The big male has stopped what he was doing to... jerk off? Just like that? The lion&#39;s expression remains blank and unchanged even as his paw glides up and down the length of his hard member, stimulating it. As he starts doing it, he continues to just jerk himself off in a steady rhythm.

&lt;span id=&quot;timer5&quot;&gt;\

&lt;div class=&quot;dot-flashing&quot;&gt;&lt;/div&gt;
&lt;/span&gt;\
&lt;&lt;set $lionwatch4 = 0&gt;&gt;\
&lt;&lt;next `$lionwatch5 + &quot;s&quot;`&gt;&gt;\
&lt;&lt;replace &quot;#timer5&quot;&gt;&gt;&lt;&lt;/replace&gt;&gt;\
Standing there at the door watching the lion masturbate makes the wolf shift uncomfortably. He remains absolutely silent as to not be seen, but the lion never turns his head or shifts his gaze. He simply keeps staring down at the ground herbs while his paw works at his cock. Still, watching this, for some reason, makes the wolf&#39;s own arousal twitch. He doesn&#39;t have a particular desire for males, but the lingering arousal in his system makes watching the large lion masturbating become a somewhat arousing experience...

Beads of pre-cum appear at the tip of the lion&#39;s member only to then turn into thin strings as they fall down to the floor below. The lion&#39;s rhythm doesn&#39;t change and, for a while, it just feels like he&#39;s going to keep idly jerking off forever.

&lt;span id=&quot;timer6&quot;&gt;\

&lt;div class=&quot;dot-flashing&quot;&gt;&lt;/div&gt;
&lt;/span&gt;\
&lt;&lt;set $lionwatch5 = 0&gt;&gt;\
&lt;&lt;next `$lionwatch6 + &quot;s&quot;`&gt;&gt;\
&lt;&lt;replace &quot;#timer6&quot;&gt;&gt;&lt;&lt;/replace&gt;&gt;\
The lion keeps jerking himself off. The huge leonine&#39;s hand just keeps beating his cock without ceasing.

&lt;&lt;print $name&gt;&gt;&#39;s ears twitch as, finally, something changes. In a display of flexibility, the large lion suddenly brings his leg up high and plants a footpaw firmly up on the counter in front of him. With his hand, he pulls the mix of herbs closer, and with the lion tilted slightly to the side now the wolf gets a full view of the events.

The large lion&#39;s chest heaves. Though his eyes remain wide and expressionless, his breathing clearly picks up and his hand speeds up as well, masturbating with greater force. The lion points his cock down... right at the bowl filled with ground herbs that he just pulled up to be right under it.

&lt;&lt;print $name&gt;&gt;&#39;s eyes grow wider yet. Does the lion intend to...? 

The wolf gets his answer soon enough. The lion grunts and huffs, the first real noises the wolf has heard him let out so far. Then, the feline grits his teeth, showing his fangs as his hand speeds up once again to jerk his cock off with vigor. The lion&#39;s muscles bulge from the increased effort, until, finally...

The lion lets out a long grunt as his cock finally erupts. A burst of seed shoots straight into the herb mixture, followed by another, and then a whole sequence of pearly cum keeps coming to mix in with the herbs ground within the bowl.

The male keeps pumping his cock, milking it of every last drop of his seed into the mortar before the lion lets out one last sigh and pulls his footpaw from the counter. Standing properly, the leonine lets go of his cock that only twitches alone in the air, but remains erect, and picks up the mortar and pestle to start mixing the cum with the ground herbs.

Much to the wolf&#39;s dismay, after mixing for a while longer, the lion soon dumps the mixture into one of the empty vials, making a &#39;potion&#39; out of it, before grabbing a new handful of herbs to start grinding from the start.

What the hell?!

&lt;span id=&quot;timer7&quot;&gt;\

&lt;div class=&quot;dot-flashing&quot;&gt;&lt;/div&gt;
&lt;/span&gt;\
&lt;&lt;set $lionwatch6 = 0&gt;&gt;\
&lt;&lt;next `$lionwatch7 + &quot;s&quot;`&gt;&gt;
&lt;&lt;replace &quot;#timer7&quot;&gt;&gt;&lt;&lt;/replace&gt;&gt;\
With his own cock still pulsing after the display, the wolf just continues watching for a while longer, but after the unusual display, the lion goes back to his old, expressionless self doing nothing but grinding herbs in a continuous motion.

It doesn&#39;t seem like he&#39;s going to be going anywhere or doing anything different for the time being unless interrupted. On the other hand, he seems almost... mindless. Despite his size, he does not seem as dangerous to the wolf as he looked at first. Approaching him could be a good idea after all... maybe.

&lt;&lt;set $lionCutscene = true&gt;&gt;
&lt;&lt;set $lionwatch7 = 0&gt;&gt;\
&lt;&lt;set $lionwatchFinal = 0&gt;&gt;\
&lt;&lt;/timed&gt;&gt;\
\
&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
      &lt;li&gt;[[Stop watching him and return to the hallway.|Second Floor]]&lt;/li&gt;
    &lt;&lt;if $lionCutscene&gt;&gt;\
      &lt;li&gt;[[Approach the lion.|Lion Start]]&lt;/li&gt;
    &lt;&lt;else&gt;&gt;\
      &lt;&lt;timed `$lionwatchFinal + &quot;s&quot;` t8n&gt;&gt;\
        &lt;li&gt;[[Approach the lion.|Lion Start]]&lt;/li&gt;
      &lt;&lt;/timed&gt;&gt;\
    &lt;&lt;/if&gt;&gt;\
  &lt;/ul&gt;\
&lt;/div&gt;\</tw-passagedata><tw-passagedata pid="69" name="Extraction Room" tags="" position="525,3900" size="200,200">&lt;&lt;if $extractionRoom&gt;&gt;\
There isn&#39;t much to see despite the room&#39;s size. The mysterious, numbered alcoves line up along the tall walls around the wolf, with most of them being closed.

At the center, the altar with the gooey thing resting on it draws the most attention, with the desk full of books and writing supplies splayed all over it being the second most interesting thing.
&lt;&lt;else&gt;&gt;
&lt;&lt;set $extractionRoom = true&gt;&gt;\
Carefully entering the grand hall, the wolf proceeds with care. This place seems safer as there is no sign of anyone being here, though. As the wolf moves into the room, paw still keeping his stubborn erection pressed against his leg, even the mighty warrior is taken aback by the grandioseness of the place.

Taking a moment to survey the room well, the wolf can see that some of the strange alcoves are open. The open ones reveal nothing but a small space inside. What could be the purpose of something like that? Most of them are so high up that they aren&#39;t even reachable, although that&#39;s probably not a problem for someone with magic. The wolf cannot see any indication of how exactly to open the heavy, stone-made doors of the closed ones.

Upon approaching the center of the room, the wolf has a chance to properly inspect the thing that looks like some kind of altar and the desk as well. The substance in the altar stands still. It almost looks like liquid, but unlike water, it doesn&#39;t run down the sides of the altar, but rather stays still in its own self-contained oval-shaped bubble over the firm stone. Maybe some kind of barrier holds it together...? It&#39;s hard to tell, but in this tower, $name believes any kind of bullshit is possible.

The desk, on the other hand, is lined up with books and scrolls. It seems to be the place with the most recent activity, so $name can guess that, whatever Ivex does in this room, he mostly does at that desk. Maybe there&#39;s useful information in some of those books?

A careful, more thorough investigation of the strange room could be helpful.
&lt;&lt;/if&gt;&gt;\

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
      &lt;li&gt;[[Examine the desk.|The Desk]]&lt;/li&gt;
    &lt;li&gt;[[Examine the altar.|The Altar]]&lt;/li&gt;
    &lt;li&gt;[[Go back to the hallway.|Second Floor]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;</tw-passagedata><tw-passagedata pid="70" name="Lion Start" tags="" position="1075,3225" size="100,100">Frowning and taking a deep breath, the wolf has had enough observing and decides to approach the lion. One of his paws goes down to cover his hard cock as best as it can, but the wolf&#39;s ears remain up and his stance a wary one. The lion has the appearance of a warrior himself, and he&#39;s definitely not normal, so he doesn&#39;t know what to expect.

Abandoning subtlety, the wolf opens the door and steps in. The sounds do cause the lion to turn his head towards the lupine, although his hands continue to grind herbs and his expression does not change, even as he sets his eyes on $name.

Waiting to see what the lion will do, the wolf says nothing, but for the first few seconds... the lion does not react. His eyes remain locked on the wolf, but he doesn&#39;t speak. $name starts to think the lion won&#39;t even acknowledge his presence, which wouldn&#39;t be so bad, when finally, the feline does form words.

&quot;All visitors must be welcomed,&quot; the lion says, his voice as void of expression as his eyes. &quot;The master has not scheduled any visitors. Are you here to take your place?&quot;

The question makes the wolf blink. At least the lion isn&#39;t showing any signs of aggression. $name can&#39;t help but feel uncomfortable speaking to a naked, erect male while being naked and aroused himself... but what is even normal in this cursed tower? The wolf brushes those thoughts aside and scratches his head.

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
      &lt;li&gt;[[&#39;&quot;Uhh... Yes?&quot;&#39;|Lion Conversation]]&lt;/li&gt;
    &lt;li&gt;[[&#39;&quot;I&#39;m looking for a way out...&quot;&#39;|Lion Conversation]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;\</tw-passagedata><tw-passagedata pid="71" name="Lion Conversation" tags="" position="1200,3225" size="100,100">Before the wolf can even properly finish speaking, however, the lion interrupts him.

&quot;I am directed to provide the means for one to take their place. Wait here.&quot;

The lion finally puts down the mortar and pestle and, without saying anything, moves to one of the cabinets and pulls open a drawer. In it, the wolf can see a handful of &lt;span class=&quot;imp-info&quot;&gt;dim, gray gemstones&lt;/span&gt;, of which the lion takes one.

&lt;&lt;if $journalKnowledge&gt;&gt;\
The wolf&#39;s eyes grow wide! The words he read on Ivex&#39;s journal return to his mind. Empty gemstones... That might be what the wolf is looking for!

The lion, however, takes one and closes the drawer. He then walks towards the wolf. $name tenses up for a moment, but the lion just walks past him and leaves the room. Confused, the wolf can at least see that he goes into the other room across the hallway. He&#39;s not sure what the lion is doing, but it&#39;s his chance!

In a rush, the wolf moves towards the drawer to open it and take a closer look. Indeed, it contains a handful of gray and dull-looking gemstones, but gemstones nevertheless. These must be the empty ones! The wolf&#39;s tail starts wagging, but before he can do anything with them, the sound of the lion returning forces him to quickly shut the drawer and step away as to avoid drawing suspicion.

When the feline returns, he no longer holds a gray gemstone, but rather a bright, blue one that glows just like the one hanging from the pendant around his neck. He must have enchanted it. That increases the wolf&#39;s hopes that those gemstones are what he is looking for. All he has to do now is not look suspicious and somehow deal with this lion so that he can get them...

The lion attaches a piece of string to it, and just like that, he has a makeshift pendant much like his own.
&lt;&lt;else&gt;&gt;\
He then walks towards the wolf. $name tenses up for a moment, but the lion just walks past him and leaves the room. Confused, the wolf can at least see that he goes into the other room across the hallway.

It takes a few moments, but soon the lion returns and the dim gemstone he took with him now has a bright, blue glow. One that looks just like the one hanging from the pendant around the lion&#39;s neck. It is not surprising to see him attach it to a piece of string, quickly making a makeshift pendant out of it.
&lt;&lt;/if&gt;&gt;\

&quot;Take this and wear it,&quot; the lion offers, showing the pendant to the wolf. &quot;You will need this to navigate the master&#39;s tower as you should.&quot;

The wolf looks at the pendant but hesitates. The lion&#39;s eyes lock on the wolf, patiently waiting for him to take the pendant. His expression remains neutral, his eyes blank... but he seems to know what he&#39;s doing. Somehow.

&quot;What is your name? Do you work for Ivex?&quot; the wolf tries asking.

The lion, however, simply repeats what he says before.

&quot;Take this and wear it. You will need this to navigate the master&#39;s tower as you should.&quot;

&quot;What does that pendant do?&quot; the wolf tries asking again.

&quot;Take this and wear it. You will need this to navigate the master&#39;s tower as you should.&quot;

$name frowns. There is no talking to this lion. Whatever Ivex has done to him... he&#39;s barely a person! Looking down at the pendant, $name bites his lip.

On one side, it looks dangerous. What did the lion say before about taking his place...? On the other side, it could be useful for navigating the tower, as well as to keep the lion nice and friendly.

Apparently tired of waiting, the lion starts stepping forward, raising the pendant up and readying it to be put on the wolf&#39;s neck. A decision on how to approach this must be taken now.

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
      &lt;li&gt;[[Let the lion put the pendant on.|Mind Capture]]&lt;/li&gt;
    &lt;li&gt;[[Refuse the pendant.|Lion Refusal]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;\</tw-passagedata><tw-passagedata pid="72" name="Mind Capture" tags="end" position="1325,3225" size="100,100">&lt;&lt;include &quot;Mind Capture (Text)&quot;&gt;&gt;

&lt;span class=&quot;bad-ending&quot;&gt;Bad Ending: &lt;i&gt;Enthrallment&lt;/i&gt;&lt;/span&gt;

[[Continue|Mind Capture 2]]</tw-passagedata><tw-passagedata pid="73" name="Lion Refusal" tags="" position="1200,3350" size="100,100">There&#39;s no way $name is letting this lion put some magic gadget on him without him knowing what it is, especially coming from someone like that panther.

With a growl, $name takes a step back and slaps the lion&#39;s hands to the side.

&quot;I&#39;m not wearing that until you start doing some explaining!&quot; the wolf exclaims, baring his teeth towards the feline.

The lion simply stares at the wolf for a moment. $name half expects the dumb feline to just repeat the same line from before, but he does not.

&quot;The master&#39;s pendant must be worn by his thralls at all times. Visitors are excluded. You are not a visitor.&quot;

The wolf narrows his eyes towards the lion and opens his muzzle to respond, but before he can... It is only &lt;&lt;print $name&gt;&gt;&#39;s warrior reflexes that catch the way the lion positions his feet before he lunges forward that allows the wolf to react in time. Within a moment, the large lion pounces forward at the wolf, tackling him and bringing the pendant up to try and force it up past his neck.

&quot;Get OFF me!&quot; the wolf growls. The wolf&#39;s arms come up to hold the lion&#39;s as the feline tries to grab and take hold of him. Bringing his leg up to hit the lion in the ribs, $name manages to avoid having the pendant forced upon him by the grabbing feline. Although his expression never seems to change, the lion does grunt at the hit and retreats with a step back.

The feline&#39;s eyes remain locked with the wolf, though. It seems the lion does not intend on backing down from putting that necklace on $name, which makes the wolf even more sure that not accepting it was the right choice.

Now, however, he has to face a large lion warrior...

The wolf&#39;s eyes scan the room around him for weapons or ways to subdue the lion. Unfortunately, there is hardly anything that could make for a useful weapon or tool, but at one corner, there is a &lt;span class=&quot;imp-info&quot;&gt;bundle of old rope&lt;/span&gt; that could be used to tie the bastard up and keep him quiet, at least.

After all, Ivex could still return at any minute or hear something if things get too loud...

[[Continue|Lion Fight]]</tw-passagedata><tw-passagedata pid="74" name="Lion Fight" tags="" position="1200,3475" size="100,100">&lt;&lt;include &quot;Lion Fight (Text)&quot;&gt;&gt;

[[Continue|Lion Pindown]]</tw-passagedata><tw-passagedata pid="75" name="Lion Pindown" tags="" position="1200,3600" size="100,100">&lt;&lt;include &quot;Lion Pindown (Text)&quot;&gt;&gt;
&lt;&lt;if $arousalLevel == 1&gt;&gt;\

The candle&#39;s lingering influence... it must be that, but... It&#39;s so hard to resist. This damned lion, one of Ivex&#39;s thralls, gave him so much trouble. He&#39;s asking for it. Looking down at the feline&#39;s tender hole, the wolf&#39;s cock throbs. As he keeps squirming, the lion&#39;s backside gets matted with the lupine&#39;s pre-cum. $name huffs, his eyes growing wide with lust and desire. Maybe... Maybe he could...
&lt;&lt;elseif $arousalLevel == 2&gt;&gt;\

The candle&#39;s lingering influence... it drives the wolf crazy, It&#39;s so hard to resist. This damned lion, one of Ivex&#39;s thralls, gave him so much trouble. He&#39;s asking for it. Looking down at the feline&#39;s tender hole, the wolf&#39;s cock pulses with life. As he keeps squirming, the lion&#39;s backside gets matted with the lupine&#39;s pre-cum. $name huffs, his eyes growing wide with lust and desire. It&#39;s right there, ripe for the taking...
&lt;&lt;/if&gt;&gt;\

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
      &lt;li&gt;[[Fight the urge. Tie the lion up and be done with it.|Lion Bondage]]&lt;/li&gt;
    &lt;li&gt;[[The lion is a defeated thrall. Just a quick fuck to help relieve the urges...|Lion Fucking]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;\</tw-passagedata><tw-passagedata pid="76" name="Lion Bondage" tags="key" position="1000,3800" size="100,100">&lt;&lt;set $end07 = false&gt;&gt;\
Reaching for the rope, it is only a matter of holding the lion down while forcing his arms back to tie them behind his back. Once that is done, the wolf plays it safe by doing the same to his legs and finishing with the lion in a tight hogtie.

Very satisfied with his work, the wolf smirks, looking down at the feline. He keeps struggling, not too intensely, but rather with a mild yet continuous amount of effort the whole time.

&quot;The master&#39;s pendant must be worn by his thralls at all times. Visitors are excluded. You are not a visitor,&quot; he says up at the wolf, unsurprisingly.
&lt;&lt;if !$journalKnowledge&gt;&gt;\

The wolf just rolls his eyes and steps over him to start searching the room. There are cabinets and cabinets of nothing but potions, some of them very suspicious-looking. The only thing of note the wolf is able to find in that room is the drawer full of &lt;span class=&quot;imp-info&quot;&gt;dim gemstones&lt;/span&gt;, yet after picking them up and looking them over, it is unclear if they can be of any use.
&lt;&lt;/if&gt;&gt;\

Attempting to speak to the lion is utterly useless. No matter what the wolf tries asking him, his response is always the same:

&quot;The master&#39;s pendant must be worn by his thralls at all times. Visitors are excluded. You are not a visitor.&quot;

Annoyed with it, the wolf&#39;s last idea is to try and remove the pendant the lion wears, as he does, however, the lion struggles more to avoid it. Still, bound as he is, he&#39;s no match for the big wolf, however...

As soon as the wolf tries to pull the pendant from around the lion&#39;s neck, it just... doesn&#39;t budge. It feels as if it&#39;s blocked by something invisible. No matter how much the wolf pulls, the pendant will not go past the lion&#39;s neckline. Tearing the cord does not work either. No matter how frail and worn it looks, the thing does not break no matter what.

After exhausting his options, the wolf just grunts and gives up. The lion looks up at him and repeats his sentence once more.

&quot;The master&#39;s pendant must be worn-&quot;

The wolf interrupts the mindless lion&#39;s annoying blabbering by shoving a piece of rope between his teeth. The lion continues to talk, his words now muffled, even while the wolf ties it behind his head to serve as a gag. Better not let him shout for help or draw attention.

&lt;&lt;if $journalKnowledge&gt;&gt;\
Smiling, the wolf looks down at the bound lion. With him out of the way, there is nothing stopping $name from taking what he needs. Stepping over the wiggling feline, the naked wolf gladly makes his way to the drawer full of gemstones and opens it.

Empty gemstones. One of the materials needed to create his way out according to Ivex&#39;s journal. The wolf&#39;s tail wags back and forth with satisfaction.
&lt;&lt;set $lionGemstoneKnowledge = true&gt;&gt;\
&lt;&lt;if $spellbookKnowledge&gt;&gt;\

Knowing where Ivex&#39;s spellbook is, the wolf eagerly grabs a handful of those gemstones and makes his way back to the other room. 

He is ready to try and craft the key to his escape.

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
      [[Try and craft the red gemstone.|Gemstone Crafting]]
  &lt;/ul&gt;\
&lt;/div&gt;
&lt;&lt;else&gt;&gt;\

[[Continue|Second Floor]]
&lt;&lt;/if&gt;&gt;\
&lt;&lt;else&gt;&gt;\
Sighing, the wolf looks down at the bound lion. In the end, there wasn&#39;t anything particularly useful in this room, but at least Ivex&#39;s servant is neutralized. He should not be a problem anymore.

All the wolf can do for now is return to the hallway and explore the rest of this floor.
&lt;&lt;set $lionGemstoneKnowledge = true&gt;&gt;\

[[Continue|Second Floor]]
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="77" name="Lion Fucking" tags="" position="1350,3600" size="100,100">&lt;&lt;include &quot;Lion Fucking (Text)&quot;&gt;&gt;
&lt;&lt;if $arousalLevel &gt;= 2&gt;&gt;\

But there&#39;s no decision to be made. After being exposed to that candle for so long, the wolf&#39;s body is mad with arousal. He needs to knot, he &lt;b&gt;needs&lt;/b&gt; to, and with a huff of mad lust, he starts working towards it...
&lt;&lt;/if&gt;&gt;\

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
    &lt;&lt;if $arousalLevel &lt; 2&gt;&gt;\
      &lt;li&gt;[[Resist knotting him.|Lion Finish]]&lt;/li&gt;
    &lt;&lt;else&gt;&gt;\
    &lt;li&gt;[[Knot him!|Lion Knotting]]&lt;/li&gt;
    &lt;&lt;/if&gt;&gt;\
  &lt;/ul&gt;\
&lt;/div&gt;\</tw-passagedata><tw-passagedata pid="78" name="Lion Finish" tags="" position="1250,3750" size="100,100">Gritting his teeth, it takes every ounce of effort from the wolf to, instead of shoving his knot into that damned lion hard as he wants to, reach down to his knot with his own paw and give it a hard squeeze.

$name moans out loud. That&#39;s what he needs, that&#39;s what any wolf needs, to drive him crazy and past the point of no return. With pleasure overcoming him, the wolf&#39;s cock throbs, shoved deep inside the lion save for the knot, to start depositing the wolf&#39;s mark deep into the other male.

It feels really good. After being tortured with unbridled lust for so long, getting to relieve himself in a tight, tender ass like that is everything the wolf could want and more. Jet after jet of wolf seed is deposited into the lion&#39;s backside while the wolf enjoys his pleasure.

The lion, on the other hand, reacts to it with little more than a grunt. He still tries to get out of the pin, as usual, but the wolf has no trouble keeping the lion&#39;s arm against his back even as the wolf enjoys the pleasure of a mind-blowing orgasm. Due to the lack of knotting, it doesn&#39;t take long for his seed to overflow and start leaking down the lion&#39;s taint even with his cock still thick and hard into the lion&#39;s backside.

As $name pulls back, seeing his own seed drip down the large, defeated lion&#39;s ass down his taint and the back of his balls, brings him pleasure. His cock, however... As expected, despite how good the relief felt, the lupine member continues hard as a rock, knot inflated and feeling ready for more. The wolf contemplates for a brief moment shoving it back in. His own cum would probably make for good lubrication for a second round...

But, no! He&#39;s wasted enough time as it is! Ivex could return at any time. Looking at the rope, the wolf takes a deep breath and prepares to do what he must.

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
      &lt;li&gt;[[Tie the lion up and be done with it.|Lion Bondage]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;\</tw-passagedata><tw-passagedata pid="79" name="Lion Knotting" tags="" position="1475,3600" size="100,100">&lt;&lt;if !$enthrallmentLion&gt;&gt;\
&lt;&lt;set $enthrallmentLionUnlock = true&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;include &quot;Lion Knotting (Text)&quot;&gt;&gt;

[[Continue|Mind Capture (Knot)]]</tw-passagedata><tw-passagedata pid="80" name="Mind Capture (Knot)" tags="" position="1600,3600" size="100,100">&lt;&lt;include &quot;Mind Capture (Knot) (Text)&quot;&gt;&gt;

&lt;span class=&quot;bad-ending&quot;&gt;Bad Ending: &lt;i&gt;Enthrallment&lt;/i&gt;&lt;/span&gt;

[[Continue|Mind Capture 2]]</tw-passagedata><tw-passagedata pid="81" name="Mind Capture 2" tags="" position="1450,3225" size="100,100">&lt;&lt;include &quot;Mind Capture 2 (Text)&quot;&gt;&gt;

[[Continue|Enthrallment 1]]</tw-passagedata><tw-passagedata pid="82" name="Enthrallment 1" tags="" position="1575,3225" size="100,100">&lt;&lt;include &quot;Enthrallment 1 (Text)&quot;&gt;&gt;

[[Continue|Enthrallment 2]]</tw-passagedata><tw-passagedata pid="83" name="Enthrallment 2" tags="" position="1700,3225" size="100,100">&lt;&lt;if !$enthrallmentEnding&gt;&gt;\
&lt;&lt;set $enthrallmentEndingUnlock = true&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;include &quot;Enthrallment 2 (Text)&quot;&gt;&gt;

&lt;span class=&quot;bad-ending&quot;&gt;Bad Ending: &lt;i&gt;Enthrallment&lt;/i&gt;&lt;/span&gt;

[[Continue|Enthrallment End]]</tw-passagedata><tw-passagedata pid="84" name="Enthrallment End" tags="end" position="1800,2875" size="100,100">$name became Ivex&#39;s thrall.

&lt;&lt;if $enthrallmentEndingUnlock&gt;&gt;\
&lt;&lt;set MT.mdSet(&quot;enthrallmentEnding&quot;, true)&gt;&gt;\
&lt;&lt;set $enthrallmentEndingUnlock = false&gt;&gt;\
The &lt;span class=&quot;imp-info&quot;&gt;Bad Ending: Enthrallment&lt;/span&gt; is unlocked in the Archive!
&lt;&lt;/if&gt;&gt;\
&lt;&lt;if $enthrallmentLionUnlock&gt;&gt;\
&lt;&lt;set MT.mdSet(&quot;enthrallmentLion&quot;, true)&gt;&gt;\
&lt;&lt;set $enthrallmentLionUnlock = false&gt;&gt;\
The &lt;span class=&quot;imp-info&quot;&gt;Lion variant&lt;/span&gt; for Bad Ending: Enthrallment is unlocked in the Archive!
&lt;&lt;/if&gt;&gt;\

To change the adventurer&#39;s fate, you can...

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\  
      &lt;li&gt;[[Return to the point of escaping the first floor.|Escape Start]]&lt;/li&gt;
      &lt;li&gt;&lt;&lt;link &quot;Return to the beginning of the game&quot;&gt;&gt;
        &lt;&lt;run Engine.restart()&gt;&gt;
      &lt;&lt;/link&gt;&gt;&lt;/li&gt;  &lt;/ul&gt;\
&lt;/div&gt;</tw-passagedata><tw-passagedata pid="85" name="Archives" tags="noreturn" position="2400,700" size="100,100">&lt;&lt;sidebar-auto-stow&gt;&gt; \
@@.meta-text;&lt;&lt;link &quot;Return to the game&quot; $return&gt;&gt;&lt;&lt;/link&gt;&gt;@@\
\
&lt;h1 class=meta-text&gt;Archives&lt;/h1&gt;\
Welcome to the Mage&#39;s Tower Archives.

Here you can revisit the different endings the adventurer has met in his time in the Mage&#39;s Tower. When the adventurer goes through an ending in the game for the first time, it will be unlocked here to be revisited at any time. If an ending has different variations due to the adventurer&#39;s choices during the game, these also can be set here, provided they have been seen before.

Grayed out endings are paths that have not yet been found, although there are hints under them as to what path the adventurer should take to reach them. The same applies to different variations of endings.

Saved games will remember all the endings you&#39;ve unlocked. Loading a saved game may unlock more endings, but it will not re-lock anything already unlocked.

&lt;hr&gt;\
&lt;h2&gt;Endings unlocked:&lt;/h2&gt;\
&lt;&lt;include [[Interrogation Archive Display]]&gt;&gt;\
\
&lt;&lt;include [[Enthrallment Archive Display]]&gt;&gt;\
\
&lt;&lt;include [[Extraction Archive Display]]&gt;&gt;\
\
&lt;&lt;include [[Ivex Punishment Archive Display]]&gt;&gt;\
\
&lt;&lt;include [[Ivex Enthrallment Archive Display]]&gt;&gt;\
\
&lt;&lt;include [[Ivex Extraction Archive Display]]&gt;&gt;\
&lt;hr&gt;\
&lt;&lt;link &quot;Lock all the Archives&quot;&gt;&gt;
  &lt;&lt;script&gt;&gt;
    Dialog.setup(&quot;Confirm lock Archives&quot;);
    Dialog.wiki(&quot;&lt;&lt;include [[g1m Archives Forget]]&gt;&gt;&quot;);
    Dialog.open();
  &lt;&lt;/script&gt;&gt;
&lt;&lt;/link&gt;&gt;
&lt;&lt;link &quot;Return to the game&quot; $return&gt;&gt;&lt;&lt;/link&gt;&gt;</tw-passagedata><tw-passagedata pid="86" name="The Desk" tags="" position="900,4350" size="100,100">&lt;&lt;if $theDesk&gt;&gt;\
The only interesting things the wolf can see on the desk are the &lt;span class=&quot;imp-info&quot;&gt;thick book&lt;/span&gt; and the &lt;span class=&quot;imp-info&quot;&gt;journal&lt;/span&gt;.
&lt;&lt;else&gt;&gt;\
&lt;&lt;set $theDesk = true&gt;&gt;\
$name decides to approach the desk full of books and paperwork to take a closer look.

The wolf pushes the chair away and stands in front of it. His active erection brushes against its corner, making the adventurer growl and shift uncomfortably. The thought that all this humiliation he is going through comes from the mage...

With a soft growl, the wolf&#39;s paw just curls into a fist and he pushes such thoughts away to focus on the contents of the desk.

It&#39;s filled with writing supplies and they seem like they were used recently. The larger book that lies closed near the center of the desk draws the most attention. It&#39;s a thick tome.

Though there are other books of varied titles spread over the desk, they all seem like regular books used for studying or research, none of which $name has any interest in. There is one more book that draws the wolf&#39;s attention, however. This one has no cover and no title. The remnants of ink at its corner indicate that Ivex must have been writing in it rather than just reading from it. It looks like some kind of &lt;span class=&quot;imp-info&quot;&gt;journal&lt;/span&gt;.

If they belong to Ivex, they might be worth checking out.
&lt;&lt;/if&gt;&gt;\

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
    &lt;&lt;if !$theJournal&gt;&gt;\
    &lt;li&gt;[[Examine the journal.|The Journal]]&lt;/li&gt;
    &lt;&lt;else&gt;&gt;\
    &lt;li&gt;[[Examine the journal again.|Journal Notes]]&lt;/li&gt;
    &lt;&lt;/if&gt;&gt;\
    &lt;&lt;if !$spellbookKnowledge&gt;&gt;\
      &lt;li&gt;[[Examine the large book.|The Spellbook]]&lt;/li&gt;
    &lt;&lt;/if&gt;&gt;\	
    &lt;li&gt;[[Go try something else.|Extraction Room]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;</tw-passagedata><tw-passagedata pid="87" name="The Altar" tags="" position="800,4000" size="100,100">&lt;&lt;if $thePlatform&gt;&gt;\
$name approaches the altar at the center of the room to take a closer look once more.

The strange blob rests over the altar as before, unmoving. Inside it, the red glowing gemstone still floats harmlessly near the altar&#39;s surface.

Inspecting it further would mean touching it or fiddling with it, but it being an unknown magical thing, the wolf is not sure if that is wise or not.
&lt;&lt;else&gt;&gt;\
&lt;&lt;set $thePlatform = true&gt;&gt;\
$name approaches the altar at the center of the room to take a closer look.

Standing right next to it, the naked wolf can&#39;t help but feel somewhat uncomfortable. From up-close, the blob is indeed not like water. It looks more... viscous, and while it sits still on the platform, the wolf can swear it moves every now and then. Just a twitch here, a ripple there... On top of all, it doesn&#39;t seem to be held by anything. This blob of... whatever it is made of, just stands still on the altar doing nothing.

The wolf can also see that there&#39;s something &lt;b&gt;inside&lt;/b&gt; the blob of strange slime. Squinting his eyes to see through the viscous-looking liquid, it looks like... a gemstone? Yes, a pristine-looking red gemstone that floats near its bottom. It seems to emit a faint glow that is visible even through the liquid.
&lt;&lt;if $journalKnowledge&gt;&gt;\

&lt;&lt;print $name&gt;&gt;&#39;s eyes go wide! That must be the &lt;span class=&quot;imp-info&quot;&gt;red gemstone that the fox thief lost when he got captured&lt;/span&gt; according to Ivex&#39;s journal! If he can grab that, he should be able to escape! An urge to just reach in and take it surges within the wolf, but he stops himself. This thing is weird. It would be wise to be careful around it before rushing into anything.
&lt;&lt;/if&gt;&gt;\

The wolf decides to walk around it to inspect the blob from all sides. It has a weird oval shape and, on top of all, it&#39;s big. The altar is large enough so that it seems like a person could comfortably lie on it, but the blob takes most of its space. It&#39;s like some kind of giant, see-through egg.

The wolf sniffs towards it, but its smell is very weak. When $name is almost giving up on finding anything interesting about this thing, the wolf finally notices something. Not on the blob, but on the altar beneath it. It seems to be made of stone, which is strange enough, but since the blob is see-through, from this close the wolf notices for the first time that there is a small hole near the middle of the altar. About the size of two fingers.

The blob, even though it appears to be somewhat liquid-like, does not slip into the hole, though. With the blob on top, it&#39;s almost impossible to see where the small hole goes.

Unfortunately, there isn&#39;t much more to this thing. It must have some kind of purpose, but what it could be, $name can only guess. The only thing the lupine hasn&#39;t done yet is touch the thing. He brings a finger up, curious about how it feels, but hesitates. It does seem simple to just reach into it and grab the gem, but at the same time, one of the most basic rules of adventuring comes to his mind. &#39;Don&#39;t touch magical objects you don&#39;t know&#39;.

Still, it looks absolutely harmless.
&lt;&lt;set $blobGemstoneKnowledge = true&gt;&gt;\
&lt;&lt;/if&gt;&gt;\

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
      &lt;li&gt;[[Touch the substance.|Pulled In]]&lt;/li&gt;
    &lt;li&gt;[[Go back to try something else.|Extraction Room]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;</tw-passagedata><tw-passagedata pid="88" name="Pulled In" tags="" position="925,4000" size="100,100">&lt;&lt;include &quot;Pulled In (Text)&quot;&gt;&gt;

[[Continue|Pulled Further]]</tw-passagedata><tw-passagedata pid="89" name="Pulled Further" tags="end" position="1050,4000" size="100,100">&lt;&lt;include &quot;Pulled Further (Text)&quot;&gt;&gt;

&lt;span class=&quot;bad-ending&quot;&gt;Bad Ending: &lt;i&gt;Extraction&lt;/i&gt;&lt;/span&gt;

[[Continue|Extraction 1]]</tw-passagedata><tw-passagedata pid="90" name="Extraction 1" tags="" position="1175,4000" size="100,100">&lt;&lt;include &quot;Extraction 1 (Text)&quot;&gt;&gt;

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
      &lt;li&gt;[[&quot;Hmmfgh!!&quot;|Extraction 2]]&lt;/li&gt;
    &lt;li&gt;[[&quot;Hmmfffhhg?!&quot;|Extraction 2]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;</tw-passagedata><tw-passagedata pid="91" name="Extraction 2" tags="" position="1300,4000" size="100,100">&lt;&lt;include &quot;Extraction 2 (Text)&quot;&gt;&gt;

[[Continue|Extraction 3]]</tw-passagedata><tw-passagedata pid="92" name="Extraction 3" tags="" position="1425,4000" size="100,100">&lt;&lt;include &quot;Extraction 3 (Text)&quot;&gt;&gt;

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
      &lt;li&gt;[[&quot;Hmmrrrrhfgh!!!&quot;|Forceful Extraction 1]]&lt;/li&gt;
    &lt;li&gt;[[&quot;Hmmmffh...&quot;|Gentle Extraction 1]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;</tw-passagedata><tw-passagedata pid="93" name="Forceful Extraction 1" tags="" position="1550,4050" size="100,100">&lt;&lt;set $forcefulExtraction = true&gt;&gt;\
&lt;&lt;include &quot;Forceful Extraction 1 (Text)&quot;&gt;&gt;

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
      &lt;li&gt;[[&quot;HMMRFGH!!!&quot;|Forceful Extraction 2]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;</tw-passagedata><tw-passagedata pid="94" name="Gentle Extraction 1" tags="" position="1550,3925" size="100,100">&lt;&lt;set $forcefulExtraction = false&gt;&gt;\
&lt;&lt;include &quot;Gentle Extraction 1 (Text)&quot;&gt;&gt;

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
      &lt;li&gt;[[&quot;Hmmmmfffgghh...!&quot;|Gentle Extraction 2]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;</tw-passagedata><tw-passagedata pid="95" name="Forceful Extraction 2" tags="" position="1675,4050" size="100,100">&lt;&lt;include &quot;Forceful Extraction 2 (Text)&quot;&gt;&gt;

[[Continue|Forceful Extraction 3]]</tw-passagedata><tw-passagedata pid="96" name="Forceful Extraction 3" tags="" position="1800,4050" size="100,100">&lt;&lt;include &quot;Forceful Extraction 3 (Text)&quot;&gt;&gt;

[[Continue|Forceful Extraction End]]</tw-passagedata><tw-passagedata pid="97" name="Forceful Extraction End" tags="" position="1925,4050" size="100,100">&lt;&lt;include &quot;Forceful Extraction End (Text)&quot;&gt;&gt;

[[Continue|Extraction End 1]]</tw-passagedata><tw-passagedata pid="98" name="Extraction End 1" tags="" position="2050,3975" size="100,100">&lt;&lt;include &quot;Extraction End 1 (Text)&quot;&gt;&gt;

&lt;&lt;if $forcefulExtraction&gt;&gt;\
[[Continue|Forceful Extraction End 2]]
&lt;&lt;else&gt;&gt;\
[[Continue|Gentle Extraction End 2]]
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="99" name="Forceful Extraction End 2" tags="" position="2175,4050" size="100,100">&lt;&lt;if !$extractionEnding&gt;&gt;\
&lt;&lt;set $extractionEndingUnlock = true&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;if !$extractionForcefulEnd&gt;&gt;\
&lt;&lt;set $extractionForcefulEndUnlock = true&gt;&gt;\
&lt;&lt;/if&gt;&gt;\

&lt;&lt;include &quot;Forceful Extraction End 2 (Text)&quot;&gt;&gt;

[[Continue|Extraction End 2]]</tw-passagedata><tw-passagedata pid="100" name="Extraction End 2" tags="end" position="2525,3575" size="100,100">$name remained trapped serving as fuel for Ivex&#39;s magic.

&lt;&lt;if $extractionEndingUnlock&gt;&gt;\
&lt;&lt;set MT.mdSet(&quot;extractionEnding&quot;, true)&gt;&gt;\
&lt;&lt;set $extractionEndingUnlock = false&gt;&gt;\
The &lt;span class=&quot;imp-info&quot;&gt;Bad Ending: Extraction&lt;/span&gt; is unlocked in the Archive!
&lt;&lt;/if&gt;&gt;\
&lt;&lt;if $extractionGentleEndUnlock&gt;&gt;\
&lt;&lt;set MT.mdSet(&quot;extractionGentleEnd&quot;, true)&gt;&gt;\
&lt;&lt;set $extractionGentleEndUnlock = false&gt;&gt;\
The &lt;span class=&quot;imp-info&quot;&gt;Gentle variant&lt;/span&gt; for Bad Ending: Extraction is unlocked in the Archive!
&lt;&lt;/if&gt;&gt;\
&lt;&lt;if $extractionForcefulEndUnlock&gt;&gt;\
&lt;&lt;set MT.mdSet(&quot;extractionForcefulEnd&quot;, true)&gt;&gt;\
&lt;&lt;set $extractionForcefulEndUnlock = false&gt;&gt;\
The &lt;span class=&quot;imp-info&quot;&gt;Forceful variant&lt;/span&gt; for Bad Ending: Extraction is unlocked in the Archive!
&lt;&lt;/if&gt;&gt;\

To change the adventurer&#39;s fate, you can...

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\  
      &lt;li&gt;[[Return to the point of escaping the first floor.|Escape Start]]&lt;/li&gt;
      &lt;li&gt;&lt;&lt;link &quot;Return to the beginning of the game&quot;&gt;&gt;
        &lt;&lt;run Engine.restart()&gt;&gt;
      &lt;&lt;/link&gt;&gt;&lt;/li&gt;  &lt;/ul&gt;\
&lt;/div&gt;</tw-passagedata><tw-passagedata pid="101" name="Gentle Extraction End 2" tags="" position="2175,3925" size="100,100">&lt;&lt;if !$extractionEnding&gt;&gt;\
&lt;&lt;set $extractionEndingUnlock = true&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;if !$extractionGentleEnd&gt;&gt;\
&lt;&lt;set $extractionGentleEndUnlock = true&gt;&gt;\
&lt;&lt;/if&gt;&gt;\

&lt;&lt;include &quot;Gentle Extraction End 2 (Text)&quot;&gt;&gt;

[[Continue|Extraction End 2]]</tw-passagedata><tw-passagedata pid="102" name="Gentle Extraction 2" tags="" position="1675,3925" size="100,100">&lt;&lt;include &quot;Gentle Extraction 2 (Text)&quot;&gt;&gt;

[[Continue|Gentle Extraction 3]]</tw-passagedata><tw-passagedata pid="103" name="Gentle Extraction 3" tags="" position="1800,3925" size="100,100">&lt;&lt;include &quot;Gentle Extraction 3 (Text)&quot;&gt;&gt;

[[Continue|Gentle Extraction End]]</tw-passagedata><tw-passagedata pid="104" name="Gentle Extraction End" tags="" position="1925,3925" size="100,100">&lt;&lt;include &quot;Gentle Extraction End (Text)&quot;&gt;&gt;

[[Continue|Extraction End 1]]</tw-passagedata><tw-passagedata pid="105" name="Interrogation Archive" tags="noreturn" position="1700,1100" size="100,100">&lt;&lt;include &quot;Ivex Torture 1 (Text)&quot;&gt;&gt;

&lt;&lt;include &quot;Ivex Torture 2 (Text)&quot;&gt;&gt;

&lt;&lt;if $interrogationEnd == &quot;rough&quot;&gt;&gt;\
The wolf&#39;s only response is to growl towards the mage in defiance.

&lt;&lt;include &quot;Hard Way (Text)&quot;&gt;&gt;

The wolf spits towards Ivex in response to show his distaste.

&lt;&lt;include &quot;Defiance (Text)&quot;&gt;&gt;
&lt;&lt;elseif $interrogationEnd == &quot;mild&quot;&gt;&gt;\
The wolf&#39;s only response is to shamefully splay his ears in submission.

&lt;&lt;include &quot;Easy Way (Text)&quot;&gt;&gt;

The wolf chooses to remain silent with nothing but a low growl towards the mage.

&lt;&lt;include &quot;Resistance (Text)&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;\

&lt;&lt;if $interrogationSpell == &quot;freeze&quot;&gt;&gt;\
&quot;Yes, I come from the far north, so what?&quot; the wolf asks.

&lt;&lt;include &quot;Ice (Text)&quot;&gt;&gt;

&lt;&lt;include &quot;Ice 2 (Text)&quot;&gt;&gt;

&lt;&lt;include &quot;Ice 3 (Text)&quot;&gt;&gt;
&lt;&lt;elseif $interrogationSpell == &quot;shock&quot;&gt;&gt;\
&quot;No, I come from the south, so what?&quot; the wolf asks.

&lt;&lt;include &quot;Shock (Text)&quot;&gt;&gt;

&lt;&lt;include &quot;Shock 2 (Text)&quot;&gt;&gt;

&lt;&lt;include &quot;Shock 3 (Text)&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;\

&lt;&lt;include &quot;Extra Torture (Text)&quot;&gt;&gt;

&lt;&lt;if $interrogationEnd == &quot;rough&quot;&gt;&gt;\
&quot;You thought you could fight me. You thought you had a chance of escaping. Of beating me. Hah! How wrong were you, hmm?&quot; the mage laughs. He grips the wolf&#39;s knot and gives it a painful squeeze. Enough to force a muffled whine. &quot;I did not forget your defiance, though. You will now see what your hopeless fighting and bravery brings upon you...&quot;

&lt;&lt;include &quot;Defiant End (Text)&quot;&gt;&gt;
&lt;&lt;elseif $interrogationEnd == &quot;mild&quot;&gt;&gt;\
&quot;You&#39;ve been such a good boy, all things considered...&quot; the panther muses, caressing the wolf&#39;s knot. His hand grips the wolf&#39;s member more firmly, starting to stroke it in a pleasurable way. &quot;I&#39;ll be pleased to have someone like you by my side. I&#39;ve been needing more thralls, and I only accept handsome ones. Oh, the pleasures you will feel... too bad you won&#39;t be quite as aware of them...&quot;

&lt;&lt;include &quot;Compliant End (Text)&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;\

&lt;span class=&quot;bad-ending&quot;&gt;Bad Ending: &lt;i&gt;Interrogation&lt;/i&gt;&lt;/span&gt;

[[Return to the Archives|Archives]]</tw-passagedata><tw-passagedata pid="106" name="Ivex Torture 1 (Text)" tags="text" position="1100,1925" size="100,100">The mage hums to himself as he takes the time to casually walk around the wolf, observing him from all sides. $name can&#39;t help but keep desperately pulling against the restraints. The wolf&#39;s cock flexes, dripping pre-cum almost constantly now from the overwhelming arousal he&#39;s subjected to.

&quot;Look at you... barely more than a feral beast now, slave to your baser instincts...&quot; the mage mocked. &quot;What would your fellow adventurers say if they could see you now? Bound, drooling, wanting to get out just so that you can pleasure yourself relentlessly...&quot;

The panther stops right in front of the wolf again. He looks at the wolf&#39;s member and, once more, seems to take extreme delight in just touching it, caressing it with a finger or two, all to make $name howl with need.

&quot;Unfortunately, as amusing as it is to have you in this state, we need to dial it down just a little bit. Don&#39;t worry, it won&#39;t be nearly enough for you to stop suffering, but I want you fully conscious so that you can properly... experience everything I have in mind.&quot;

With a snap of his fingers, the cursed candle burning by their side is snuffed out of nowhere.

Its arousing scent lingers for a few more moments, but soon enough the wolf&#39;s breathing starts to feel softer. Clearer. It felt indeed as if he had been breathing fire itself and now, finally, fresh air was coming to his nose again.

Still panting, $name finally stops struggling and lets himself relax against his bonds for a moment. He realizes how sore all of his muscles are from the continuous desperate effort. Everything aches. Even as his mind clears up to some extent, however, the burning fire of arousal within him doesn&#39;t subside. It merely stops growing. His cock still remains fully hard, knot engorged and everything, and just looking at it makes his heart race with an urge to touch it.

At least the wolf has enough awareness back to know he won&#39;t be able to, while bound as he is. And to worry about the panther standing in front of him.

Ivex pulls the cloth covering his nose down as well to reveal his large grin.

&quot;Now that you&#39;re back with me... shall we begin?&quot;</tw-passagedata><tw-passagedata pid="107" name="Ivex Torture 2 (Text)" tags="text" position="1225,1925" size="100,100">The mage brings both his hands up. A few precise movements are made and $name can see the panther&#39;s eyes glow for a moment. Ivex mutters some words under his breath and then the creaking sound of a chest opening comes from behind the bound wolf. From there, a small crystal comes floating to Ivex with remarkable speed, which he promptly catches with ease and holds up.

&quot;This is a gravity crystal. Handy things, those are. You can bind their energy and attach them to anything. They have many practical uses, but I&#39;m going to show you one of my favorites.&quot; Ivex took a step forward.

&quot;Whatever you&#39;re planning, it&#39;s not gonna fucking work!&quot; $name growls down at the mage. He pulls at the binds just as a display of his strength. His muscles bulge, but of course, the leather doesn&#39;t budge.

Ivex, however, just stops and smiles up at the wolf. &quot;Oh, we&#39;ll see about that.&quot;

The mage touches the crystal with his finger. The touch alone is enough for it to start glowing and emitting a strange hum. Then, Ivex grins up at the wolf and brings the crystal up... towards the wolf&#39;s groin.

$name grows concerned. His erection pulses with just the thought of Ivex touching him again and he can&#39;t tell if he hopes that he does that or not. Ivex&#39;s finger, however, does not come for the wolf&#39;s aching member this time but rather touches the very center of the wolf&#39;s long-hanging, furry balls. A tingle can be felt on them as he does, and that is enough to make the lupine growl anew. Feeling the mage touch his most precious, vulnerable assets is enough to make the urge to punch him almost as big as his urge to jerk off!

At first, nothing happens, but Ivex still holds the crystal close to the wolf&#39;s sack. It glows for a few more moments, then the glow vanishes. Still, nothing happens, and the nervous wolf looks at Ivex, who grins up at him once more and then, finally...

The mage lets go of the crystal.

As soon as he does, the crystal starts falling, but instead of falling all the way to the ground...

&quot;Hmmfgh!&quot; the wolf grunts. &lt;&lt;print $name&gt;&gt;&#39;s whole body tenses up when, instead of falling as it should, the crystal remains in the air between his legs. Not floating, but rather acting as if it was attached... to his balls. The wolf feels the small crystal pulling his balls away from his body, acting as a weight attached to them. It definitely feels much heavier than it looks as well, at least when it&#39;s the wolf&#39;s nuts that have to bear its weight...

&quot;And you know the best part? I can change their weight at will as well,&quot; Ivex mused. With a hand gesture near the crystal, the wolf let out a new grunt. The crystal grew visibly heavier, pulling the bound wolf&#39;s balls further down in an extremely uncomfortable way.

Ivex chuckles in a way of mocking. &quot;See how utterly helpless you are before me? And this is just the beginning. You will tell me everything I want to know and more.&quot; The panther went back to grinning. &quot;Now, little wolf, are we doing this the easy way or the hard way?&quot;

The weight on the wolf&#39;s balls feels heavy. It tugs at them uncomfortably and, even though it has only been a few seconds, it already starts to feel a little painful to hold the crystal with his nuts alone. Ivex stares at the wolf with a cocky smile of superiority waiting for his answer.</tw-passagedata><tw-passagedata pid="108" name="Easy Way (Text)" tags="text" position="1375,1875" size="100,100">&quot;Learning your place I see...&quot; the mage smiles. Even though the wolf says nothing, Ivex seems smart enough to pick up the hesitation in body language.

The panther leans in close, his hand coming to the wolf&#39;s leg to caress it. $name can&#39;t help but draw in a sharp breath as just the caressing near his needy cock is enough to make the wolf&#39;s heartbeat accelerate.

&quot;I reward those that help me, you know? Sure, I haven&#39;t even begun showing you what I can do and... I just can&#39;t resist playing around with a handsome adventurer like you, but if you collaborate with me... I promise your fate will be much, much more pleasant.&quot;

The mage&#39;s hand trails upwards. So close to his member now! Ivex takes half a step back and smiles up at the wolf. There is something in that smile, though. The malicious hint that always accompanies it is still there.

The mage finally takes hold of the wolf&#39;s exposed cock with a paw. The feeling around it alone is enough to make the wolf gasp anew. Though the candle is no longer burning and his mind is mostly his own, his member had never felt so sensitive. Ivex&#39;s fingers around it are enough for it to drool pre-cum all over again. $name can see the veins on his length between Ivex&#39;s fingers, the way his knot throbs in response...

It gets even worse when Ivex starts massaging it ever so lightly with his fingers. The pleasure contrasts with the pain of his balls being so mercilessly pulled by the crystal&#39;s weight.

&quot;I know the Wayward Adventurers Guild sent you. What do they have on me?&quot;

A vague question. The wolf&#39;s knowledge is limited, but any details he tells Ivex could put Guild or whoever else they send after Ivex in the same danger he is facing. Betraying his comrades is something the wolf would never do, and just the fact that Ivex believes he would is an offense in itself.</tw-passagedata><tw-passagedata pid="109" name="Hard Way (Text)" tags="text" position="1375,2200" size="100,100">&quot;Aahh... still so full of fire, aren&#39;t you? Even knowing how small you are next to me?&quot; Ivex says with his usual lingering smile of amusement. &quot;I suppose it&#39;s only fair. I haven&#39;t even begun to show you what I can do to you.&quot;

&lt;&lt;print $name&gt;&gt;&#39;s growling continues. &quot;You wouldn&#39;t stand a fucking chance against a warrior like me if it weren&#39;t for your magic tricks!&quot;

For some reason, that seems to make Ivex&#39;s smile vanish in a heartbeat. The mage frowns looking up at the bound lupine, but just for a moment.

&quot;Very well. I very much prefer it the hard way anyway.&quot;

With but a wave of his hand towards the crystal hanging from the wolf&#39;s balls... its weight feels like it doubled.

&quot;HMMFGH!&quot; Drekkar grits his teeth. His balls feel like they are attached to a solid piece of heavy metal. It pulls on them painfully to the point where the wolf can&#39;t help but tear up.

That brings Ivex&#39;s hateful smile back.

&quot;Perhaps that will serve as a lesson so you can start behaving better. If not, I&#39;ll keep repeating it until you learn. Now... let&#39;s get to the fun part.&quot;

The mage grabs the wolf&#39;s exposed cock with a paw. The feeling around it alone is enough to make the wolf gasp anew. Though the candle is no longer burning and his mind is mostly his own, his member had never felt so sensitive. Ivex&#39;s fingers around it are enough for it to drool pre-cum all over again. $name can see the veins on his length between Ivex&#39;s fingers, the way his knot throbs in response...

It gets even worse when Ivex starts massaging it ever so lightly with his fingers. The pleasure is a terrible contrast to the pain of his balls being so mercifully pulled by the crystal&#39;s weight.

&quot;I know the Wayward Adventurers Guild sent you. What do they have on me?&quot;

A vague question. The wolf&#39;s knowledge is limited, but any details he tells Ivex could put the Guild or whoever else they send after Ivex in the same danger he is facing. Betraying his comrades is something the wolf would never do.</tw-passagedata><tw-passagedata pid="110" name="Resistance (Text)" tags="text" position="1525,2200" size="100,100">&quot;Not willing to tell me, hmm? A shame... such a shame...&quot; Ivex speaks with obviously fake disappointment. In fact, he smiles, the panther&#39;s tail swishing back and forth lazily as a sign of worrying satisfaction and amusement.

$name decides to remain quiet. It is hard enough to endure the weight on his balls on one side and the urge to let out sounds of pleasure as Ivex&#39;s fingers still continue to tease his oversensitive cock. If only that cursed arousal would go away! Looking down at his member, hard as a rock and leaking, a small wave of shame comes over the wolf, but this is all the sick mage&#39;s doing, $name tells himself. Only his doing...

&quot;There are so many things I can do to you... Even the simplest spells will be so much fun and effective right now! What to do... what to do... ah!&quot;

Ivex opens a large, malicious grin.

&quot;Tell me, wolf, your fur is thick. Are you one of those wolves that come from the cold lands? Do you like the snow, the chill in the air? Or do you hate it?&quot;

The panther looks up at $name expectantly. $name can&#39;t help but lower his ears a little in confusion. Where is the mage going with such a stupid question?

As he waits for an answer, Ivex&#39;s hand on the wolf&#39;s cock starts stroking it. It moves up and down the smooth, red length of the wolf&#39;s member, teasing it with gentle, smooth fingers. It makes $name have to grit his teeth harder to suppress a moan. All the arousal that had built up so mercilessly starts bubbling back up with even that light tease, making the waves of sexual pleasure radiate from the wolf&#39;s sensitive member.

It bothers him. Another male is touching his cock just like that and there is nothing he can do about it. In his mind, $name curses his bonds, curses the magic, curses Ivex. Bound with his limbs spread like that and his member forced to be erect... he feels more vulnerable than ever, and he hates it.

The light touch is not enough to satisfy the wolf&#39;s urges, not nearly enough, but it does quickly build up his need. More pre-cum comes. $name does his best not to let Ivex have the pleasure of seeing how much it affects him, but he suspects the mage knows. He knows and is stroking his cock slowly on purpose. The fucker...

&quot;So? Do you like the cold or not? Answer me or I&#39;ll make my own assumptions...&quot; he grins once more.</tw-passagedata><tw-passagedata pid="111" name="Defiance (Text)" tags="text" position="1525,1875" size="100,100">$name spits at the mage to give his response. The panther is fast enough to take a quick step back so that the spit, at best, splashes at his footpaws.

The mage&#39;s smile fades immediately.

&quot;I see. So this is how it will be. Very well.&quot;

The panther, glaring up at the wolf, approaches again. $name growls down at him, pulling against his bindings and wishing with all of his heart he could bite at the panther. Still, there is nothing the wolf can do as Ivex takes hold of the crystal &#39;hanging&#39; from his balls...

Ivex tugs it down. Gently, but with increasing force, and as he does, the wolf&#39;s heavy balls get pulled further and further away from his body. At first, $name tries to keep growling and resist, but as Ivex keeps pulling, a whine becomes unavoidable. The pressure on his nuts is too much!

It feels like the mage pulls on them for far too long before he finally stops, holding the crystal further down with the wolf&#39;s nuts painfully extended.

&quot;Try that again and I&#39;ll take these as a punishment.&quot;

With wet eyes, the growling wolf looked down at Ivex just in time to see him make the crystal glow for a moment, then, as the mage let the small crystal go...

It rockets back up towards the wolf&#39;s balls. Like some sort of elastic, the crystal flies up and hits the lupine&#39;s balls with such an impact that $name gasps in a silent cry. Pain radiates from his struck nuts, reverberating through his whole body. To make matters worse, after striking his balls, the crystal still feels like it&#39;s attached to them and just as heavy. It falls back down, stopped by the wolf&#39;s hurt testicles and bouncing in a few extra tugs before it settles in place as a painful weight again.

It takes several seconds of gasping and panting until the pain from his struck nuts starts subsiding. Ivex, on the other hand, is back to being all smiles. The mage touches the wolf gently, approaching him again as if he hadn&#39;t just inflicted a world of pain on the bound adventurer.

&quot;There are so many things I can do to you... You don&#39;t even know. Even the simplest spells will be so much fun and effective right now! What to do... what to do... ah!&quot;

Ivex opens a large, eerily malicious grin. His punishment is clearly not over yet.

&quot;Tell me, wolf, your fur is thick. Are you one of those wolves that come from the cold lands? Do you like the snow, the chill in the air? Or do you hate it?&quot;

The panther looks up at $name expectantly. $name can&#39;t help but lower his ears a little in confusion. Where is the mage going with such a stupid question?

As he waits for an answer, Ivex&#39;s hand on the wolf&#39;s cock starts stroking it. It moves up and down the smooth, red length of the wolf&#39;s member, teasing it with gentle, smooth fingers. It makes $name have to grit his teeth harder to suppress a moan. All the arousal that had built up so mercilessly starts bubbling back up with even that light tease, making the waves of sexual pleasure radiate from the wolf&#39;s sensitive member.

It bothers him. Another male is touching his cock just like that and there is nothing he can do about it. In his mind, $name curses his bonds, curses the magic, curses Ivex. Bound with his limbs spread like that and his member forced to be erect... he feels more vulnerable than ever, and he hates it.

The light touch is not enough to satisfy the wolf, not nearly enough, but it does quickly build up his need. More pre-cum comes. $name does his best not to let Ivex have the pleasure of seeing how much it affects him, but he suspects the mage knows. He knows and is stroking his cock slowly on purpose. The fucker...

&quot;So? Do you like the cold or not? Answer me or I&#39;ll make my own assumptions...&quot; he grins once more.</tw-passagedata><tw-passagedata pid="112" name="Shock (Text)" tags="text" position="1675,1800" size="100,100">With a chuckle, the panther comes even closer. $name grows stiff and growls seeing the panther leaning against him. With the wolf bound and spread as he is, Ivex has full freedom to press his side against the wolf&#39;s, going as far as leaning his head to rest it against &lt;&lt;print $name&gt;&gt;&#39;s broad chest. The panther&#39;s hand never leaves the wolf&#39;s cock, continuing to stroke and tease it in its way too slow manner, but the mage&#39;s other hand comes to caress the exposed fur of the wolf&#39;s chest.

&quot;Such a big specimen... the big ones are my favorite. Wolves, even more. I wonder what sounds you&#39;ll make...&quot;

&lt;&lt;print $name&gt;&gt;&#39;s growl intensifies. &quot;What are you talking about?!&quot;

&quot;As I said,&quot; Ivex chuckles, &quot;the simplest of spells...&quot;

The mage pulls his hand away from the wolf&#39;s chest and raises it so that the bound lupine can see it. Ivex&#39;s hand looks normal at first, but as he clenches it into a fist and opens it again, it glows blue for a moment, and then...

A spark surges around his paw. It&#39;s subtle at first, a flash of blue that lasts only a split second, but soon another one comes, then another. A crackling sound comes and then, when Ivex curls his fingers, several sparks trail around them in a multitude of flashes. The hand itself looks normal and unaffected, but more and more flashes of lightning appear around it.

Playfully, Ivex brings his hand to the wolf&#39;s chest to touch it again.

&quot;Fuck!!&quot; $name can&#39;t help but curse. He grows stiff as, the moment the tip of Ivex&#39;s claw touches his fur, a painful zap of lightning courses through the bound wolf&#39;s body. His fur stands on end around the touched location on his chest and, while the pain comes and goes in but a second and there doesn&#39;t seem to be any lasting damage, it leaves the wolf stiff and wary of the source of pain.

&quot;See? A very simple spell. And yet it can be so effective when used right...&quot; The mage giggles. He brings his hand up, approaching the wolf&#39;s chest with his lightning-covered finger and threatening to touch it again. $name tenses up, bracing for the incoming pain and growling down at the mage. Unexpectedly, however, the mage&#39;s finger quickly trails to the side towards the wolf&#39;s exposed nipple...

&quot;HNFGH!!!&quot;

The shock feels much, much worse when applied to the wolf&#39;s sensitive nipple. It comes and goes just as fast as before, as thankfully Ivex pulls his finger back with a laugh as soon as the wolf yelps in pain. Still, a lingering feeling remains all over the wolf&#39;s chest. Much to the wolf&#39;s relief, the mage, while still laughing, shakes his hand a few times, and the lightning surrounding it fades away.

$name breathes a small sigh of relief.

Yet Ivex grins again. &quot;Time to have fun with you.&quot;</tw-passagedata><tw-passagedata pid="113" name="Shock 2 (Text)" tags="text" position="1800,1800" size="100,100">The panther&#39;s eyes move back to the wolf&#39;s cock. That hand never stopped teasing it, much to the wolf&#39;s dismay, and the weight on his balls never went away either. Yet, still, as Ivex chuckles again, his hand speeds up. The stroking gets faster. The panther&#39;s hand skillfully strokes and teases the whole of the wolf&#39;s exposed length, going all the way down to the knot, toying with it to make him gasp, then moving back to the dripping tip. He does it a few times, furthering the wolf&#39;s pleasure, and soon $name is panting. The candle did too much. His balls churn and the weight feels more uncomfortable than ever. $name feels like he could cum ten times in a row and one of them is already coming with just that bit of stimulation... until Ivex grins.

&lt;&lt;print $name&gt;&gt;&#39;s eyes start going wide.

&quot;No! NO!&quot; $name exclaims, but there is nothing he can do stop it.

Ivex&#39;s hand continues to stroke his cock, but while the panther&#39;s paw felt soft and delicate before, it now starts to feel... &lt;b&gt;tingly&lt;/b&gt;.

The sparks appear again. Slowly at first, some can be seen at the back of Ivex&#39;s hand, but tingling sensations and weak pinches are also felt over the surface of the wolf&#39;s cock that Ivex holds in that same hand. He doesn&#39;t stop caressing it, stroking it, keeping a firm grip as the lightning starts rising around his hand.

&quot;FUCK!&quot; $name pretty much yells. Ivex is merciful enough to open his hand, letting go of the wolf&#39;s cock for a moment, but then he curls his fingers, touching the sensitive, erect canine length with three of them at once.

&quot;HNNGHGFH!&quot; the wolf grunts. The zaps of lightning feel so, so much worse originating from his sensitive length! The surge around the mage&#39;s hand keeps growing like before, but this time, Ivex does not relent. He keeps touching the wolf&#39;s cock, from below, from above, each touch emitting a zapping sound that is very much felt by the bound lupine in a sharp surge of pain. Yet it also mixes in with the pleasure. His cock flexes each time it&#39;s zapped, a hidden wave of pleasure coming from his loins as well accompanying the pain each time it happens. The pain wins, though, and yet... yet his erection is not going away. Why is it not going away?!

&quot;Isn&#39;t it nice?&quot; Ivex muses. &quot;With how much of that candle you breathed in, I could cause you pain for hours and you would still be hard as a rock. Ready to fuck. Some tribes deep in the jungles use something similar to ensure good mating, did you know that? But even then, this is a perfected formula. Works much faster and is much, much stronger...&quot;

The panther giggles. His hand, now covered in sparks of lightning, approach the wolf&#39;s cock again. Ivex chuckles as he touches the very tip, making the wolf let out a new yelp, and this time, he doesn&#39;t pull his claw away. The current of lightning continues over the wolf&#39;s cock as the mage delicately trails his claw down the underside of the wolf&#39;s forcefully erect dick in a way too slow motion all the way to its center. Only then does he pull his finger back, leaving the wolf panting.

&quot;Such a beautiful cock... and such a beautiful knot, too... I&#39;ve always loved that about canines...&quot;

It occurred to $name that Ivex had been focusing on his length since the lightning appeared, but just as he says that the wolf&#39;s eyes go even wider as the mage&#39;s hand trails down the wolf&#39;s length... and reaches for his knot.

$name can&#39;t help it. The wolf lets out what is almost a howl as Ivex pinches his knot with two fingers, one from each side, creating a current of pain and pleasure that travels right through the sensitive bulb of flesh. The wolf gasps, trying to form words to ask him to let go, but they don&#39;t even come. Only a whine does, and a shameful one, but there is no time to feel shame. Only the pleasure mixed with pain coming from Ivex&#39;s cruel torture.

It feels like far, far too long before he lets go, and the tingling sensation remains around the wolf&#39;s knot and entire groin. 

&quot;Now, are you willing to tell me &lt;b&gt;everything&lt;/b&gt; I want to know?&quot; the mage asks with three fingers playing around the wolf&#39;s knot, threatening to touch it. It takes effort to even form words to muster a response, but when $name finally manages to...</tw-passagedata><tw-passagedata pid="114" name="Shock 3 (Text)" tags="text" position="1925,1800" size="100,100">Before the wolf can finish saying anything at all, a movement from Ivex&#39;s finger has some kind of belt come flying from behind to wrap itself around the wolf&#39;s muzzle with lightning speed. It buckles itself and tightens &lt;b&gt;hard&lt;/b&gt;, making the wolf flinch and causing him to be unable to open his muzzle at all.

&quot;Hmmmhgghm!&quot; the wolf complains. It&#39;s impossible to form proper words with his muzzle shut tight.

&quot;There we go... silence. Let me tell you a little secret...&quot; the panther says as he touches the wolf&#39;s knot. This time, the lightning feels a lot weaker, yet the surge coming from Ivex&#39;s touch is still there, ravaging the wolf&#39;s sensitive knot and making his cock hurt and shoot pre-cum at the same time. 

&quot;I never really cared to get information out of you. I know who sent you, and I know they will keep sending more. I&#39;ll appreciate it if they do. They&#39;ll end up like you, furthering my goals. Helping me keep this place up and running and providing fun at the same time.&quot;

The panther laughs. A genuine laugh. All the while the bound wolf feels small tears of both pain and frustration going down as the mage closes his lightning-engulfed hand around the wolf&#39;s knot, gripping it in its entirety. The weaker lightning envelops it and, in a way, it feels worse than before, keeping a relentless surge going through his cock.

That hand squeezes his knot, shocking it, then moves up to the wolf&#39;s length, slowly, far too slowly, trailing up from the base all the way to the tip while keeping its current surging through the canine&#39;s erection.

It feels like a long time goes by before Ivex&#39;s hand finally reaches the tip and retreats. The wolf&#39;s cock feels sore with a constant, lingering tingle that makes it feel numb. It twitches in the air, however, and Ivex takes a step back so that he can grab it with his other hand. To the wolf, the regular touch on his length feels even more overwhelming than before. It is as if the lightning has made its surface even more sensitive, if that is even possible, so as the mage gives the wolf&#39;s cock a few strokes, the pleasure that was hidden under the pain comes surging through. $name, still panting hard, makes an effort not to moan.

Ivex spends a little time pleasuring the wolf, but unfortunately, it is all too brief. Before long, the panther lets go and makes sure the wolf is watching as he grins and brings his lightning-covered hand close to his cock again.

$name shakes his hand, letting out muffled pleas and complaints against it, but it is to no avail. The wolf howls through his shut muzzle as Ivex envelops his cock in lightning once more and starts stroking it with that hand instead...</tw-passagedata><tw-passagedata pid="115" name="Extra Torture (Text)" tags="text" position="2050,2125" size="100,100">It&#39;s hard to tell for how long the mage plays with the wolf. Unable to even say anything, all $name can do is stay there, bound and exposed, as he endures the whims of the sadistic mage. With his magic-engulfed hand, he alternates between torturing and pleasuring the wolf&#39;s exposed cock a few more times before he moves on to different methods.

Ivex seems to take immense pleasure in shifting the weight of the crystal hanging from the wolf&#39;s balls back and forth. Sometimes it grows light to give his nuts some relief, and sometimes the mage makes it so heavy that $name feels like his balls are supporting the weight of a person by themselves.

It does not stop there, however. With swift movements, more things come flying out from the cursed chest situated behind the bound wolf. The worst one perhaps being the riding crop. It is small, thin and looks worn and well-used. It takes no effort at all from Ivex to make the floating instrument approach the wolf&#39;s forcefully erect cock and strike at it. The lashes are strong and precise, even if made by magic, and each time it strikes the wolf&#39;s length, he tenses up and yells from behind his shut muzzle.

The lashes to the wolf&#39;s poor cock never come alone. Ivex laughs at his pain, taking obvious enjoyment in torturing the bound wolf. With his magic, the mage takes delight in now producing both ice and lightning from his hands to freeze and zap, often aimed at the wolf&#39;s sensitive cock, but sometimes the mage takes pleasure in aiming for the balls as well. Having the panther poke at his nuts with electric fingers or grip them with what feels like pure ice while the crystal&#39;s weight is at its highest is one of the toughest things $name ever had to endure.

That torture sometimes comes in the form of pain and sometimes in the form of pleasure. After relentless lashing, Ivex sometimes gives the wolf respite. Stopping his torture, the mage seems to have no reservations in using his hand, and on one occasion even his tongue, to pleasure the wolf&#39;s tortured cock and force his arousal to spike back up. The wolf thrashes in shame against his bindings as the mage forcefully brings him all the way to the edge of orgasm, only to then deny him and take immense pleasure in dialing it back again through new means of torture.

To the wolf, it feels like hours pass by. His cock feels sore, his balls even more so, and yet his arousal, as Ivex says, does not relent. His member is rock hard, his knot is out, and that drive to fuck something, to knot, to &lt;b&gt;cum&lt;/b&gt;, is still as strong as it was at the beginning... The urge to reach down and touch his cock is great, but Ivex does not give him the pleasure.

&quot;Well then... isn&#39;t this fun? Unfortunately, I have things to do, so we must be moving on...&quot;

Ivex approaches the wolf again, leaning against his chest, his hand caressing the wolf&#39;s tortured knot and bringing a whine of need from the bound adventurer.</tw-passagedata><tw-passagedata pid="116" name="Defiant End (Text)" tags="text" position="2325,2025" size="100,100">Ivex&#39;s painful squeezing thankfully does not last long. The panther soon lets go of it, stepping back, but as he does, he motions with his hands again and...

Four small metal rings come to him, all flying between the mage and the wolf. With a smile, the panther motions more delicately, and much to the wolf&#39;s dismay, all four rings fly in order towards his cock and carefully slide around it. One rests right above his knot, the other three a little spaced out around the wolf&#39;s throbbing length.

&quot;Consider this your punishment for being naughty. It will serve me well to foster your needs before I turn you into something useful for me.&quot;

Ivex merely grins. The mage does nothing at first, simply waiting, and then he waves his hand towards the wolf&#39;s cock and, with that, the rings start working.

&quot;Hmmghf!&quot; the wolf groans. All the metal rings start... vibrating? Heating up? Both? Neither? He can&#39;t tell. All the wolf can tell is that it feels heavenly around his sensitive cock. The crystal was never removed, so it keeps weighing down his balls, but regardless of it, the pleasure that surrounds his cock is insurmountable. The flames of his arousal revive in an instant, the wolf&#39;s cock ravaged with pleasure almost beyond his understanding. All the wolf can do is let out muffled moans as the rings force him towards an orgasm.

Before he can reach it, however, Ivex hums. His finger gets close to the wolf&#39;s balls and, as the adventurer observes it, the mage seems to merely draw something in the air next to it with his claws. Out of nowhere, a rune appears, and as if it was made of something solid, the mage pushes it... towards the wolf&#39;s balls.

$name can feel a sort of pressure surrounding his hanging nuts. It grips them to the point of discomfort and then, much to his dismay, the rune Ivex had drawn appears on them, as if it had been scribbled over the fur that covers it...

&quot;You know what that is? Of course you don&#39;t. It&#39;s a sign of stillness. I&#39;ve tampered with it. You know what it&#39;ll do?&quot; the mage grins.

The wolf doesn&#39;t know, but he can barely think. The rings mercifully working on his cock take his pleasure to new lengths and, just like that, his balls pull up, his cock flexes. The feeling of orgasm feels inevitable and, as much as it shames $name to cum to the perverted mage&#39;s ministrations like that, his body wants it, needs it, and he can&#39;t fight it.

...Except it does not come. The sensation of inevitable orgasm in the next split second is still there, but his body cannot pass it. The pleasure, so high, does not bring the satisfaction that every male is used to receiving at the end of it. It just... lingers in that state.

$name huffs. He looks down at his cock, pulsing, throbbing, drooling pre-cum, ready to cum, but it &lt;b&gt;doesn&#39;t&lt;/b&gt;! He pulls against the bindings mindlessly to reach down and make it happen, but of course that doesn&#39;t help.

The mage reads his mind, though. Ivex&#39;s hand comes to his cock, caressing it between the rings and adding even more to his stimulation. The wolf lets out an intense muffled moan, the pleasure is almost too much, but it&#39;s no use. His orgasm doesn&#39;t come no matter what.

&quot;Yes, that&#39;s what it does. I will leave you here having fun while I tend to my business. This will make you think twice before you ever think about speaking against me, hmm? That is, if you were to ever get a chance again, which you won&#39;t...&quot;

The mage laughs. He takes his hand away and steps back. &quot;But I&#39;m not done yet.&quot;

Ivex raises both of his hands. Under his control, several things come flying from behind the wolf to envelop him. New layers of leather bindings envelop his arms, his biceps, his chest, legs, thighs... everything. Floating in the air by themselves, they wrap around the wolf&#39;s body and tighten hard, making the wolf grunt as he is made completely and utterly immobile on the cross he&#39;s bound to.

&quot;And the last touch...&quot; Ivex grins.

With but a finger, he motions towards the candle. It sat silently on the desk it had always been, but now it floats towards him, stopping between the mage and the wolf... and with a flicker of his finger, it lights up again.

Almost immediately as it does, Ivex covers his face, and the wolf&#39;s eyes go wide. His next breath comes with the same maddening fire from before and its magic resumes its cursed work, fostering the wolf&#39;s arousal even more while his torment continues.

$name tries fighting it. His large muscles bulge with all of his strength and desperation against the bindings, but reinforced as they were, he is no match for them. Even with all of his strength, the wolf cannot move a single inch, bound standing to the cross with his limbs spread and his tormented cock exposed, throbbing, begging for release...

Ivex is not done yet, however. With a laugh, the mage makes another simple motion with his hand, and the candle floats downwards... until it sits right above the wolf&#39;s cock, floating there.

And then, with a final flick of his fingers... the candle tips to the side.

As soon as it does, a drop of hot wax falls down right at the center of the wolf&#39;s exposed, red cock. It makes $name let out a muffled howl from his shut muzzle. The intense heat over the surface of his sensitive cock brings pain, but the pleasure being inflicted on it never stops. For a moment, the wolf is blissfully pulled away from his near-orgasm state, but that is accomplished by the blinding pain of the wax over the smooth surface of his cock. It lasts only for a few seconds, as the wax is quick to grow cold and harden instead.

&quot;I think that&#39;s a good look for you. It is the look of all who dare go against me.&quot; the mage hums. &quot;Now, be a good wolf and stay put. In a few hours, I&#39;ll be back, then you will have the honor of using your life essence to fuel my great work. Just as many before you do as well.&quot;

The mage turns and starts walking away. $name grunts and yells through his shut muzzle for the mage not to leave him like that, but there is little he can do. Every breath is fire, the wolf can feel the sheer arousal starting to cloud his mind again, and the pleasure never stops, but also never comes. And then, as if on cue... a new drop of wax falls from the candle that remained floating above his cock and tipped to bring the wolf to a new howl of hot pain.

&quot;Don&#39;t worry,&quot; Ivex says, stopping by the door. &quot;I did enjoy our time together. The best part is that, since you will be here anyway, we can bring you back up, strap you up and have another one of these fun play sessions whenever I feel like it. Isn&#39;t that great?&quot;

$name shakes his head. Ivex, however, just laughs and walks away. The large wolf is left alone in the room, bound, with the candle burning and clouded in unending pleasure for who knows how long. Overwhelmed by everything inflicted upon him, $name can&#39;t even wonder what Ivex has in store for him in the future now that he&#39;s in the mage&#39;s hands.</tw-passagedata><tw-passagedata pid="117" name="Compliant End (Text)" tags="text" position="2125,1800" size="100,100">Ivex&#39;s pleasurable stroking does not last long. The panther soon lets go of it, stepping back, but as he does, he motions with his hands again and...

Four small metal rings come to him, all flying between the mage and the wolf. With a smile, the panther motions more delicately, and much to the wolf&#39;s dismay, all four rings fly in order towards his cock and carefully slide around it. One rests right above his knot, the other three a little spaced out around the wolf&#39;s throbbing length.

&quot;Consider this a reward for being good. Your last conscious pleasure before you start your life of servitude.&quot;

Ivex starts walking around the wolf, leaving his field of vision, but before he does, he waves his hand towards the wolf&#39;s cock, and with that, the rings start working.

&quot;Hmmghf!&quot; the wolf groans. All the metal rings start... vibrating? Heating up? Both? Neither? He can&#39;t tell. All the wolf can tell is that it feels heavenly around his sensitive cock. The crystal was never removed, so it keeps weighing down his balls, but regardless of it, the pleasure that surrounds his cock is insurmountable. The flames of his arousal revive in an instant, the wolf&#39;s cock ravaged with pleasure almost beyond his understanding. All the wolf can do is let out muffled moans as the rings force him towards an orgasm.

The wolf&#39;s cock spasms and shoots. In another surprise turn of events, his seed arcs towards the air, but instead of continuing its trajectory towards the floor, the white, pearly substance stops midair and turns into a floating ball. Each shot adds more to it, and the wolf sees it, but he barely cares...

All $name can feel is the pleasure crashing through his body. His arousal, caused and enhanced by magic, finally brings waves upon waves of satisfaction after so much torture and teasing. The wolf shoots and shoots, his orgasm long and lasting, and when it starts to subside... it doesn&#39;t, really.

Ivex was right. $name feels like he can cum ten more times. Twenty, even. His cock remains hard, his knot engorged, his arousal high. There is no refractory period, and the rings don&#39;t let him have it either. They push his pleasure up, teasing the wolf&#39;s cock in impossible ways and driving him towards a second orgasm while the results of his first still float around in the air.

$name moans, feeling like he&#39;s close to shooting again when the rings shut down. The wolf whines in frustration, but Ivex reappears. With another motion of his hand, the rings come off the wolf&#39;s cock and fly to his hand to join the rest of the gear the panther is now holding.

It&#39;s hard for $name to make out what it is, but he can see several bands of leather. A harness, perhaps? A collar...? There seems to be more, but the panting wolf feels too overwhelmed to think. 

&quot;Did you enjoy it? You sure look like you did...&quot; Ivex smiles. He walks around the floating ball of seed and chuckles. &quot;I know what to do with this...&quot;

The mage motions towards it, and the ball starts moving. It moves upwards, towards the wolf, towards &lt;&lt;print $name&gt;&gt;&#39;s muzzle.

&quot;Stand still,&quot; the mage orders, and it doesn&#39;t matter if $name turns his head to the side when the ball of his own cum comes too close. The smell of it is characteristic of his own seed and, as much as he tries to avoid it, it keeps coming closer... then the cum is pressed against his face. Against his muzzle. It feels wet and warm as if he had just ejaculated it, and the wolf grunts as it mats the fur of his face.

&quot;There we go. That&#39;s a good look for you. I think I&#39;ll leave that there and make sure you never clean it up just as a reminder of your sorry, failed adventurer life before you served me,&quot; the mage laughs. &quot;Now...&quot;

Ivex lets go of all he is holding and, as usual, everything floats up instead of falling. The wolf gets a better look at all the gear. A harness indeed, a collar, some kind of pants that are completely open in all the places they should be closed, and a strange pendant.

&quot;I will love having you as my loving thrall... and the best part? Since you will be here anyway, we can come back here, strap you up and have another one of these fun play sessions whenever I feel like it. Isn&#39;t that great?&quot;

$name shakes his head. Ivex, however, just laughs and motions with his hand again. The gear approaches the bound wolf... and there is nothing he can do to stop it.</tw-passagedata><tw-passagedata pid="118" name="Ice (Text)" tags="text" position="1675,2300" size="100,100">With a chuckle, the panther comes even closer. $name grows stiff and growls seeing the panther leaning against him. With the wolf bound and spread as he is, Ivex has full freedom to press his side against the wolf&#39;s, going as far as leaning his head to rest it against &lt;&lt;print $name&gt;&gt;&#39;s broad chest. The panther&#39;s hand never leaves the wolf&#39;s cock, continuing to stroke and tease it in its way too slow manner, but the mage&#39;s other hand comes to caress the exposed fur of the wolf&#39;s chest.

&quot;Such a big specimen... the big ones are my favorite. Wolves, even more. I wonder what sounds you&#39;ll make...&quot;

&lt;&lt;print $name&gt;&gt;&#39;s growl intensifies. &quot;What are you talking about?!&quot;

&quot;As I said,&quot; Ivex chuckles, &quot;the simplest of spells...&quot;

The mage pulls his hand away from the wolf&#39;s chest and raises it so that the bound lupine can see it. Ivex&#39;s hand looks normal at first, but as he clenches it into a fist and opens it again, it glows white for a moment, and then...

A thin layer of ice starts appearing. It is as if it grows from the surface of Ivex&#39;s palm. The coldness brought by Ivex&#39;s magic surrounds his hand and grows into a thicker layer of what looks like pure ice. When Ivex moves his hand, it looks normal inside its frigid exterior.

Playfully, Ivex brings his hand to the wolf&#39;s chest to touch it again.

&quot;Fuck...!&quot; $name can&#39;t help but curse. He grows stiff as, even through his thick fur, he can feel the sheer, unrelenting coldness of the ice enveloping Ivex&#39;s hand. It&#39;s uncomfortable, to say the least.

&quot;See? A very simple spell. And yet it can be so effective when used right...&quot; The mage giggles. He presses his icy finger against the wolf&#39;s chest, then trails towards his nipple. $name grits his teeth, eyes fixated on it and bracing for the inevitable...

&quot;HNFGH!&quot;

The ice feels terrible on the wolf&#39;s soft, exposed nipple. $name is forced to suck in a breath and hold it to avoid making any painful sounds. Thankfully, Ivex only plays around it for a few moments before he pulls away. Showing his hand again, $name can see with relief that the ice starts melting away as quickly as it appeared.

He breathes a sigh of relief.

Yet Ivex grins again. &quot;Time to have fun with you.&quot;</tw-passagedata><tw-passagedata pid="119" name="Ice 2 (Text)" tags="text" position="1800,2300" size="100,100">The panther&#39;s eyes move back to the wolf&#39;s cock. That hand never stopped teasing it, much to the wolf&#39;s dismay, and the weight on his balls never went away either. Yet, still, as Ivex chuckles again, his hand speeds up. The stroking gets faster. The panther&#39;s hand skillfully strokes and teases the whole of the wolf&#39;s exposed length, going all the way down to the knot, toying with it to make him gasp, then moving back to the dripping tip. He does it a few times, furthering the wolf&#39;s pleasure, and soon $name is panting. The candle did too much. His balls churn and the weight feels more uncomfortable than ever. $name feels like he could cum ten times in a row and one of them is already coming with just that bit of stimulation... until Ivex grins.

&lt;&lt;print $name&gt;&gt;&#39;s eyes start going wide.

&quot;No! NO!&quot; $name exclaims, but there is nothing he can do to stop it.

Ivex&#39;s hand continues to stroke his cock, but while the panther&#39;s paw felt soft and delicate before, it now starts to feel... &lt;b&gt;cold&lt;/b&gt;.

It gets colder. Colder and colder. With wide eyes, $name can see- and feel, as the ice starts forming on the palm that is stroking his cock. Ivex doesn&#39;t stop, grinding it against the wolf&#39;s oversensitive length, moving it up and down, back and forth, and spreading the growing ice all over the wolf&#39;s length.

&quot;FUCK!&quot; $name pretty much yells. The hand seems to get colder still. Impossibly cold. It contrasts with the heat of his erection in an extremely uncomfortable manner, yet the arousal is still there. The pain he feels from the ice mixes in with the pleasure of the stroking. The pain wins overall, but his erection is not going away... why is it not going away?!

&quot;Isn&#39;t it nice?&quot; Ivex muses. &quot;With how much of that candle you breathed in, I could cause you pain for hours and you would still be hard as a rock. Ready to fuck. Some tribes deep in the jungles use something similar to ensure good mating, did you know that? But even then, this is a perfected formula. Works much faster and is much, much stronger...&quot;

The panther giggles. His hand, now fully covered in ice, continues to stroke and play with the wolf&#39;s cock. Tears sprout from the wolf&#39;s eyes, his muscles tensing up hard against his bonds as each stroke of the mage&#39;s hand on his length feels like burning. Yet, just as Ivex said, his arousal does not relent. Pre-cum even still drips from it, but the hand is so cold that the touch almost feels numb to $name.

&quot;Such a beautiful cock... and such a beautiful knot, too... I&#39;ve always loved that about canines...&quot;

It occurred to $name that Ivex had been focusing on his length since the ice appeared, but just as he says that the wolf&#39;s eyes go even wider as the mage&#39;s hand trails down the wolf&#39;s length... and reaches for his knot.

$name can&#39;t help it. The wolf lets out what is almost a howl as the ice envelops his knot. Ivex makes a point to grip it in his hand, keeping the sensitive bulb of flesh trapped and encased in the punishing ice. The wolf gasps, trying to form words to ask him to let go, but they don&#39;t even come. Only a whine does, and a shameful one, but there is no time to feel shame. Only the pleasure mixed with pain coming from Ivex&#39;s cruel torture.

&quot;Now, are you willing to tell me &lt;b&gt;everything&lt;/b&gt; I want to know?&quot; the mage asks without letting go of the wolf&#39;s knot. It takes effort to even form words to muster a response, but when $name finally manages to...</tw-passagedata><tw-passagedata pid="120" name="Ice 3 (Text)" tags="text" position="1925,2300" size="100,100">Before the wolf can finish saying anything at all, a movement from Ivex&#39;s finger has some kind of belt come flying from behind to wrap itself around the wolf&#39;s muzzle with lightning speed. It buckles itself and tightens &lt;b&gt;hard&lt;/b&gt;, making the wolf flinch and causing him to be unable to open his muzzle at all.

&quot;Hmmmhgghm!&quot; the wolf complains. It&#39;s impossible to form proper words with his muzzle shut tight.

&quot;There we go... silence. Let me tell you a little secret...&quot; the panther says at a pace of leisure with his ice-covered hand continuing to painfully massage the wolf&#39;s engorged knot as he speaks.

&quot;I never really cared to get information out of you. I know who sent you, and I know they will keep sending more. I&#39;ll appreciate it if they do. They&#39;ll end up like you, furthering my goals. Helping me keep this place up and running and providing fun at the same time.&quot;

The panther laughs. A genuine laugh. All the while the bound wolf feels small tears of both pain and frustration going down as the mage keeps relentlessly torturing his cock.

It feels like a long time goes by before Ivex&#39;s hand finally retreats. The wolf&#39;s cock feels icy cold, wet with a sheen layer of cold melted water... and yet it still throbs, radiating the heat of his forced arousal. Ivex takes a step back so that he can grab it with his other hand and, to the wolf, the wave of pleasure and relief is unmatched. The warmth of Ivex&#39;s hand on his cold cock as he teases it feels heavenly and brings the conflicting pleasure back up. Unfortunately, it only lasts a few seconds. Before long, the panther lets go and makes sure the wolf is watching as he grins and brings his ice-covered hand close to his cock again.

$name shakes his hand, letting out muffled pleas and complaints against it, but it is to no avail. The wolf howls through his shut muzzle as Ivex envelops his cock in ice once more and starts stroking all over again.</tw-passagedata><tw-passagedata pid="121" name="Mind Capture (Knot) (Text)" tags="text" position="1700,3600" size="100,100">For a moment, $name feels his adrenaline shoot up. His first reflex is to bring his paw up to remove the pendant from his neck, but as he tries to do so he realizes... it doesn&#39;t work. His arm won&#39;t move, no matter how much he wills it to. Neither will the other one, or his legs, or... anything!

The wolf finds himself stuck there, on all fours above the lion with his knot stuck to the feline. His mind races for a moment, his heart speeding up, but then...

A thought pops up in his head. It feels... alien, however. A thought that feels like his own but is not made by him. He looks at the herbs without meaning to and, suddenly, the wolf realizes he knows what to do.

$name calmly lets the lion under him go. Unlike before, the feline no longer struggles or even attacks him. The lion just waits, expression as blank as before, as the wolf&#39;s arms move and his hands are placed on the floor. They&#39;re moving, but he&#39;s not controlling them!

His body then starts to get up. As it does, however, there&#39;s a tug. His knot is still stuck fast to the lion. The wolf can feel everything. The jolt of pleasure the tug of his knot brings him. Usually, it would be oversensitive discomfort, but something about that candle has completely killed his refractory period. Though he can feel it, however, his body ignores it. The wolf tugs again, harder this time, trying to pull his inflated knot out of the lion who, in turn, just grunts below him. It doesn&#39;t work, however.

$name grows nervous watching his body place a hand on the lion&#39;s back. He knows what&#39;s coming next and grows worried, but it feels so strange to be worried and feel his body being relaxed anyway. It feels like there are two minds inside his head now, more thoughts continuing to pop up, yet the artificial thoughts take precedence over his own. If there are two minds inside his head, his own is not the one in control. The wolf starts panicking, but his body does not react to that.

No, instead, his body starts pulling. Both wolf and lion grunt as the process is not easy. Still, his body is stubborn and decided. $name can feel on his dick and knot how tightly the lion grips it and how uncomfortable it feels to try and pull it out before it deflates, but there is no choice. His body just keeps pulling, keeping the lion down as he pulls and pulls, until, finally...

When his knot pops, a rush of his seed flows down from the lion&#39;s used and spread ass. Both wolf and lion grunt at it, but neither says anything or shows any expression. Instead, both of them stand up. The wolf grows more and more worried as, no matter how much he fights, his body won&#39;t obey.

Another thought pops up in his head. Then another, then another. They become more and more constant, taking his body over. The wolf finds himself looking at the herbs and realizes that, somehow, he knows what to do, even if he didn&#39;t before.

$name walks. Without his consent, his body walks towards the cabinets, opens one at the top, and pulls out a mortar and pestle he didn&#39;t know were there, but at the same time, did. The wolf&#39;s mind has trouble even grasping what&#39;s going on, but there&#39;s no choice. New thoughts keep coming to his head, thoughts that aren&#39;t his, but that overcome his own, taking the forefront whenever they pop up. It feels as if... as if there are two minds in his head at the moment, and the one in command is not his!

All the lupine can do is watch his body bring the mortar and pestle to the counter and set it down. He can feel the touch of the herbs on his hand as usual when his body grabs a handful and throws it in. By his side, the lion is doing the same thing, going back to grinding his own batch. He&#39;s expressionless and, when the wolf is forced to glance at the lion, $name realizes... he has the same blank expression on his own face. And he can&#39;t change it, no matter how hard he tries.

His body starts grinding herbs next to the lion and there&#39;s nothing he can do about it. The gemstone on the pendant... it must be the gemstone! But removing it is out of question. His body won&#39;t obey. 

$name is trapped.</tw-passagedata><tw-passagedata pid="122" name="Mind Capture (Text)" tags="text" position="1325,3125" size="100,100">The lion stands chest to chest with the wolf and brings the pendant up. $name reluctantly allows the feline to put it over his head and around his neck.

Looking down at it, the wolf can see the blue gemstone glowing brighter. It is as if there is a mist inside it that glows and whirls. At first, nothing happens.

The lion stands there, not moving and not saying anything, watching the wolf as if expecting something. It is only when $name tries to speak that he realizes something is wrong.

His mind wants to speak, but his muzzle does not obey. With urgency, the wolf raises his hands up to feel his muzzle, but midway towards it, his hands stop. His arms grow limp, resting by his sides without him meaning to. Adrenaline starts shooting up the wolf and the urge to move grows, but his legs stop responding as well. He&#39;s forced to just stand there! $name growls, looking at the lion, and then...

A thought pops up in his head. It feels... alien, however. A thought that feels like his own but is not made by him. He looks at the herbs without meaning to and, suddenly, the wolf realizes he knows what to do.

$name walks. Without his consent, his body walks towards the cabinets, opens one at the top, and pulls out a mortar and pestle he didn&#39;t know were there, but at the same time, did. The wolf&#39;s mind has trouble even grasping what&#39;s going on, but there&#39;s no choice. New thoughts keep coming to his head, thoughts that aren&#39;t his, but that overcome his own, taking the forefront whenever they pop up. It feels as if... as if there are two minds in his head at the moment, and the one in command is not his!

The wolf grows more and more worried as, no matter how much he fights, his body won&#39;t obey. $name can feel himself relaxing, no longer nervous, even though he wants to be. His other mind isn&#39;t.

All the lupine can do is watch his body bring the mortar and pestle to the counter and set it down. He can feel the touch of the herbs on his hand as usual when his body grabs a handful and throws it in. By his side, the lion is doing the same thing, going back to grinding his own batch. He&#39;s expressionless and, when the wolf is forced to glance at the lion, $name realizes... he has the same blank expression on his own face. And he can&#39;t change it, no matter how hard he tries.

His body starts grinding herbs next to the lion and there&#39;s nothing he can do about it. The gemstone on the pendant... it must be the gemstone! But removing it is out of the question. His body won&#39;t obey. 

$name is trapped.</tw-passagedata><tw-passagedata pid="123" name="Mind Capture 2 (Text)" tags="text" position="1450,3125" size="100,100">It doesn&#39;t matter how much the wolf shouts and yells inside his thoughts or how much willpower he puts into defying his body&#39;s movements. It won&#39;t obey. Whatever that pendant is, it&#39;s strong enough to overcome him entirely.

$name is forced to remain there next to the lion in the exact same state the leonine warrior is in. Blank expression and mindlessly grinding herbs for Ivex&#39;s nefarious purposes. Like... like some sort of slave. Like a mindless fucking thrall! The thought alone is enough to drive the wolf mad with anger, but his heart does not even speed up. It feels so unnatural to feel these things without really feeling them!

Everything about it is unnatural. Invasive! And the worst part? $name can tell that there&#39;s more to the pendant too. All around him, the smell of herbs that were already prevalent in this room now feels enhanced. His sensitive canine nose can pick it up very well, and it grows even stronger when he grinds them. The smell comes out of them and when it does...

For some reason, that smell feels incredibly &lt;b&gt;arousing&lt;/b&gt;. If he could look at the lion by his side, he would. The wolf starts to understand why the lion was hard and dripping the whole time while working. He himself cannot help it. His cock throbs between his legs, unattended, but the arousal is there, coming from the herbs he&#39;s forced to grind. With how boring the work is, the lust surrounding his body is the only thing his mind can focus on. It feels like torture to feel it and be completely unable to even get close to tend to it. 

No matter how much he tries, $name cannot find a way out. He&#39;s trapped there grinding herbs and getting aroused by it until who knows how long after that, Ivex himself opens the door.</tw-passagedata><tw-passagedata pid="124" name="Interrogation Archive Display" tags="noreturn" position="1700,1000" size="100,100">&lt;&lt;silently&gt;&gt;
  &lt;&lt;if $interrogationEndingFreeze &amp;&amp; $interrogationEndingShock&gt;&gt;
    &lt;&lt;set $interrogationSpell = &#39;freeze&#39;&gt;&gt;
  &lt;&lt;elseif $interrogationEndingFreeze &amp;&amp; !$interrogationEndingShock&gt;&gt;
    &lt;&lt;set $interrogationSpell = &#39;freeze&#39;&gt;&gt;
  &lt;&lt;elseif !$interrogationEndingFreeze &amp;&amp; $interrogationEndingShock&gt;&gt;
    &lt;&lt;set $interrogationSpell = &#39;shock&#39;&gt;&gt;
  &lt;&lt;else&gt;&gt;
    &lt;&lt;set $interrogationSpell = &#39;&#39;&gt;&gt;
  &lt;&lt;/if&gt;&gt;
  &lt;&lt;if $interrogationEndingMild &amp;&amp; $interrogationEndingRough&gt;&gt;
    &lt;&lt;set $interrogationEnd = &#39;mild&#39;&gt;&gt;
  &lt;&lt;elseif $interrogationEndingMild &amp;&amp; !$interrogationEndingRough&gt;&gt;
    &lt;&lt;set $interrogationEnd = &#39;mild&#39;&gt;&gt;
  &lt;&lt;elseif !$interrogationEndingMild &amp;&amp; $interrogationEndingRough&gt;&gt;
    &lt;&lt;set $interrogationEnd = &#39;rough&#39;&gt;&gt;
  &lt;&lt;else&gt;&gt;
    &lt;&lt;set $interrogationEnd = &#39;&#39;&gt;&gt;
  &lt;&lt;/if&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
\
&lt;&lt;if $interrogationEnding&gt;&gt;\
  &lt;b&gt;[[Bad Ending: Interrogation|Interrogation Archive]]&lt;/b&gt;
  Variation 1: &lt;&lt;nobr&gt;&gt;
  &lt;&lt;if $interrogationEndingFreeze&gt;&gt;
    &lt;label&gt;&lt;&lt;radiobutton &quot;$interrogationSpell&quot; &quot;freeze&quot; autocheck&gt;&gt; Freeze&lt;/label&gt;
  &lt;&lt;else&gt;&gt;
    &lt;span class=&quot;helper-container&quot;&gt;
      &lt;span&gt;&lt;label&gt;&lt;&lt;radiobutton &quot;$interrogationSpell&quot; &quot;&quot;&gt;&gt; &lt;span class=&quot;disabled&quot;&gt;Freeze&lt;/span&gt;&lt;/label&gt;&lt;/span&gt;
      &lt;small class=&quot;helper-text&quot;&gt;Ivex has a special treatment for northern wolves that like the cold...&lt;/small&gt;
    &lt;/span&gt;
    &lt;&lt;done&gt;&gt;&lt;&lt;script&gt;&gt;
    document.getElementById(&quot;radiobutton-interrogationspell-0&quot;).disabled = true;
    &lt;&lt;/script&gt;&gt;&lt;&lt;/done&gt;&gt;
  &lt;&lt;/if&gt;&gt;
  &lt;&lt;/nobr&gt;&gt;\
   | &lt;&lt;nobr&gt;&gt;
    &lt;&lt;if $interrogationEndingShock&gt;&gt;
        &lt;label&gt;&lt;&lt;radiobutton &quot;$interrogationSpell&quot; &quot;shock&quot; autocheck&gt;&gt; Shock&lt;/label&gt;
      &lt;&lt;else&gt;&gt;
        &lt;span class=&quot;helper-container&quot;&gt;
          &lt;span&gt;&lt;label&gt;&lt;&lt;radiobutton &quot;$interrogationSpell&quot; &quot;&quot;&gt;&gt; &lt;span class=&quot;disabled&quot;&gt;Shock&lt;/span&gt;&lt;/label&gt;&lt;/span&gt;
          &lt;small class=&quot;helper-text&quot;&gt;Ivex has a special treatment for southern wolves that hate the cold...&lt;/small&gt;
        &lt;/span&gt;
        &lt;&lt;done&gt;&gt;&lt;&lt;script&gt;&gt;
            document.getElementById(&quot;radiobutton-interrogationspell-1&quot;).disabled = true;
        &lt;&lt;/script&gt;&gt;&lt;&lt;/done&gt;&gt;
    &lt;&lt;/if&gt;&gt;
  &lt;&lt;/nobr&gt;&gt;

  Variation 2: &lt;&lt;nobr&gt;&gt;
  &lt;&lt;if $interrogationEndingMild&gt;&gt;
    &lt;label&gt;&lt;label&gt;&lt;&lt;radiobutton &quot;$interrogationEnd&quot; &quot;mild&quot; autocheck&gt;&gt; Mild&lt;/label&gt;
  &lt;&lt;else&gt;&gt;
    &lt;span class=&quot;helper-container&quot;&gt;
      &lt;span&gt;&lt;label&gt;&lt;&lt;radiobutton &quot;$interrogationEnd&quot; &quot;&quot;&gt;&gt; &lt;span class=&quot;disabled&quot;&gt;Mild&lt;/span&gt;&lt;/label&gt;&lt;/span&gt;
      &lt;small class=&quot;helper-text&quot;&gt;Ivex treats those that choose collaboration over defiance with &quot;kindness&quot;...&lt;/small&gt;
    &lt;/span&gt;
    &lt;&lt;done&gt;&gt;&lt;&lt;script&gt;&gt;
    document.getElementById(&quot;radiobutton-interrogationend-0&quot;).disabled = true;
    &lt;&lt;/script&gt;&gt;&lt;&lt;/done&gt;&gt;
  &lt;&lt;/if&gt;&gt;
  &lt;&lt;/nobr&gt;&gt;\
   | &lt;&lt;nobr&gt;&gt;
    &lt;&lt;if $interrogationEndingRough&gt;&gt;
      &lt;label&gt;&lt;&lt;radiobutton &quot;$interrogationEnd&quot; &quot;rough&quot; autocheck&gt;&gt; Harsh&lt;/label&gt;
    &lt;&lt;else&gt;&gt;
      &lt;span class=&quot;helper-container&quot;&gt;
      &lt;span&gt;&lt;label&gt;&lt;&lt;radiobutton &quot;$interrogationEnd&quot; &quot;&quot;&gt;&gt; &lt;span class=&quot;disabled&quot;&gt;Rough&lt;/span&gt;&lt;/label&gt;&lt;/span&gt;
      &lt;small class=&quot;helper-text&quot;&gt;Ivex has a special disdain for those that dare defy his wishes...&lt;/small&gt;
      &lt;/span&gt;
      &lt;&lt;done&gt;&gt;&lt;&lt;script&gt;&gt;
      document.getElementById(&quot;radiobutton-interrogationend-1&quot;).disabled = true;
      &lt;&lt;/script&gt;&gt;&lt;&lt;/done&gt;&gt;
    &lt;&lt;/if&gt;&gt;
  &lt;&lt;/nobr&gt;&gt;
&lt;&lt;else&gt;&gt;\
  &lt;span class=&quot;helper-container&quot;&gt;
      &lt;b&gt;&lt;span class=&quot;disabled&quot;&gt;Bad Ending: Interrogation&lt;/span&gt;&lt;/b&gt;
    &lt;small class=&quot;helper-text&quot;&gt;Interrogation by the hands of the wizard is the first step that awaits those that cannot escape his contraptions...&lt;/small&gt;
  &lt;/span&gt;
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="125" name="Enthrallment 1 (Text)" tags="text" position="1575,3125" size="100,100">The wolf can&#39;t even turn his head to look at the damned mage, but the panther is incredibly happy and amused to find him there with a gemstone around his neck and working next to the lion.

There is nothing $name can do. Ivex compliments the lion for capturing him with a slap to the feline&#39;s bare ass. The wolf is forced to remain there, grinding herbs while Ivex&#39;s hands explore his helpless body, stroke and play with his forcefully aroused cock and even go as far as shoving a finger up his ass.

The wolf can&#39;t growl, can&#39;t speak, can&#39;t do anything about it! It hurts his pride to no end.

Ivex decides there and then to keep him as a thrall, saying the lion had been needing company anyway and $name was just as nice to look at. The mage then goes and grabs a set of leather straps he calls a &#39;uniform&#39; to outfit the wolf with.

Much to &lt;&lt;print $name&gt;&gt;&#39;s dismay, whatever order Ivex issues, the parasitic mind created by the necklace makes his body obey right away. The wolf has never tried so hard to will his body to punch someone as he does when Ivex makes him lift his arms, turn this way and that, and even lift his tail while he puts the leather gear upon his body. Just like the lion, his &#39;uniform&#39; consists of little more than a leather harness. Unlike the lion, however, the wolf gets nothing more than a metal ring around the base of his balls that keeps them uncomfortably pulled forward, making them more exposed. The discomfort is still felt by the wolf, but Ivex? He merely pats the wolf&#39;s exposed nuts and laughs, saying he&#39;ll enjoy looking and playing with them in the future.

After that, there is nothing else the wolf can do. Removing the pendant is impossible by himself and Ivex surely won&#39;t do it. $name finds himself doomed to serve as the perverted mage&#39;s thrall against his will.</tw-passagedata><tw-passagedata pid="126" name="Enthrallment 2 (Text)" tags="text" position="1700,3125" size="100,100">Time loses all meaning to the wolf. Inside Ivex&#39;s tower, it&#39;s impossible to tell day from night. His body sleeps sometimes, but the intervals at which he does seem random and, sometimes, get interrupted by Ivex&#39;s orders if they are particularly lengthy.

Little by little, the unwilling wolf learns more about the mage, but every new thing he learns just makes him hate him more. $name gets by telling himself that, as soon as he&#39;s free, he&#39;s gonna get his revenge on the mage, except that the days keep going by and freedom never comes.

At first, Ivex takes a lot of pleasure in just making the wolf do tricks for him. Making him dance, giving him clothes to put on, just so that he can strip for him, ordering the wolf to exercise, often way past even &lt;&lt;print $name&gt;&gt;&#39;s considerable limits, just for his own amusement. As always, the wolf can &lt;b&gt;feel&lt;/b&gt; everything, but stop none of it.

It gets worse when the mage moves on to more... invasive things. Forcing the wolf to jerk off for him is bad enough, but the mage seems to also take immense pleasure in ordering the wolf to jerk off and then making him stop halfway through. Ivex is definitely aware that &lt;&lt;print $name&gt;&gt;&#39;s mind is intact behind his body, for he often talks to the wolf as if he had any choice in any matter, just to further insult and humiliate him.

Life under Ivex&#39;s command is absolute hell to the wolf. Days and days of grueling work grinding his herbs, making his potions, or just carrying around his things around his tower. Whole nights edging himself and unable to get release for Ivex&#39;s amusement at the corner of his office while he works, with the worst one being the one when the mage falls asleep on his desk and forgets the wolf was there doing that, leaving $name to spend an entire night of relentlessly jerking off and edging without being able to release, move or otherwise even say anything against it.

There&#39;s the lion as well. Overhearing Ivex&#39;s comments to him, $name finds out his name is, or was, Aidham. The wolf can only guess he must have been an adventurer that tried to fight Ivex just like he is, but in the end, failed, and now has fallen under Ivex&#39;s spells as well.

Activities with the lion end up being quite common as well. The mage takes pleasure sitting back and jerking off while watching the two of them fuck each other under his orders in any position he can imagine. Neither warrior has any choice in the matter but to watch their bodies obey and feel everything as the mage uses them for his own pleasure.

Time keeps passing, each day a new set of orders with some being worse and some being better. Still, &lt;&lt;print $name&gt;&gt;&#39;s own mind waits. His current system is counting the number of punches he&#39;s gonna give Ivex when he gets free, but as of right now he&#39;s beaten a thousand and is still going. Still, someday... someday freedom will come and he&#39;ll be able to settle the score. Someday, somehow.</tw-passagedata><tw-passagedata pid="127" name="Lion Description" tags="" position="1025,2950" size="100,100">The lion is large with shiny golden fur and an impressive mane. He is also quite muscular, with thick arms and a broad chest, as made plain by the fact that he does not wear much in terms of clothing. What seems to be some kind of harness made of leather has some straps going across his chest and back, and below? Nothing. The lion does not wear anything to cover his rear that is plain for the wolf to see from where he stands.

[[Return|Lion Room Intro]]</tw-passagedata><tw-passagedata pid="128" name="Lion Fucking (Text)" tags="text" position="1350,3500" size="100,100">It&#39;s too hard to resist. Besides, the lion is clearly a thrall fighting for Ivex. The wolf has beaten him fair and square, and now...

With a lustful growl, $name pulls his hips back so that he can line himself up with the struggling lion&#39;s hole. His cock is already coated in his own pre-cum from all the fighting, the damned lingering arousal from that blasted candle. The thought of it, the memories, the humiliation he went through because of Ivex&#39;s pervertedness makes the wolf angry. All he went through... Yeah, it&#39;s time to let it out on something.

With a grunt, the wolf drives his hips forward. The tapered tip of his canine cock meets the lion&#39;s entrance right away and, with the force he put behind it, the feline simply grunts as the wolf spreads him open with ease. $name, on the other hand, groans out loud. The feeling of the lion&#39;s warmth around his cock, driven to max sensitivity by Ivex&#39;s foul magic, is just... sublime. This feels so much better than he ever thought it would.

The wolf&#39;s lust burns tenfold upon feeling it for the first time. With a growl, the wolf presses the lion harder against the ground and pushes forward, driving more of his cock into the pinned feline and reveling in how incredibly good it feels.

The wolf&#39;s mind slips towards sex again. Blissful, incredible, amazing sex. Driving his cock forward, the wolf keeps going until nothing but his large, engorged knot remains outside. Then, still growling, he pulls back, only to drive himself back in and feel how tightly those walls grip at his cock. This is the best sex he&#39;s ever had.

The lion below only grunts every now and then in reaction and keeps up the same struggle to try and get out. His expression still doesn&#39;t change, even as the wolf starts fucking him steadily. $name doesn&#39;t care, though. The tightness of the lion&#39;s backside feels like the most amazing thing he&#39;s ever sunk his cock into at that moment. Sensitive as it was, each thrust deep into the lion&#39;s ass sends electric jolts of sheer pleasure coursing through the whole of the wolf&#39;s body.

Before long, $name is panting like a dog as he fucks with reckless abandon. His own pre-cum, coming in excess, makes it smoother and smoother. Each thrust is pure bliss, and the wolf goes fast and hard, reveling in it. Driven by pure instinct, the wolf hammers down, his growling getting louder as his pleasure reaches new heights, until the base urge any wolf has while fucking starts overcoming him.

His knot is the only thing that still remains outside of the lion. It begs to feel that same tightness around it, to be gripped, squeezed, and to make the wolf&#39;s act of filling that damned lion up the best it can be.

Despite his eagerness and need, however, the wolf glances at the rope. Knotting the lion would mean being stuck to him for a long time, which is a luxury he definitely does not have. His rational mind tells him that, but as $name keeps fucking, his body begs him to knot the damned bastard. As he fucks faster, his pleasure reaching its peak...</tw-passagedata><tw-passagedata pid="129" name="Lion Knotting (Text)" tags="text" position="1475,3500" size="100,100">Gritting his teeth, the wolf puts even more force behind his fucking. It feels good, great even, to give in to the overwhelming lust. Drool runs down the wolf&#39;s muzzle to fall down on the lion&#39;s exposed back at the mere thought of how that tight ass is going to feel around his knot.

It takes effort. A lot of effort. With a lot of grunting from both parties and a lot of insistence from the wolf, his knot finally spreads the lion&#39;s ass, the large bulb forcing its way in until finally...

With a pop, $name has to resist the urge to downright howl. As his knot makes its way into the lion&#39;s ass, his cock drives deep and the feline&#39;s warm walls grip it with such tightness...!

It feels heavenly!

Driving his hips back and forth, the wolf still fucks the lion with his cock lodged inside him. It&#39;s enough to make the lion grunt and clench around it, and the grip on his knot is all that he, or any wolf, needs to finally...

&lt;&lt;print $name&gt;&gt;&#39;s tongue hangs from his muzzle as he feels his body getting overcome with pleasure. After being subjected to unbridled lust for so long, feeling something this tight around his cock and knot feels like absolute heaven. The wolf leans forward, almost lying over the lion. In a completely instinctual urge, he bites down on the back of the lion&#39;s neck. Like a feral wolf, he grips the lion&#39;s fur there as he feels his cock start spasming to finally mark the lion&#39;s insides deep with his seed.

The wolf&#39;s knot grows to full size and pleasure overcomes him for real. It is by far the best orgasm $name has ever felt in his life. The pleasure radiates from his cock, from his knot, and overcomes his entire being. For a few long, blissful seconds, there is nothing but pleasure.

Moaning, $name lets go of the lion&#39;s neck, panting as he drives his hips back and forth to milk his cock in there as it still shoots jet after jet of seed deep into the lion. His knot does not let a single drop escape, sealing it all inside as any canine should, with more and more getting added by the second.

The wolf&#39;s orgasm is hard and long and, even after it starts ebbing, his cock does not soften in the least. It remains just as hard as before, locked in the lion as he knows it will still be for quite some time. It feels great, however, and $name finds himself smiling without realizing, at least until...

With one sudden move, the lion&#39;s hand reaches over his head. The wolf feels something around his neck. Looking down, he can see it is... the pendant.

$name blinks. Through his fucking, he didn&#39;t realize the lion had freed his other hand, reached out for the pendant and now managed to place it over his neck.</tw-passagedata><tw-passagedata pid="130" name="Enthrallment Archive" tags="noreturn" position="1825,1100" size="100,100">&lt;&lt;if $lionFuck&gt;&gt;\
&lt;&lt;include &quot;Lion Fight (Text)&quot;&gt;&gt;

&lt;&lt;include &quot;Lion Pindown (Text)&quot;&gt;&gt;

The candle&#39;s lingering influence... it drives the wolf crazy, It&#39;s so hard to resist. This damned lion, one of Ivex&#39;s thralls, gave him so much trouble. He&#39;s asking for it. Looking down at the feline&#39;s tender hole, the wolf&#39;s cock pulses with life. As he keeps squirming, the lion&#39;s backside gets matted with the lupine&#39;s pre-cum. $name huffs, his eyes growing wide with lust and desire. It&#39;s right there, ripe for the taking...

The lion is a defeated thrall. Just a quick fuck to help relieve the urges...

&lt;&lt;include &quot;Lion Fucking (Text)&quot;&gt;&gt;

But there&#39;s no decision to be made. After being exposed to that candle for so long, the wolf&#39;s body is mad with arousal. He needs to knot, he &lt;b&gt;needs&lt;/b&gt; to, and with a huff of mad lust, he starts working towards it...

&lt;&lt;include &quot;Lion Knotting (Text)&quot;&gt;&gt;

&lt;&lt;include &quot;Mind Capture (Knot) (Text)&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
&lt;&lt;include &quot;Mind Capture (Text)&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;\

&lt;&lt;include &quot;Mind Capture 2 (Text)&quot;&gt;&gt;

&lt;&lt;include &quot;Enthrallment 1 (Text)&quot;&gt;&gt;

&lt;&lt;include &quot;Enthrallment 2 (Text)&quot;&gt;&gt;

&lt;span class=&quot;bad-ending&quot;&gt;Bad Ending: &lt;i&gt;Enthrallment&lt;/i&gt;&lt;/span&gt;

[[Return to the Archives|Archives]]</tw-passagedata><tw-passagedata pid="131" name="Enthrallment Archive Display" tags="noreturn" position="1825,1000" size="100,100">&lt;&lt;silently&gt;&gt;\
  &lt;&lt;set $lionFuck = false&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
\
&lt;&lt;if $enthrallmentEnding&gt;&gt;\
  &lt;b&gt;[[Bad Ending: Enthrallment|Enthrallment Archive]]&lt;/b&gt;
  Variation: &lt;&lt;nobr&gt;&gt;
    &lt;label&gt;&lt;&lt;radiobutton &quot;$lionFuck&quot; false checked&gt;&gt; None&lt;/label&gt;
  &lt;&lt;/nobr&gt;&gt;\
   | &lt;&lt;nobr&gt;&gt;
    &lt;&lt;if $enthrallmentLion&gt;&gt;
        &lt;label&gt;&lt;&lt;radiobutton &quot;$lionFuck&quot; true&gt;&gt; Lion&lt;/label&gt;
      &lt;&lt;else&gt;&gt;
        &lt;span class=&quot;helper-container&quot;&gt;
          &lt;span&gt;&lt;label&gt;&lt;&lt;radiobutton &quot;$lionFuck&quot; &quot;&quot;&gt;&gt; &lt;span class=&quot;disabled&quot;&gt;Lion&lt;/span&gt;&lt;/label&gt;&lt;/span&gt;
          &lt;small class=&quot;helper-text&quot;&gt;Engaging in arousing activities while overtaken by previous magical lust makes some things impossible to resist...&lt;/small&gt;
        &lt;/span&gt;
        &lt;&lt;done&gt;&gt;&lt;&lt;script&gt;&gt;
            document.getElementById(&quot;radiobutton-lionfuck-1&quot;).disabled = true;
        &lt;&lt;/script&gt;&gt;&lt;&lt;/done&gt;&gt;
    &lt;&lt;/if&gt;&gt;
  &lt;&lt;/nobr&gt;&gt;
&lt;&lt;else&gt;&gt;\
  &lt;span class=&quot;helper-container&quot;&gt;
      &lt;b&gt;&lt;span class=&quot;disabled&quot;&gt;Bad Ending: Enthrallment&lt;/span&gt;&lt;/b&gt;
    &lt;small class=&quot;helper-text&quot;&gt;Sometimes a magical accessory is for more than just the looks...&lt;/small&gt;
  &lt;/span&gt;
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="132" name="Lion Pindown (Text)" tags="text" position="1100,3600" size="100,100">The feline is good. Very good. How can someone this strong end up grinding herbs in some psycho mage&#39;s tower?! The wolf&#39;s wondering has to wait, however, because as the lion uses his legs to trap his own, things start getting ugly. Much to the wolf&#39;s dismay, the lion grips him closer than ever and, in that position, the wolf&#39;s cock finds itself hard-pressed against the lion&#39;s own member. It feels warm against the wolf&#39;s sensitive length, tingles of pleasure distracting $name from the urgency of the situation. The lion forces him back, climbing on top of him, dangerously close to pinning him down...

&quot;NO!&quot; the wolf yells at the lion&#39;s face. With a surge of anger, the wolf lets out a loud snarl and bends his knee, hitting the exposed lion straight on the nuts.

This time, the wolf sees an expression. Or, at least, a semblance of one. The lion&#39;s face twists in pain and, even though his eyes stay eerily still, the verge of tears can be seen in its corner. The feline loses his strength for a moment, and that moment is enough for the wolf to seize victory.

In one swift, precise motion, $name throws his weight to one side in order to topple the lion above him. The feline falls to the side, belly down, one hand gripping at his kicked balls, and within a second, the wolf is above him. Pressing a knee to the lion&#39;s lower back, $name pins the feline down against the ground harshly before grabbing the lion&#39;s arm and twisting it behind his back. Holding the feline like that, all the lion can do is squirm under him, but with the whole of the large wolf&#39;s weight pinning him down, his efforts are in vain.

&quot;The master&#39;s pendant must be worn by his thralls at all times,&quot; the lion repeats, grunting with stubborn effort to escape, but to no avail. The wolf, still panting and out of breath from the fighting, finally has time to catch it. He smirks. The lion is defeated.

Glancing to the side, the wolf realizes that they rolled back and forth so much that the rope is within his reach. All he has to do is uncoil it and tie the lion up, then he&#39;ll have time to properly...

Interrupting the wolf&#39;s line of thought, the lion tries to use his legs to escape the wolf&#39;s pin. For &lt;&lt;print $name&gt;&gt;, however, that&#39;s little more than a mild annoyance. The wolf, keeping the lion&#39;s arm firmly pressed against his back, shifts down to sit right on the lion&#39;s thighs and keep his legs in check.

However...

As he does so, the lion keeps squirming. When he does, the wolf looks down to see...

The lion&#39;s rear is toned and round. The feline&#39;s tail swishes back and forth in distress, but with his squirming, his cheeks move and up and down, back and forth... right against the wolf&#39;s cock. His erection sits right there, between the beautiful molds of the lion&#39;s ass, and his squirming just makes it grind against it. Tingles of pleasure shoot up at the wolf and, as he looks down with more attention, he can see everything. The lion&#39;s exposed ass. Bare. Vulnerable. It looks really tight...</tw-passagedata><tw-passagedata pid="133" name="Lion Fight (Text)" tags="text" position="1100,3475" size="100,100">The lion rushes forward. The wolf growls, bracing to meet the large warrior chest to chest. $name has fought many strong men before and, while many couldn&#39;t match the large wolf&#39;s strength and size, giving him an advantage, that is not the case with this lion. When the feline tackles him and pushes forward, the wolf finds himself losing his footing.

Before he can fall, however, $name spins, paws pushing back against the lion trying to grip and hold him so that they both fall side by side rather than letting the lion be on top. The wolf then props his knee up to try and get the upper hand and force the lion to roll with him to pin the feline down, but despite the lion&#39;s apparent mindless status, $name can tell that his fighting reflexes are still sharp.

The feline braces and pushes back, trying to force his way on top of the wolf instead. $name changes strategies, pulling the lion instead with the intent of using the other warrior&#39;s own momentum to roll on top of him. That gives the feline an opportunity to push even closer to the wolf. The two stand chest to chest, $name growling and the lion eerily quiet save for the grunts of effort as they wrestle on the ground. Each of them trying to get the upper hand over the other in a purely physical match.

There is one major distraction for the wolf, however. While $name has fought and wrestled many times, never before has he done it... entirely naked. And erect. Against a foe that is also naked and also hard. As the wolf shows his teeth and uses all of his muscle power to keep the lion from pinning him down, he can&#39;t help but feel his shaft grinding against the lion&#39;s fur. Against his leg as he throws the lion down and tries to take hold of the feline&#39;s arm...

The lion grabs hold of &lt;&lt;print $name&gt;&gt;&#39;s wrist and tries to twist it. The wolf has seen that move before, so he moves his body alongside it to avoid the pain that would follow, and attempts to force his way against the lion&#39;s hold. His muscles bulge with effort, as does the lion&#39;s, both of them panting from the effort... And his arousal won&#39;t go away. Neither will the lion&#39;s for some reason...

&quot;The master&#39;s pendant must be worn by his thralls at all... times...&quot; the lion says, grunting with effort as he keeps fighting. His voice still remains toneless save from the effect his effort has on it.

The two roll on the ground, muscle against muscle, each trying to end up on top.</tw-passagedata><tw-passagedata pid="134" name="The Spellbook" tags="key" position="1575,4725" size="100,100">Opening the large tome, it&#39;s plain to see that it is something of importance.

On one of its pages, a very intricate circle that even $name can identify as some sort of arcane incantation symbol takes all the space. On the page beside it, there is what seems to be the name and instructions on words to say for the incantation itself. The random page the wolf opens the book on only says &#39;Levitate&#39;. It&#39;s definitely some sort of &lt;span class=&quot;imp-info&quot;&gt;spellbook&lt;/span&gt;.

Pulling the spellbook closer to himself, the wolf leafs through the book, but every page is the same. A different incantation circle spread over an entire page and vague instructions on its side. The instructions seem to be words that need to be uttered to activate the incantation, but when the wolf reads one of them out loud, nothing happens. All of them mention a &lt;span class=&quot;imp-info&quot;&gt;gemstone&lt;/span&gt;. As he goes through the book idly, there are a multitude of them.

&#39;Growth&#39;, &#39;Thrall&#39;, &#39;Hidden&#39;, &#39;Desire&#39;, &#39;Itch&#39;, &#39;Freeze&#39;, &#39;Dumb&#39;...

Each incantation only has a word to describe it, though. No thorough description of its effects. Ivex probably doesn&#39;t need that... 

&lt;&lt;if $journalKnowledge&gt;&gt;\
After leafing through a bunch of them, the wolf&#39;s tail wags. This must be it! &lt;span class=&quot;imp-info&quot;&gt;Ivex&#39;s spellbook&lt;/span&gt;! With this, the wolf might be able to make the gemstone he needs to escape! Quickly going through the book, the wolf smiles as he finds what he is looking for. A spell called &#39;Teleportation&#39;.

&lt;&lt;if $lionGemstoneKnowledge&gt;&gt;\
Now, to craft a gemstone, all he would need is to find an empty gemstone somewhere that he can use to imbue the spell into. The wolf&#39;s tail wags even faster, a grin opening across his muzzle. The gemstones the lion had looked dim and empty.

With eager excitement, the wolf leaves the spellbook and pretty much runs back to the other room. Over there, the bound lion still squirms on the floor and, upon seeing him, seems to try to mutter the same words he has been saying all along again. $name ignores him, however, and goes straight for the drawer where he saw the gemstones before. With a large grin, the wolf takes one, then runs back to the spellbook.

He is ready to try and craft the key to his escape.

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
      &lt;li&gt;[[Try and craft the red gemstone.|Gemstone Crafting]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;
&lt;&lt;else&gt;&gt;\
Now, to craft a gemstone, all he would need is to find an empty gemstone somewhere that he can use to imbue the spell into. Where to find something like that, though?
&lt;&lt;set $spellbookKnowledge = true&gt;&gt;\

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
      &lt;li&gt;[[Leave the spellbook as it is for now.|The Desk]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;
&lt;&lt;/if&gt;&gt;\
&lt;&lt;else&gt;&gt;\
After leafing through a bunch of them, the wolf just grunts. It doesn&#39;t seem like the spellbook is particularly useful for someone like him if he doesn&#39;t know how to use it.
&lt;&lt;set $spellbookKnowledge = true&gt;&gt;\

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
      &lt;li&gt;[[Leave the spellbook as it is.|The Desk]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="135" name="The Journal" tags="" position="1000,4475" size="100,100">&lt;&lt;set $theJournal = true&gt;&gt;\
Pulling the journal close to himself, the wolf sits down to take a look. His bare rear against the chair reminds him of his forced nudity, but he forces himself to ignore it and focus on the contents of the journal instead.

It does seem to indeed be Ivex&#39;s personal journal of some sort. There are pages upon pages filled with writing. Some look like scribbled notes, some look like detailed writing, and as the wolf skims through it, its contents seem to vary wildly as well.

As $name goes through it, there are a few parts that catch his attention...

[[Continue|Journal Notes]]</tw-passagedata><tw-passagedata pid="136" name="Journal Notes" tags="" position="900,4600" size="100,100">Among the many, many pages of passages, some stand out...

Near the beginning of the journal...

* [[&#39;&quot;Memory Note-taking&quot;&#39;|Memory Book Notes]]

* [[&#39;&quot;Academy activities&quot;&#39;|School Notes]]


By the middle of the journal...

* [[&#39;&quot;Compression breakthrough and triumph!!&quot;&#39;|Tower Notes]]

* [[&#39;&quot;Gemonology was NOT for losers!&quot;&#39;|Gem Notes]]

* [[&#39;&quot;Fuck ethics, seed is EVERYTHING&quot;&#39;|Extraction Notes]]


Near the end of the written content of the journal...
&lt;&lt;if $lionDoor&gt;&gt;\

* [[&#39;&quot;Pathetic feline thugs&quot;&#39;|Lion Notes]]
&lt;&lt;/if&gt;&gt;\

* [[&#39;&quot;Reminders of fun stuff to do&quot;&#39;|Kink Notes]]

* [[&#39;&quot;Pitiful theft attempt&quot;&#39;|Thief Notes]]

The rest of the journal is still blank and unwritten.

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
      &lt;li&gt;[[Leave the journal as it is.|The Desk]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;</tw-passagedata><tw-passagedata pid="137" name="Memory Book Notes" tags="" position="1050,4600" size="100,100">This is the first entry in the journal. The calligraphy is neat and done with care, but the ink is already starting to fade, signaling that it might have been written a long time ago. It reads:

&lt;span class=&quot;handwriting&quot;&gt;
&lt;h3&gt;Memory Notes&lt;/h3&gt;

Professor Gallahan instructed us to write what he calls a &#39;memory book&#39;. He says that we should take note of absolutely everything, the more the better, in order to have our memories and experiences preserved in writing. It makes so much sense! I was very worried about botching the beginner memory spells we are learning in our mind-altering classes, but this makes me feel better.

The professor says that all experiences must be jotted down, whether good or bad, as even bad experiences provide wisdom and clarity when read over again. He is so wise! Truly a remarkable wolf. I have nothing but admiration for his kind.

The magic academy is the best! This is only my first week and already I got all of its routines. In the morning...
&lt;/span&gt;

This part continues on to some far too detailed notes of what seems to be Ivex&#39;s routine as a student, as well as notes from magic classes and a lot of random gibberish.

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
      &lt;li&gt;[[Read something else.|Journal Notes]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;</tw-passagedata><tw-passagedata pid="138" name="School Notes" tags="" position="1150,4600" size="100,100">These notes are smeared and poorly written, unlike most that surround them. They read:

&lt;span class=&quot;handwriting&quot;&gt;
&lt;h3&gt;10th of the Waning Moon, 5th&lt;/h3&gt;

Today, after physical practice, that damned wolf got to me again. He knows more telekinetic magic and is aware that I&#39;m not good at casting or countering spells without a catalyst yet. He insists on taking advantage of that. He calls me small, weak, puny, even though he is only a few feet taller than me! Alongside his friends, they torment me to no end.

After physical practice this morning, he thought it would be funny to telekinetically pull me up by the back of my undergarments, as he usually does. It hurts! I have a very hard time dispelling his magic when my own clothes are causing me so much pain. He takes advantage of that like a coward. I hate wolves! 

Today he dragged me to a classroom and hung me by my underwear right above its door.
&lt;/span&gt;

There&#39;s a pause in the writing and it&#39;s all smeared. It&#39;s barely readable...





h̸̨̨̛̦̙̠̼͖̘̲̻̱̯̦̟̹̜̗͉̺̙̦̦̟̣͂̾͗̔̎͒͑͂͌͗̉̐̓̃͛̔̚͘̕͜͜ë̴̢̼̝̘̰̫̞̩̮̳͍͙́̀̇̃̇͛̃ ̵̛̪̝̿͛̍͑̂̀͘c̸̨̛͖̗̤̭̟̮̖̝̦̜̰͈͚͓͔̖̰̟̣̖͈̙̜̝̼̮̔͑̈́̑̓̂̾͑̈̈́͛͑̅͠ą̴̢̨̨̼̠̹̰͍̦̟̟̞͈̰͍̩̥̜̯̩̜͒̔͗̋́̑̉̓͗̉̏̋̓̉͂͐̊͋͘̚͜ͅś̷̢̡̙͍͉̰͎̻̻̙̼̪̙̞̬͍̠̱̔͒́͊́͒̏͐͂̿̎̋̂̅̀̑̿̇̽̕͘͜ţ̵̨͙̙̰͖̫̝̲̈̅͗ ̷̢͚̗̻̜̗̙͕̻̯͗̈̇̈́̑͑̈̎͑̅͒̓̌͑̈́͂̀̍͛̏̈́́̈́̄̾͆̀̽̕͠ä̵͓̬͙̮̖͖̼̯̟̮͕́̄̓͆̉͋̓̃̓͂̈̌̉̄̓̄̑̓͛͑̇̕͠ ̶̡̥̭̬̙̹̼̪͔̥̺̱͇͍̦̫͍͉̘̻̣͕̹̠̹̖̪͇̰̏̋̍̆ͅs̴͈̱̅̓̇͛̒̽̓̄į̴̛̛͙̯̞͖͍̲̜̹̹͙̟̙̳̘̻̻̭̬̙̲̮̩̬͊͐͑̒͋͛̓̍̑̔̍͂̏͛͐͊̒̿̄̇̕̚̕͘͘͜͝͝͝ͅĺ̵̨̻̫͙͖͕̝̮̮̝͔͙̓̐̃̿̈́̇ͅë̸̛̞̯́̆̈͂̏͑̅̓̉͂̄̇͐̋̈́̏̉̏̎͝͝͝͠͠ǹ̸̛̳͙̲̙̙̟̟̙̫̦̞̠͓̯̯͐̌̔̆̉̈̈́͂͛̈́̍͝͝͠c̵̛̙̍͑͑̀̏̒̋̆̀̓̎̀̒͊͗̀̂̎̊̆͛̔̔̍̅̆̏̚͝e̶̢͕͓̺͉̜̲̣͙͔̱̩̤̻͙̰̭̬͍̤̞̻͙͆̂͑̄͘ͅ ̵̛͙̲̜͖̦͑̏͐̍̀̉̊̈̈́̐̆̈́͌̉͌̾̿̈́̍͑̓͌̚͝͠͝͠ȁ̴̡̝͖̣̤̜̯̘͕̦̪̱͖̥̟̹̞̙͕͗̒̑̆̀̈́̆̕̚͝n̸̨̢̛̤͍̫̰̣̳̞̪̻̥̘͖͚͈̠̺̅̏̌̓̈́̈́̂̇̑̆̇͌̂̑̌̊̿́́̾̈́̐͜͜͜͠ͅd̸̛͍̘̖͈̹̗̫͕͕͕̞̪̹͂̾̒̓̓̀̀̊̀͛̚͝͠͠ ̵̻͚̺͍̬͙̼̻̗̫͔͎̙̬̰̺̤̺͋̈̉̒͜͜͝i̶̛͕̜̺̼̖̻͕͍̣̖̼̰͉̬̙̰̩͎͖͕̫͓̲̟̣͖̘̫͎̘̇͆̈́̓͊͐̈́͒̎̌̄̾̓͐̄̔͊̎̔̈́̕͘͝n̸͕̟͔̻͐̽͂̀́̇v̷̡̖̮̦̼̰̼̯̬͇͈̫̪͗̅͐̾̄͆͘͜i̶̧̳̮͕͎̗͙̗͚̎̀͗̊͆̒͗͛͐̂͂̌̀̎͒̃̓̕͝ş̴̢̡̧͉͍̹͖͇͉̰̩͔͚͎̞̍̓̀̎͐̿̀̇͛͑̌̎̈̾̓̑͌̐̐̃̓͑͗̀͘͜͝ì̸̡̢͖̻̺̬̻͓̠̹̯̣͔̭̣̥̩̭̭̱̙̻̹̞̯̠̫̄́̆̒̀̊͂̽͗̆͘̚͜͝ͅb̴̧̛͉̤̝̹̐͒̽̏͗̔̉̍̀̂̃̈̌̋̀̇͑͆̓͐̓͘͘̕͘͠ǐ̸̡̯̣͚͙͈͖̹̰̻͚̬͔̭͓̯̫̤̖̞̩̀̉̐̅̅̏̌̂̑̽̒̅͐ͅĺ̷̨̛̰̗̠̻̗̦͔͓̜͚̖̳̰͍̠͔̤̼̖̈̋͂̏̓͌͗̕̚͜į̸̮̣͉̣̘̦̤̭͖̲͇̜̟͕̻̠͉͊̓̀̀̽̓͊̉̄̄̈́́͂̽́̅́́̕͜͝ͅṯ̶̨̢̧̛͓͕͙̖͓̳̜̘̪̮̺̩͖͖̞͚̭̻͇̝̣͔̒̅̑͐̄̇̋̌̀̽͊̌͋̽̒͛̇̉̆̓̈́̇͆̚͘͠͠y̸̯̙͈͇͔̙͎̹̯̲͈͙͎͔̥̫̬̳̯̜͔̫͍͑̅̔̉͑̾̀̎̈́̄̔̐͊͛͊̐̐̈́̃̑͂̋͑̂̐̂͜͠͝ ̸̛̛̯̖̮̻̥̰̱͍͙̭̜̼̱̼̼̖̻̱͕̣̬̌̋̾̄͐̂̅̾͑̈́̽̍̈́̊̈́͌̑̓̄̏̈́̃́̚̚̕͜͝͠ͅs̷̛͖̻̗̼̝̗̱̥̙̥̖͈̺̋̀͐̏̓̈̓̀̾͑̓̐͗̽̑̎̓͒̃͋̚p̴̢͖͖̉͌̅̾͐̒̽̈́̒̿̆́̐̈̌͒̔̀̏͌̎͗̾́̅͠͝͝e̶̦̻͔͎̗̪̼̮̬͈̱̖̱̜̯̣̘͉̟̥̪̥̙͍͒̑͐͌͐͜͜͠l̴̨̗̥̬͚̺̮̣͕̜̩͚̲̬͔͔̻̰̼͙͖͑̀̓̒̏͌́̽̍̆̔͒͌̒͂̓͑͘͜ḷ̶̨̨͕̣̏̎̓̀͜ ̸̢̞̠͈͍͚̔̋͒͗̄͒͋̿͆̋̇̾̈́́̽͛̏͝ö̷̧͓̣͕̬̋̉͌̆̋̐̆̓̍͌̐̈́̈̎̋̆͋̈̃͝͠ņ̴̡̨̛̖̲̝̯̭̤͉̮͎̞͚̜̬́̋͂̀̔͛͜͠͝ ̸̧̝̙͚̻̝̥͗̋̈̐́m̵̧̤̣̘̬̮̫̹̝̠͖̈͑͆̈͗̇̅̋̍̄̓̾̀̈́͐́͒̈́̄͂̅͜͝͝ȩ̷͈̜̪̠͕̝͒͗͆̊̒͐̒̇̉͂̈̽̽́̈́̑͊̈́͆͊͐̋͠ ̵̡̢̨̧̯͍͙̹̟̮͔̘̺͓̠͍̗̯͙̞̥͓̼̣̜̣̣̯͎̉̽̔̿͜a̵̧̛͍̾̌̓͆͂̈́̌̉̀͑͌͐̐̏͑̓̑̀̄̄̄͊̆̆̇͌͌̚ͅş̴̢̨̢̨͔͓̜͚͈̮̼͙̤͈̬̫̟̯̀̐͂̈́̔̀̾̉̍̈́̋̀͐̌͌̒͂́̚͘͝͠͠ ̴̻͚̹̠̻̳͙͉̉͋̃̎͋͂̆̈̑̿͊̈̍̃̀̀̓̌̎̚͘͘̕̕͝w̷̜̗͙͈̯̑̑͛̄̎̽́̎͗̕̕ĕ̸̢̧̛̛̖̤̖̺͔̘͙̫͎̰̼̫͉̼̖͖̏͂̇̒̄̿̌͛̒̔̆͑̎͂́̿́̒͑̑̾̕͘͘͝͠͝ͅl̷̨̝̖̣̦̥͙̾͂͊͛̓̉̂̀͠͝ͅl̴̺̣̪̬͙̉̃̌̈́̋̇͛͆̽͗́͋̾̐̅͒̅͒͠͝͠ ̷̛͓̼͓͎͑̓̈́͑͊̔͋̀̔͘͜s̸̟̣̥̗̦̑̓̑͂̉͒̉̾̅̃̚ͅo̴͉͙̱̣͕̻̦̝̦̿ ̷̡̧̧̹̹̣̱̭̰̣͉̻̮̥̻̦̻̻̙͇̥͉̳̔̋͋̿̿͐̑̊̆̒͘̕͝͝͝͝͝ͅẗ̸̺̪͓́̇́͊̍̄̂̾̇͌̑̈͘̕͘͠͝h̸̨̧̧̛͔͎͔̣̩̤̤̠̰̯̣̫͔̥̔́̊͑̌̒̒͗̿̍͌͌̀̋̎̉͆͗̑̍̉̾̚̕͘͝ͅà̵̢̮͓̫̜̲̮̫̺̰̼̻͈̖̦̜̰̬͙̟̝̤̦̼͜t̵̢̡̥̦͙̞͙̮̬̘̩̫͎̹̭̲̩̙̯̳̘̅̅̀̅̅̽̌̍͋̔͛̽̓͘͠ͅ ̵̺͚̙̤̒͑́̾̋̎̈́̽̔̓̋̌͌̌̈́͋͌̈́̄̌͂̐͘̕̕̕w̶̡͔̩͓̭͉͝͝ḩ̴̧̨̘̥͙̗̘̰͍̼̜̰͕͈̫̪̹̬͙̥̗̲͎̒͠ę̷̨̡̝͉̼̰̭̫̬̣̘̭͓̫͈͇̯̦̠̗͔̓͌̇̑̊͌̾̀̒͗̀̈́̐́̃̉͜͝͠ͅn̸̛̦̱̟̹̮̝̋̊́͗̊̽̌̐̌̆͐̅͒̆͛͂͑̂̏͐̎͗̅̓͘͠ͅ ̷̛̙͈͔̥̯͛͒̓̊́̐̀̇͌̎̀̒͆̑̿̑̅̏̍͘̕͜͝͠͝ț̵̨̤̤͖͙̰̮̪̞̳̝̱̰̠͉̗̱̳̬͕̀̑͂̂̽̽̈́̾̂̋͒͛́̍̾̈́͐̏̚h̷̨̛͚͔̫͙̟͚̲̙͓̮̪͉͈̥̩̼̹̭̝̾͆͗̃͂͌͐̀͆͛̔̾̃͗̀̍̑̇̐̆̚̕͜͠͠͝ȇ̸̢̡̢̡̧͙̜̭̖̝̰̝̮̦̩̮̟͈̠̬̫̲͖͈̲͖̱̜͂̄̐̄̅̕͜͠͝ ̶̡̨̻̩̯̠͎̙̘̯̆̿͒̓̀̉̄͒͠s̵͎̞̙̫̰̲͛̋͗̊̑̍̇͊͒́̋͋́͆̍̓̔̿̊̔̈̾̄͑͑͠͝t̴̨̨̧̡̛̛͎̫͉͚̱̱̻̠̘̬͍̦͙̯̥͈̘͈̯̓͗͑̄̉̇̆͛̉̉̔̆̐̒̾̆̀͂̈́́̌͜͠͝ͅứ̸̛̹̄̌̎̍͒͐̒͋̈́̀̃̊͛͒̿̋̒̈̕͝ḑ̶̨̧̢̛̮͓͓͈͍̮̲̙̘̰̳̰̘͙̎̃̒͊̌̅̽̀̀͗̾̓̕͝ȩ̷̡̨̛͉̮̣̣̥͚̱̲̰̤̲̱̥̮̰̼͚̝̦̰̝̭͈̂̃̽̎͑̈́̋͊͒̒̈́̃̈́͒̍̿͊̏͛̅̓̂̇̄͊͗̾͝ņ̷̳̣̲͎̖̳̲̹̝̝̤̟̼͍̰͔͓̞̭͍͎͓͙̰̤̐̆̋̒͑̾ẗ̴̡̨̡̧̛̛̰͇̹̭̗̤͖̤͇͕͔̜̖͔̦̠́̑͒̄͒̓͛̉͋̀͗́͝ͅs̷̰̟̟͓̱̲̹͔̈́̐̄̈́͊̀̀͋̂̀̽̈́͛͋͊́͊̓͌͂͋̈́̕̕͜͝͝͝ ̵̤̲͐̆̕ạ̴̢̡̧̢̧̙̠͕̟͔͎̰̘̩̤̞̻͎̗̣̻͓͕̭́̇̅̆̈́̅̆̔̊̓̆̾̍̆͌͂̅̉̿̓̈́̌̕͠͠͝͝͠ͅͅͅņ̴̨̨̢̧͚̭̣̟͖͉̻̖̭͍̳̹͕̣͌̔͒͋̈́̾̒͐̎̍̌͛̀͘͜͜͠͝d̷̢̧̨̧͉̩̼̯̥̹̞͈̘͖̥̖͈̫͙̙̘̟̭͇͕͖̎̂̿̒̐́̿̓͌̆̀̈̏̈̍͐͠ ̴̛͎̝̻̼̦̝̖̫̺̖̲̂̀͂͐͋̍̇̑̔̔͑͑̆̒͋̌̃͋̈́̐̇͝͝ţ̶͙̩̳̫͙̦̻̖̝͌͐̀̋̈̆̃͐̑̀͂̌͆̏̓̌̕̚͜͝ͅe̴̡̼͇͈͙̺̓̀̀͜ͅǎ̵̢̛̫̦̹͓͇̭͔̙͖̲͔̜̍͆͗̔̆͆̀̒̈͊̽̀̓̈́̎̂͆̑͒͑̐͑̔͘͝͝͝c̷̘̾̔̂̍̓̀͆́̈́͌͐̀̂̅͐̇̆̾̕̚͘͝͝ḧ̶̛̹̙̭́̃͗̓̃̃̉͂̊̍̑̓̎̕̚̕̕͝͝͝͠͠é̴̗̐̇̆͛̑̕̚͘r̴͓̰̦͓͇͇̮̭̮̹̻͓̘̘͔̀̅͆ ̴͕̩̙͕͔͖̱̀̿͒͛͐̀̅̿̃̋̈̉̓̊̽̋͂̇͊̍̋͗͒̉̚͝͠͝ͅw̵̡̯͔̍̽͝a̵̹̩̠͒́͋́̓́́̉̇̔͋̊͊̀̏̀̉͊͊́̊̋͊̀͊͘̕ļ̸̜̙̩̥̣͕̝̘͙̘̤̭̞͖͔͉̭͙̐́̋̕k̴̨̡̘͔̺̹͎̫͇͍͇̄̏̂̎̍͑̐͝͠ͅe̸̞̫͑̓̽͠d̴̯̦͚̫̯̀͑̂̏͆ ̶͔͚̪̠̥͍̑̔͆͐̅̚ï̶͚̍͊͆͋͋̈́͊̿̏̍̍͠͠͝n̶̛̟̱͍̫͚͓̯̮̝͓̬͈̬̮̠̈́̂̈͜͝ ̷̡̤̥̻̻͕̲̥̭͕͈̥͂̈́́̋͐̾̒́̅̒͝t̴̢̢̧̧̡͓̜̰̮̭̥̘̰͖̻͓̤̤̺̳̜̫̍̏̍̈͌͋̒̎͋͌̉̿͐͊̿̑̐̐̈́̓̈́̓̚̕͜ͅh̴̡̝͓̮̩̬̼̰̤͍̳͇͚̜̒͠è̴͉͈̱̖̻̰̙̮̲͔͈̦͍̥͔̹͙̒̒͊̂͌͋͊̅̒͘͜͝y̴̢̰͉̭͇̘̗̞͚̬̰̰̼̰̤̫̙̺̥̹͇̐̍̆̀͑̋͑̈̈̀̀̑͗̿̏̃̓̈͑͜͝ ̴̨̝̙̗͚͓̮͔̟̒̓̀̚w̷̡̛̛͔̼̗̖̲̰̪͍̟͖̻͕͓͎̩̬͓͍͙͙̣̟̗̹̞͉̭̉͋͗̀̈̏͗̉̒̌̅̀͆̽͠ͅờ̵̧̡͙͚̲͎͎̖̙͇̮̫̲̥̜̗̝̱̪̰̼̩̖̳̪͍̪̫͆̿̇̄̌̓͛͒̿͐̄͌̀̃̀̏̐̿͋̕͝͝͝ͅͅu̵̡̨̨̡͈̗̯̯̦̲̝̣̝͍̺̬̤̯͚̩̠̤̳̖̔̋̋̓̅́͋͋̀ͅͅl̷̨̢͙̬͙͉̩̦͇̻̻̭̮̝̩̠̠͙͓̱̟͓̦̗͕̝̻̫͆d̴̠͚̮̫͒̽͐̀́̆̄͊̎̒̅͆̕̚͘̚͠ń̸̡̛̛̠̙̳̙̲͓͉͔̬̭̝̱̭̭̝̘̘̾͐͆̍̄͋͋̊̆̽̑̈́̿͊͛̎̆̊͂̊̈̽͌̅̚̚t̶̨̧̧̫͔̻̺͙̖̠̖͖͓̻̗͔̺̞͇̹͓̜͉̒͒̏͐͗͒̏̏͋̕͜͝ ̵̢̛̺̗͈̻͎̮̦̯̙͒͛͆̀͆̑͋̈́͗̅̽̀͂̂s̸̨̺̳̟͕̳̙̜̦̖͔̟͙̠̲̯̺͙̠͉̬̦̥̲̥̱̰̪͈̓͜ë̴͈͚̫̰͇͓͙͆͌̐͌̐͋̂̾̈́͑́̏̇̉̿̑͂̈́͠͝ͅè̸̞̦̮̪̱̱̜̟̦̪̦̫̼̥̦̗̯̪̝̞̻̳̬̖͐̀͐̽̿̚ ̷̢̧̡̧̛͇̺̥̝̻̹̣͚̬̯͇̩̮̗̬̟̫̬͙̰̱̦̠̪̽̓̌̆̓͊͒̎͐͗̋̿̓̆̉͒͊̌͘̕͝͠ͅơ̷̭̝̝̥̮̪͓̹͔̪̐̀͗͂̓́̓̋͊͆̊̌͂̇̀̈̀̑̑̃̔͘͘͝͝r̸̡̯̬̻̰̭̭̹̙̜̗̪͔̳̦̗̈̑͛̑̅͊̎̈͒͛̿̎̎̚̕̕͜ ̶̲̞̾̀̏͒͆̌̈́̈́̈́̐̍̏̉̅͌͋̔̄̅̽̀̈̔̑͘̕͝͝h̵͕̖̘̳̝̟̬̞͓̮̻̯̦̟̙͖̹̭̜͎͈͓͉͚̟͒͒̽̍̈́̀̐̌̏̀͊͂̀̇̍̿̿͆̏̌͘͝͝͝ͅè̶̡̗̳͈͙̥͔̣̟͕͖̤͊̏̾ä̵͔͐͊͌̍̈́̅̂̉̇͆̿͗͑̂̿͑̂̿͋͑͐̔͆̍̀͛́̚r̶̡̨̞̠̞͔̻̬̺̯̣͚̯̦̹̼͕̬̮͉͓̯͂͆̊͋̍͑ͅ ̴̛̗͈̩̫͙̩̰͚̰̹̰̖̇̒̓̾͒̂̀̐͛͐̃̅̓̇̀̚͘͘ͅm̵̢̡̡̧̖̹̼͓͍̤̩̤͍̼͔̰̘̥͚̻͑͋͂̅̋͘͜ẽ̷̢̡̨̡̡̼̼͓͓̖͇̟̰͉̭̘͇̝̝͈̻̜̦͔̗͛͒̿̿̽̌̐͛͆̉͑͆͠ͅ.̵̛͉͚̌̓͊̓̊̑̆̎̌̇̈́̐͂͗̈́͂͛̎͒̿͝ ̴̡̧̳̺̲̰̙̲͉͉͓̰̲̯̱͎̰̲̑͛͐̀̉Ṱ̵̡̨̡̧͈͔͉̯̱̺̦̻̻̣͙͙̮̮̲̺͇̯̹̪̃̐̆͊h̶̨̡̧̨̼̦̼͇͎̯͎̭̻̟̯͕̦̲̱̖͖̘̜̫̟̝̰̖̉̑̉̌̉̄̋͑̄̄̉͛͆ͅe̶̡͙̠̠̻͖̜͙̫͇̪̞̲̳̲̜̱̦͊̈́̆̊͌̔͘͜͝ͅͅ ̸̡̡̹͎͕̯̹͔̬̖̱͈̰̰͎͕̞̺̣̬͒̇͑͌̈́̂́̈́̈̎͗͜͝s̴̨̧̡̧̫̱͖̠̬͕̮͍̤͇͉̯̬͗̏̓̀̑̽̉͗̓̈̇̾̽̾̈͌́̚͠͠ͅp̵̢̢̛̛͉̹͖̻̰̱̙̞̭̜͕̲͔̗̹͈̫̱̀̎̈̔͋͂̏͠ẹ̶̡̛̛̛͇̠͚̼̥̟̫̫̠͚̤̱͚̲͍̳͈͙̹̹͛̂͑̽̈́̚ͅl̴̨̘̘̙̻͉͍̭̖̱̺̤͒̉͐͛͊̊̓͋͊͊̎̅͘͠l̴̛͙̠͙̬̠̲̲͔̘̦̀̂̽̃̿̋̐͆͘͝ ̷̧̛̛̯̤̬͇͖͙̞̟̝̜̞͎̮͈̙̃̄̄͋̾̋́̏̔̋͗͆̈́̒ǫ̴̛̝͙̫̹͔̺͔̗͍̠̰̞̖̓͊̽̈́͊̊̎́̋́͛̑̉́̇̀̑̿̈̚̕͝ͅn̵̢̬̦̙̟̗̯͂̀̈̄̀͊̍͐͋͂̔̅͗̔͌̓̑̚̕͠ľ̸̩̫̺̭̺̰̹̜̘̊̒͋̈̑̉̔̊̇̓̉̆̆̈̓̈́̓̚̕̕͘͝͝͝͝͠ͅy̶̡̛̛̯̻̳͚͈͔̥͇̹̫͈̤͙͓̳̟̫͚̻̭̤̦͓͂̿̋̅̍͐̄͐̃̊̂̈́͋͜͜͜ͅ ̶̢̢͙̺͉̼̺̗̠̲̜͕̯̭͍̤̘̾͌̾̎͊͛̓̈́̏͒̆͂̎̇́̾̀͘f̶̣̯̀̓̆̍̐̂͊̽̈́͒̏͠͠͝ạ̴̟͉͈̜͇͕͓̤͍̺̀̅̀͆̎̔̀̉͊̕̚͘̕͠d̷̘͎̭͙̮͓̗͈̣̟͖̪̳͍̩̥̐̈́̌̅͐̽̔̽̏̋̈́͆̿̅̐͜e̵̢̲̭͎̦͈͓̙̻͔̜͕̒̿́͒ḑ̶̢̢͉̺̲͙̩̳͎̭͙̮̮̩͓̘̝̝͋͐̃̇̔̈̕̚ ̴̢̨̦͓̖̻̻̰̲͔̦̘̣̮̺̙̱͇̹͖͕̟̺̣͙̼̤͖̃͂͑͊̆̈́̑͌̂̂̿͛̎̈́̆͜͝͝͝ͅẘ̸̺̫̙͉͎́̓͐̍̿͜͝ͅḩ̵̡̢̛͇͙̬̺̫͙̪̱̲̫͔̟͔̣̠̻̦̫̗͑̃̓͂̂̀̊͋͆͋̔͐̍̄̏͗͛̔̎̿̉̔͆̚͘͝͠ę̴̖̩̳̣͔̜͍͇͍̬̍n̷̡̛̗̮̥̟͎̱͉̼̤̂́͊̃͆̊̒͌̂͆̉́̊̈̏̂̇̆̿͐͐̇̍̈́̆̚͘͠ ̶̙̫͓̞͖̩͆̈́͆̒͂̓̽̅̍̀͐̏̓m̵̼͇̠̽̔̂͊̑̿̕̕ÿ̸̨̨̛̹̘̙͈̤̬͈̪̪̞̝͕̲̼̯̗̫͚̥͖̘̘̪̯̥̗́͒͛͑̃͘͜ ̶̨͍̬̮͊̏̉͑̃͑̌͛͊̒̄͘̚͠͠ͅȗ̵̼̜͗͒͝n̷̡̙̟̯̣͖͉͔̫̺̞͚̗͉̘̣̿͗͗̈́̽͆́͜ͅd̵̺̉̏̒́̆̎̀̓͋͛̏̾̔͗̇̈̉͂̔̊͊́̎̒͝͝ę̸̧̲̰̳̳̜̗̻͇͔͚̰̱͚̰̣͙͖͔̯̓͂͆̀̀̐̀͝r̵̨̬̪͓̗̲̖͍̲̯͎̩̲̀̀̆͒̎͗̈́͗͌͆̽̐͛͗̽̔̀́̌͝w̵̥͓̹̓̃̍͋͂͊̑̀̒̈́͂̀͐͊͛͋̋̇͊̐̏̏̐e̸̡̨̲͍͓͈̞̜͔̭̗̔͊͗́̓̓̽͌͆̈̈́̔͆́͒͜͝a̷̧̧̖͉͚̙͓̦̟̱͖̝͖͚͆́̈́͐͛̄͜r̶̢̠̩͔̪͍͎͚̙̭̦̮͎̋̊͂͗͊̇̌̓̏̄̍̒͠͝͠ ̷̨̨̰̬̦͔͊͒̾̋̓͊͗̄̇̍̓̋͊͗̏͘͝r̷̢̡͎͚̪̩̮̘͙̪̭̜̗̫͖͚̅̽̈̚͜ͅͅi̴̫̘͙͎͇͚̞̠͎̪̘̤͇̝̦̱̞̗͙̳͚̤͗͋̊̄̆̿͠p̴̛͇̈́̊́̈̇̀̅̄͌̅̾̉̊͂͂̒̾̄̆̿̃̚̕͝͝p̷̧̧͉̻͎͙͈͚̹̹̩̠͕̦̗̫̬̞̥̬͇̦̰̥̞̿̈́̀̾̐́͑̾̔͋̄͐̃̋͌͛͐͊̑̋͒̈́̽̽̕͜͠͠ȩ̸̛̤̐̓̿̍̂̇͆̒̍̈̀̄͑̈́̈́̎́̌͗̋̚̕͠d̵̫̮̭̺͎̹̻̭̤̠̖̻̥̫͗̔̑̀́̓̀̀̽͛̾͊́́̈́̐̄̔̿̍̍͆̊͘͜͝,̷̨̥͖͕̺̤̜͖̙͈͕̖͈̳̺͇͍͎̥͕̯̲̣̓́̈́̋̏̌͌̂̈͌͑̌̉͗̀̔̄͌̏̒̋͒̏̒̾͘͘̕͝ ̵̧̧̺͖̯̤̱̬͉͚̬͙̝͖̮̪̜̩̞̬̜͕̺̙͙̗̪̱̱̱̌̀̂̄̋͆́̃͘͘̚͝a̷̡̡̨̛͔̯̲͙̩̪̤̮͉̮̟̮̹̩̦͉̼̭̤͕̜͔͈̩̟̰̒̿̽̑́̄̇͛̔́͌͒̌́̍̓͋̕̕͜t̶̡̧̧̛̛͍̮̝͔͖̦̙̞͈̥̿̀͐̍̔̔̎̑́̃̍̓̅͜͜͝ͅ ̶̧̢͓͙̺̣͇̦̣͙̹̻͗̏̓̂̓̎͗̍̉̇̌͋͒̅́̐̋̾̄̃́̇̏͌͑̎́͑̚͜͝ẇ̸̧̡̡̛̯̼̜̼̦̙̬̫̟̖͛͑̆̒̕ͅh̴̩̰͚͖̼̯͍̖̳̣͍͍͙͕͈̩̊̈́̔͜ì̶̧̖̖̠̙͉͈͖̫̩͓̫̮̾̊̏́̄́̿̌̽͛̾͛͆͂̕̕͜͝͝ç̵̛̖̟̭̩̱̩͇̟̘̯̰͎̼̬̩̤̩͕̭̏͌̅̅̾̇́̅̿̒̔͐̍͗̆̍́͌͋̉̑̕͜ͅh̶̡͔̹͉̘͈͇͍̥͈̩̻̟̟͓̩͊͋̊̈̉͒͗̾̑̐̉̿̇̐̉̕͝͠͝ ̶̨̙̼͇̪̳̟̮̺͓̈́̆̋̔͑̄͌̑͑̋͝͝p̵̜̬̪̩͚̜̰͍̟͔̺̲̯̼̘͉̃͌̾͋̑̒̃̃̓̏͌̎̓̓͊̌̅̒͒͘͘̚͘͜͠ͅǫ̵̙̺̟̳̙͇̫̖̮̠͍̹̥͎̗͎̖̬̠̞͉̟͉̓̃̄͗̊̓̈̉̅̒̒̔̀͛̋̀̑͋͗̄͝͝͠ḯ̴̱̜̘́̿̈̆͐̎̑͒́̉̿̀͊͑̎̔̕͘͠ņ̴̢̛̛̫͙̮̺̳̝̯̯̟̜̱̟͇̹̊̊̐́͑̉̍̄͆̉̇̓̀̿̍̿͘͜͠ẗ̸̡͎͕̟͓͙̙̠̹̯̞̼͍̯̝̲̖̰̠͛͜ ̶̨̣͖̳̰̣̭̱̮̟͔̞̞̩̙͍͇̃̈́̋͊̌̓͒̄͑̍̉̓̀̇́͌̀̚̕͘ͅţ̷̱͚̲̦̥͙̘͎̬̝̮̥̙͙̭̯̊̂́̓̾̄̋̈̉͆̉͆̐͌̈́̀̚͘͘͜͝h̷̢̢̛̗̦̦͎̝̻̝̻͖̻̩̯͍̾̏̒̏̓͆̄̿͌́̄͌͐̔̃̾͊̈́͒̆͒̓ę̶̨̨̨͇͎̳͉̭̤̘͙̗͕̜̞̩͚̅̀̃̾́̓̏̉͌̆̀̋̀͗̉̿͝y̷̧̪̤̫̗̯̫͎͎̳͍̜̦̣̮͉̪͙͍̖͔̮̥̞̗̰̙͌͜͜ͅ ̸̖̓͑̾a̶̢̧̢͎͉̺̞̭̳̣̤͉̭̰̙̦̜̱̘̗̟̥̫̗̼͈̙̹̺͋͛̏̋̎̈́̏̈́͜͠l̶̡͚̻̳̜̳̐̀́̑̑̈̀̇̈́̂̕͘l̶̡̫̖͉̳͚̰͇̠͇̲̗̝̟͓̥͈͎̰̥̳̐̎̊̑͗̍̈̆͑͂̿͝




&lt;span class=&quot;crude-handwriting&quot;&gt;
fuck writing this
&lt;/span&gt;

After that, the next routine writing seems to take place several days later and it becomes more methodic, but not very interesting.

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
      &lt;li&gt;[[Read something else.|Journal Notes]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;</tw-passagedata><tw-passagedata pid="139" name="Tower Notes" tags="" position="1050,4700" size="100,100">This note stands out amidst a bunch of unorganized notes. The writing at this point is more sporadic and rough. It speaks of concerning matters. It reads:

&lt;span class=&quot;mild-handwriting&quot;&gt;
&lt;h3&gt;Completion!&lt;/h3&gt;

I did it! Let it be recorded that I succeeded in my experiments! The compressing of matter inside the faceted reflections works! Stealing these books from my old academy&#39;s library was the best decision of my life!

There&#39;s still much to do. It&#39;s not sustainable. Without a continuous source of rather powerful energy, it collapses back into reality in a matter of minutes. Less if the structure was larger. My mind races! Energy...

possible sources of energy:
* &lt;s&gt;pre-charged gemstones&lt;/s&gt;
* &lt;s&gt;sun-converted rays&lt;/s&gt;
* &lt;s&gt;artificial fire furnace&lt;/s&gt;
* blood magic?
&lt;/span&gt;

The rest of the notes on this page are crude drawings of both things that look arcane and things that just look like very poorly done drawings of objects...

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
      &lt;li&gt;[[Read something else.|Journal Notes]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;</tw-passagedata><tw-passagedata pid="140" name="Gem Notes" tags="" position="1150,4700" size="100,100">These notes stand out amidst a bunch of unorganized notes. The writing at this point is sporadic and rough. They seem to talk about &lt;span class=&quot;imp-info&quot;&gt;gemstones&lt;/span&gt; though. It reads:

&lt;span class=&quot;mild-handwriting&quot;&gt;
&lt;h3&gt;Gemstones&lt;/h3&gt;

That utter fool Gallahan calls himself a professor in that fucking cheap academy and said that gemonology was an outdated magical art because of its &#39;limitations&#39;.

I say fuck them all. So what if I need gemstones for all my spells? They work, and with this, I can have them stored in ways no other mage can. The progress and breakthroughs I am making go beyond their close-minded dreams.

In a gemstone the world is literally mine.

I am synthesizing a way to easily create them. I will need to steal more, but I have a vast supply and they are easy to reuse. My compression experiments are a success. The only thing the gemstones don&#39;t seem to be able to do is to solve my energy extraction problem. I will have to look elsewhere for that.

I have devised a spellbook to make gemstone spells. The spell is in it, the gemstone absorbs the magic from the arcane circle as it was made to do, and the spell is done! The only downside is that anyone can use them by just clutching them with their hand. Maybe I can attune them to me alone somehow. Note to look into that later.
&lt;/span&gt;

The notes that follow this get far too into magical terms for the wolf to properly make use of it.

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
      &lt;li&gt;[[Read something else.|Journal Notes]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;</tw-passagedata><tw-passagedata pid="141" name="Extraction Notes" tags="" position="1250,4700" size="100,100">These notes stand out amidst a bunch of unorganized notes. The writing at this point is sporadic and rough. Ivex seems to write about his plans but in a confusing manner. It reads:

&lt;span class=&quot;mild-handwriting&quot;&gt;
&lt;h3&gt;Extraction methodologies&lt;/h3&gt;

I have done it. They said it couldn&#39;t be done, but fuck them. I have done it. A completely self-sustained structure that is mine and mine alone!

I will need more subjects to make it truly sustainable. From my calculations, I will need at least five? The two I have so far are only enough to sustain their prison and a little more. If that obnoxious wolf knew what his fate was going to be when he messed with me in the academy I bet he wouldn&#39;t have dared even look at me. Once again, I prove to be the superior being!

Theoretically, the more I get, the more I can expand. I can build something truly beautiful, magnificent, and of my own! And all of this at what cost? Breaking &#39;ethics and morals&#39;? Isn&#39;t putting useless people to a better purpose the right thing to do? And the way I devised it, it&#39;s not as if they are not enjoying themselves. In a way.

I will admit that I only decided to use semen instead of blood because it has a higher concentration of energy from the get-go, which I can absorb immediately. Maybe I would have ended up going this route regardless, as it is much easier to upkeep and maintain production of it with the assistance of a few other basic spells. I have developed some of those further as well to astounding results. Each day my research progresses more and more!

The most arduous process is the creation of more of the extraction material. The heavy alchemy required and the volume of semen needed to attune it to its extraction still need to be expanded upon. I can mix my own semen with aloe and carcinatus ground together and feed it to it little by little, but I can only produce so much semen myself and it hasn&#39;t been pleasant. Note to come up with a solution for this problem as well...

Little by little, my plans come to fruition.

Note to make the attunement of the extraction material process to myself easier as well. If the material were to ever think I am an extraction subject when I touch it, everything would be lost. Maybe with less blood. Duplication magic might work?
&lt;/span&gt;

There are drawings and sketches beneath more strange notes. The drawings are little more than circles, though. Circles with stick people inside them. What does that even mean?

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
      &lt;li&gt;[[Read something else.|Journal Notes]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;</tw-passagedata><tw-passagedata pid="142" name="Lion Notes" tags="" position="1050,4800" size="100,100">These notes are written in a brasher way with much less care for the handwriting. They seem to mention a lion, which reminds the wolf of the one he&#39;s seen in the tower, making them possibly worth reading. It reads:

&lt;span class=&quot;crude-handwriting&quot;&gt;
Today when I was shopping for ingredients at the Kargaro markets, two tall men grabbed me by the shoulders and led me to an alley. Taking off their hoods, I found that they were fellow felines: a tiger and a lion.

Just because they were several feet taller and more muscular than me, they thought they could rob me. Utter, absolute fools.

My writing can&#39;t convey my feelings at the time. I smiled wide. When I went shopping for alchemical herbs, I was trying to solve the conundrum of needing more subjects, and then the subjects just bring me to a dark alley and offer themselves to me.

They pulled out daggers and threatened me. I laughed at their face. I had a few extra transportation gems on me, so when the lion charged at me spouting nonsense about beating me up, I just pointed it at him and poof.

The look on his tiger companion&#39;s face when I made his thug friend disappear was utterly priceless. He thought charging at me as his friend did would work. These brutes are all just about as useful as mindless ferals. Needless to say, he met the same fate, and I left that alley with a big smile on my face knowing I had two new subjects to play with.

Once back in my domain, it was the simplest matter to subdue them both. I had some fun with them. Both of them were scarred, seasoned warriors, and I managed to make them tell me they were former mercenaries stealing because of work shortage. Pathetic.

I put the tiger in extraction, but I like the way the lion looks. He has a beautiful mane, a sculpted body and is well-endowed. I enjoyed playing with him, maybe also because lions tend to look down upon panthers. Who is inferior now, I asked him as he crawled between my legs and licked my balls.

I decided it would be a waste to just throw him at extraction as well and, instead, I decided to use him to experiment with my new enthrallment spells. They are still simple, but they seem to work well enough.

He now obeys my orders without thinking. Literally.

I will keep tweaking with his mind, however. The enthrallment spell coming from a gemstone is indeed inefficient. It needs to stay with him at all times. I would like to find a way to make his mind-altering permanent so that I no longer have to worry about him, nor do I need to waste a gemstone on that.

I need to make the spell better as well. Suppressing his own mind works, but it makes him too simple and dumb with nothing but my weaved rules to live by. Last week I ordered him to stay still while I fucked him against a table and, when I was done, I just walked away. Next morning I found him still there in the exact same position standing still with my dry cum around his ass. Similarly, when I ordered him to clean up some semen I had shot on the floor in my office with his tongue and left, I found him the next day still working on cleaning the office as a whole with his tongue. It was funny but highly inefficient.

For now, the temporary solution was to keep the simple spell in a gemstone while multiplying the sturdiness and cursing strings to fashion a pendant. It makes it indestructible and unremovable, but it will need further refinement. So much to do, so little time.

At least now I have some help around the tower. More thralls would do nicely. Perhaps a way to make the spell permanent could involve...
&lt;/span&gt;

This seems to be where the notes about the lion end. The topic of the notes changes to magical gibberish on mind-altering magic.

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
      &lt;li&gt;[[Read something else.|Journal Notes]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;</tw-passagedata><tw-passagedata pid="143" name="Kink Notes" tags="" position="1150,4800" size="100,100">These notes are written in a brasher way with much less care for the handwriting. Around the page, there are marks left by some kind of dry liquid and, when the wolf touches them, they feel a tad sticky. It reads:

&lt;span class=&quot;crude-handwriting&quot;&gt;
Ideas to try

Earlier today, my thrall was cleaning the office and I was bored. Appreciating the nice view of his bare ass as he scrubbed the floor, an idea hit me. I decided to order him to get the broom as far up his ass as possible. It was an incredibly funny and hot scene seeing that big, imposing man struggling to get the broom into his ass. When I thought he had had enough, I ordered him to clean like that, brushing the floor with it inside his ass. I never laughed so much in my life. Not only that, but I made him clean my seed off the floor like that too after I spilled it from jerking off while watching.

This got me thinking of other fun things I can do with these thralls. I must write them down so I don&#39;t forget my most brilliant ones

- interdimension teleport portals
creating simple and small versions of the dimension hop used for teleportation I could create small interconnected portals and use them for my amusement. This gives me many ideas
-- attach a portal to the thrall&#39;s balls and attach his balls to a mortar, then order him to grind herbs all day using his own balls to grind them

-- &lt;s&gt;put thrall&#39;s snout through portal and leave it over a lit arousal candle to have fun with his bodily reactions&lt;/s&gt; thrall would look ugly with a portal on his face, unpleasant to look at
-- leave thrall with his head through a portal and attach head under my work desk for ease of pleasure during work

- continuous mage hand spells
supplying a gemstone with a mage hand spell and a source of continuous energy supply I could maintain it for hours, maybe days
-- hang mage hand crystal on the thrall&#39;s balls and have a hand enchanted to finger fuck him the entire time (would make it nice and loose for fucking)
-- hang on thrall&#39;s balls and have hand edge the thrall the entire time. would &lt;s&gt;require magical precision on subject&#39;s arousal state&lt;/s&gt; orgasm inhibitor

-- order thrall to fight off hands and make them incorporeal so he cannot do it. have them assault him sexually just to watch him struggle

- modify thrall spell to make target aroused from laughing and enchant feathers to tickle him until he orgasms multiple times
- make thrall luminescent and hang from tail on ceiling
- have thrall cum on his food before eating it

- make him fuck funny things: a cake, mud, ice, his own ass?, sand
- turn thrall&#39;s bed into perpetual ice and have them masturbate lying on it
- do all of the above while thrall has the chastity from my chaste spell around his sheath? &lt;u&gt;funny&lt;/u&gt;

More ideas would be possible with multiple thralls. Ideas for two thralls:

- have thralls spank each other and see which one cries first
- make thralls suck on each other&#39;s...
&lt;/span&gt;

There are dozens of other ideas written here, but the anger inside the wolf makes him growl and stop reading them. The only useful information that comes from this section is the absolute certainty that Ivex is a perverted madman.

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
      &lt;li&gt;[[Read something else.|Journal Notes]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;</tw-passagedata><tw-passagedata pid="144" name="Thief Notes" tags="" position="600,4775" size="100,100">These notes are written in a brasher way with much less care for the handwriting. The ink in these notes is dry but still strong, signaling that they might be recent. It reads:

&lt;span class=&quot;crude-handwriting&quot;&gt;
There was a pathetic attempt to escape my tower last night. The sly little fox adventurer I captured last week was left bound to my wooden cross in the extraction hall. I planned on going back to play with him in the morning, but what I found was that the cross was empty. The fucker had managed to cut the magic ropes I used to keep the cross in place and got away.

Luckily, even a stupid animal can be crafty sometimes, but ultimately their dumbness catches up to them.

When I arrived at the extraction hall this morning, I found him not on the cross as he was supposed to be, but rather already stuck in a different way. HAH! The fool must have gotten curious or thought he could steal something valuable from me. He messed with what he wasn&#39;t supposed to mess with and paid for it dearly. The sight of him stuck there and the way his drowsy eyes looked at me gave me immense pleasure.

Admittedly, it is also a pain in the ass. The extraction substance was not ready yet. Luckily, I had already adjusted it to retain bodily functions, or else the fool would have gotten himself killed. I had also already adjusted its extraction capabilities, but not its rate, so it was funny to see him failing to produce enough as it kept trying to take more out of him.

Regardless, I hadn&#39;t finished attuning the extraction substance to me either. That forced me to use a strong repellant spell that took hours to create in order to be able to pull him out of it and it still wasn&#39;t easy.

I had planned on maybe making him a thrall, but after pissing me off like that, I pulled him out from the incomplete extraction substance, carried him, and threw him straight into a complete one. He begged me not to as I did it, but then, as usual, as it did its work, there was nothing but sweet, sweet silence and the knowledge that he would no longer bother me.

Unfortunately, my repellant spell wore off, and I did not notice that he had a &lt;span class=&quot;imp-info&quot;&gt;red gemstone&lt;/span&gt; in there as well. He must have dropped it once the substance took hold of him. To think that the key to his escape was right there, so close yet so far, is humorous. In the end, it was left inside the incomplete substance. Fucking hell. In a few more days, the substance will be complete, then pulling it out of it will be a simple matter.

To think he managed to make one, though... the fucker doesn&#39;t know how close he was to escape, and if he did, that would be problematic. How did he find my empty gemstones? How did he know to use my spellbook to make a teleportation one? I imagine he must have seen me do it while he was bound. I should be more careful.

Next time, I will take the cross to the upper office and have my fun up there. I also need something better than magic rope to keep the thing still so that they cannot escape. Maybe gravity crystals will work.
&lt;/span&gt;

&lt;&lt;if !$journalKnowledge&gt;&gt;\
This is the last entry in the journal so far. The wolf&#39;s eyes go wide. This is useful information!
&lt;&lt;else&gt;&gt;\
This is the last entry on the journal so far and, thankfully, it has already proven to be very useful.
&lt;&lt;/if&gt;&gt;\

[[Continue|Notes Knowledge]]</tw-passagedata><tw-passagedata pid="145" name="Notes Knowledge" tags="key" position="400,4825" size="100,100">&lt;&lt;if !$journalKnowledge&gt;&gt;\
Re-reading the journal entry one more time, the naked wolf&#39;s tail wags back and forth. That poor fox, wherever he is, left very useful information in these records! If that fox adventurer could have escaped the tower, then so can &lt;&lt;print $name&gt;&gt;.

All he needs to do is gather the right things...

It seems that what is needed to get out is a red gemstone that lets the user teleport out of the crazy tower. When the wolf thinks back to his time bound in the cross, before Ivex left, the memory of the panther clutching a glowing red gemstone makes the wolf&#39;s ears twitch. That has to be it! If he can get his hands on one of those...

But how?
&lt;&lt;/if&gt;&gt;\

According to these notes...

The fox that tried and failed to escape had a red gemstone made for that purpose. That gemstone should currently be &lt;span class=&quot;imp-info&quot;&gt;left somewhere in this very room&lt;/span&gt;. That is if Ivex hasn&#39;t had the time to get rid of it just yet...

Alternatively, it seems to be possible to make one. According to the text, it isn&#39;t too hard to &lt;span class=&quot;imp-info&quot;&gt;make a teleportation gemstone&lt;/span&gt; like the fox did. 

Making one seems to require that the wolf use &lt;span class=&quot;imp-info&quot;&gt;Ivex&#39;s spellbook&lt;/span&gt; that is mentioned in the text, as well as an &lt;span class=&quot;imp-info&quot;&gt;empty gemstone&lt;/span&gt; to apply the spell into.

The wolf can&#39;t help but smile. Escape is definitely within his reach! The adrenaline coursing through his body makes the wolf&#39;s magically erect cock throb as well, which in turn annoys him. Yes, he can escape and then get rid of Ivex&#39;s vile magic to then, somehow, get rid of the panther himself later.

All he has to do is get his hands on one of those red gemstones. $name knows that gathering more information on what he has at his disposal is vital. At the same time, however, there is no time to lose. Ivex has been gone for a while and he might be back at any time.
&lt;&lt;set $journalKnowledge = true&gt;&gt;\

&lt;&lt;if $spellbookKnowledge || $blobGemstoneKnowledge || $lionGemstoneKnowledge&gt;&gt;\
The wolf&#39;s ears twitch and his smile widens. He, in fact, already has some knowledge about these factors!

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
      &lt;li&gt;[[Assess his knowledge...|Knowledge Assessment]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;
&lt;&lt;else&gt;&gt;\

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
      &lt;li&gt;[[Read something else on the journal.|Journal Notes]]&lt;/li&gt;
      &lt;li&gt;[[Sift through the other contents of the desk.|The Desk]]&lt;/li&gt;	
      &lt;li&gt;[[Get away from the desk and look somewhere else.|Extraction Room]]&lt;/li&gt;	
  &lt;/ul&gt;\
&lt;/div&gt;
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="146" name="Gemstone Crafting" tags="key" position="825,5200" size="100,100">The naked wolf pulls the desk&#39;s chair and sits on it properly. He sets a gray gemstone from the lion&#39;s room on the table and pulls the spellbook closer to himself.

With a frown, he begins looking for the right spell. Luckily, it doesn&#39;t take long for him to smile as he finds what has to be the right one.

&#39;Teleport&#39;.

It has some drawings of a gemstone and what seems to be something coming out of it. The wolf can&#39;t quite tell what that means, but the circle on the opposite page looks as genuine as the other ones. $name has never done anything of this sort, but recalling the journal&#39;s notes, the wolf brings the empty gemstone over and sets it right in the center of the drawn circle, then turns to the other page to read the incantation words.

They make little sense to him. Magic words that sound like a lot of mumbo-jumbo. The warrior reads them out loud, squinting his eyes and unsure if he&#39;s pronouncing anything right at all. Once he finishes speaking the last line...

Nothing happens.

But then, it does. As anxiety is starting to set on the wolf, the drawn circle in the book starts glowing. It&#39;s faint at first, but it grows brighter and brighter with a red hue, until it gets so bright that the wolf has to look away for a moment.

And then, just like that, the glow goes away. When the wolf looks at it again, he smiles widely. In place of the gray gemstone sits an infused, glowing red one. The stone he supposedly needs.

[[Continue|The Exit]]</tw-passagedata><tw-passagedata pid="147" name="Knowledge Assessment" tags="key" position="200,4850" size="100,100">According to Ivex&#39;s journal, the wolf needs a &lt;span class=&quot;imp-info&quot;&gt;red teleportation gemstone&lt;/span&gt; to get out of the tower.

Ivex&#39;s journal mentions two ways to get those...

&lt;&lt;if $blobGemstoneKnowledge&gt;&gt;\
One was created by a fox thief who ultimately failed to escape the tower. There&#39;s no sign of the fox, but in his journal, Ivex mentions that the gemstone he created was left &lt;span class=&quot;imp-info&quot;&gt;in this very room&lt;/span&gt; and the wolf&#39;s tail wags in recognition. It must &lt;span class=&quot;imp-info&quot;&gt;the red gemstone he saw floating inside that strange blob thing at the center of the room.&lt;/span&gt; Ivex made the mistake of leaving it there and, if the wolf could get his hands on that, he could use it to escape.
&lt;&lt;else&gt;&gt;\
One was created by a fox who ultimately failed to escape the tower. There&#39;s no sign of the fox, but in his journal, Ivex mentions that the gemstone he created was left &lt;span class=&quot;imp-info&quot;&gt;somewhere in what sounded like this very room&lt;/span&gt;. If Ivex hasn&#39;t taken it yet, the wolf is certain that he could and, therefore, use it to escape.
&lt;&lt;/if&gt;&gt;\

The second option is to &lt;span class=&quot;imp-info&quot;&gt;create a teleportation gemstone from scratch&lt;/span&gt;. According to Ivex&#39;s journal, that would require &lt;span class=&quot;imp-info&quot;&gt;an empty gemstone&lt;/span&gt; and &lt;span class=&quot;imp-info&quot;&gt;Ivex&#39;s spellbook&lt;/span&gt;...
&lt;&lt;if $spellbookKnowledge&gt;&gt;\

Ivex&#39;s spellbook is a simple matter. Still at the desk, the wolf simply shifts his eyes to the large, closed tome full of spells and strange drawings that he looked at before.
&lt;&lt;/if&gt;&gt;\
&lt;&lt;if $lionGemstoneKnowledge&gt;&gt;\

Empty gemstones... The wolf has to think for a moment, but his ears suddenly twitch up as he recalls the lion from the other room opening a drawer full of gray, dim gemstones that he used to make a blue magical one. Those must be the empty gemstones!
&lt;&lt;/if&gt;&gt;\
&lt;&lt;if $spellbookKnowledge &amp;&amp; $lionGemstoneKnowledge&gt;&gt;\

That&#39;s it! With the spellbook in hand, and knowing where to get the empty gemstones, crafting one to get him out of this damned place should be possible.
&lt;&lt;else&gt;&gt;\

Crafting a gemstone could be possible if only the wolf could find all of the required materials...
&lt;&lt;/if&gt;&gt;\

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
    &lt;&lt;if $spellbookKnowledge &amp;&amp; $lionGemstoneKnowledge&gt;&gt;\
      &lt;li&gt;[[Try and craft the red gemstone.|Gemstone Crafting]]&lt;/li&gt;
    &lt;&lt;else&gt;&gt;\
    &lt;li&gt;[[Read something else on the journal.|Journal Notes]]&lt;/li&gt;
    &lt;li&gt;[[Go back to the main hallway to explore more...|Second Floor]]&lt;/li&gt;
    &lt;&lt;/if&gt;&gt;\
    &lt;&lt;if $blobGemstoneKnowledge&gt;&gt;\
    &lt;li&gt;[[Try and get the red gemstone left by the fox.|The Altar]]&lt;/li&gt;
    &lt;&lt;/if&gt;&gt;\
  &lt;/ul&gt;\
&lt;/div&gt;</tw-passagedata><tw-passagedata pid="148" name="The Exit" tags="" position="825,5325" size="100,100">With care, $name grabs the gemstone. He holds it in his paw. It feels warm to the touch. The wolf looks at it, takes a sniff at it, then holds it up with two fingers to inspect it properly. It&#39;s a beautiful gemstone, but... how to use it?

Even though he has it, $name frowns. Does he need to go to a certain place? Speak certain words? Ivex didn&#39;t when he left, but the panther mage could do a whole lot of impressive and downright impossible things.

$name stands up. As he does, his lingering erection bumps against the corner of the desk, making his cock bounce up and down. It makes the large wolf warrior&#39;s ears grow hot as it reminds him of his nudity. His most humiliating situation caused by none other than Ivex himself.

A growl comes to his throat. He has the gemstone he supposedly needs, but now he is going to get beaten by not knowing how to use it? Maybe he could go back and untie the lion to try and make him speak if he knows how to do it. Or perhaps he could look for that fox that Ivex supposedly captured...

Frustrated, $name closes his fist around the gemstone. Just as the wolf pushes the chair back to go try something else, he feels it growing hotter inside his hand, and then...

The whole world around him starts shifting into a blur.

[[Continue|Outside]]</tw-passagedata><tw-passagedata pid="149" name="Outside" tags="restart" position="950,5325" size="100,100">The big wolf stumbles forward. A sense of vertigo overwhelms him for a moment as everything spins and loses its shape. However, as quickly as it comes, the feeling goes away. The wolf suddenly feels his feet touching the ground again. His hands find a table behind him to hold onto to keep himself steady and, when he blinks... everything feels different.

The air on his bare fur feels colder than before. The floor under his feet is simple wood rather than stone. As the wolf looks around, he realizes he is no longer in the large hallway he was before, but rather somewhere else entirely.

It looks... like a small room. A bedroom? No... a storage room? The furniture is crude and made of old wood. There are wooden boxes near some of the walls, but there is also a hay bed off to the side. There are no windows, but the smell of cold, fresh air feels very familiar to the wolf. A smell that, he only just realizes, he did not feel at all while in the tower. In there everything felt... stale.

Taking a step forward, the wolf looks back to see something else that makes his eyes go wide.

Sitting over a crude desk and held by a small pedestal is a large gemstone. It&#39;s bigger than most he&#39;s seen before and more transparent. As the wolf leans forward to get a better look at it, what he sees makes his eyes go even wider.

Inside the gemstone, he can see... a tower. A miniature tower that looks exactly like the one he was trapped in as far as he could tell. At the top of the gemstone, small clouds float and, at the bottom of it, there&#39;s green that resembles grass. The whole thing looks like an artificial place created &lt;b&gt;inside&lt;/b&gt; the gemstone...

Before $name can ponder more over the implications of that, the sound of steps coming from outside the room have the warrior twisting on his feet.

[[Continue|Ivex&#39;s Fall]]</tw-passagedata><tw-passagedata pid="150" name="Ivex&#39;s Fall" tags="" position="950,5450" size="100,100">Not knowing what to expect, the wolf prepares himself as best as he can in his naked, unarmed state. The door opens casually without rush, but the person coming in...

Is none other than Ivex himself.

Except he looks different. While the black panther that $name had seen inside the tower taunting him while he was bound was tall enough to reach his shoulders, this one seems like he would barely measure up to his abdomen. The Ivex that $name had seen wore a pristine vest, his long cape and plenty of jewelry and this one wears nothing but a plain, brown ragged robe. Not only that, but Ivex had a firm, toned musculature before and now? The panther that walks in is skinny and slender. He makes for a much, much less impressive figure than the Ivex from before.

Yet, as the panther walks in holding a piece of jerky that he nibbles on, he almost chokes as he looks up and meets the large wolf&#39;s eyes. The body, the clothing and everything else might be different, but seeing his face there is no doubt. This is Ivex, the dangerous mage that trapped him. The wolf can&#39;t help but growl in pure reflex.

The feline, however, does not look nearly as arrogant as before. His face has nothing but surprise and, perhaps, panic in it.

&quot;W-w-what?! How did you get out of my tower?!&quot; Ivex stammers. &quot;Y-you dare try to escape ME?!&quot; He drops the food he had been holding and $name can see him reaching down to pull a pouch he had attached to his belt. The panther reaches into it so quickly that some gemstones of different colors fall off as he scrambles to find the right one.

The wolf isn&#39;t having it. In three large steps, the distance between them is covered and, like a charging bull, the large wolf tackles the panther down. Ivex lets out a pathetic yelp, his pouch of gemstones going flying, making them scatter all across the floor.

Skillfully, the large wolf catches the panther before he can even fall, grabbing him by the neck as he scrambles to reach for any of his gems and, instead, lifting him up.

The panther does not cast magic. All the black panther does is wiggle and struggle, his hands coming to the wolf&#39;s wrists to try to pull it away from his neck so that he can get away, but his attempts are barely even felt by the wolf. Even his claws do little more than scratch the angry wolf&#39;s skin.

The wolf growls at him. There is no strange magic being used against him, no unexplainable acts, nothing. The reality of the situation dawns on the wolf and, judging by Ivex&#39;s panicking expression, the panther can tell that the warrior has figured it out.

Ivex is not nearly as powerful outside of his tower. In fact, held by the wolf and wiggling in the air, he looks pretty damn powerless in its entirety.

&quot;L-let me go!&quot; the panther gasps. &quot;I&#39;ll m-make you regret... this... if you don&#39;t... ugh!&quot;

The arrogant feline&#39;s threats feel empty. The wolf can see how the panther&#39;s eyes shift back and forth towards his scattered gemstones, giving away how much he needs those.

&quot;We&#39;ll see who regrets what here, mage,&quot; the wolf growls.

And he smiles. His cock, still forcefully erect due to Ivex&#39;s own ministrations inside the tower, throbs with renewed life. Looking at the panther, thinking back to all he said, all he did, and all $name had to go through because of him in that crazy, perverted tower of his...

The wolf lets out a growl of anger, showing his sharp teeth to the wiggling panther and taking another step forward to slam Ivex against the crude wall. The panther merely yelps, his hands still desperately trying to pry the large wolf&#39;s paw from around his neck as he&#39;s held up. $name can feel his claws prickling his skin, but his efforts are so pathetic that he needs no more than an arm to hold the panther up.

Desperately, Ivex extends his arms toward some of the fallen gemstones as if that would somehow help him reach them. Pressed against the wall and held by his neck, the panther can&#39;t breathe. He gasps for air, growing more and more desperate with each passing second, until he finally looks at the wolf... and passes out.

The moment he does, the wolf lets go of him. The panther&#39;s unconscious body falls down to the floor. $name has no intention of killing the panther, even if he might even deserve it. The bounties are, after all, larger when the target is delivered alive, and the value for Ivex comes to his mind. He&#39;ll get the bounty alright, they&#39;ll know how to deal with the panther, and $name will get a hefty sum to make up for all of his suffering.

Finally. Finally, the wolf has escaped the mage&#39;s crazy tower and now, outside, the cards are in his hands. Picking the unconscious panther up by his scruff effortlessly, the wolf looks at him... and his cock throbs again. An effect caused by the panther himself.

As he stares at the arrogant, puny mage, however... a few ideas come to his mind. ...Should the wolf let the panther off the hook that easily after everything the mage made him go through?

He looks around. All those gemstones scattered across the floor are the source of Ivex&#39;s power. Without them, the panther seemed absolutely helpless.

[[Continue|Tying up]]</tw-passagedata><tw-passagedata pid="151" name="Pulled In (Text)" tags="text" position="925,4100" size="100,100">Intent on getting that gemstone, the wolf brings his paw up to the blob. Slowly and carefully, he approaches it to test it with a clawed finger until...

He pokes at it. The whole surface ripples when he does, but the blob remains firm in place. It feels... strange. Definitely viscous and more &#39;wet&#39; than he thought. Odd. Nothing in particular happens, however, and the wolf pokes it a few more times, seeing it bounce and ripple in response to it. With a small chuckle, the wolf just shakes his head and pulls his paw away.

Or tries to.

When $name tries to pull his finger away from the slime, he finds that it pulls back. Only the tip of his claw is enveloped by it, but as he tugs at it, the firm blob resists it, keeping his finger there.

With a small growl and a frown, the wolf pulls harder. The large warrior puts the strength of his muscles into pulling, his other paw coming to wrap around his wrist to pull it more, yet even if he does manage to distend the blob a little further... it still doesn&#39;t let go. It feels like his entire finger might come loose before the blob lets go of it. 

Stopping his pulling for a moment, the wolf stops to catch his breath. Looking at the blob, $name tries to think of a solution for a moment, when all of a sudden...</tw-passagedata><tw-passagedata pid="152" name="Pulled Further (Text)" tags="text" position="1050,4100" size="100,100">The wolf&#39;s ears twitch when he feels his wrist getting engulfed in one swift motion. The blob protrudes itself forward to grab more of his paw, and before the wolf can even properly react, &lt;b&gt;it&lt;/b&gt; pulls him.

&quot;Whoa!&quot; The wolf stumbles forward, the entirety of his arm pulled into the viscous blob before he can plant his feet on the ground and use his other hand to grab onto the platform&#39;s edge and keep it from pulling him further in. With a growl, the wolf tries to pull his arm out but meets the same resistance that his finger had met before.

&quot;What the fuck?!&quot; the wolf curses. &lt;&lt;print $name&gt;&gt;&#39;s muscles bulge as he tries to pull his arm out, but the blob does not yield. It simply stands there, unmoving and clinging to the wolf&#39;s entire arm. Its insides feel... warm. The wolf can feel the blob&#39;s essence moving around the fur of his arm in that same slow, viscous way.

The wolf tries to pull his arm out with all of his might. When his strength is spent and he stops for a moment to take another breather and curse again, the blob acts once more.

The next sudden pull has the wolf stumbling forward once more and his arm sinking into the blob all the way to his shoulder. $name manages to awkwardly keep himself pressed against the altar, but his awkward leverage doesn&#39;t amount to much.

&quot;What the fuck is this?!&quot; the wolf asks no one in particular. Fuck. How&#39;s he going to get out?! Before he can wonder properly, the blob pulls again. The wolf warrior uses all of his strength to keep it from pulling him further in, but the more of him the thing has, the stronger it seems to get.

$name fights bravely, but soon his hand slips and the blob pulls him in so that his neck and the side of his head get pulled in. Desperately, $name tries to fight against it, but with even less leverage...

In one sudden, even more surprising move, the blob suddenly sucks him in with such strength that the wolf as a whole gets taken into its form.</tw-passagedata><tw-passagedata pid="153" name="Extraction 1 (Text)" tags="text" position="1175,4100" size="100,100">&lt;&lt;print $name&gt;&gt;&#39;s first instinct is to hold his breath as he gets pulled into the viscous blob. Keeping his muzzle well shut, the wolf thrashes as best as he can inside it. It all feels... sticky, wet and warm. It feels like being underwater, but its texture is thicker and moving inside it is hard. It takes a lot of strength from the wolf to be able to wave his arms in a feeble attempt to &#39;swim&#39; out of the thing, but the blob keeps him engulfed.

Before long, it starts hardening too. Moving becomes harder and harder. The wolf is left in an awkward &#39;floating&#39; position with his limbs half-spread. Grunting, $name&#39;s muscles bulge with effort as he tries to keep moving, but the liquid hardens all around him, stopping the wolf altogether and keeping him well inside it.

Panicking, $name gets more and more desperate. He keeps his breath held, but he knows he can&#39;t hold it for much longer. The slime keeps hardening until the wolf can no longer move even an inch, frozen inside its transparent body no matter how hard he tries, and as the seconds tick by...

And then, the choice is removed from him. Though he can&#39;t move inside the slime, $name can feel &lt;b&gt;it&lt;/b&gt; move around him. Without his consent, the wolf feels his muzzle being opened as if being pulled from both sides. A silent groan and whine comes from the wolf as he feels the slime coat the inside his muzzle and tongue. It tastes of... nothing, really. A stale taste, like lapping water. That&#39;s not his main concern, however. His main concern is breathing and, as his lungs start screaming for it and the situation starts getting dire...

A sudden income of air comes down his throat and nostrils.

$name gasps. His eyes look around frantically. Though the wolf can barely see it, it seems the slime has made an opening between his muzzle and nostrils to the outside, allowing air to go past so that he can breathe.

Breath after eager breath, the frozen wolf takes it all in gladly. Though his situation is still dire, the knowledge that at least he won&#39;t die of asphyxiation is very reassuring. Frozen there, the wolf&#39;s eyes dart to the side. The red gemstone is still there too. Although the wolf himself takes the center of the blob now, the gemstone is still visible beneath him near the altar&#39;s surface. Very close, but nigh unreachable in the wolf&#39;s current state.

As $name is busy regaining his breath, though, the wolf&#39;s eyes widen once more. The slime starts moving more around his body. He can feel its slimy caressing in a very weird way. It moves all around him, encasing and feeling his chest, his stomach, his legs, going through his whole body, and then...

$name can&#39;t even frown when he feels it starts focusing on his forcefully erect cock.</tw-passagedata><tw-passagedata pid="154" name="Extraction 2 (Text)" tags="text" position="1300,4100" size="100,100">No matter how much the wolf tries to struggle or move, it feels as if he might as well be encased in solid rock. The slime around him does not budge even a little. His arms, legs, paws, everything remains completely immobile and yet, at the same time, the slime&#39;s texture can be felt over it. Always moving, always working.

Thankfully for $name, his muzzle ended up slightly tilted so that, directing his eyes downwards, he can look down at his own cock. It stands there just as erect as it was when he fell into the slime. The red spire protruding from his sheath with its veiny, dark red surface remains still as well, and yet...

The wolf can definitely feel it. While the slime can be felt moving softly all around his body, on the surface of his cock, it&#39;s as if it moves with more vigor. Around the entire length of his cock, the wolf can feel it &lt;b&gt;kneading&lt;/b&gt; its sensitive surface. The increased movement starts at the very tip of his member and goes down his shaft all the way down to his sheath, where the slime also feels like it kneads and tugs at it. Beyond that point? Nothing. Just the light, immobile feeling the slime has over the rest of his body.

The wolf lets out a growl from his throat. The sound barely makes it past his encased muzzle, but anger surges through the wolf over the knowledge that he remains there, frozen and with this... this &lt;b&gt;thing&lt;/b&gt; taking advantage of him. What does it want? Why is it doing that?!

Before the wolf can ponder on it further, the movement around his cock changes. The paralyzed wolf&#39;s eyes dart down towards it and, this time, he can see it for sure.

Though the slime seems solid as rock everywhere else, around his cock it moves. It flexes, its surface shifting ever so slightly around his member and, as it does, the wolf can feel... a stroke over his sensitive shaft.</tw-passagedata><tw-passagedata pid="155" name="Extraction 3 (Text)" tags="text" position="1425,4100" size="100,100">The slime does it again. And again, and again. It starts a slow, rhythmic set of movements around the wolf&#39;s cock, kneading it at the same time as it strokes it. At first, the strokes are loose and wild, but as the slime moves up and down, it seems to adapt to his length. The strokes become wider, reaching all the way to the wolf&#39;s tapered tip and then going downwards all the way to the top of his knot, which in turn throbs and pulses, growing more engorged for the stimulation.

From within the slime, $name growls again, but he also can&#39;t help but moan. Completely immobilized, the wolf can&#39;t even frown as the weird magical slime starts masturbating him without his consent.

Pleasure surges through the bound lupine. The candle&#39;s after-effects still linger in his system but with this, the wolf suspects that even if it didn&#39;t, the slime&#39;s methodic and unusual way of pleasuring might have coaxed him regardless. It seems to know very well what it&#39;s doing. A little too well, perhaps. $name no longer has any doubt that this must be another one of Ivex&#39;s perverted, twisted creations, but how to get out of it?!

At the moment, it&#39;s hard to think. As the slime keeps stroking the wolf&#39;s cock with increased precision and speed, the pleasure is undeniable. A small burst of pre-cum comes from its tip and, with that, the slime seems to redouble its efforts in masturbating him. What the hell does it want?

There&#39;s little the wolf can do. Inside him, his rage swells. He can try harder to fight against this thing. Ivex won&#39;t get him that easily! On the other hand, it&#39;s much, much easier to just give in to the pleasure. It feels so heavenly good. It&#39;s not like there&#39;s anyone watching. Maybe giving in to it just for a little while would be beneficial as well...</tw-passagedata><tw-passagedata pid="156" name="Forceful Extraction 1 (Text)" tags="text" position="1550,4150" size="100,100">No! The wolf lets out another muffled growl. A powerful warrior such as him will never, ever give in to this mage&#39;s perverted machinations!

Huffing in outrage, the wolf redoubles his efforts to fight against the slime encasing him. His biceps, his chest, all of his muscles bulge out with effort as the wolf does his best to ignore the pleasure forcefully enveloping his cock and, instead, puts all of his might into forcing himself against the slime.

A few seconds go by and nothing happens. The wolf lets his rage fuels him. He won&#39;t be subjected to this kind of humiliation again! Focusing all of his strength on his right arm, the wolf pushes and pushes, until...

He moves! His arm pushes against the slime, successfully displacing it an inch, and as $name feels it displacing around him, he&#39;s fueled by the thrill of success. The strength he puts against it increases, trying hard to move it a little more.

But then, all of a sudden, the slime hardens even more.

Around his entire body, the slime&#39;s density seems to increase. The movement on his cock stops for a moment and the wolf&#39;s entire body feels as if the slime is closing in around him. He feels it press back against him everywhere. His chest feels heavy for it, his muzzle is forcefully closed by it and $name is forced to whimper as even his round, furry balls that were resting between his legs feel like they&#39;re being crushed.

Panic sets into the wolf for a moment as he feels pain, but then, just as suddenly as it came... the pressure vanishes.

As it does, however, the slime around him feels, somehow, even more solid than before. If it felt like the wolf was encased in stone earlier, now it feels like the damned slime is made of pure metal.

And the wolf is left panting from all of his efforts with a lingering ache on his balls. Then, much to his dismay, the slime softens around his cock again and immediately restarts its work in forcefully pleasuring him. If anything, it seems to work with harsher strokes than before.

It can&#39;t be!</tw-passagedata><tw-passagedata pid="157" name="Forceful Extraction 2 (Text)" tags="text" position="1675,4150" size="100,100">With even more outrage, the wolf is determined to fight again. Once more, his muscles bulge as he summons his strength. The outrage swells within him. His eyes focus down on his cock, abused by the slime moving around it, pleasuring its surface...

The wolf does his best to try and ignore it. He huffs from the effort while, at the same time, he groans from the pleasure. The slime goes up and down the smooth surface of his cock, assaulting it from all sides. It feels like the softest of hands is stroking him, like a group of smooth tongues is licking it, from top to bottom, over and over again. The wolf can see its surface displacing itself as it moves from the tip of his cock to the base and back, and then, as it goes down his shaft just like all the other times...

The slime keeps going down, displacing itself in a wider motion to engulf his knot. The wolf&#39;s strength falters when he feels it for the first time. The engorged bulb of flesh at the base, the most sensitive part of his cock by far, sends jolts of incredible pleasure through the wolf&#39;s entire body as it is kneaded and massaged by the slime in that same warm, methodic way.

$name would close his eyes if he could. They lose focus for a moment as the pleasure overwhelms him. The wolf&#39;s breathing quickens, his chest heaving the slime&#39;s body as it finishes with his knot and goes up his length again, pulling at it, masturbating him masterfully, and then when it reaches his tip, it starts going down again. The wolf&#39;s eyes follow the slime&#39;s movements as it gets closer and closer to his knot, as it does...

&quot;Hmmmmghfff..!!&quot; the wolf grunts. 

The pleasure is overwhelming, but his rage is not gone. If anything, it is bolstered by the slime&#39;s further abuse of his weak points. Fighting through the pleasure, $name is resolved not to give up. Despite how weak his muscles feel as the slime keeps working on his cock, the wolf musters up all of his strength to try fighting again.

His arms, his legs, his head, anything. He growls, desperately trying to move, desperate to fight against this thing!

The slime keeps pleasuring his cock, but as the wolf tries and tries to fight against it, the rippling around his member does seem to falter somewhat. It tilts this way or that every now and then, as if the slime is having difficulty keeping him at bay.

It gives the wolf hope! The slime starts speeding up the treatment of his member, maybe trying to distract him with pleasure? He won&#39;t fall for it, though! The wolf is determined to keep fighting no matter what! Just as he thinks he might get some movement done inside the slime again, however...</tw-passagedata><tw-passagedata pid="158" name="Forceful Extraction 3 (Text)" tags="text" position="1800,4150" size="100,100">The slime hardens again. This time, however, it does not feel the same as last time.

All around his body, that pressure comes from the viscous liquid again, yet around his cock, the stroking doesn&#39;t stop. If anything, it increases. While before the wolf could feel a single displacement in the slime&#39;s surface going up and down his length, a second one now appears. Then a third, then a fourth. All of them assault his cock, kneading it from different sides to the point where his cock even bobs back and forth inside the liquid as the different surfaces start masturbating it. The feeling of them around his shaft, around his &lt;b&gt;knot&lt;/b&gt;, makes the wolf let out a drawn-out groan as the pleasure enforced on him increases tenfold.

That&#39;s not all, though. The slime&#39;s pressure does not subside. All around him, the slime starts moving. Though the wolf cannot move himself, the slime around him does. Little by little, the wolf finds himself getting moved around the inside of that blob of gelatinous water. Without his consent, $name finds his arms coming closer to his chest. Both of them slowly approach, then get crossed over his muscular pectorals and then, when both of his arms are hard-pressed against it, the wolf feels the slime around his upper body harden again, rendering him completely immobile. At the same time, however, his legs start getting forcefully spread. 

The new movement makes the wolf feel more vulnerable as he&#39;s forced to spread them while his cock keeps getting abused. And then, when the wolf thinks things can&#39;t possibly get worse...

The slime starts softening around his sheath. Then around his balls. The same tongue-like treatment that his cock is being assaulted with starts happening around his sensitive orbs.

&quot;HMMFGH!&quot; the wolf howls in outrage. With the slime around his upper body feeling harder, the sound barely makes it past his muzzle anymore. $name tries and tries to fight it in outrage, but with the increased assault on his cock and knot joined in by the one on his balls, the stimulation is too much. The wolf&#39;s ears grow red, the humiliation growing as he feels the slime succeeding in extracting the pleasure out of him. It&#39;s close...

And then, things get even worse for the captured adventurer.</tw-passagedata><tw-passagedata pid="159" name="Forceful Extraction End (Text)" tags="text" position="1925,4150" size="100,100">As if the stimulation on his cock and balls wasn&#39;t enough, the wolf feels the slime start to soften around the underside of his tail as well.

Frantically, the wolf&#39;s eyes grow even wider.

&quot;NNHM! NNHHH!&quot; he yells to the slime as if it can hear it. The thing does not care, though.

Little by little, the wolf feels himself being violated. As a proud warrior, the humiliation of feeling the slime&#39;s viscous texture going up his ass makes his face burn with rage, but no matter how hard he tries, there is no escaping it.

The slime, as always, seems to know exactly what to do. It penetrates the wolf, spreading him, then going just deep enough into the wolf to find the special spot in there. When it does, the wolf lets out a muffled howl as it starts softening, getting the same warm texture it has around his cock, and the slime starts mercilessly pressing and pressuring against the wolf&#39;s most sensitive spot...

It&#39;s too much.

All the pleasure being inflicted on him comes together. The wolf&#39;s eyes roll back as the stimulation of his cock, knot, balls and prostate send mind-numbing waves of pleasure through his body. There&#39;s nothing he can do to fight them, nothing he can do to stop them. The wolf is forced to endure them and, being assaulted in so many ways at once, the wolf feels himself get forcefully thrown past the point of no return.

With a drawn-out muffled moan, the wolf&#39;s exposed cock starts pulsing inside the slime and then, as the wolf feels the pleasure of climax overwhelm his entire being, it flexes as the first strong jet of wolf cum is expelled from it.

It doesn&#39;t stop there, and neither does the slime. All the stimulation keeps going as the wolf&#39;s orgasm hits, shooting jet after jet of cum into the slime. His seed seems to be &#39;caught&#39; by the blob. The white, pearly substance is gathered just above his cock, melding together as the wolf is forced to shoot more and more. The slime keeps milking him, kneading his cock, his knot, and pressing hard inside his ass until the wolf&#39;s cock is reduced to quick throbs, spurting the last remnants of his orgasm. Only then does the slime start slowing down, although the stimulation doesn&#39;t truly stop. It allows the wolf to catch his breath, though. And as he looks down...</tw-passagedata><tw-passagedata pid="160" name="Extraction End 1 (Text)" tags="text" position="2050,4075" size="100,100">The seed the wolf expelled is taken by the slime. It travels through its surface around the wolf&#39;s body and then it goes down. The wolf remembers the small hole he had seen in the altar beneath the slime and, seeing no more traces of his seed, he can only assume it was taken there.

Before $name can ponder on what might happen next, it simply starts over again.

The slime&#39;s kneading of his cock returns, as does everything else. It&#39;s slow at first, but it starts speeding up fast. Still feeling overwhelmed by his last orgasm, the wolf groans and whines inside his prison, but there is nothing he can do but take it.

Though the candle he endured before helps, there is still some sensitivity to be felt around his cock. The slime ignores it entirely, however, and continues milking him. Soon the wolf can feel little more than pleasure all over again.

As he continues to be overwhelmed, $name at last notices that his surroundings change. The stone altar the slime was resting on starts glowing. Runes appear on it and, from the corner of his eye, he can see one of the open alcoves that adorn the wall start glowing as well.

It all happens very fast. In an instant, the wolf is trapped inside the blob in the middle of that hall. Then, in the next, the blob the wolf is trapped in is no longer in the middle of the large room but rather teleported to an alcove. Surrounded by walls of rock, the wolf gets to see as its large doors magically close, and then, darkness surrounds him.

Trapped inside the slime completely in the dark feels worse. It keeps assaulting his cock and everything else mercilessly, drawing him closer and closer to orgasm again despite the fact that he only just cummed. All in the absolute dark! For a moment, despite all the pleasure, the wolf panics. How can his situation get any worse?

And then, as always, it does.

As the wolf is being forcefully milked by the slime, a flicker of light suddenly appears above him.</tw-passagedata><tw-passagedata pid="161" name="Forceful Extraction End 2 (Text)" tags="text" position="2175,4150" size="100,100">The wolf&#39;s eyes grow wide as his eyes and nose recognize what the light is at the same time. 

It&#39;s a candle. It burns on a special candleholder built inside the closed alcove. A bright red, large candle that looks exactly the same as the one he&#39;s seen before.

As the wolf breathes in the only air he&#39;s allowed, his nose burns. It feels like breathing fire...

&quot;HMMMMGHF!&quot; the wolf howls, fully aware of what that candle does. His struggle is renewed, his rage increases, yet, with his arms folded across his chest and the slime as hard as it is... it is hopeless.

The candle&#39;s influence is quickly felt. The arousal the wolf already felt grows tenfold and, somehow, the candle seems to do something to the slime as well.

Its movements start to change. They grow wilder, more frantic, even more determined. Does it detect the candle&#39;s smell or does it feel the way the wolf&#39;s cock hardens yet a bit more from its influence? $name can&#39;t know. All he knows is that he finds himself trapped in a dead-end of pure, forced pleasure.

With the way the slime works on his cock, on his knot and pounding his ass... it doesn&#39;t take long for the wolf to reach a forced climax once again.

The second one feels a little worse than the first. Though it is still overwhelming pleasure that takes over the wolf, it feels like too much. Way too much. More than even a powerful warrior like him can handle. The wolf whines as his cock shoots just as much seed as before, if not more, for the slime to collect and take who knows where.

And it doesn&#39;t stop there. As the wolf keeps trying to fight and resist the slime, all it does is make it work harder to milk him. With every ounce of his strength, the wolf tries to keep hold of his mind. To not breathe in too much of the candle, to keep himself lucid. Yet, he can feel the pleasure overwhelming, the fire taking over, but as he keeps fighting...

The wolf&#39;s hope only vanishes when a second flicker of light appears above him. Then a third, a fourth, a fifth...

Above him, the wolf sees a myriad of candles. Dozens of them affixed to the alcove&#39;s ceiling with about ten of them burning at the same time. The wolf&#39;s next breath feels like hot, concentrated lava. The fire of arousal inside him burns.

And his cock shoots.

Time loses all meaning to the trapped wolf. Eventually, some of the candles get magically put out, but there&#39;s always at least one burning. It is the only thing he can idly focus on. The light, or the red gemstone stuck there with him. Both out of the wolf&#39;s reach and, with his thoughts muddled by lust, out of his interest as well. The candles keep him in a perpetual state of lust, his balls churning as they produce, and the slime working on pleasuring him so that he shoots and supplies.

Over, and over, and over again, the wolf is brought to orgasm through merciless masturbation, and it never stops.

Every now and then, the wolf is aware that he falls asleep, but even as he does, he is not sure if the slime ever stops. When he sleeps, he dreams of sex, when he wakes up, the slime gets to work. His cock is always hard, always ready to shoot, always cumming. His other needs are met as well. Somehow, everything is set so that he has everything he needs for the slime to keep working in his alcove in the dark. One of many, supplying the mage&#39;s tower.

At one point, $name is barely aware that Ivex opens his alcove to look at him. The mage says a few words that he cannot hear because he&#39;s busy howling as his cock shoots his seed for the slime to collect. The panther mage just laughs, then with his glowing hand, reaches into the blob as if it was water, takes the red gemstone with him, smirks and closes the alcove again, leaving him in the dark with the slime and the candles. The slime kneads his cock, works his knot, pounds his ass...

The pleasure feels unending.</tw-passagedata><tw-passagedata pid="162" name="Gentle Extraction End 2 (Text)" tags="text" position="2175,3825" size="100,100">The wolf&#39;s eyes grow wide as his eyes and nose recognize what the light is at the same time. 

It&#39;s a candle. It burns on a special candleholder built inside the closed alcove. A bright red, large candle that looks exactly the same as the one he&#39;s seen before.

As the wolf breathes in the only air he&#39;s allowed, his nose burns. It feels like breathing fire...

&quot;Hmmmmmmgghhf!&quot; the wolf howls, fully aware of what that candle does. His body almost wants to struggle, yet it&#39;s as if the slime detects that and, in turn, massages all of his sensitive spots to keep him from doing so.

The wolf closes his eyes and whines. The lust, the pleasure... it&#39;s so intense, it&#39;s so... good.

The candle&#39;s influence is quickly felt. The arousal the wolf already felt grows tenfold and, somehow, the candle seems to do something to the slime as well.

Its movements start to change. They grow more calculated, more precise. Does it detect the candle&#39;s smell or does it feel the way the wolf&#39;s cock hardens yet a bit more from its influence? $name can&#39;t know. All he knows is that he finds himself trapped in a cloud of pure, heavenly pleasure.

With the way the slime works on his cock, on his knot and all around his body, it doesn&#39;t take long for the wolf to reach a forced climax once again.

The second one feels even better than the first. Though it is still overwhelming pleasure that takes over the wolf, the slime makes it feel just right, being gentle when it needs to be and stroking him hard where pleasure hits the best. A powerful warrior like him has much to give... The wolf moans, the sound trapped inside the alcove with him as his cock shoots just as much seed as before, if not more, for the slime to collect and take who knows where.

And it doesn&#39;t stop there. The more the wolf gives in to the pleasure, the more the slime wants to take. It keeps milking him, pleasuring him and convincing him to relax and keep enjoying just one more orgasm. The wolf is aware that the candle he&#39;s breathing will mess up his mind soon and, deep inside, a voice yells at him not to let it happen, but the pleasure...

The single candle burning above him is the focus of the wolf&#39;s eyes as it slowly overcomes him. The slime keeps working on his cock, on his nipples, on his feet, everywhere. It&#39;s just... too much. The fire of arousal inside him burns brighter.

And his cock shoots.

Time loses all meaning to the trapped wolf. The candle above him is always burning and, when it starts getting small from burning for too long, it goes out and, much to the wolf&#39;s surprise, another candle right next to it magically lights up instead. One that is still big and brand new. It is only then that the wolf, barely aware of his surroundings anymore, notices that there aren&#39;t one or two candles inside the alcove above him, but rather dozens of them placed there so that they can keep burning, one after the other. It is the only thing he can idly focus on. The light, or the red gemstone stuck there with him. Both out of the wolf&#39;s reach and, with his thoughts muddled by lust, out of his interest as well. They keep him in a perpetual state of lust, his balls churning as they produce, and the slime working on pleasuring him so that he shoots and supplies.

Over, and over, and over again, the wolf is brought to orgasm through merciless masturbation, and it never stops.

Every now and then, the wolf is aware that he falls asleep, but even as he does, he is not sure if the slime ever stops. When he sleeps, he dreams of sex, when he wakes up, the slime gets to work. His cock is always hard, always ready to shoot, always cumming. His other needs are met as well. Somehow, everything is set so that he has everything he needs for the slime to keep working in his alcove in the dark. One of many, supplying the mage&#39;s tower.

At one point, $name is barely aware that Ivex opens his alcove to look at him. The mage says a few words that he cannot hear because he&#39;s busy howling as his cock shoots his seed for the slime to collect. The panther mage just laughs, then with his glowing hand, reaches into the blob as if it was water, takes the red gemstone with him, smirks and closes the alcove again, leaving him in the dark with the slime and the candles. The slime kneads his cock, works his knot and teases his entire body.

The pleasure feels unending.</tw-passagedata><tw-passagedata pid="163" name="Gentle Extraction 1 (Text)" tags="text" position="1550,3825" size="100,100">Yeah. The wolf lets out a muffled groan. Just for a moment, $name lets himself relax inside the slime as it continues to treat his cock.

Resting for just a moment feels wise. The wolf is gathering his strength, he tells himself, as he feels pleasure emanating from his loins all over his body because of what the slime does. His face and ears grow red for letting it happen, but what can he do?

The slime as a whole seems to soften all around him as he relaxes. It starts to feel less like being encased in rock and more like lying on something soft. The wolf still can&#39;t move at all, but as he lets his muscles go easy, the pleasure feels even better...

It&#39;s so hard to resist it. As he lets himself feel it, the wolf&#39;s urge is to thrust his hips up. To push his cock further into the slime&#39;s ministrations of it, to shove his knot in, have something squeeze on it!

His hips try to move reflexively to do that, but they can&#39;t. Of course, they can&#39;t. The wolf lets out a frustrated whine knowing that he&#39;s at the mercy of the slime. At the rate it&#39;s going, though...

As if reading his thoughts, the wolf can swear the slime starts speeding up. Its strokes, up and down the wolf&#39;s smooth, red length, become a little tighter. The pleasure is... almost too much.</tw-passagedata><tw-passagedata pid="164" name="Gentle Extraction 2 (Text)" tags="text" position="1675,3825" size="100,100">Despite all the pleasure, the wolf clings to his willpower. He can&#39;t let it overcome him, he has to fight it! With effort, his muscles bulge as he summons his strength. The outrage swells within him. His eyes focus down on his cock, abused by the slime moving around it, pleasuring its surface...

The wolf does his best to try and ignore it. He huffs from the effort while, at the same time, he groans from the pleasure. The slime goes up and down the smooth surface of his cock, assaulting it from all sides. It feels like the softest of hands is stroking him, like a group of smooth tongues is licking it, from top to bottom, over and over again. The wolf can see its surface displacing itself as it moves from the tip of his cock to the base and back, and then, as it goes down his shaft just like all the other times...

The slime keeps going down, displacing itself in a wider motion to engulf his knot. The wolf&#39;s strength falters when he feels it for the first time. The engorged bulb of flesh at the base, the most sensitive part of his cock by far, sends jolts of incredible pleasure through the wolf&#39;s entire body as it is kneaded and massaged by the slime in that same warm, methodic way.

$name would close his eyes if he could. They lose focus as the pleasure overwhelms him. The wolf&#39;s breathing quickens, his chest heaving the slime&#39;s body as it finishes with his knot and goes up his length again, pulling at it, masturbating him masterfully, and then when it reaches his tip, it starts going down again. The wolf&#39;s eyes follow the slime&#39;s movements as it gets closer and closer to his knot, as it does...

&quot;Hmmmmghfff...&quot; the wolf groans. 

The pleasure is overwhelming. The slime keeps pleasuring his cock. It&#39;s impossible to fight it. It just feels too good. Little by little, the rippling around his member gets more and more intense. It makes it incredibly hard to focus on anything else.

The slime starts speeding up the treatment of his member, and then...</tw-passagedata><tw-passagedata pid="165" name="Gentle Extraction 3 (Text)" tags="text" position="1800,3825" size="100,100">The slime softens itself even more around the wolf. It starts to feel like floating in water and, though the pleasure is almost overwhelming, even in his relaxed state, $name realizes he can move his head. Thoughts of trying to get away pop up in his head and try to fight the lust he&#39;s feeling, but before he can move at all, the slime itself does.

When the wolf feels everything shifting around his body, his reflex is to move his arms or his legs to keep himself balanced. He quickly finds that that&#39;s not possible, though. Though the blob around him feels softer, it still feels sticky and impossible to push through for his limbs.

The slime itself seems to know what it&#39;s doing, though. It moves the wolf inside it, spreading all of his limbs. With his legs spread, his cock feels even more exposed. The red spire juts out from the wolf&#39;s crotch and, in full view, as it is, the wolf can visibly see how the slime twists and turns around it to pleasure it.

Once it finishes positioning the wolf, he starts feeling more there as well. While before the wolf could feel a single displacement in the slime&#39;s surface going up and down his length, a second one now appears. Then a third, then a fourth. All of them assault his cock, kneading it from different sides to the point where his cock even bobs back and forth inside the liquid as the different surfaces start masturbating it more thoroughly. The feeling of them around his shaft, around his &lt;b&gt;knot&lt;/b&gt;, makes the wolf let out a drawn-out groan as the pleasure enforced on him increases tenfold.

The new position makes the wolf feel more vulnerable as he&#39;s made to spread and keep his body bare while his cock keeps getting pleasured. And then, when the wolf thinks things can&#39;t possibly get more intense...

The slime starts softening around his sheath. Then around his balls. The same tongue-like treatment that his cock is being assaulted with starts happening around his sensitive orbs.

&quot;Hmmmffffhh...&quot; the wolf moans in pleasure. With the slime around him feeling softer, the sound echoes through the empty room. $name can&#39;t help but let himself relax once more, the increased assault on his cock and knot joined in by the one on his balls, the stimulation is too much. The wolf&#39;s ears grow red, the humiliation growing as he feels the slime succeeding in extracting the pleasure out of him. It&#39;s close...

And then, things grow even more intense for the captured adventurer.</tw-passagedata><tw-passagedata pid="166" name="Gentle Extraction End (Text)" tags="text" position="1925,3825" size="100,100">As if the stimulation on his cock and balls wasn&#39;t enough, the wolf feels the soft slime all around his body start to move and twitch as well.

The wolf&#39;s eyes grow wide.

&quot;Hmmfgh! Hmmmmmmfffff...&quot; he moans to the slime as if it can hear it.

The caressing the wolf had been getting around his cock starts spreading all over his body. Every erogenous zone the wolf has gets stroked, caressed, massaged all at once. The slime seems to know exactly where to hit, somehow. Around his nipples, it twists and turns, kneading and teasing them in tandem with the strokes of his cock. Behind his ears, the slime does firm yet soft movements, bringing pleasure that almost forces the wolf to relax to it.

Everywhere.

His foot paws get massaged from all sides, rubbed and teased in the most pleasurable of ways. His shoulders, his sides, even the base of his tail gets the blob around him massaging it. It becomes a moving bubble on which the wolf finds himself lost inside, as pleasure unlike anything he&#39;s ever felt overcomes all of his senses.

And all of that pleasure coalesces into the center of everything: his cock. The slime seems to redouble its focus there. It massages his balls, kneads at his knot, strokes his length. Overwhelmed, all $name can do is moan.

It&#39;s too much.

All the pleasure around him comes together. The wolf&#39;s eyes roll back as the stimulation of his cock, knot, balls and body send mind-numbing waves of pleasure through his body. There&#39;s nothing he can do to stop them. Being stimulated at every point of his body, the wolf feels himself melting into the softness that surrounds him as all of that pleasure culminates into a huge, growing apex.

With a drawn-out moan, the wolf&#39;s exposed cock starts pulsing inside the slime and then, as the wolf feels the pleasure of climax overwhelm his entire being, it flexes as the first strong jet of wolf cum is expelled from it.

It doesn&#39;t stop there, and neither does the slime. All the stimulation keeps going as the wolf&#39;s orgasm hits, shooting jet after jet of cum into the slime. His seed seems to be &#39;caught&#39; by the blob. The white, pearly substance is gathered just above his cock, melding together as the wolf is encouraged to shoot more and more. The slime keeps milking him, kneading his cock, his knot, and inflicting pleasure all around his body until the wolf&#39;s cock is reduced to quick throbs, spurting the last remnants of his orgasm. Only then does the slime start slowing down, although the stimulation doesn&#39;t truly stop. It allows the wolf to catch his breath, though. And as he looks down…</tw-passagedata><tw-passagedata pid="167" name="Extraction Archive Display" tags="noreturn" position="1950,1000" size="100,100">&lt;&lt;silently&gt;&gt;\
  &lt;&lt;if $extractionGentleEnd &amp;&amp; $extractionForcefulEnd&gt;&gt;
    &lt;&lt;set $extractionVariant = &#39;gentle&#39;&gt;&gt;
  &lt;&lt;elseif $extractionGentleEnd &amp;&amp; !$extractionForcefulEnd&gt;&gt;
    &lt;&lt;set $extractionVariant = &#39;gentle&#39;&gt;&gt;
  &lt;&lt;elseif !$extractionGentleEnd &amp;&amp; $extractionForcefulEnd&gt;&gt;
    &lt;&lt;set $extractionVariant = &#39;forceful&#39;&gt;&gt;
  &lt;&lt;else&gt;&gt;
    &lt;&lt;set $extractionVariant = &#39;&#39;&gt;&gt;
  &lt;&lt;/if&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
\
&lt;&lt;if $extractionEnding&gt;&gt;\
  &lt;b&gt;[[Bad Ending: Extraction|Extraction Archive]]&lt;/b&gt;
  Variation: &lt;&lt;nobr&gt;&gt;
  &lt;&lt;if $extractionGentleEnd&gt;&gt;
    &lt;label&gt;&lt;&lt;radiobutton &quot;$extractionVariant&quot; &quot;gentle&quot; autocheck&gt;&gt; Gentle&lt;/label&gt;
  &lt;&lt;else&gt;&gt;
    &lt;span class=&quot;helper-container&quot;&gt;
      &lt;span&gt;&lt;label&gt;&lt;&lt;radiobutton &quot;$extractionVariant&quot; &quot;&quot;&gt;&gt; &lt;span class=&quot;disabled&quot;&gt;Gentle&lt;/span&gt;&lt;/label&gt;&lt;/span&gt;
      &lt;small class=&quot;helper-text&quot;&gt;The slime is fine-tuned to reward those that let it do its work...&lt;/small&gt;
    &lt;/span&gt;
    &lt;&lt;done&gt;&gt;&lt;&lt;script&gt;&gt;
    document.getElementById(&quot;radiobutton-extractionvariant-0&quot;).disabled = true;
    &lt;&lt;/script&gt;&gt;&lt;&lt;/done&gt;&gt;
  &lt;&lt;/if&gt;&gt;
  &lt;&lt;/nobr&gt;&gt;\
   | &lt;&lt;nobr&gt;&gt;
    &lt;&lt;if $extractionForcefulEnd&gt;&gt;
        &lt;label&gt;&lt;&lt;radiobutton &quot;$extractionVariant&quot; &quot;forceful&quot; autocheck&gt;&gt; Forceful&lt;/label&gt;
      &lt;&lt;else&gt;&gt;
        &lt;span class=&quot;helper-container&quot;&gt;
          &lt;span&gt;&lt;label&gt;&lt;&lt;radiobutton &quot;$extractionVariant&quot; &quot;&quot;&gt;&gt; &lt;span class=&quot;disabled&quot;&gt;Forceful&lt;/span&gt;&lt;/label&gt;&lt;/span&gt;
          &lt;small class=&quot;helper-text&quot;&gt;The slime is fine-tuned to go rougher on those that insist on fighting it...&lt;/small&gt;
        &lt;/span&gt;
        &lt;&lt;done&gt;&gt;&lt;&lt;script&gt;&gt;
            document.getElementById(&quot;radiobutton-extractionvariant-1&quot;).disabled = true;
        &lt;&lt;/script&gt;&gt;&lt;&lt;/done&gt;&gt;
    &lt;&lt;/if&gt;&gt;
  &lt;&lt;/nobr&gt;&gt;
&lt;&lt;else&gt;&gt;\
  &lt;span class=&quot;helper-container&quot;&gt;
      &lt;b&gt;&lt;span class=&quot;disabled&quot;&gt;Bad Ending: Extraction&lt;/span&gt;&lt;/b&gt;
    &lt;small class=&quot;helper-text&quot;&gt;Touching unknown magical things always ends badly...&lt;/small&gt;
  &lt;/span&gt;
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="168" name="Extraction Archive" tags="noreturn" position="1950,1100" size="100,100">&lt;&lt;include &quot;Pulled In (Text)&quot;&gt;&gt;

&lt;&lt;include &quot;Pulled Further (Text)&quot;&gt;&gt;

&lt;&lt;include &quot;Extraction 1 (Text)&quot;&gt;&gt;

&lt;&lt;include &quot;Extraction 2 (Text)&quot;&gt;&gt;

&lt;&lt;include &quot;Extraction 3 (Text)&quot;&gt;&gt;

&lt;&lt;if $extractionVariant == &quot;forceful&quot;&gt;&gt;\
&quot;Hmmrrrrhfgh!!!&quot; the wolf grumbles with outrage.

&lt;&lt;include &quot;Forceful Extraction 1 (Text)&quot;&gt;&gt;

&lt;&lt;include &quot;Forceful Extraction 2 (Text)&quot;&gt;&gt;

&lt;&lt;include &quot;Forceful Extraction 3 (Text)&quot;&gt;&gt;

&lt;&lt;include &quot;Forceful Extraction End (Text)&quot;&gt;&gt;
&lt;&lt;elseif $extractionVariant == &quot;gentle&quot;&gt;&gt;\
&quot;Hmmmffh...&quot; the wolf moans with unresistable lust.

&lt;&lt;include &quot;Gentle Extraction 1 (Text)&quot;&gt;&gt;

&lt;&lt;include &quot;Gentle Extraction 2 (Text)&quot;&gt;&gt;

&lt;&lt;include &quot;Gentle Extraction 3 (Text)&quot;&gt;&gt;

&lt;&lt;include &quot;Gentle Extraction End (Text)&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;\

&lt;&lt;include &quot;Extraction End 1 (Text)&quot;&gt;&gt;

&lt;&lt;if $extractionVariant == &quot;forceful&quot;&gt;&gt;\
&lt;&lt;include &quot;Forceful Extraction End 2 (Text)&quot;&gt;&gt;
&lt;&lt;elseif $extractionVariant == &quot;gentle&quot;&gt;&gt;\
&lt;&lt;include &quot;Gentle Extraction End 2 (Text)&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;\

&lt;span class=&quot;bad-ending&quot;&gt;Bad Ending: &lt;i&gt;Extraction&lt;/i&gt;&lt;/span&gt;

[[Return to the Archives|Archives]]</tw-passagedata><tw-passagedata pid="169" name="Title Screen" tags="restart" position="2500,25" size="100,100">&lt;&lt;script&gt;&gt;
    const v = variables();
    if (v.personalEnding) {
        v.characterDisplay = &#39;images/wolf.png&#39;;
    } else {
        v.characterDisplay = &#39;images/panther.png&#39;;
    }
    if (v.sawTitle) {
        // already seen title, speed it up.
        v.titleDelay1 = &#39;0.1s&#39;;
        v.titleDelay2 = &#39;1s&#39;;
        v.titleDelay3 = &#39;0.2s&#39;;
    } else {
        MT.mdSet(&quot;sawTitle&quot;, true);
        v.titleDelay1 = &#39;1s&#39;;
        v.titleDelay2 = &#39;2s&#39;;
        v.titleDelay3 = &#39;3s&#39;;
    }
    if (v.passedContentWarning) {
        v.startGameText = &#39;Try Again&#39;;
    } else {
        v.startGameText = &#39;New Game&#39;;
    }
&lt;&lt;/script&gt;&gt;\
\
&lt;div class=&quot;title-screen&quot;&gt;\
&lt;div class=&quot;title-container&quot;&gt;\
\
&lt;&lt;timed $titleDelay1 t8n&gt;&gt;\
&lt;img class=&quot;title-character&quot; @src=&quot;$characterDisplay&quot;&gt;\
\
&lt;&lt;next $titleDelay2&gt;&gt;\
&lt;img class=&quot;title-logo&quot; src=&quot;images/logo_tr.png&quot;&gt;\
\
&lt;&lt;next $titleDelay3&gt;&gt;
&lt;div class=&quot;title-options&quot;&gt;\
\
&lt;&lt;link $startGameText&gt;&gt;
    &lt;&lt;if $passedContentWarning&gt;&gt;
        &lt;&lt;goto [[Bound]]&gt;&gt;
    &lt;&lt;else&gt;&gt;
        &lt;&lt;script&gt;&gt;
            Dialog.setup(&quot;Content Warning&quot;);
            Dialog.wiki(&quot;&lt;&lt;include [[Content Warning]]&gt;&gt;&quot;);
            Dialog.open();
        &lt;&lt;/script&gt;&gt;
    &lt;&lt;/if&gt;&gt;
&lt;&lt;/link&gt;&gt;
\
&lt;&lt;link &#39;Load Game&#39;&gt;&gt;
    &lt;&lt;run UI.saves()&gt;&gt;
&lt;&lt;/link&gt;&gt;
&lt;&lt;link &#39;Content Warning&#39;&gt;&gt;
    &lt;&lt;script&gt;&gt;
        Dialog.setup(&quot;Content Warning&quot;);
        Dialog.wiki(&quot;&lt;&lt;include [[Content Warning]]&gt;&gt;&quot;);
        Dialog.open();
    &lt;&lt;/script&gt;&gt;
&lt;&lt;/link&gt;&gt;
\
[[Credits]]
\
&lt;/div&gt; &lt;!--title-options--&gt;\
&lt;&lt;/timed&gt;&gt;\
&lt;/div&gt; &lt;!--title-container--&gt;\
&lt;/div&gt; &lt;!--title-screen--&gt;\</tw-passagedata><tw-passagedata pid="170" name="Tying up" tags="" position="1075,5450" size="100,100">Holding the unconscious panther up, he almost looks harmless. $name keeps growling, though. After all that time wandering around naked and erect, it doesn&#39;t bother the wolf as much anymore, but that thought alone is enough for the wolf&#39;s anger to feel bolstered. Who knows what the damned mage has done with his gear? With his trusty sword, even? Punishment of the same level should be inflicted upon him so that he can learn how it feels. But... what, exactly?

Carelessly letting the panther fall down, $name looks around. Ivex&#39;s gems are scattered all over the floor. It is wise to gather them up and make sure he can&#39;t get ahold of them, but before anything, he has to make sure the mage is secure. Going around the house, $name quickly sees that he is in some kind of farmhouse. The tower was stored in the attic, but after going down a crude set of stairs, the windows reveal that there is nothing but fields and a poorly kept road surrounding it. Ivex keeps his hideout well-hidden. Luckily for the wolf, a farmhouse is well-equipped for many things, so he has no trouble finding a good bunch of thick rope in the main room, which he promptly takes upstairs to use.

The panther is not his first bounty, so within a few minutes, the unconscious feline&#39;s hands and feet are well tied together with a knot he will not undo anytime soon. With that done, the wolf turns his attention toward the gemstones. With a grunt, he picks up the discarded pouch and starts gathering them up.

As he shoves each of the many colored gems back into the small sack, he can&#39;t help but be curious. According to Ivex&#39;s notes, he stores the spells from his spellbook into these things so that he can cast them at will. His magical ability seems to be pretty limited to that method, at least outside of the damned tower. Glancing at the unconscious panther, the wolf picks a light blue gemstone up and looks it over.

[[Continue|Gemstones]]</tw-passagedata><tw-passagedata pid="171" name="SFW Finish" tags="" position="2400,5200" size="100,100">Yeah. It&#39;s not his place to punish Ivex. A long time in prison ought to be enough to make him re-think his actions. With aching loins, the wolf moves out of the room with the feline in tow. Despite everything, however, $name can&#39;t help but smile. A lot has happened, but luckily, no one will need to know about it, and his reputation is safe. Not only that, but the criminal is taken and the wolf is victorious.

There is a lot of satisfaction in the thought that a large sack of gold awaits him for all this effort. In his head, the wolf already makes plans for a night of heavy drinking... and perhaps a few escorts in a tavern to make up for all the built-up need he never got to satisfy.

[[Continue|Bounty Collection]]</tw-passagedata><tw-passagedata pid="172" name="Gemstones" tags="" position="1200,5450" size="100,100">Frowning, the wolf hesitates, but curiosity takes over and, carefully, the wolf lets the gemstone rest on his paw... before closing it around to grip it.

The gemstone starts glowing with a faint blue light.

As soon as it does, the wolf releases his grip, but the glowing doesn&#39;t stop. $name is about to let go of the gemstone when his eyes instead go wide. Inside the wolf&#39;s mind, he suddenly &lt;b&gt;knows&lt;/b&gt;.

$name looks down at the gemstone glowing on his paw. It doesn&#39;t feel any different from reading a description in a book. Or, rather, having &lt;b&gt;read&lt;/b&gt; that description in a book. By holding the gemstone and activating it, in his mind, he realizes it tells him what it does. This gemstone in particular would encase his paw in ice, allowing him to transfer very low temperatures into anything he touches.

The wolf frowns. He does not like the idea of these things prying into his mind, but he decides to test it. Gripping the gemstone again, its glow intensifies inside the wolf&#39;s paw and then... it gets cold. It feels just slightly chilly for the wolf, but his eyes go wide seeing ice start growing around his paw, encasing it little by little...

And then he lets go of the gem. As soon as he does, the ice fades from his paw immediately and, before even hitting the ground, the gemstone loses its glow. Thankfully, it doesn&#39;t shatter, but rather just bounces off the floor and rests there.

It&#39;s amazing what magic can do. $name picks the gemstone back up and shoves it into his pouch. Next, he gathers a purple one and, curious, he grips it the same way. The knowledge that this one will wrap his paw with electricity comes to his mind. Gripping it just a tad tighter, a crackle of lightning appears around his paw as well. The wolf opens his grip, startled, but he smirks.

No wonder Ivex didn&#39;t include any descriptions of his spells in his spellbook. He didn&#39;t have to. He did something to these gemstones so that it&#39;s easy to know which is which when activating them...

&quot;Huh. These spells sure are handy...&quot; $name muses to no one in particular.

One by one, the wolf picks up all the gemstones on the floor. There are too many to test one by one, but he does try out a few. He finds some spells that look dangerous, like the one that supposedly starts fires or the one that just states that it downright causes pain. The wolf frowns at those. On the other hand, there are others that range from seemingly useless to just downright perverted, such as the one that causes itching, the one that stops someone from talking or... the one that supposedly induces lust and arousal.

$name shoves each and every one of them into the pouch until there are only four of them left on the ground. Growing enthusiastic, the wolf grabs a yellow-ish one. When he grips it around his paw, it glows, and what this one does...

[[Continue|Chastity]]</tw-passagedata><tw-passagedata pid="173" name="Punishments" tags="" position="1425,5575" size="100,100">The wolf&#39;s hands curl into tight fists. He can barely control his growling, looking down at Ivex. Will getting locked up in some mage&#39;s containment chamber, or whatever else the Guild decides to do to him, be enough to make him pay for what he&#39;s done? Of course not. They don&#39;t know half of what he&#39;s done, and even if he tells them, it won&#39;t have the same impact as seeing it.

With the sack of gemstones in hand, the wolf stomps over to the tied-up feline and lifts him up by the scruff. Ivex shifts and grunts in his sleep, but doesn&#39;t wake up quite yet.

The more $name stares at the panther, the angrier he gets remembering that cocky face making fun of him. Leaving him tied up inside that room at the mercy of that candle...

It&#39;s time to give Ivex a taste of his own medicine. A few ideas come to the wolf&#39;s mind. It&#39;s enough to make him smirk...
&lt;&lt;if $enthrallmentEnding&gt;&gt;\

Memories of the lion $name left bound inside the tower come to mind. He&#39;ll need to release him later, but the pendant the lion insisted on putting around his neck is still there as well. Judging by how things went, the pendant would clearly have made him into some kind of mindless thrall like the lion was. What if Ivex himself was made to wear it?
&lt;&lt;/if&gt;&gt;\
&lt;&lt;if $extractionEnding&gt;&gt;\

Thinking back to his experience in the tower and Ivex&#39;s journal, his report on what he has done to the poor fox that tried to escape comes to the wolf&#39;s mind. According to the mage&#39;s notes, the substance that was lying in wait in that room was hinted to be something he put his prisoners in, and something Ivex said he had to be careful not to touch. How would he feel about being thrown into one of those?
&lt;&lt;/if&gt;&gt;\

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
      &lt;li&gt;[[Wake him up. He needs to be awake to experience this.|Personal Vengeance]]&lt;/li&gt;
    &lt;&lt;if $enthrallmentEnding&gt;&gt;\
        &lt;li&gt;[[ [Unlocked: Enthrallment] Put a pendant around his neck.|Enthrallment Vengeance]]&lt;/li&gt;
    &lt;&lt;/if&gt;&gt;\
    &lt;&lt;if $extractionEnding&gt;&gt;\
        &lt;li&gt;[[ [Unlocked: Extraction] Throw him into that blob.|Extraction Vengeance]]&lt;/li&gt;
    &lt;&lt;/if&gt;&gt;\
  &lt;/ul&gt;\
&lt;/div&gt;</tw-passagedata><tw-passagedata pid="174" name="Personal Vengeance" tags="end" position="1375,5975" size="100,100">&lt;&lt;silently&gt;&gt;
&lt;&lt;set $gagged = false&gt;&gt;
&lt;&lt;set $randomGag to random(1, 2)&gt;&gt;
&lt;&lt;if $randomGag == 1&gt;&gt;
  &lt;&lt;set $lastGag to &quot;his own undergarments&quot;&gt;&gt;
&lt;&lt;elseif $randomGag == 2&gt;&gt;
  &lt;&lt;set $lastGag to &quot;a thick piece of rope&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
  &lt;&lt;set $lastGag to &quot;his own undergarments&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set $stripped = false&gt;&gt;
&lt;&lt;set $spellOptions = false&gt;&gt;
&lt;&lt;set $lustSpell = false&gt;&gt;
&lt;&lt;set $freezeSpell = false&gt;&gt;
&lt;&lt;set $shockSpell = false&gt;&gt;
&lt;&lt;set $ivexEdging = false&gt;&gt;
&lt;&lt;set $ivexEdges = 0&gt;&gt;
&lt;&lt;set $revengeStage = 0&gt;&gt;
&lt;&lt;set $stage0Clear = false&gt;&gt;
&lt;&lt;set $stage1Clear = false&gt;&gt;
&lt;&lt;set $stage2Clear = false&gt;&gt;
&lt;&lt;set $ivexClimax = false&gt;&gt;
&lt;&lt;/silently&gt;&gt;
The wolf, still holding Ivex up by the scruff, lifts him higher so that he can look at the unconscious feline&#39;s face. Then, without hesitation, $name brings a paw up and gives the panther&#39;s muzzle a hard slap.

Ivex shakes, awakening with a grunt and a mewl. The feline blinks, his feet wiggling up in the air and he looks around confused for a moment before his eyes focus on the large wolf holding him up. The sight of him trying to do something about it, only to realize that his arms are bound behind his back and his bound feet can&#39;t even touch the floor makes for quite an amusing scene.

Of course, after Ivex realizes the direness of his predicament, he still has the audacity to show his teeth at the wolf.

&quot;What do you think you&#39;re doing?! Unhand me! Let me go or I&#39;ll make you regret ever being born with all of my power!&quot; the panther says in a tone that &lt;b&gt;tries&lt;/b&gt; to sound intimidating. Paying attention to the feline, $name can see his eyes darting back and forth across the room and floor. The wolf then picks up the pouch full of gemstones from his belt and lifts it up to the panther with a smirk.

&quot;Looking for these?&quot; $name asks, lightly shaking the sack to showcase the sound of the gemstones inside.

Ivex looks at it for a moment... then juts forward, trying to reach for the sack even without the use of his arms. A most pitiful attempt that makes the larger wolf laugh as he simply pulls the pouch away.

&quot;I was right. You really are completely powerless without your little toys, aren&#39;t you? At least out here, you are...&quot; The wolf grins and chuckles.

&quot;N-no!&quot; the panther says with a small growl. &quot;You fool! When I get out of here, I&#39;m gonna make you lick my feet! Yes! You will spend the rest of your days as my foot rest and cleaner! I will make you lick them every time I g-&quot;

The wolf decides to interrupt the arrogant mage&#39;s babbling with a new slap to his face. It&#39;s enough to make him whine, even though the wolf doesn&#39;t even put much strength into it.

After that, he decides to just drop the panther down. He yelps again as he falls down, grunting like a cub and making effort to sit back up. He looks at the wolf, hisses, then starts pathetically trying to crawl away from the large lupine. Like a little worm wiggling on the ground.

A fun sight, but...

Looking down at himself, the wolf can see his cock. Because of Ivex&#39;s own magic, the red spire still throbs with insatiable need. That candle&#39;s effect has to fade at some point, but while it doesn&#39;t...

The wolf looks up at the wiggling panther.

&quot;You&#39;ll pay!&quot; he seethes. &quot;I swear, you&#39;ll pay! To think you&#39;d have the audacity of striking me! Of doing this! You will regret this!&quot; Ivex continues to hurl insult after insult at the wolf. $name all but ignores him, instead focusing on thinking.

What to do to him first?

&lt;span class=&quot;good-ending&quot;&gt;Ending: &lt;i&gt;Punishment&lt;/i&gt;&lt;/span&gt;

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
      &lt;li&gt;[[Strip him.|Strip]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;</tw-passagedata><tw-passagedata pid="175" name="Enthrallment Vengeance" tags="end" position="1600,5575" size="100,100">&lt;&lt;include &quot;Enthrallment Vengeance (Text)&quot;&gt;&gt;

&lt;span class=&quot;good-ending&quot;&gt;Ending: &lt;i&gt;Ivex&#39;s Enthrallment&lt;/i&gt;&lt;/span&gt;

[[Continue|Ivex Enthrallment 1]]</tw-passagedata><tw-passagedata pid="176" name="Extraction Vengeance" tags="end" position="1650,5750" size="100,100">&lt;&lt;include &quot;Extraction Vengeance (Text)&quot;&gt;&gt;

&lt;span class=&quot;good-ending&quot;&gt;Ending: &lt;i&gt;Ivex&#39;s Extraction&lt;/i&gt;&lt;/span&gt;

[[Continue|Ivex Extraction 1]]</tw-passagedata><tw-passagedata pid="177" name="Ivex Extraction 1" tags="" position="1775,5750" size="100,100">&lt;&lt;include &quot;Ivex Extraction 1 (Text)&quot;&gt;&gt;

[[Continue|Ivex Extraction 2]]</tw-passagedata><tw-passagedata pid="178" name="Chastity" tags="" position="1325,5450" size="100,100">It is just as perverted as some of the other ones he found, yet even though its effects make the wolf&#39;s eyes grow wide, it also makes his tail wag enthusiastically.

It&#39;s perfect.

In his mind, the wolf can see the effects of the gemstone as clearly as if there were written instructions including detailed drawings. This obscene spell... is called &#39;Chastity&#39;.

Knowing Ivex&#39;s perverted ways and means of torture, however, the wolf looks at the unconscious feline. Ivex grumbles something but doesn&#39;t wake up. His lack of consciousness clearly won&#39;t last too long. The wolf looks down at the damned panther. Just staring at him makes his rage bubble up. Who knows what other crazy spells these gemstone holds? Who knows how many people Ivex has used them against?

Inside him, &lt;&lt;print $name&gt;&gt;&#39;s body still feels hot with an insatiable lust that the damned mage himself inflicted upon him. To how many others has Ivex done this as well? Or worse?

With the yellow gemstone in hand, the wolf smirks.

Kneeling next to Ivex, the wolf carefully grips the yellow gemstone again. The moment it starts glowing, however, $name lets go of it and, holding it with only a finger... he presses it against Ivex&#39;s chest instead.

For a moment, nothing happens, and the wolf starts thinking it might not be the way to use it on someone else, but before long, a glow can be seen under the cloth of the feline&#39;s pants. Right around his crotch.

Jackpot.

Holding the gemstone steady against his chest, the wolf uses his other paw to quickly undo the laces of Ivex&#39;s pants with a claw and pull them open. Exposing the feline feels indecent, but compared to everything the damned mage has done to him? To &lt;&lt;print $name&gt;&gt;, it almost feels sweet. The panther&#39;s sheath is modest, covered in black fur, and by the time the wolf exposes it, the yellow glow is already surrounding it. It grows brighter for a moment, then it seems to condense around the sheath. For a moment, the wolf is afraid the thing is gonna hurt Ivex somehow, but no, instead, the barrier around the feline&#39;s sheath just... &#39;merges&#39; with his fur and skin. The black sheath glows with a yellow hue, but stays still.

Carefully, the wolf pulls the gemstone away from the feline&#39;s body and, keeping an eye on it, the yellow glow remains. Curious about if the spell is doing what he saw it would, the wolf uses a finger to touch Ivex&#39;s sheath. It feels... normal. Maybe he was wrong.

However, when $name traces his finger over the surface of Ivex&#39;s sheath and reaches the opening, the wolf&#39;s ears twitch. It feels as if there&#39;s something solid covering the opening. Something invisible, but as the wolf taps the opening with a claw, there is a solid thud.

$name smiles. He has seen whores and such wearing devices of chastity in brothels in the big cities. That Ivex developed something to touch on those subjects comes as no surprise, but the way the magic works does. It is as if the feline is wearing a cage around his sheath, but at the same time, there is no cage. Looking down at the gemstone, the wolf smiles. Damn if those things are not powerful.

Of how to undo what he has done, the wolf has no idea. Ivex probably knows, but he will likely need that gemstone or a different one to do so. Given how many obscene torments the mage has inflicted upon others, it seems very fitting that he be inflicted with the inability to enjoy himself in any way.

The wolf&#39;s member throbs in excitement at the thought. Now he can&#39;t wait for the panther to wake up. As the naked wolf stares at the unconscious feline, he wonders, though. The magical chastity locking his sheath should be a good punishment for all he has done, but is it enough? With a frown, the wolf wonders... should he just pick the mage up and turn him in... or should Ivex be put through a more &lt;b&gt;proper&lt;/b&gt; type of punishment?

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
      &lt;li&gt;[[Punish Ivex for his misdeeds.|Punishments]]&lt;/li&gt;
      &lt;li&gt;[[Turn Ivex in and be done with it.|Turn In]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;</tw-passagedata><tw-passagedata pid="179" name="Ivex Extraction 2" tags="" position="1900,5750" size="100,100">&lt;&lt;include &quot;Ivex Extraction 2 (Text)&quot;&gt;&gt;

[[Continue|Ivex Extraction 3]]</tw-passagedata><tw-passagedata pid="180" name="Ivex Extraction 3" tags="" position="2025,5750" size="100,100">&lt;&lt;include &quot;Ivex Extraction 3 (Text)&quot;&gt;&gt;

[[Continue|Ivex Extraction Final]]</tw-passagedata><tw-passagedata pid="181" name="Ivex Extraction Final" tags="" position="2150,5750" size="100,100">&lt;&lt;include &quot;Ivex Extraction Final (Text)&quot;&gt;&gt;

[[Continue|Ivex Extraction End]]</tw-passagedata><tw-passagedata pid="182" name="Ivex Extraction End" tags="" position="2275,5750" size="100,100">&lt;&lt;include &quot;Ivex Extraction End (Text)&quot;&gt;&gt;

[[To the end|Extraction Finish]]</tw-passagedata><tw-passagedata pid="183" name="Ivex Enthrallment 1" tags="" position="1725,5575" size="100,100">&lt;&lt;include &quot;Ivex Enthrallment 1 (Text)&quot;&gt;&gt;

[[Continue|Ivex Enthrallment 2]]</tw-passagedata><tw-passagedata pid="184" name="Ivex Enthrallment 2" tags="" position="1850,5575" size="100,100">&lt;&lt;include &quot;Ivex Enthrallment 2 (Text)&quot;&gt;&gt;

[[Continue|Ivex Enthrallment 3]]</tw-passagedata><tw-passagedata pid="185" name="Ivex Enthrallment 3" tags="" position="1975,5575" size="100,100">&lt;&lt;include &quot;Ivex Enthrallment 3 (Text)&quot;&gt;&gt;

[[Continue|Ivex Enthrallment 4]]</tw-passagedata><tw-passagedata pid="186" name="Ivex Enthrallment 4" tags="" position="2100,5575" size="100,100">&lt;&lt;include &quot;Ivex Enthrallment 4 (Text)&quot;&gt;&gt;

[[Continue|Ivex Enthrallment 5]]</tw-passagedata><tw-passagedata pid="187" name="Ivex Enthrallment 5" tags="" position="2225,5575" size="100,100">&lt;&lt;include &quot;Ivex Enthrallment 5 (Text)&quot;&gt;&gt;

[[Continue|Ivex Enthrallment Final]]</tw-passagedata><tw-passagedata pid="188" name="Ivex Enthrallment Final" tags="" position="2350,5575" size="100,100">&lt;&lt;include &quot;Ivex Enthrallment Final (Text)&quot;&gt;&gt;

[[Continue|Ivex Enthrallment End]]</tw-passagedata><tw-passagedata pid="189" name="Ivex Enthrallment End" tags="" position="2475,5575" size="100,100">&lt;&lt;include &quot;Ivex Enthrallment End (Text)&quot;&gt;&gt;

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
      &lt;li&gt;[[Keep Ivex as a personal thrall.|Enthrallment Finish]]&lt;/li&gt;
      &lt;li&gt;[[Take him back as he is and collect the bounty.|Bounty Collection]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;</tw-passagedata><tw-passagedata pid="190" name="Gag" tags="" position="1225,6425" size="100,100">&lt;&lt;set $gagged = true&gt;&gt;\
Yeah, silencing him might be a good idea. Given the place Ivex has chosen to hide, it is unlikely that anyone would hear him, but his prattling is growing annoying pretty quickly.

&quot;-and when you&#39;re done mopping the floor with your tail, I&#39;ll make you do it all over again with your TONGUE! And then-&quot; the panther continues angrily.

The wolf looks around. There&#39;s a few options on how to silence him. What to gag him with...

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
      &lt;li&gt;[[With a piece of rope.|Gag with Rope]]&lt;/li&gt;
      &lt;li&gt;[[With a silence spell.|Gag with Spell]]&lt;/li&gt;
      &lt;li&gt;[[With his own undergarments.|Gag with Underwear]]&lt;/li&gt;	
  &lt;/ul&gt;\
&lt;/div&gt;</tw-passagedata><tw-passagedata pid="191" name="Strip" tags="" position="1375,6175" size="100,100">&lt;&lt;if !$stage0Clear&gt;&gt;\
Memories of the perverted panther getting rid of his clothes back in the tower come to the wolf&#39;s mind. Narrowing his eyes towards the feline, he reaches up to him.

&quot;What?! Stop! Let go of me! Let go of me right NOW!&quot; Ivex demands as wiggles in the wolf&#39;s hold. Still, it takes no effort for $name to lift the feline up by his scruff again.

The large wolf is not gentle. Using his own paw and sheer strength, he takes hold of Ivex&#39;s shirt around the neck and &lt;b&gt;pulls&lt;/b&gt;.

Ivex whines as the fabric rips. His skinny chest is exposed to the elements and, with a few more tugs and tears, soon the rags of what was once his shirt fall down to the floor.

Then, both the panther and the wolf look down his pants, the only thing left covering his body.

Their eyes meet, and $name smirks.

&quot;No! NO! Don&#39;t you dare! Don&#39;t-!&quot; Ivex growls, starting to wiggle in his hold again, but the wolf ignores it.

With a pull just as strong, $name grabs the waistband of Ivex&#39;s pants, and it takes very little effort for the big, strong wolf to tear the fabric apart. The bound panther continues to struggle in the air, and when his pants fall, he is left with nothing but a small, worn-looking cloth undergarment wrapped around his crotch. The feline hisses, but for the wolf, it takes but one finger to snap the waistband of Ivex&#39;s last piece of modesty and let it fall down to the floor as well.

&quot;I will make you SUFFER!&quot; the panther yells. Still held up in the air, Ivex presses his legs together in a feeble attempt to hide his modesty. It looks like he doesn&#39;t enjoy it that much when it&#39;s done to him and not to others.

Nonchalantly, the wolf drops the panther back down, letting him fall and taking a good look at his naked form. Ivex rolls on the floor trying to get rid of the ropes keeping him bound and, now naked as he is, the wolf can finally get a good look at his body.

He is lean indeed, not a single muscle adorning his arms, but his body is still... curvy enough. Perhaps it is the arousal speaking, but looking down at the panther&#39;s round ass as he struggles back and forth makes the wolf&#39;s cock throb again. His member, perpetually stuck in an erect state, grows even harder as lustful thoughts fill up his mind...

Still, $name shakes his head and shakes them off. They are still very much there, but there will be plenty of time for that if he decides to go for it. For now, this is about punishing the panther...

&quot;You BRUTE! You brainless, dumb brute! You can&#39;t even fathom what you&#39;re doing! I will make you EAT the clothes you ruined when I get out of here!&quot; Ivex continues to prattle.

On one hand, fucking him would be a fitting punishment. Hell knows that the wolf&#39;s cock wants that... On the other hand, there are other things he could also do to him that would definitely be fun.

Ivex is not aware of the chastity spell yet either. Perhaps giving him a taste of his own medicine in that regard too would be better...

What to do to him next?
&lt;&lt;set $stage0Clear = true&gt;&gt;\
&lt;&lt;else&gt;&gt;\
Now properly gagged, the panther is reduced to angrily spitting out muffled complaints that the wolf can&#39;t even make out.

The sight of the once-powerful mage bound on the floor, squirming and hissing like an angry kitten amuses the naked wolf.

Still, the show must go on. Kneeling next to the panther, the wolf drags him closer.
&lt;&lt;/if&gt;&gt;\

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
      &lt;li&gt;[[Show him.|Fondle]]&lt;/li&gt;
    &lt;&lt;if !$gagged&gt;&gt;\
      &lt;li&gt;[[Gag him.|Gag]]&lt;/li&gt;
    &lt;&lt;/if&gt;&gt;\
  &lt;/ul&gt;\
&lt;/div&gt;</tw-passagedata><tw-passagedata pid="192" name="Gag with Rope" tags="" position="1475,6500" size="100,100">Better to go with the classics.

Cutting a spare piece of rope with his teeth, the wolf then ties it into a thick, single piece and, nonchalantly, shoves it into the maw of the complaining panther.

&quot;HMMFGH!&quot; Ivex complains again, this time blissfully muffled. He shakes his head back and forth clearly trying to dislodge the rope but, just for the fun of it, the wolf uses a claw to press it even deeper within his maw.

&quot;Hnnnnghhfff! Hngh hnmmf!&quot; Ivex complains again, but the wolf can&#39;t even tell what he&#39;s saying.

Sweet, sweet silence.

&lt;&lt;if $revengeStage == 0&gt;&gt;\
[[Continue|Strip]]
&lt;&lt;elseif $revengeStage == 1&gt;&gt;\
[[Continue|Hold]]
&lt;&lt;elseif $revengeStage == 2&gt;&gt;\
[[Continue|Hold]]
&lt;&lt;elseif $revengeStage == 3&gt;&gt;\
[[Continue|Fucking]]
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="193" name="Gag with Spell" tags="" position="1375,6500" size="100,100">Why not use Ivex&#39;s own tools against him?

Shoving his paw into the pouch of gemstones, the wolf pulls out a gray-ish one that he remembers was a spell of silence. Clutching it into his paw, the wolf activates it and sees how to use it.

All he has to do is touch Ivex&#39;s muzzle with the gemstone. The moment he does, the feline&#39;s eyes go wide realizing what was done. Ivex opens his muzzle to say something, but the moment he does, it gets clamped shut.

&quot;HMMFGH!&quot; Ivex complains again, except this time his words come out muffled. It&#39;s impressive! The panther seems like he tries and tries to open his muzzle, but no matter what, he can&#39;t. Because of it, his words come out as barely intelligible.

&quot;Hnnnnghhfff! Hngh hnmmf!&quot; Ivex complains again, but the wolf can&#39;t even tell what he&#39;s saying.

Sweet, sweet silence.

&lt;&lt;if $revengeStage == 0&gt;&gt;\
[[Continue|Strip]]
&lt;&lt;elseif $revengeStage == 1&gt;&gt;\
[[Continue|Hold]]
&lt;&lt;elseif $revengeStage == 2&gt;&gt;\
[[Continue|Hold]]
&lt;&lt;elseif $revengeStage == 3&gt;&gt;\
[[Continue|Fucking]]
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="194" name="Gag with Underwear" tags="" position="1575,6500" size="100,100">The wolf smirks. It&#39;s time to get creative.

Reaching out for Ivex&#39;s cut and discarded clothes, it&#39;s easy to find the stained piece of cloth he had wrapped around his crotch. 

The panther&#39;s eyes follow the wolf&#39;s hand and he seems confused for a moment. Then, $name crumples the cloth into a tight ball and approaches the feline&#39;s muzzle with it.

&quot;WHA-&quot; Ivex has time to say and, when he opens his muzzle to do so, the wolf shoves his own undergarments into his maw with a swift motion.

&quot;HMMFGH!&quot; Ivex complains. His eyes water and his face grows red. The panther shakes his head, clearly trying to dislodge the underwear from within his muzzle, but the wolf does not let him. With two fingers, he presses the garments in deeper and deeper, to the point where they seem like they&#39;re close to reaching the mage&#39;s throat.

&quot;Hnnnnghhfff! Hngh hnmmf!&quot; Ivex complains again, but the wolf can&#39;t even tell what he&#39;s saying. He looks absolutely furious, though.

Sweet, sweet silence.

&lt;&lt;if $revengeStage == 0&gt;&gt;\
[[Continue|Strip]]
&lt;&lt;elseif $revengeStage == 1&gt;&gt;\
[[Continue|Hold]]
&lt;&lt;elseif $revengeStage == 2&gt;&gt;\
[[Continue|Hold]]
&lt;&lt;elseif $revengeStage == 3&gt;&gt;\
[[Continue|Fucking]]
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="195" name="Fondle" tags="" position="1500,6175" size="100,100">&lt;&lt;set $revengeStage = 1&gt;&gt;\
The wolf takes a few heavy steps toward the panther. Seeing $name approaching is enough to make Ivex look fearful again. He tries to wiggle away, but a simple pull on his tail is enough to drag him back closer. Then, the wolf gets down on all fours over the bound mage.

Ivex shrinks and closes his eyes to the simple act of the growling wolf&#39;s sharp teeth approaching him. Upon getting on all fours above the feline, however, the wolf stops. His cock flexes between his legs, so very close to the naked panther and, in fact, with a droplet of pre-cum falling to mat the panther&#39;s perfect black fur.

&lt;&lt;if !$gagged&gt;&gt;\
&quot;Stop! Get away!&quot; Ivex hisses, sounding less and less threatening.
&lt;&lt;else&gt;&gt;\
&quot;Shhnf! Ghn aawhhff!&quot; Ivex hisses, sounding less and less threatening.
&lt;&lt;/if&gt;&gt;\

&quot;Quiet,&quot; the wolf orders, plain and simple. With one hand, the wolf grabs the panther&#39;s shoulder and forces him onto his back. Then, looking down at Ivex&#39;s sheath... The wolf takes pleasure in roughly grabbing it and starting to fondle it between two of his powerful fingers.

&lt;&lt;if !$gagged&gt;&gt;\
&quot;What are you doing?!&quot; The panther seems outraged to be touched like that, which is ironic, really. Ivex hisses and tries to wiggle away, but he is very easy to hold down. It is, however, surprisingly soon that the wolf feels the panther&#39;s sheath starting to swell.
&lt;&lt;else&gt;&gt;\
&quot;Whhmf hhrm yhm ddhff?!&quot; The panther seems outraged to be touched like that, which is ironic, really. Ivex hisses and tries to wiggle away, but he is very easy to hold down. It is, however, surprisingly soon that the wolf feels the panther&#39;s sheath starting to swell.
&lt;&lt;/if&gt;&gt;\

Ivex is too busy being angry at first to notice, but before long, he stops. The feline grunts, his eyes go wide, and he looks downward trying to get a look at his sheath.

Upon seeing that, the wolf smiles. His fingers coaxing and stroking Ivex&#39;s sheath start to work faster, kneading it the same way he does his own to force pleasure upon the panther. Both $name and Ivex see the same thing when looking down at that sheath.

The feline&#39;s member trying to grow out of it, but failing. It gets trapped inside it, held back by the barely visible translucent barrier from Ivex&#39;s own spell. Recognition flashes on Ivex&#39;s eyes and the look of seething anger and outrage he gives the wolf make all of this worth it by itself.

&lt;&lt;if !$gagged&gt;&gt;\
&quot;WHAT DID YOU DO?!&quot; he asks, yelling. &quot;You didn&#39;t- NO! YOU FOOL! That spell is not ready yet! Do you know how much work it will be to dispel it?! I will make you PAY for this!&quot;
&lt;&lt;else&gt;&gt;\
&quot;WHMM HM DHFF HMMFGH?!&quot; he tries to ask through muffled yelling.
&lt;&lt;/if&gt;&gt;\

As the panther attempts to keep yelling his outrage, the wolf simply smirks. His fingers move even faster in stroking and kneading Ivex&#39;s sheath. Soon enough, his complaining stops and, instead, he starts groaning. A droplet of pre-cum comes from Ivex&#39;s sheath, smearing its inside as his cock continues to fail to grow out of it.

This will, indeed, be plenty of fun.

&lt;&lt;if !$gagged&gt;&gt;\
&quot;You- I will place ten layers of this spell on you when I get out of this! It will take an archmage to ever access your fucking sheath ever again!!&quot; Ivex continues to idly threaten... and then he stops to groan in frustrated pleasure again.
&lt;&lt;else&gt;&gt;\
&quot;Hnnnghh! Hnngh hnmffg yhmgh HMGFFGH mmfffh!&quot; Ivex continues to attempt to threaten... and then he stops to groan in frustrated pleasure again.
&lt;&lt;/if&gt;&gt;\

$name continues to hold the panther down and forcefully stimulate him. What to do to him next, though? Hmm...

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
      &lt;li&gt;[[Use one of his spells on him.|Spell]]&lt;/li&gt;
      &lt;li&gt;[[Continue stimulating him.|Edge]]&lt;/li&gt;	
    &lt;&lt;if !$gagged&gt;&gt;\
      &lt;li&gt;[[Gag him.|Gag]]&lt;/li&gt;
    &lt;&lt;/if&gt;&gt;\
  &lt;/ul&gt;\
&lt;/div&gt;</tw-passagedata><tw-passagedata pid="196" name="Spell" tags="" position="1875,6375" size="100,100">&lt;&lt;if !$spellOptions&gt;&gt;\
Yes. Ivex has made so many spells with the sole intent of using them on people for his own perversion. Why not use some of these against him?

The wolf smirks down at the panther and lets go of him. The mage stares daggers up at the wolf but is left panting and looking flustered. His sheath is still full and his cock still fights to grow past it. The frustration of it is plain in Ivex&#39;s face and he takes that moment of reprieve to recover a little from it.

In the meantime, the wolf pulls out the pouch filled with his gemstones and brings it up. The moment Ivex sees it, his eyes narrow.

&lt;&lt;if !$gagged&gt;&gt;\
&quot;What are you doing with that, you mongrel?!&quot; he asks between his raspy breathing.
&lt;&lt;else&gt;&gt;\
&quot;Whmmgh hmm yyhm ddhmff?!&quot; he tries to ask between his raspy breathing.
&lt;&lt;/if&gt;&gt;\

The wolf all but ignores it. He opens the pouch wide and looks down at it. Shoving his paw inside, $name goes through a few of the gemstones, clutching them to get a read of what they do. After a little while, he looks down at the panther and smirks.

There are a few that could definitely be used against Ivex right here...
&lt;&lt;set $spellOptions = true&gt;&gt;\
&lt;&lt;else&gt;&gt;\
Bringing the spell pouch up, the wolf shoves his paw into it to grab one.

Which spell would be best to use right now?
&lt;&lt;/if&gt;&gt;\

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
      &lt;li&gt;[[Use a Lust spell on him.|Lust Spell]]&lt;/li&gt;  
    &lt;&lt;if $interrogationEndingFreeze&gt;&gt;\
        &lt;li&gt;[[ [Unlocked: Freeze] Use an ice spell on him.|Ice Spell]]&lt;/li&gt;
    &lt;&lt;else&gt;&gt;\
      &lt;li&gt;&lt;span class=&quot;disabled&quot;&gt;[Locked: Interrogation - ???] ???&lt;/span&gt;&lt;/li&gt;
    &lt;&lt;/if&gt;&gt;\
    &lt;&lt;if $interrogationEndingShock&gt;&gt;\
        &lt;li&gt;[[ [Unlocked: Shock] Use an lightning spell on him.|Lightning Spell]]&lt;/li&gt;
    &lt;&lt;else&gt;&gt;\
      &lt;li&gt;&lt;span class=&quot;disabled&quot;&gt;[Locked: Interrogation - ???] ???&lt;/span&gt;&lt;/li&gt;
    &lt;&lt;/if&gt;&gt;\	
    &lt;&lt;if $revengeStage == 2 || $revengeStage == 1&gt;&gt;\
    &lt;li&gt;[[On second thought, maybe no spells just yet...|Hold]]&lt;/li&gt;
    &lt;&lt;elseif $revengeStage == 3&gt;&gt;\
    &lt;li&gt;[[On second thought, maybe no spells just yet...|Fucking]]&lt;/li&gt;
    &lt;&lt;/if&gt;&gt;\
  &lt;/ul&gt;\
&lt;/div&gt;</tw-passagedata><tw-passagedata pid="197" name="Edge" tags="" position="1675,6025" size="100,100">&lt;&lt;if !$ivexEdging&gt;&gt;
$name is fond of the good, old methods, and this seems to be extra effective on the mage.

Roughly taking hold of Ivex&#39;s sheath, the wolf&#39;s fingers start kneading and teasing it in a firmer manner.

&lt;&lt;if !$gagged&gt;&gt;\
&quot;S-stop!&quot; Ivex growls, but though he seems like he wants to hide it, the effects on him are quite obvious. The feline groans, his member straining- &lt;b&gt;begging&lt;/b&gt; to grow hard to the wolf&#39;s stimulation, but it is unable to. The mage&#39;s own spell keeps it firmly stuck inside its sheath as if contained by unyielding metal.
&lt;&lt;else&gt;&gt;\
&quot;Shmmfgh!&quot; Ivex growls, but though he seems like he wants to hide it, the effects on him are quite obvious. The feline groans, his member straining- &lt;b&gt;begging&lt;/b&gt; to grow hard to the wolf&#39;s stimulation, but it is unable to. The mage&#39;s own spell keeps it firmly stuck inside its sheath as if contained by unyielding metal.
&lt;&lt;/if&gt;&gt;\

$name takes advantage of that.

The wolf uses every trick in the book. He fondles the mage&#39;s balls, strokes his sheath, and does everything he can to inflict pleasure upon the mage. The way the panther squirms in frustration delights $name immensely. An act that would usually feel great, turned into pure frustration by the mage&#39;s own spell. The irony of it makes the wolf&#39;s own cock throb once in delight.

Despite Ivex&#39;s complaints, he keeps going. For a good while, the wolf continues to tease and pleasure the mage without him being able to enjoy. $name clearly feels how much the panther is dripping, how high his pleasure reaches, and he can read the signs. Soon enough, the panther is teetering at the edge of climax.

Yet, without proper stimulation and unable to even grow hard, he cannot achieve it. The panther squirms in perpetual frustration and the wolf keeps going. Teasing Ivex in that state feels even better.

It&#39;s only when the panther seems like he can barely breathe properly from all the pleasure, that the wolf decides to stop. He wipes his claws sticky with pre-cum on the panther&#39;s own fur and lets him catch his breath. Ivex pants and groans, clearly deeply frustrated and needier than ever.

His cock continues to strain to grow and fail.
&lt;&lt;set $ivexEdging = true&gt;&gt;\
&lt;&lt;else&gt;&gt;\
Smirking, the wolf&#39;s paw reaches down for Ivex&#39;s sheath again.

&lt;&lt;if !$gagged&gt;&gt;\
&quot;N-no! Stop!&quot; Ivex pleads. He denies it, but the wolf can feel how his cock throbs in its prison again knowing what&#39;s coming.
&lt;&lt;else&gt;&gt;\
&quot;N-nhmmfgh! Shmmfgh!&quot; Ivex pleads. He denies it, but the wolf can feel how his cock throbs in its prison again knowing what&#39;s coming.
&lt;&lt;/if&gt;&gt;\

Surely enough, the wolf starts the process all over again. The painfully long and pleasurable process of kneading, massaging and teasing Ivex&#39;s sheath and balls. The panther complains as pleasure is inflicted on him, slowly and surely, with the wolf&#39;s strong fingers stimulating Ivex&#39;s trapped cock until it&#39;s dripping in desperation.

Feeling it struggle so very hard to grow hard and fail is delightful.

Soon enough, Ivex is clearly at the edge of orgasm once more. The feline groans in deep frustration, going as far as trying to lightly hump against the wolf&#39;s hand as if that would provide any stimulation at all. $name can see his face flustered, conflicted between humiliation and desperate pleasure, and that only fuels the wolf&#39;s fire to keep going.

For quite a while longer, he pleasures and teases Ivex, keeping him on the edge of a climax that will never come in his state.

After he&#39;s satisfied, $name wipes his hand on the panther&#39;s already matted fur and chuckles while the panther lets out a pathetic whine and struggles to catch his breath.
&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $ivexEdges += 1&gt;&gt;\

&lt;&lt;if $revengeStage == 2 || $revengeStage == 1&gt;&gt;\
[[Continue|Hold]]
&lt;&lt;elseif $revengeStage == 3&gt;&gt;\
[[Continue|Fucking]]
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="198" name="Ice Spell" tags="" position="1775,6500" size="100,100">Pulling out the light blue gemstone, the wolf clutches it in his hand and looks down at Ivex.

&lt;&lt;if !$freezeSpell&gt;&gt;\
The panther sees the gemstone in the wolf&#39;s hand and laughs.

&lt;&lt;if !$gagged&gt;&gt;\
&quot;You utter fool! You don&#39;t even know what you&#39;re doing!&quot; Ivex taunts.
&lt;&lt;else&gt;&gt;\
&quot;Hmmfg hmmfgff hummghf!&quot; Ivex just mumbles. He looks smug as he does.
&lt;&lt;/if&gt;&gt;\

The smile adorning the panther&#39;s fade fades and his expression starts shifting into an increasingly worried one as the wolf&#39;s paw, encased in ice, moves towards his sheath.

&lt;&lt;if !$gagged&gt;&gt;\
&quot;What are YOU GONNA D-AAAAH!&quot;
&lt;&lt;else&gt;&gt;\
&quot;Whmmfgh rhmmf dh- HMMMFGH!!&quot;
&lt;&lt;/if&gt;&gt;\

The panther thrashes in place the moment the wolf&#39;s paw grabs at his crotch. With his wide paw, the wolf manages to take hold of both Ivex&#39;s sheath and nuts, his paw pressing hard against them while transferring the low temperature of that icy cold spell directly onto Ivex&#39;s sheath and balls.

The way the panther tears up and yelps over having the coldness enveloping his sheath and balls is comic. The wolf chuckles, then pulls his paw away to let Ivex gasp and pant.

The reprieve is pretty short, however. With the ice lingering on his paw due to Ivex&#39;s own spell, the wolf uses his fingers to touch the mage&#39;s sheath in a more precise way. Ivex whines again as the wolf uses his icy fingers to pry that sheath open and play with it, followed by sticking one of them in there.

To Ivex, it must certainly feel like a block of pure ice is being put inside his sheath. The panther&#39;s member that had been straining against the invisible barrier shrinks and shies away from the freezing touch, but the wolf makes a point to caress it, forcing Ivex to feel the coldness on his most sensitive region.

&quot;HNNNNGH!&quot; the panther just grunts. The wolf can just hear the rage behind that grumble, but he seems to be too busy coping with the cold feeling to even attempt to properly say anything. 

The barrier from the chastity spell does not let the wolf pry any deeper into Ivex&#39;s sheath, but that doesn&#39;t stop him from rubbing it all over the panther&#39;s fuzzy pouch, nor does it stop the wolf from grabbing Ivex&#39;s balls in his hand and rolling them between his ice-cold fingers. It&#39;s a delight to hear him whine and complain about how terrible it feels.

After a while, the wolf lets go of the gem. His paw gets warm right away and, just for fun, he touches Ivex&#39;s sheath again. It&#39;s still icy cold as if it had been sunken in freezing water for a while.

The panther pants and glances back at the wolf with a look of pure fury, but doesn&#39;t dare say anything.

Fun stuff.
&lt;&lt;set $freezeSpell = true&gt;&gt;\
&lt;&lt;else&gt;&gt;\
Ivex&#39;s eyes go wide when he sees it once more. The panther shakes his head, his eyes a mix of begging and anger, but that does not dissuade the wolf.

His paw feels mildly cold as it grows encased in ice once again. $name does not hesitate, though. It goes straight for Ivex&#39;s vulnerable sheath and balls.

The way the panther grunts and groans as the wolf plays with his sheath between his icy cold fingers is always fun to watch. $name alternates between freezing the panther&#39;s balls for a while, then going back to play around with his sheath and trapped cock. The panther twitches, struggling to get away from it, but there&#39;s nowhere to go.

For a good while, the wolf teases the mage with the freezing touch of his own spell, forcing Ivex to literally cool down.

After he&#39;s satisfied, Ivex&#39;s member is left shy and cold inside his sheath, ready to be played with again.
&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $ivexEdges -= 1&gt;&gt;\

&lt;&lt;if $revengeStage == 2 || $revengeStage == 1&gt;&gt;\
[[Continue|Hold]]
&lt;&lt;elseif $revengeStage == 3&gt;&gt;\
[[Continue|Fucking]]
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="199" name="Lightning Spell" tags="" position="1875,6500" size="100,100">Pulling out the purple gemstone, the wolf clutches it in his hand and looks down at Ivex.

&lt;&lt;if !$shockSpell&gt;&gt;\
The panther catches a glimpse of which gemstone the wolf is pulling out and frowns.

&lt;&lt;if !$gagged&gt;&gt;\
&quot;You idiot! Be careful what you touch! You don&#39;t even know what you&#39;re doing!&quot; The panther hisses and wiggles trying to get away.
&lt;&lt;else&gt;&gt;\
&quot;Ymm mmfgh! Mm gmfmf hmmgff gmfhgh!&quot; The panther hisses and wiggles trying to get away.
&lt;&lt;/if&gt;&gt;\

The wolf&#39;s grip on Ivex simply tightens while he clutches the gemstone with the other hand. The cackle of lightning around his paw creates a tingle. A funny one. It definitely seems like it does more than just tingle when his paw touches something, though.

And the wolf decides to test it out in the best way possible.

&lt;&lt;if !$gagged&gt;&gt;\
&quot;Wh-what are you doing?&quot; Ivex asks, looking at the wolf and seeing his hand slowly going between his legs. &quot;Stop!&quot;
&lt;&lt;else&gt;&gt;\
&quot;Whmmfg hmmf yhmmfh?&quot; Ivex asks, looking at the wolf and seeing his hand slowly going between his legs. &quot;HMMFGH!&quot;
&lt;&lt;/if&gt;&gt;\

The wolf doesn&#39;t. With a smirk, he extends a single finger and brings it down to touch Ivex&#39;s balls with the tip of his claws.

The panther lets out a high-pitched yelp as a lightning current goes through his sensitive nuts. He jerks away from it, but in the motion, all he does is get in contact with the wolf&#39;s finger again, which makes him get zapped once more.

&quot;HNNNGH!&quot; Ivex groans. The mage thrashes and struggles, but the wolf gives him no reprieve. With two fingers, the wolf takes hold of Ivex&#39;s caged sheath... and the feline yelps yet again.

Despite what looks like a deep discomfort, the wolf still feels droplets of pre-cum running down his paw as he lightly rubs the lightning-imbued fingers on Ivex&#39;s helpless sheath. His member does shy away ever so slightly, and the panther keeps twitching and mewling with discomfort.

&lt;&lt;if !$gagged&gt;&gt;\
&quot;YOU FUCKING-!&quot; Ivex starts, but the wolf stops his complaining with a simple, very mild squeezing of the sheath. Apparently, applying more pressure increases the current his paw discharges and, in turn, it makes Ivex yelp out loud.
&lt;&lt;else&gt;&gt;\
&quot;HMMGH HGH-!&quot; Ivex starts, but the wolf stops his complaining with a simple, very mild squeezing of the sheath. Apparently, applying more pressure increases the current his paw discharges and, in turn, it makes Ivex yelp out loud.
&lt;&lt;/if&gt;&gt;\

That new knowledge makes the wolf smirk. He lets go of the feline&#39;s sheath for a moment to give him some respite, but soon enough, his fingers are hovering around the feline&#39;s hanging nuts again. The wolf then presses a single, playful finger right on the middle of Ivex&#39;s balls.

The panther whines at first, but little by little, the wolf increases the pressure, pressing ever so slightly against the sensitive balls and, as a result, increasing the electric current going through Ivex&#39;s nuts little by little, all caused by his own spell.

He plays with it for a while, softening his touch, then tightening again, all while hearing Ivex&#39;s mewling and complaining the whole time. Sometimes the panther seems angry, sometimes a little more complacent, and the different reactions bring a few laughs out of the wolf.

After zapping the mage&#39;s sheath and balls for a good while, the wolf finally lets go of the gemstone. His paw returns to normal and Ivex looks relieved... but his eyes carry vengeful fury when he stares at the wolf.

He clearly still has much to learn.
&lt;&lt;set $shockSpell = true&gt;&gt;\
&lt;&lt;else&gt;&gt;\
Ivex all but yelps when he sees it once more. He seems like he wants to speak against it, but the wolf is faster with it this time. Clutching it in his paw, within moments his finger is already touching Ivex&#39;s sheath, zapping it with a current of electricity.

The panther&#39;s grunting starts all over again. This time, $name makes a point of rubbing his lightning-filled fingers against Ivex&#39;s sheath, teasing his balls, and even lightly touching the tip of his claw against Ivex&#39;s straining member. Trapped inside his chastity, held, and bound as he is, the panther can do nothing but endure it.

On a whim, the wolf even goes as far as grabbing Ivex&#39;s balls within his paw as a whole. That seems to shock it from all sides, providing the panther with a very unpleasant experience coming from his own spell, before the wolf lets go of it.

He keeps his prodding random, chuckling at how the feline reacts when he zaps his balls twice, then sheath once, then balls twice again...

Before long, he gets bored of it. Ivex&#39;s member seems to have shirked away a little bit because of the shocking.
&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $ivexEdges -= 1&gt;&gt;\

&lt;&lt;if $revengeStage == 2 || $revengeStage == 1&gt;&gt;\
[[Continue|Hold]]
&lt;&lt;elseif $revengeStage == 3&gt;&gt;\
[[Continue|Fucking]]
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="200" name="Hold" tags="" position="1675,6175" size="100,100">&lt;&lt;set $revengeStage = 2&gt;&gt;\
&lt;&lt;if !$stage1Clear&gt;&gt;\
  &lt;&lt;if !$gagged&gt;&gt;\
  &quot;Fuck... you!&quot; Ivex mutters between raspy breaths. The wolf merely smirks at it.
  &lt;&lt;else&gt;&gt;\
  &quot;Fhmmff... yhmmfgh!&quot; Ivex mutters between raspy breaths. The wolf merely smirks at it.
  &lt;&lt;/if&gt;&gt;\

  Keeping him held down is an easy matter even if he does try to squirm away every now and then. The meek panther does not look threatening at all anymore like that.

  As the wolf stares down at him, his own member still pulses, however. The lust Ivex has inflicted on him still feels like it is unsatisfied. Perhaps taking it out on him would satisfy it and, even if it doesn&#39;t, it will at least &lt;b&gt;feel&lt;/b&gt; fucking satisfying. Just the thought of it makes the wolf let out a small growl of lust. His knot feels cold out in the open like that for so long...

  $name takes control of his senses, though. He&#39;s there to punish Ivex, not to indulge in his own forced lust. Not that he couldn&#39;t do both at the same time.

  &lt;&lt;if !$gagged&gt;&gt;\
  &quot;You fucking... mutt! You&#39;ll pay...&quot; Ivex repeats, doing nothing but foster the wolf&#39;s anger.
  &lt;&lt;else&gt;&gt;\
  &quot;Yhmmgh PHMMGH!&quot; Ivex repeats, doing nothing but annoy the wolf with his incessant attempts to prattle.
  &lt;&lt;/if&gt;&gt;\

  At any rate, though, what to do with him next?
  &lt;&lt;set $stage1Clear = true&gt;&gt;\
&lt;&lt;else&gt;&gt;\
  &lt;&lt;if $ivexEdges &lt; 0&gt;&gt;\
    &lt;&lt;set $ivexEdges = 0&gt;&gt;\
  &lt;&lt;/if&gt;&gt;\
  &lt;&lt;if $ivexEdges &lt;= 2&gt;&gt;\
    The wolf roughly grabs the bound mage&#39;s caged sheath to feel it up.
    The panther&#39;s arousal feels... &lt;span style=&quot;color:#e7d778&quot;&gt;gripping&lt;/span&gt;.
  &lt;&lt;elseif $ivexEdges &gt; 2 &amp;&amp; $ivexEdges &lt;= 3&gt;&gt;\
    The wolf roughly grabs the bound mage&#39;s caged sheath to feel it up.
    The panther&#39;s arousal feels... &lt;span style=&quot;color:#bb5e39&quot;&gt;powerful&lt;/span&gt;.
  &lt;&lt;elseif $ivexEdges &gt; 3 &amp;&amp; $ivexEdges &lt;= 5&gt;&gt;\
  The wolf roughly grabs the bound mage&#39;s caged sheath to feel it up.
  The panther&#39;s arousal feels... &lt;span style=&quot;color:#bf5150&quot;&gt;overpowering&lt;/span&gt;.
  &lt;&lt;elseif $ivexEdges &gt; 5&gt;&gt;\
    The wolf roughly grabs the bound mage&#39;s caged sheath to feel it up.
    The panther&#39;s arousal feels... &lt;span style=&quot;color:#e92940&quot;&gt;overwhelming&lt;/span&gt;.
  &lt;&lt;else&gt;&gt;\
  &lt;&lt;/if&gt;&gt;\

  Keeping the bound mage held down on his back against the floor is remarkably easy, especially when he&#39;s panting and gasping after being... tortured.

  What to do with the helpless, evil feline next?
&lt;&lt;/if&gt;&gt;\

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
      &lt;li&gt;[[Use one of his spells on him.|Spell]]&lt;/li&gt;
      &lt;li&gt;[[Stimulate and tease him by hand.|Edge]]&lt;/li&gt;
    &lt;li&gt;[[Fuck him.|Fuck]]&lt;/li&gt;
    &lt;&lt;if !$gagged&gt;&gt;\
      &lt;li&gt;[[Gag him.|Gag]]&lt;/li&gt;
    &lt;&lt;/if&gt;&gt;\
  &lt;/ul&gt;\
&lt;/div&gt;</tw-passagedata><tw-passagedata pid="201" name="Lust Spell" tags="" position="1975,6500" size="100,100">Pulling out the pink gemstone, the wolf clutches it in his hand and looks down at Ivex.

&lt;&lt;if !$lustSpell&gt;&gt;\
The panther catches a glimpse of the gemstone and starts shaking his head.

&lt;&lt;if !$gagged&gt;&gt;\
&quot;You can&#39;t! Don&#39;t you DARE!&quot; Ivex growls, but that does nothing to stop the wolf from pressing the glowing gemstone against the squirming panther&#39;s chest.
&lt;&lt;else&gt;&gt;\
&quot;Yhmm cchmfgh! Dhmmf hmmgh hmmffg!!&quot; Ivex growls, but that does nothing to stop the wolf from pressing the glowing gemstone against the squirming panther&#39;s chest.
&lt;&lt;/if&gt;&gt;\

The moment it does, Ivex lets out a loud, lingering moan. Just to see its effects, $name brings his other paw down to the feline&#39;s sheath. He fondles it, teasing it, and on his fingers, he can feel it actually heating up.

Ivex&#39;s member, which had already been straining to grow hard, clearly pushes even harder against the chastity spell, but it&#39;s hopeless. His cock cannot grow, will not grow, and the feline just moans and writhes in frustration over it. Pre-cum starts coming from his member, little by little at first, but the more the wolf keeps that gemstone pressed against his chest, the more frequent it becomes. 

It seems like the mage doesn&#39;t enjoy his magic being used on him as much as he enjoys using it on others.

With no rush, the wolf keeps kneading the panther&#39;s sheath, stimulating it and helping the spell foster Ivex&#39;s frustration. The feline just writhes, his face shifting between frustration and pleasure every second as he deals with the spell&#39;s effects forcing him into a deep arousal he cannot have.

&lt;&lt;if !$gagged&gt;&gt;\
&quot;Hnnngh... fuck... please...!&quot; Ivex whines after a short while. His hips jut up pathetically as if humping. He seems desperate to grow hard. Pre-cum leaks without ceasing from his member and, even small and forcefully contained as it is, it still pulses inside the panther&#39;s sheath. It looks as if he&#39;s ready to reach his climax, but is unable to without the proper stimulation he can&#39;t get.
&lt;&lt;else&gt;&gt;\
&quot;Hnnngh... fhmmgh... plhhmmfgh...!&quot; Ivex whines after a short while. His hips jut up pathetically as if humping. He seems desperate to grow hard. Pre-cum leaks without ceasing from his member and, even small and forcefully contained as it is, it still pulses inside the panther&#39;s sheath. It looks as if he&#39;s ready to reach his climax, but is unable to without the proper stimulation he can&#39;t get.
&lt;&lt;/if&gt;&gt;\

$name takes pleasure in keeping the gemstone firmly pressed against the helpless feline as he moans in that state for several minutes. It is only when the wolf&#39;s fingers are drenched in pre-cum and the panther looks like he might pass out from too much pleasure that he finally pulls the gemstone back.

When he does, Ivex lets out a frustrated groan, but finally seems like he starts catching his breath rather than just mindlessly moaning. The panther looks dazed. The wolf wipes his hand on the fur of Ivex&#39;s thigh, but even with the source of arousal gone, Ivex&#39;s cock remains in that state of trying so very hard to grow.

The wolf just snorts. The mage that looked so powerful in the tower, submitting him to that, now looks like a mewling cat under the effects of the same spell.

The wolf&#39;s own cock throbs, ever erect, remembering how it felt, and as it does... he only feels angry. Ivex still has much more to feel.
&lt;&lt;set $lustSpell = true&gt;&gt;\
&lt;&lt;else&gt;&gt;\
Ivex sees it coming once more and shakes his head. He looks conflicted between wanting it or not, but he knows the effect it will have on him in his current state.

&lt;&lt;if !$gagged&gt;&gt;\
&quot;If you do that again I&#39;ll TORTURE you so much that y- AAH!&quot;
&lt;&lt;else&gt;&gt;\
&quot;Hmmfgh! Hhmmf hmgh ghhmf- HNNGHH!&quot;
&lt;&lt;/if&gt;&gt;\

The panther&#39;s senseless rambling is interrupted by the wolf holding the glowing gemstone against him again. This time, rather than holding it against the panther&#39;s chest... the wolf holds it right against his sheath.

Ivex lets out a long, loud moan. The effect is instantaneous. The wolf keeps rubbing the glowing, warm gemstone right against the panther&#39;s bulging sheath and, radiating the spell, Ivex&#39;s cock instantly suffers the waves upon waves of forced arousal.

Too bad it cannot grow at all.

Held by the wolf, the panther becomes a mewling, begging mess as the magical arousal assaults him. It does not take long at all for him to go back to that stage where he is obviously at the very edge of cumming, but unable to get past it. It looks like a mighty frustrating experience.

The wolf takes his sweet time lightly rubbing the glowing gemstone against Ivex&#39;s desperate sheath and trapped member, leaving him in that state for quite some time before he finally pulls it back again.

Hearing Ivex panting in desperate frustration like he made him pant in the past is music to the wolf&#39;s ears.
&lt;&lt;/if&gt;&gt;\
&lt;&lt;set $ivexEdges += 1&gt;&gt;\

&lt;&lt;if $revengeStage == 2 || $revengeStage == 1&gt;&gt;\
[[Continue|Hold]]
&lt;&lt;elseif $revengeStage == 3&gt;&gt;\
[[Continue|Fucking]]
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="202" name="Fuck" tags="" position="1800,6175" size="100,100">It&#39;s high time Ivex deals with the consequences of what he has caused.

The wolf&#39;s member throbs in excitement. $name keeps one paw firmly on Ivex&#39;s shoulder, holding him down on his back, but the other? The wolf&#39;s eyes lock with the panther&#39;s and he brings it down to his own cock. The wolf gives it a stroke, from top to bottom. The bright red, veiny spire has been aching for this for hours and hours. Ever since he was forced to breathe in that candle. This fire inside him has been burning for too long.

Slowly, the wolf gives himself a few strokes. His paw feels so damn good on the length of his member. From the tapered tip all the way to the engorged knot. When it reaches the base, the wolf envelops his knot with his paw and gasps over how good it feels to squeeze. Just a light squeeze is enough to fuel his arousal, to make him think of sex and little else. Sure, he would prefer a tight cunt over a skinny panther, but...

He looks down at Ivex, who in turn is staring at the wolf&#39;s cock as if guessing what&#39;s coming next.

This will feel immensely satisfying.

Bringing his paw back up, $name spits on it. Then, he looks down at the panther while coating his member with a layer of his saliva.

&lt;&lt;if !$gagged&gt;&gt;\
&quot;W-what are you going to do?!&quot; Ivex asks, his eyes going wide. He looks between the wolf and his cock apprehensively.
&lt;&lt;else&gt;&gt;\
&quot;H-hmmfgh hmmghff ghmff?!&quot; Ivex tries to ask, his eyes going wide. He looks between the wolf and his cock apprehensively.
&lt;&lt;/if&gt;&gt;\

&quot;You caused this. Now you gotta deal with it,&quot; the wolf merely says with a low growl. Then, with both hands, he takes hold of the panther&#39;s shoulders and turns him around.

&lt;&lt;if !$gagged&gt;&gt;\
&quot;What?! Wait! Wait! If you do this, you&#39;ll regret it! Don&#39;t you DARE!&quot; 
&lt;&lt;else&gt;&gt;\
&quot;Hmmfgh! Whmmfgh! Whmmfgh!! Yhmmfg hmmgh hhfmmgh HMMFGH!&quot; 
&lt;&lt;/if&gt;&gt;\

Ignoring the loud feline, $name takes pleasure in pressing Ivex down against the ground after forcing him to be on his belly. Then, grabbing the panther&#39;s tail, he forces him up on his knees while keeping his face still well-pressed against the floor with pressure on his upper back.

The mage squirms, but bound and pinned down as he is, there is little he can do. The sight of his raised rump is glorious. His pink, tight-looking entrance taunts the wolf and fans the flames burning within him. Pre-cum drips from his cock. No more wasting time.

Positioning himself above the smaller feline, the wolf continues to ignore Ivex&#39;s protesting and struggling beneath him as he lines himself up. The tip of his member brushes against the mage&#39;s entrance and, when it does, he tries to get away from it, but a good tug on his tail keeps his ass up in the air where it should be.

&quot;This is for everything you put me through,&quot; the wolf growls before shoving his hips forward.

&lt;&lt;if !$gagged&gt;&gt;\
&quot;AAH!&quot; Ivex pretty much yells. The initial penetration... feels absolutely great.
&lt;&lt;else&gt;&gt;\
&quot;HMMMFGH!&quot; Ivex pretty much yells. The initial penetration... feels absolutely great.
&lt;&lt;/if&gt;&gt;\

The tight walls of the smaller feline are forced to spread to give room to the wolf&#39;s considerable endowment. Feeling the warmth engulfing his needy cock is the best thing he could have asked for. $name moans out loud. There&#39;s no reason to be quiet. The wolf makes a point to groan and growl as he shoves his hips forward, sinking another inch of his cock into the feline.

Beneath him, Ivex mewls and complains, but the wolf merely presses him down harder against the ground and shoves another inch into him, silencing the panther by making him grunt. It does not take long for the wolf to shove the entirety of his cock into the mage, save for the knot. The drive to shove his knot in is there... and it is strong. The wolf resists it, though. There is plenty of time... and he wants to savor this for as long as possible.

In a rough movement, $name pulls back, pulling his cock out and making Ivex yelp, then he shoves himself back in, driving his entire length in there again. Giving the feline little time to adjust, the wolf takes his pleasure. He pistons in and out of the panther&#39;s ass, fucking him with gusto and taking immense pleasure in sating some of the burning lust within him.

Ivex is simply forced to take the wolf&#39;s pounding.
&lt;&lt;set $ivexEdges += 1&gt;&gt;\

[[Continue|Fucking]]</tw-passagedata><tw-passagedata pid="203" name="Fucking" tags="" position="1975,6175" size="100,100">&lt;&lt;if !$stage2Clear&gt;&gt;\
&lt;&lt;set $revengeStage = 3&gt;&gt;\
&quot;Fuck...&quot; the wolf groans. His lusty growling is constant as he continues to fuck the panther hard. In and out, the smaller feline&#39;s ass already taking his size with more ease, yet still feeling delightfully tight around his cock.

&lt;&lt;if !$gagged&gt;&gt;\
&quot;F-fuck! Slower-! Hnngh!&quot; Ivex mewls beneath him. The wolf does not slow down.
&lt;&lt;else&gt;&gt;\
&quot;Fhmmgh! Shhmmffwhr! Hnngh!&quot; Ivex mewls beneath him. The wolf ignores it.
&lt;&lt;/if&gt;&gt;\

$name speeds up. The larger wolf huffs through his nose, his arm that holds Ivex down moves to grab the feline, enveloping him by the chest and bringing him up to press him against the wolf&#39;s own, broader chest. Holding the panther tight, $name finds a better position to fuck, managing to go just a little deeper with each thrust.

Ivex himself groans and grunts without ceasing at that. The skinny panther is easily held against his body in that good fuckable position. The wolf starts thrusting harder. Faster. The pleasure is so great...!

&lt;&lt;print $name&gt;&gt;&#39;s knot grows larger. It begs to be shoved in and, in a couple of harder thrusts, the wolf actually tries, pressing the much larger bulb of flesh against Ivex&#39;s stretched ass, but it&#39;ll take more effort, and...

No! Not quite yet!

Out of nowhere, the wolf suddenly stops. He pauses with his cock deep within the panther. His chest heaves and he pants from the effort of fucking, but though his cock still throbs inside the panther, he continues to stay still.

$name is not catching his breath. No, he realizes he was too close. Too close to finishing inside that tight ass. He wants to do that. More than anything. Just... not so fast.

Ivex has not had all of his punishment just yet.

The panther pants as well beneath him. He seems glad to have a break, even though he groans, obviously stretched by the wolf&#39;s entire cock, save the knot, that remains firmly impaled within him.

Just out of curiosity, &lt;&lt;print $name&gt;&gt;&#39;s paw lets go of Ivex, letting the feline fall down face-first on the floor with a grunt while his ass remains raised and impaled. Ivex yelps at that, but the wolf does not care. No, instead, his paw trails down, moving to grab and feel Ivex&#39;s sheath.

It is very engorged. Just touching it leaves the wolf&#39;s fingers sticky with the feline&#39;s pre-cum. It seems that, liking it or not, the panther&#39;s body is enjoying being pounded.

&lt;&lt;if !$gagged&gt;&gt;\
&quot;I-It&#39;s not what you&#39;re thinking!&quot; Ivex manages to say, although he&#39;s clearly flustered.
&lt;&lt;else&gt;&gt;\
&quot;Hmgh! Hmmgh ffhmmgh...!&quot; Ivex tries to say, clearly flustered.
&lt;&lt;/if&gt;&gt;\

The wolf simply chuckles. Giving Ivex&#39;s sheath a squeeze just to hear him squirm, the wolf uses a finger to tease the panther&#39;s trapped member. He can feel how hard it tries to grow, but it can&#39;t. It won&#39;t be able to. That thought brings $name enough pleasure to make his cock throb inside the feline again.

This is what it feels like to be on top. Literally. And the panther brought this upon himself.

This and more.
&lt;&lt;set $stage2Clear = true&gt;&gt;\
&lt;&lt;else&gt;&gt;\
&lt;&lt;if $ivexEdges &lt;= 2&gt;&gt;\
The wolf roughly grabs the bound mage&#39;s caged sheath to feel it up.
The panther&#39;s arousal feels... &lt;span style=&quot;color:#e7d778&quot;&gt;gripping&lt;/span&gt;.
&lt;&lt;elseif $ivexEdges &gt; 2 &amp;&amp; $ivexEdges &lt;= 3&gt;&gt;\
The wolf roughly grabs the bound mage&#39;s caged sheath to feel it up.
The panther&#39;s arousal feels... &lt;span style=&quot;color:#bb5e39&quot;&gt;powerful&lt;/span&gt;.
&lt;&lt;elseif $ivexEdges &gt; 3 &amp;&amp; $ivexEdges &lt;= 5&gt;&gt;\
The wolf roughly grabs the bound mage&#39;s caged sheath to feel it up.
The panther&#39;s arousal feels... &lt;span style=&quot;color:#bf5150&quot;&gt;overpowering&lt;/span&gt;.
&lt;&lt;elseif $ivexEdges &gt; 5&gt;&gt;\
The wolf roughly grabs the bound mage&#39;s caged sheath to feel it up.
The panther&#39;s arousal feels... &lt;span style=&quot;color:#e92940&quot;&gt;overwhelming&lt;/span&gt;.
&lt;&lt;else&gt;&gt;\
&lt;&lt;/if&gt;&gt;\

Keeping Ivex&#39;s face against the ground and his ass raised, the wolf thrusts forward ever so slightly to keep his cock firmly stuck inside the mage. It still throbs, eager for the fucking to continue, but at the same time, feeling Ivex&#39;s ass clenching around his member as he is... &#39;tortured&#39; is also damn nice.

Holding himself like that, the wolf wonders, what to do to him next?
&lt;&lt;/if&gt;&gt;\

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
      &lt;li&gt;[[Use one of his spells on him.|Spell]]&lt;/li&gt;
      &lt;li&gt;[[Stimulate and tease him by hand.|Edge]]&lt;/li&gt;
    &lt;li&gt;[[Knot him.|Knot]]&lt;/li&gt;
    &lt;&lt;if !$gagged&gt;&gt;\
      &lt;li&gt;[[Gag him.|Gag]]&lt;/li&gt;
    &lt;&lt;/if&gt;&gt;\
  &lt;/ul&gt;\
&lt;/div&gt;</tw-passagedata><tw-passagedata pid="204" name="Knot" tags="" position="2150,6175" size="100,100">No holding back. The wolf&#39;s lust is too strong and his instincts start speaking louder. There has been enough messing with the panther. It&#39;s time to finish it.

Ivex just yelps and mewls when the wolf pulls him up and grips him hard against his chest again. The smaller feline squirms, certainly knowing what&#39;s coming, but the wolf stops it with nothing but one threatening growl.

It&#39;s the ideal position. $name pulls his cock back from the panther&#39;s ass... then shoves it back in with a strong, powerful thrust that is enough to make him moan and Ivex grunt beneath him.

And then it begins.

No more holding back, no more keeping his lust in check. The burning fire within him calls for him to fuck, and fuck he will. The wolf growls louder as he speeds up, thrusting in and out of the panther&#39;s ass, letting the tightness of the panther&#39;s rear bring him back to the apex of his pleasure, to the point where he&#39;s close to cumming again. Pistoning in and out of the panther, all he can hear are Ivex&#39;s gasps as he spreads the feline open again and again with his large member. The wolf huffs. His own pleasure grows and grows until he can feel it.

The apex. That incoming climax... and with it, that burning need every wolf has to shove his knot into his bitch and claim it entirely.

With a stronger, brutish thrust, $name slams into the panther&#39;s rear, pressing his knot against his entrance and trying to shove it in. It doesn&#39;t go. He pulls back and shoves it in again. Like a battering ram, the wolf&#39;s knot forces itself against the wizard&#39;s rear, again and again, demanding entrance.

&lt;&lt;if !$gagged&gt;&gt;\
&quot;It- it won&#39;t FIT!&quot; Ivex yells, squirming and groaning without stop.
&lt;&lt;else&gt;&gt;\
&quot;Ihmm wwhmmf FFHMFFH!!&quot; Ivex tries to yell through his gag, squirming and groaning without stop.
&lt;&lt;/if&gt;&gt;\

The wolf ignores it. He has fit his knot into many things in the past and he will fit it in again.

With brutish shove after brutish shove, the wolf&#39;s growling grows. His instincts demand something around his knot and he &lt;b&gt;will&lt;/b&gt; have it!

Putting more strength into his hips, $name pushes in one last time and, this time, he doesn&#39;t retreat, but rather forces forward, and then finally...

[[Continue|Knotted Mage]]</tw-passagedata><tw-passagedata pid="205" name="Knotted Mage" tags="" position="2275,6175" size="100,100">&lt;&lt;if !$gagged&gt;&gt;\
&quot;AAAH!!&quot; Ivex yells.
&lt;&lt;else&gt;&gt;\
&quot;HMMMFGH!!&quot; Ivex yells.
&lt;&lt;/if&gt;&gt;\

It pops in.

$name lets out a loud moan of pure pleasure. His large knot forces its way past the feline&#39;s resistance and, after spreading him wider, settles itself inside, locking the wolf to his bitch as it should.

The pressure around his knot, the most sensitive spot of any wolf, is heavenly to him. It brings his pleasure to its highest point. All that fire, everything Ivex has inflicted upon him since the beginning culminates, gathering into a pleasure unlike any he has ever felt and translating to his cock.

It throbs, it pulses... and it shoots.
&lt;&lt;if $ivexEdges &gt; 5&gt;&gt;\

At the exact same time, Ivex moans below him. It seems to be too much for him. After all that time being edged, all the teasing, all the lust he was made to feel...

The wolf can feel how the panther&#39;s ass clenches hard around his cock. It feels amazing. $name has fucked men before and he knows that feeling. It is the feeling... of an orgasming male.

The wolf trails down with his paw to feel it. All the edging coupled with the wolf&#39;s knot shoved in and the way he keeps thrusting push Ivex past the point of no return as well... despite his condition.

Even through the chastity spell, even with his cock painfully trapped within his sheath, the wolf can feel the dribbling of seed from Ivex&#39;s forceful orgasm. The panther groans and grunts, the sounds he makes sounding more like ones of frustration than ones of pleasure. It must feel quite terrible to be forced to finish like that, without being able to grow hard and without stimulation, yet he does. With the wolf fucking him as hard as he does and after all that edging... he does.

The panther&#39;s climax dribbles down to the floor. The wolf&#39;s pleasure is only enhanced by that knowledge as he continues to fuck and enjoy his own pleasure.
&lt;&lt;set $ivexClimax = true&gt;&gt;\
&lt;&lt;/if&gt;&gt;\

Holding the mage tight to himself, the wolf feels the heavenly sensation of his climax overcoming him. His body is overwhelmed with pleasure and underneath him...

Ivex groans in distaste as he is filled with wolf seed.

The wolf feels absolute delight in feeling each throb of his cock depositing his spunk inside the hateful mage. His knot grows larger, achieving full size and locking his seed inside and them together.

$name doesn&#39;t care. Midway through his orgasm, he lets Ivex go. Again, the mage yelps as he hits the ground with his face, but his ass remains stuck to the wolf&#39;s crotch being filled to the brim with all of the wolf&#39;s seed, bolstered by his own arousal spells.

When it ends, the wolf&#39;s entire body feels lighter. A feeling of relief washes over him accompanied by a deep satisfaction. Seeing the mage panting and grunting beneath him, struggling to cope with his size inside him and flustered in humiliation after what all he has done is immensely satisfying.

This is it. $name has won, and Ivex is thoroughly defeated.

As he descends upon the aftermath of his blissful orgasm, the wolf still pants. Ivex stays down on the floor panting as well after the intense experience. He seems too tired to even complain or throw insults at the moment.

It will take some time for the wolf&#39;s knot to come down, but $name is not in a hurry.

[[Continue|Pull Out Finish]]</tw-passagedata><tw-passagedata pid="206" name="Pull Out Finish" tags="" position="2400,6175" size="100,100">The wolf spends his time locked with the feline to play with him some more. Watching him squirm and whine turns out to be extremely therapeutic. To &lt;&lt;print $name&gt;&gt;, it&#39;s almost as if all the humiliation he went through in the tower didn&#39;t happen. Almost.
&lt;&lt;if $ivexClimax&gt;&gt;\

Even though Ivex has managed to cum through his own chastity spell, it must have been quite unsatisfactory, because as soon as the wolf&#39;s fingers touch his sheath and tease it, the panther turns into a mewling puddle of frustration and despair again. His cock seems as eager to grow hard as always, and it doesn&#39;t take long to take him back to the edge of orgasm.

Playing around with the panther&#39;s sheath using his paw and a few of Ivex&#39;s spells is as fun as it was before.
&lt;&lt;/if&gt;&gt;\

His knot takes a long time to shrink. In fact, it barely does so, and that is also Ivex&#39;s fault for putting him through some crazy candle-based lust spell. After a while, the wolf is forced to just hold Ivex down by placing a paw on his back and pulling hard. The feline doesn&#39;t like that very much, but he doesn&#39;t get a say in it. With enough effort, the wolf&#39;s large knot finally pops out. The sight of his white seed dribbling down the back of the panther&#39;s balls also soothes the wolf&#39;s soul.
&lt;&lt;if !$gagged&gt;&gt;\

&quot;You will... pay!&quot; Ivex still has the energy to mutter. &quot;I will make you suffer. I will create a spell to have a candle burning under your nose permanently, then I&#39;m going to cast thirty different chastity spells on your sheath and watch as you writhe in desp- HNGH!&quot;

Ivex is interrupted by the fact that the wolf finally shoves something inside his maw to silence him. He has babbled for long enough. $name does nothing but smirk watching Ivex tear up and mumble a new series of muffled complaints about having $lastGag shoved into his maw. The wolf uses his footpaw to make sure it is secured and pressed in quite deeply, then basks in sweet silence.
&lt;&lt;/if&gt;&gt;\

Wiping his hands, the wolf looks down at Ivex. Bound, gagged and without his gemstones, the once-powerful mage is nothing but a harmless kitty. It&#39;s time to fulfill the job the wolf came here to do and cash in the bounty for this dangerous mage.

$name steps towards him to pick him up. Ivex still squirms and complains, obviously still angry over having lost. He no longer gets a choice, though.

The wolf does. He wonders if Ivex has had enough punishment or if he should add a finishing touch to his reckoning. After all, it will be a few days&#39; journey back to the Wayward Adventurers Guild. Maybe adding something to... &lt;b&gt;entertain&lt;/b&gt; Ivex in the meantime would be fun as well.
&lt;&lt;if !$personalEnding&gt;&gt;\
&lt;&lt;set $personalEndingUnlock = true&gt;&gt;\
&lt;&lt;/if&gt;&gt;\

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
      &lt;li&gt;[[Add a punishing touch for the journey.|Pull Out Punishment Finish]]&lt;/li&gt;
      &lt;li&gt;[[Take him back as he is and collect the bounty.|Bounty Collection]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;</tw-passagedata><tw-passagedata pid="207" name="Enthrallment Finish" tags="" position="2600,5500" size="100,100">&lt;&lt;if !$enthralmentIvexEnding&gt;&gt;\
&lt;&lt;set $enthralmentIvexEndingUnlock = true&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;include &quot;Enthrallment Finish (Text)&quot;&gt;&gt;

&lt;span class=&quot;good-ending&quot;&gt;Ending: &lt;i&gt;Ivex&#39;s Enthrallment&lt;/i&gt;&lt;/span&gt;

[[The End|The End]]</tw-passagedata><tw-passagedata pid="208" name="Extraction Finish" tags="" position="2400,5750" size="100,100">&lt;&lt;if !$extractionIvexEnding&gt;&gt;\
&lt;&lt;set $extractionIvexEndingUnlock = true&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;include &quot;Extraction Finish (Text)&quot;&gt;&gt;

&lt;span class=&quot;good-ending&quot;&gt;Ending: &lt;i&gt;Ivex&#39;s Extraction&lt;/i&gt;&lt;/span&gt;

[[The End|The End]]</tw-passagedata><tw-passagedata pid="209" name="Turn In" tags="" position="1450,5450" size="100,100">Before Ivex can wake up, $name approaches him. He grunts looking down at the mage, but picks him up and places the unconscious, bound mage over his shoulder to get ready to take him back.

Looking down, however, the wolf sees his member still aching. Surely Ivex&#39;s candle effect must wear off at some point, but it&#39;s still uncomfortable. Even the large wolf can&#39;t help but blush remembering his time bound on that cross. The way Ivex taunted and touched him, the threats the feline made...

Not to mention the rest of his time trudging naked through his tower with a permanent hard-on. The wolf has captured many bounties before, some of them mages, but none of them had taken so much effort and humiliation to defeat.

Glancing at the mage, he wonders. If he wants to give Ivex some reckoning for all he has done to him and to others, it has to be now. Once he&#39;s in the hands of the Wayward Adventurers Guild officers, then another kind of justice will be served to him.

$name takes a deep breath. Should he really just take Ivex to be arrested and nothing more?

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\
      &lt;li&gt;[[Yes. Turn Ivex in and be done with it.|SFW Finish]]&lt;/li&gt;  
      &lt;li&gt;[[No... he deserves some punishment. Punish Ivex for his misdeeds.|Punishments]]&lt;/li&gt;
  &lt;/ul&gt;\
&lt;/div&gt;</tw-passagedata><tw-passagedata pid="210" name="Pull Out Punishment Finish" tags="" position="2525,6175" size="100,100">$name decides that, since Ivex&#39;s arrogance seems to know no bounds, he can deal with a little extra punishment during the trip back.

With a smirk, the wolf looks down at Ivex, who in turn glares daggers up at him, but is unable to say anything gagged as he is. Not breaking eye contact, the wolf shoves his paw into the gem pouch again and... pulls out the pink, lust spell gemstone.

&quot;HMMGH! Hmmghf hmmf!&quot; Ivex immediately tries to say, shaking his head.

$name ignores him. It takes little effort for the wolf to find an adequate piece of string and, with it and the gemstone in hand, he kneels next to the squirming feline. The wolf holds Ivex down on his back, forcing his legs to spread so he can work.

Ivex fights him at first, but the wolf&#39;s large paw grabs hold of his furry balls and gives them a squeeze. It&#39;s enough to make the panther groan in pain through the gag and daze him for long enough to let the wolf work.

Clutching the gemstone in hand, the wolf activates it. He presses the warm gemstone against Ivex&#39;s balls and, with the piece of string... ties the gemstone there, wrapping the string around the base of the feline&#39;s nuts and keeping the warm, lust-inducing gemstone tied against the panther&#39;s balls.

It&#39;s not until he starts feeling its effects again that Ivex moans and looks down. Realizing what was done, the panther shakes his head and yells a hundred different muffled complaints about it, but the wolf simply stands up and smirks.

The panther moans through his gag as the spell works on him continuously. His cock is quick to press hard against the invisible barrier surrounding his sheath and, soon enough, it is leaking all over again. That is how it is staying, though.

Leaving Ivex squirming on the floor, the wolf then prepares to grab his stuff to leave. It will be a long journey for the mage. When $name looks down, his own cock is still pulsing and dribbling as well. He does not know for how long Ivex&#39;s spell will keep affecting him, but, if it gets too bad...

$name just smiles. He has something he can fuck on the way if he needs to.

[[Continue|Bounty Collection]]</tw-passagedata><tw-passagedata pid="211" name="Bounty Collection" tags="" position="2950,5650" size="100,100">Lucky for the wolf, he manages to find a worn, old pair of pants in the farmhouse Ivex had made his base. They are far too short for him, but they will do, so that at least he&#39;s not naked.

Gathering what supplies he can, the wolf sets off with everything in hand: Ivex&#39;s tower inside the large gemstone, the pouch of magic gems and, most importantly, Ivex.

The journey back to the Wayward Adventurers Guild takes a few days. It could go quicker, but after the deeply distressing effort to capture the mage, $name is not exactly in a hurry to get there anymore. The wolf takes his sweet time recovering from everything he went through inside the mage&#39;s crazy tower, and basking in his success.

When he gets to the Guild, both the adventurers and officers there are deeply amused by the way $name delivers Ivex to them. After a thorough re-telling of what he went through and what he has in tow, the official mages in the Wayward Adventures Guild take Ivex to a prison where his magic will be kept in check.

They also handle his tower. The wolf does not stick around to see it, but the rumors of the insane tower a mage possessed spread like wildfire. Apparently, the mages of the Guild had to go through an arduous, delicate process to save the over fifty people Ivex had trapped inside his tower. All of them males.

With a handsome amount of gold in his pocket, the wolf moves on. The life of an adventurer is like that. Ivex wasn&#39;t the first mage he had to fight and it won&#39;t be the last. The events of the tower stick inside &lt;&lt;print $name&gt;&gt;&#39;s mind, though, and they are enough to make him blush every now and then. He will make sure that such things never happen again.

Or, at least, he will try to.

[[The End|The End]]</tw-passagedata><tw-passagedata pid="212" name="The End" tags="end" position="2775,5050" size="100,100">The End.
&lt;&lt;if $personalEndingUnlock&gt;&gt;\
&lt;&lt;set MT.mdSet(&quot;personalEnding&quot;, true)&gt;&gt;\
&lt;&lt;set $personalEndingUnlock = false&gt;&gt;\

The &lt;span class=&quot;imp-info&quot;&gt;Ending: Punishment&lt;/span&gt; is unlocked in the Archive!
&lt;&lt;/if&gt;&gt;\
&lt;&lt;if $enthralmentIvexEndingUnlock&gt;&gt;\
&lt;&lt;set MT.mdSet(&quot;enthralmentIvexEnding&quot;, true)&gt;&gt;\
&lt;&lt;set $enthralmentIvexEndingUnlock = false&gt;&gt;\

The &lt;span class=&quot;imp-info&quot;&gt;Ending: A New Servant&lt;/span&gt; is unlocked in the Archive!
&lt;&lt;/if&gt;&gt;\
&lt;&lt;if $extractionIvexEndingUnlock&gt;&gt;\
&lt;&lt;set MT.mdSet(&quot;extractionIvexEnding&quot;, true)&gt;&gt;\
&lt;&lt;set $extractionIvexEndingUnlock = false&gt;&gt;\

The &lt;span class=&quot;imp-info&quot;&gt;Ending: Energy Supply&lt;/span&gt; is unlocked in the Archive!
&lt;&lt;/if&gt;&gt;\

This is it. You&#39;ve escaped the Mage&#39;s Tower and (maybe) given the mage some rightful reckoning for all he&#39;s done! Good job!

If you haven&#39;t yet, do check out the [[Archives]], where you can read the endings you have unlocked so far and see hints on how to find different ones. Try to see them all and their variations! A lot of things can change based on your choices up until the end.

There&#39;s more to see as well, though! As an author, I&#39;ve written literally hundreds of short stories including all sorts of themes. If you enjoyed what you read here but haven&#39;t checked out my other stuff yet, there&#39;s a good chance you&#39;ll like them! You can read them on my [[FurAffinity page|https://www.furaffinity.net/user/sleth/]], [[SoFurry page|https://sleth.sofurry.com/]], or get links to them and a handy search tool in my [[website|http://www.slethstories.com/]].

If you&#39;ve enjoyed this kinky experiment of an interactive story, I also urge you to check out my &lt;span&gt;&lt;img src=&quot;images/pa_logo.png&quot; height=&quot;20&quot;&gt;[[Patreon|https://www.patreon.com/sleth]]&lt;/span&gt; as well , where I&#39;m working on a bigger scale, more story-based game called [[Demons Within|https://sleths.itch.io/demons-within]]. Rather than an interactive story, I also got an artist to work with me in it, so it&#39;s more of a visual novel with a focus on the &#39;novel&#39; part of it. Even though this new project has a larger focus on story rather than kink, be assured that there are plenty of spicy scenes as well! That&#39;s not all, though. Through Patreon, my amazing supporters have kept my passion for writing this sort of thing burning bright. By joining it, you&#39;re supporting and getting first dibs on stories and games like this one!

In fact... did you know that this interactive story as a whole was shaped up by my patrons themselves ? Yep. Through a series of polls, they chose a highly magical setting for the story, as well as kink focus in bondage, CBT, mind control and chastity from a list of possible kinks. It is based on those results that I molded this story into what it became today!

Before you continue on, I also urge you to give a quick look at the [[Credits]] !

From here on, you can...

&lt;div class=&quot;action-box&quot;&gt;\
  &lt;ul class=&quot;actions&quot;&gt;\  
      &lt;li&gt;[[Return to the point of escaping the tower.|Outside]]&lt;/li&gt;
      &lt;li&gt;[[Return to the point of escaping the first floor.|Escape Start]]&lt;/li&gt;	
      &lt;li&gt;&lt;&lt;link &quot;Return to the beginning of the game&quot;&gt;&gt;
        &lt;&lt;run Engine.restart()&gt;&gt;
      &lt;&lt;/link&gt;&gt;&lt;/li&gt;  &lt;/ul&gt;\
&lt;/div&gt;</tw-passagedata><tw-passagedata pid="213" name="Enthrallment Vengeance (Text)" tags="text" position="1600,5475" size="100,100">Deciding on his vengeance, the wolf smirks. While the panther is still unconscious on the floor, the wolf turns towards the tower inside the gemstone, picks the red teleportation stone up and clutches it again.

$name finds the transportation easier this time. Perhaps because he was ready for it? Regardless, the wolf turns up at the exact same spot he left. From there, it is a simple matter to return to the lion&#39;s room where the large feline still squirms on the ground.

&quot;The master&#39;s pendant must be worn by his thralls at all times,&quot; the lion says to him when he enters, as always.

The wolf just rolls his eyes. &quot;Yeah, the master&#39;s pendant will be put to good use,&quot; $name replies as he picks up the blue glowing pendant the lion had made for him. The feline does little more than follow him with his eyes and repeat his line when the wolf turns away to leave.

&quot;I&#39;ll come back and deal with you once I&#39;ve dealt with the mage,&quot; the wolf promises as he clutches his gemstone again and teleports outside once more.

Once out, $name can see that Ivex woke up in the meantime. The moment $name appears, the panther looks at him with that same look of surprise and fear. He had already clearly been wiggling to try and get out of the ropework the wolf had left him in, but he redoubles his efforts to do so as $name approaches.

&quot;Get away from me!&quot; Ivex hisses. Surprisingly, some of the arrogance still lingers in his tone. It only makes what the wolf is planning to do feel even better.

Without even saying anything, $name gets close to the panther, crouches down... and brings up the blue pendant.

Recognition flares up in Ivex&#39;s eyes right away. 

&quot;What?! How did you get that?! No! NO!&quot; He shakes his head and tries to wiggle and crawl away from the wolf as soon as he sees it.

&quot;Yes,&quot; the wolf says, easily grabbing the panther, pulling his bound self close and bringing the pendant up to him...

&quot;NO! Get that thing away from me! You don&#39;t know what you&#39;re doing!&quot; Ivex almost pleads.

The wolf doesn&#39;t stop.</tw-passagedata><tw-passagedata pid="214" name="Ivex Enthrallment 1 (Text)" tags="text" position="1725,5475" size="100,100">&quot;YOU FOOL!&quot; Ivex yells as the pendant is brought up to his head. &quot;When I get out of this, I will make you regret all of this a thousand times ov-&quot;

$name lowers the pendant, placing it around his neck. The gemstone emits a glow for a moment and, as soon as it does, Ivex&#39;s eyes grow wide for just a moment and his words get interrupted. Then, soon after, his expression of outrage and anger fades into a neutral one. The same one the lion holds all the time.

All signs of struggling fade and the panther relaxes in his bonds. Then, Ivex&#39;s eyes lazily shift towards the wolf, but he says nothing.

&quot;Ivex?&quot; $name asks, and only when he does, the cat speaks.

&quot;Are you master?&quot; he asks.

Taken aback by the question, the wolf thinks for a moment, but nods.

&quot;Yes?&quot;

&quot;You are master,&quot; Ivex simply states in a monotone voice that carries little emotion behind it. Then, the feline stands still. &quot;The master desires herbs ground for the attunement potions,&quot; he says.

&quot;Herbs?&quot; the wolf asks. He thinks back to the lion. That explains his behavior... &quot;No, no potions are necessary,&quot; the wolf then states.

&quot;No potions are necessary,&quot; the feline repeats, and then he remains still.

The wolf stands up and looks down at him curiously. Does this thing really work? Just as he did with the lion, he attempts to remove the pendant from Ivex&#39;s neck, but it does not go past his neckline, as if some kind of invisible barrier prevents it from doing so, making it unremovable by conventional means. Surely more of Ivex&#39;s magic to keep his thralls secure. How ironic that it now works against him.

Watching the bound feline standing still and without expression, the wolf smirks. A series of ideas go through his head and, underneath him... his cock throbs. The arousal Ivex has inflicted on him has been bothering him ever since he escaped that damned cross.

Maybe it&#39;s time to do something about that, too.</tw-passagedata><tw-passagedata pid="215" name="Ivex Enthrallment 2 (Text)" tags="text" position="1850,5475" size="100,100">Deciding to test things out before pushing anything further, the wolf grabs Ivex by his scruff and pulls him up to his knees. The panther stands firm on them, but says nothing and does not change his expression. He does seem to be completely at the wolf&#39;s mercy.

Placing the bound captive properly in front of him, the wolf keeps one hand on his head holding his fur, but with the other... he points his hard, red member down towards Ivex.

&quot;Let&#39;s test this out by asking you to do something you would never do,&quot; the wolf continues with a smirk. Then, he takes half a step forward so that the tip of his member is almost touching Ivex&#39;s nose.

&quot;Lick my cock.&quot;

The panther does not look at him or show any kind of emotion, again just like the lion, but he also does not hesitate for a second before leaning forward, taking his tongue out and lapping at the wolf&#39;s cock. The wolf winces. The panther&#39;s tongue is kind of rough, but the texture still feels great against his member. All of the burning arousal lingering inside the wolf gets lit up as his cock is stimulated. 

The red, tapered member throbs in response to Ivex&#39;s continuous licking. The panther does a thorough job, covering the wolf&#39;s member in saliva. At first, $name is wary, keeping a tight grip on Ivex&#39;s fur, ready to pull him off of him at the first sign of aggression, but after a few minutes of constant licking, it is clear that the spell works. The wolf&#39;s grip loosens and, as it does, the panther leans forward to increase his reach. His tongue caresses the whole of the wolf&#39;s member, coating it all the way to the knot. Feeling that rough tongue right against his sensitive knot has $name gritting his teeth as a bead of pre-cum appears at the tip of his member. His arousal flares higher and higher and, seeing Ivex in that position...

There is little to do but take advantage of it.</tw-passagedata><tw-passagedata pid="216" name="Ivex Enthrallment 3 (Text)" tags="text" position="1975,5475" size="100,100">&quot;Stop,&quot; the wolf orders, and the panther ceases his licking right away.

With a pleased smile, the wolf grips his cock at the base again and, taking another step forward, presses his member coated with saliva against Ivex&#39;s muzzle. The feline does not react as the wolf grinds and wipes his member against his face, smearing it with both drool and pre-cum.

The spell absolutely works.

&quot;I&#39;m going to untie you,&quot; the wolf announces, &quot;when I do, you will stand up and stand still.&quot;

The panther does not respond. $name waits for a moment, still wary, but then he walks around the feline and starts undoing the ropes around his wrists and ankles. As soon as he does, the panther does indeed stand up and stands still.

Pleased with himself, the wolf looks at him from top to bottom. Ivex is definitely not the impressive figure he made himself to be inside the tower, but he is still a fairly good-looking feline. The wolf&#39;s paw goes down to his cock, idly stroking it. Damn, it feels good to indulge in the lust Ivex induced onto him. With a low growl, the lupine issues a single order.

&quot;Take your clothes off.&quot;

Without an ounce of hesitation, the panther starts pulling his shirt off. Once they&#39;re gone, his shirt and loose pants beneath it come out next and, within moments, all of his clothes are discarded on the floor, and the black panther stands there fully bare. His sheath still has hints of that yellow, transparent barrier covering it.

$name smirks. The wolf&#39;s hand on his own cock starts stroking it properly. The wolf can&#39;t help but let out a continuous lusty growl. The sight of the naked feline, even being a male and someone he hates, fuels the fire of arousal inside him. 

&quot;Is there a bed in this farmhouse?&quot; the wolf asks the naked mage.

&quot;Yes,&quot; Ivex simply responds.

The wolf&#39;s smile widens. He does not stop stroking his cock as he walks toward the door. &quot;Then follow me.&quot;</tw-passagedata><tw-passagedata pid="217" name="Ivex Enthrallment 4 (Text)" tags="text" position="2100,5475" size="100,100">It doesn&#39;t take long for $name to find the bedroom. It looks neat, but a layer of dust on most furniture indicates it likely hasn&#39;t been used in a while. Ivex probably sleeps inside his magical tower of nonsense. The wolf points at it, though.

&quot;Get on the bed, panther. On all fours.&quot;

As always, Ivex is quick to obey. With the same blank expression, the panther climbs on the bed and gets up on all fours. $name licks his lips at the sight.

&quot;Lift your tail.&quot;

The feline does. His long tail arcs up, revealing what&#39;s underneath. The sight of the pink entrance under the mage&#39;s tail is enough to make the wolf&#39;s length throb. He usually prefers females, but in this case...

$name takes his time. His hand strokes his cock from top to bottom, giving his knot a small squeeze before he climbs onto the bed. It creaks under the muscular wolf&#39;s weight, but he ignores it as he approaches the smaller feline. The larger wolf gets on all fours behind and above him, his chest coming over Ivex&#39;s back, and with an arm, he pulls the obedient feline towards his own chest. At the same time, the wolf takes immense pleasure in letting his hard cock grind against the feline&#39;s rear.

&quot;Are you still in there, I wonder?&quot; the wolf growls in low voice against Ivex&#39;s ears. &quot;I hope you are. If you are, it must be killing you to be made to do this...&quot;

The thought brings pleasure to the wolf. &quot;It&#39;s nothing you haven&#39;t done to others before, I bet. How does it feel? To know that, soon enough, I&#39;ll be fucking you all the way to the knot?&quot;

Ivex&#39;s expression, unfortunately, does not change. If he can hear him, the panther gives no sign of it, but the wolf chooses to believe he can. Letting the mage go, $name grabs the panther&#39;s hips and positions himself behind him. Getting on his knees, the larger wolf grinds his cock against the feline&#39;s rear. His lust gets the best of him. That candle burning had made the wolf think about sinking his cock into something warm a thousand times, and the fact that it is Ivex himself makes it all the more delicious.

Spitting on his paw, the wolf then smears it around his cock, lubricating it a little bit to make it easier, but as he lines himself up with the feline, a new thought occurs to him.

Why should he do all the work?</tw-passagedata><tw-passagedata pid="218" name="Ivex Enthrallment 5 (Text)" tags="text" position="2225,5475" size="100,100">Pushing the feline to the side, $name himself lies on the bed on his back. The panther looks at him with no emotion, remaining on all fours at the corner of the bed as the wolf spreads his legs and brings his hand down to give his knot a small squeeze. Then, he looks at the panther and smiles.

&quot;Climb up and line your rear with my cock,&quot; he orders.

The enthralled Ivex obeys right away. The slender panther straddles the large wolf&#39;s abdomen at first, then he moves to stand up on the bed enough so that his rear can be right above the tapered tip of the wolf&#39;s sizeable cock. As soon as Ivex feels the tip right against his entrance, he stops, his expression still neutral, waiting.

The wolf takes in that sight with a wide smile for a while. His cock throbs in anticipation before he gives the order.

&quot;Impale yourself on my cock, mage.&quot;

Even in this case, the panther shows no hesitation. The moment the order is given, Ivex starts lowering himself. To the wolf, it feels heavenly. The panther&#39;s tight ring offers some resistance at first, but through Ivex&#39;s own effort, the resistance is breached, and soon the tightness of the panther&#39;s ass surrounds his cock as the panther keeps going down little by little.

Though Ivex&#39;s expression barely changes, he does grunt. It seems to be an intense experience for him and, judging from how &lt;b&gt;tight&lt;/b&gt; Ivex feels, the wolf guesses that he is not quite used to taking it up the ass.

It makes it all the better.

&quot;Fuck...&quot; $name grunts. &quot;Don&#39;t fucking stop. Don&#39;t stop until you reach the knot,&quot; he orders, and Ivex obeys.

Inch by inch, the feline takes his cock, and the wolf gets a front-row seat watching his ass spread for him. It takes a while and some effort, but eventually, the feline&#39;s rear finally bumps against the wolf&#39;s larger, engorged knot. $name growls. An eagerness to shove his knot into the feline, his most primal instinct, comes over him, but the wolf is patient. The time for that will come. For now, while Ivex sits there impaled on his cock...

&quot;Now... ride it. Fuck yourself with my cock.&quot;</tw-passagedata><tw-passagedata pid="219" name="Ivex Enthrallment Final (Text)" tags="text" position="2350,5475" size="100,100">The sensations of the panther going back up on his cock are amazing for the lust-filled wolf. $name lets himself moan in pleasure as the panther moves up... and then comes down again, impaling himself on his cock all over again. Ivex&#39;s expression does not change, but the little grunts of effort coming from him are like music to the wolf&#39;s ear. The blue gemstone on the feline&#39;s pendant continues glowing as the enthralled mage is forced to obey his every command.

&quot;Faster... fuck...&quot; $name growls, and the panther obeys.

The wolf&#39;s larger paws come to grip the feline&#39;s hips. He does not need to make any effort, but it still feels good to grip them as he feels the panther&#39;s ass enveloping his cock. The stimulation is downright amazing. The wolf&#39;s hips jut up every now and then in pure instinct, thrusting into Ivex every time he comes down in order to make the act even more intense for both of them.

Looking down at the panther riding him, another thought comes to the wolf&#39;s lust-filled mind. He can see Ivex&#39;s sheath engorged. His cock reacts to what&#39;s happening to him, but because of the chastity spell, it remains trapped inside the black feline&#39;s sheath. The tip of his member presses against the invisible wall, aching to get out, and $name notices droplets of pre-cum running down the panther&#39;s sheath. Still, the spell does not let him grow hard, and seeing that...

&quot;Jerk yourself off while you ride me,&quot; he orders. As soon as he does, the panther&#39;s hand goes down to his sheath. It starts teasing it, stroking it, and massaging it as best as his spell allows. The panther&#39;s moans and mewls grow a little, betraying the pleasure his body must be feeling from both his hand and the wolf&#39;s large cock filling him, but his cock has no space to grow. The sight amuses the wolf. It feels fitting that, after using others for his pleasure for so long, Ivex does not get to enjoy himself even when being used himself.

He leaves the panther jerking himself off, or trying to, and focuses on his own pleasure again. The wolf&#39;s growling increases in tone as he feels his pleasure rising. With his arousal as high as he was, he knows he won&#39;t last too long, but he has no desire to anyway. Thrusting in tandem with Ivex as he rides him, the wolf orders him to go faster quite a few times and, even when the panther is bouncing on his cock as fast as he can, he keeps growling for him to go faster still.

&lt;&lt;print $name&gt;&gt;&#39;s pleasure gets close to his peak, he can feel it, but there is one thing missing.

&quot;Fuck... hnnghf... now, impale yourself on my fucking knot. Take my knot, you fucking bastard of a mage,&quot; the wolf curses. It is incredibly blissful to feel Ivex being forced to obey. The next time the feline goes down on his cock, he keeps pressing down, impaling himself further and trying to push past his own resistance to take the wolf&#39;s knot.

The wolf pushes against it as well. His eagerness and drive to knot are too strong. With both of their efforts, it does not take too long before $name can feel the panther&#39;s ass spreading wider than before. Even in his enthralled state, Ivex lets out a grunt and a mewl as the wolf&#39;s much larger knot pops into him, but once it is in?

&quot;FUCK! Take it!&quot; $name pretty much howls. Holding Ivex&#39;s hips in place, it is he that does the work. The large wolf&#39;s hips jut up, fucking the feline deep with his knot stuck in there as he feels his pleasure reach his peak, and in one blissful moment...

With a strong throb, the first jet of wolf seed is deposited deep within the mage. Ivex&#39;s expression remains the same even as his ass is filled with wolf spunk. $name keeps thrusting, reveling in his pleasure and enjoying every second of it. Much to his delight, Ivex continues to obey his orders as well, &#39;riding&#39; him to the best of his ability even as his ass is filled. Stuck to the wolf&#39;s knot, the panther can&#39;t get up from it even if he tries, and as soon as the wolf&#39;s orgasm starts to dwindle, he has to growl to the panther and order him to stand still as he lets himself fall back panting to enjoy his afterglow.

Only the sound of Ivex&#39;s small grunts can be heard as the panther keeps jerking himself off, stimulating his sheath and looking for a pleasure he will not achieve with the chastity spell upon him.

The wolf is happy and content in laying down like that for a while, with the mage that fucked him over stuck to his cock and forced to pleasure himself in the most frustrating of ways.</tw-passagedata><tw-passagedata pid="220" name="Ivex Enthrallment End (Text)" tags="text" position="2475,5475" size="100,100">$name takes his sweet time. He is definitely not in a hurry anymore. The wolf enjoys the feeling of the panther&#39;s ass around his cock, the way it grips his grown knot, and the way it clenches while Ivex continues to try and try to jerk off to no avail.

While waiting for his knot to recede, he looks at the feline. Ivex stares at nothing in particular while his hand continues to tease and work his sheath. His cock, stuck inside it, looks absolutely desperate to grow, but the magic barrier keeping his sheath sealed is strong. The barrier, however, does not seem to apply to liquids, as a steady flow of pre-cum keeps coming from Ivex&#39;s sheath to run down towards Ivex&#39;s balls and, much to his annoyance, mat the fur of his crotch as well.

&quot;You are a feline. Felines are flexible, aren&#39;t they?&quot; $name idly asks.

&quot;Yes,&quot; Ivex answers.

The wolf smirks. &quot;Then clean this mess you made with your tongue.&quot;

It is incredibly amusing to see Ivex bend forward. In an impressive display of flexibility, the panther indeed does reach beneath his own balls with his muzzle and, as always without hesitating, starts licking up his own pre-cum from the wolf&#39;s fur.

$name growls. His cock throbs with lust at the sight of the mage being made to do that. Ivex&#39;s lust spell is keeping his knot well engorged, and a desire to fuck him for a second time comes over the wolf, but he decides against it. At least not for now. $name is content to just lay back and watch Ivex&#39;s licking move up to his own balls. The panther licks up every drop of pre-cum from them,  and then he reaches his own sheath.

From there on, things get more amusing. Ivex lets out a small groan as his tongue laps over his own sheath. His member tries and tries to grow, but stopped by his own spell, the feline&#39;s tongue can only clean the pre-cum from his sheath while stimulating himself and, as he does, more pre-cum keeps coming from his cock for him to lap up. The wolf lets out a small laugh at the sight. He leaves the panther on that little loop for a good while.

Eventually, $name realizes that his knot will, in fact, not recede. The panther will stay there licking his own trapped sheath for hours if he lets him. With a sigh, the wolf grabs the panther&#39;s hips again and gets ready.

&quot;This will be quite uncomfortable for you,&quot; $name says without an ounce of actual sorrow over it. &quot;Pull yourself off my knot.&quot;

The enthralled panther finally stops licking himself to sit up straight. Then, putting both his paws on the wolf&#39;s abdomen, starts trying to rise up. The wolf grunts, feeling the tug on his knot, but slowly, carefully, and with a lot of uncomfortable grunting on Ivex&#39;s part, eventually, the wolf&#39;s knot finally pops out of his rear. The moment it does, some of his seed runs down from the panther&#39;s rear, but the wolf is quick to order Ivex to stand up properly and get off of him.

Standing up himself, $name looks down at the mage. With the wolf&#39;s seed running down the back of his thighs, he smirks.

It&#39;s time to take Ivex back to the Wayward Adventurers Guild. Watching the blank-faced mage and knowing he&#39;s trapped like that, however, the wolf gets to thinking...

What would it be like to have a thrall himself? Would a large bag of gold really be enough to make up for something like that? What if...?

No, that wouldn&#39;t be right. ...Would it? Ivex has made thralls of others and he had no intention of letting them go. It is poetic justice that he ends up meeting the same fate. Besides, slaves are common in most cities. Wouldn&#39;t that be a fitting punishment for the mage after all he&#39;s done?</tw-passagedata><tw-passagedata pid="221" name="Enthrallment Finish (Text)" tags="text" position="2600,5400" size="100,100">A smile grows across the wolf&#39;s muzzle. Yeah, there is no reason to waste such a good thrall by delivering him in for gold. Thinking back on all Ivex did to him in the tower and, even more so, what Ivex planned to do to him still, fills the wolf with certainty that this is the right way to go about it.

&quot;This is a pretty look for you,&quot; $name comments. &quot;You don&#39;t mind staying naked, do you? I think I might just keep you naked all the time. It&#39;s not like you will mind all the stares, right?&quot;

&quot;No, master,&quot; Ivex answers blankly, and the wolf laughs again.

&quot;Even if your ass is leaking my seed after I fuck you?&quot;

&quot;No, master.&quot;

&quot;That&#39;s what I thought.&quot;

With a wide smile, the wolf makes Ivex himself gather everything. The mage finds him a ragged pair of pants in the farmhouse that is enough to hold out until he can find something better. It takes some effort for the wolf to tuck his still hard cock inside, but that is another thing the panther can take care of again soon enough.

$name packs everything. The sack of gemstones with Ivex&#39;s spells and the large gemstone containing his tower. All of that along with, of course, the panther himself.

Ivex, with the pendant around his neck, is made to walk behind the wolf the whole way. Never before had delivering a bounty been so easy. True to his word, the wolf leaves the panther completely naked. There is no point in wasting gold buying clothes for someone that does not deserve them.

The journey back to the Wayward Adventurers Guild is a few days long and the wolf is not in a hurry to return. In fact, $name makes a point to include as many towns as he can on the way back and, each time, he takes immense pleasure in watching the stares of folk as they see the naked panther parading around the city. In one of them, the wolf went as far as ordering the panther to clutch a gemstone containing a lust spell so he was mewling and dripping the whole time as well.

When they arrive back in the Guild, the wolf delivers Ivex&#39;s tower and his gemstones to the official mages, but claims that he could not capture Ivex himself. It fills him with pleasure to know that he, in fact, left the panther jerking himself off in the alley behind the building.

The mages handle his tower. The wolf does not stick around to see it, but the rumors of the insane tower a mage possessed spread like wildfire. Apparently, the mages of the Wayward Adventurers Guild had to go through an arduous, delicate process to save the over fifty people Ivex had trapped inside his tower. All of them males. It makes $name feel all the better for having such a previously dangerous and deranged mage at his disposal, ready to lick his feet if he feels like it. Literally.

With a new &#39;companion&#39; by his side, the wolf moves on. The life of an adventurer is like that. Ivex wasn&#39;t the first mage he had to fight and it won&#39;t be the last. The events of the tower stick inside &lt;&lt;print $name&gt;&gt;&#39;s mind, though, and they are enough to make him blush every now and then, but whenever that happens, his new panther servant is there to alleviate his rage. He will make sure that such things never happen again.

Or, at least, he will try to.</tw-passagedata><tw-passagedata pid="222" name="Extraction Vengeance (Text)" tags="text" position="1650,5850" size="100,100">Deciding on his vengeance, the wolf smirks. He picks Ivex up. Taking him inside the tower is risky, as he seemed to be more powerful there, therefore it has to be done before he wakes up. It&#39;ll be worth it, hopefully.

With ease, the large wolf lifts the unconscious panther up to carry him over his shoulder. He then takes the red gemstone he made to get out of the tower, looks at it, and grips it again, hoping it&#39;ll work...

It does.

The travel back in doesn&#39;t feel as bad as the travel out. Maybe because the wolf expects it? In the blink of an eye, $name finds himself back inside the tower. On the exact same spot he left, in fact. The wolf has no idea how that works, but he doesn&#39;t care. With the unconscious panther in hand, $name can&#39;t help but notice that, this time, Ivex does not change. He doesn&#39;t become bigger, more muscular, and his regular brown robes still look the same. Maybe the arrogant mage does something himself to make him look better. Tsc. Ignoring that, he makes his way to the altar at the center of the large hall.

The thing is still there. As $name approaches, the blob of... whatever that is, sits on the altar looking as harmless as before. The red gemstone the fox couldn&#39;t use to escape is still there as well, which is a risk, but from what Ivex wrote, it will do him no good. The panther seemed really wary of touching this thing, so...

With a heave, the wolf throws the tied-up panther right over the blob.

It softens his impact. The wolf takes a step back, not sure what to expect. Much to his surprise, the thing, even though it looks like water, appears to be... viscous. The panther sinks halfway into it, but the moment it does, the blob starts moving around him. It engulfs and pulls the mage further into it. At first, $name frowns, thinking it&#39;s going to drown the panther, but soon the unconscious feline&#39;s muzzle opens and the wolf can clearly see that the blob creates an airway for him. This thing is clearly created with devious purposes in mind...

It is at that moment that Ivex&#39;s droopy eyes start to open. The blob continues to engulf him, moving the feline to its center. Ivex looks confused for a moment, but then... his eyes grow wide. They meet the wolf&#39;s, then dart all around him, and his expression shifts to one of rage... and panic.</tw-passagedata><tw-passagedata pid="223" name="Ivex Extraction 1 (Text)" tags="text" position="1775,5850" size="100,100">The panther&#39;s muzzle moves, but if he makes any sound, it doesn&#39;t make it past the thick, viscous substance of the blob. Ivex&#39;s bound arms and legs move for a moment, but as soon as they start, they immediately slow down, and the wolf can see that the thing is hardening around them to keep the panther still. Frozen in place, Ivex&#39;s eyes dart back and forth until they meet the wolf&#39;s. $name can see him frown, his expression shifting to one of anger, but his face too freezes inside the thing. Whatever this blob is, it doesn&#39;t seem keen on letting the feline move. Good. It works even better than the wolf expected.

$name wipes his paws and smiles triumphantly. Seeing Ivex trapped inside his own device is extremely pleasant. For a few moments, he watches the feline as he clearly struggles to move. His small muscles contract here or there, showing he&#39;s trying to put effort into moving his limbs, but none of it amounts to anything. What a weakling! After a while, it is clear that the feline is trapped and cannot get out. The wolf is ready to leave him there, for in fact, he doesn&#39;t even know how he would go about getting Ivex out of it. The mages in the Wayward Adventurers Guild will surely figure something out when he delivers the panther and his tower to them in a few days. Taking a step back, the wolf is about to leave, but then something else catches his eye.

Ivex seems to start growing more frantic in his entrapment. As the wolf&#39;s eyes go over the feline, he can see why. Little by little, the blob seems to &lt;b&gt;dissolve&lt;/b&gt; Ivex&#39;s clothing. It moves around the panther as a whole, its surface full of ripples as it does its work while keeping the mage still at the same time. Ivex&#39;s robes start tearing, then little by little, holes start appearing in the fabric and these grow wider and wider, expanding until, soon enough, there is nothing left. The wolf smirks. The panther is left not only trapped but also &lt;b&gt;naked&lt;/b&gt;. The rope that bound him dissolve as well, which worries the wolf for a moment, but the panther can&#39;t even manage to move them out of the position they were while bound inside the slime.

But that&#39;s not all of it. The wolf notices how the blob&#39;s movement starts focusing around Ivex&#39;s genitals. The panther grows more and more frantic, seemingly trying to make sounds, as the thing starts gripping his balls. The black-furred orbs are the only thing that moves as if they are being kneaded by the thing, and soon it expands up to Ivex&#39;s sheath as well.

The thing moves around it as if massaging his sheath, except...

The yellow glow surrounding it stops it. The blob seems keen on continuing to stimulate it for some reason, but the yellow glow blocks it. The wolf raises an eyebrow watching it all unfold. Is this thing another one of Ivex&#39;s perverted machinations?</tw-passagedata><tw-passagedata pid="224" name="Ivex Extraction 2 (Text)" tags="text" position="1900,5850" size="100,100">The panther seems angrier and more distressed as time goes on. The blob moving around his sheath grows more active. Even from outside, it looks as if it is actively stroking it, trying to stimulate it for some reason.

In response to that, $name can see how Ivex&#39;s body reacts. Since the magic&#39;s chastity cage is transparent, the way the panther&#39;s sheath grows thicker is clear. The pink member nestled within reaches the opening of his sheath and bulges it, but because of the spell, it is unable to properly grow hard. It sure seems keen on trying to, though.

And the more Ivex fails to grow erect, the harder the blob seems to work to make it so. The feline&#39;s balls start getting massaged more roughly. The wolf can see the blob forcefully spreading Ivex&#39;s legs, then pulling his balls away from his body ever so slightly so that it can press against them again and again, massaging them without stop. At the same time, the movement around the panther&#39;s sheath grows firmer as well. The blob actively pushes and pulls, tugging it up and down with a clear intent of stimulating it.

The panther does react to it. His member seems more and more eager to grow. Through the transparent liquid of the blob, $name can see Ivex&#39;s member leaking white pre-cum inside his sheath. Somehow, the liquid seems to make it past the invisible barrier keeping his cock confined. Maybe that&#39;s part of the spell? As soon as the pre-cum reaches the blob, however...

It gets absorbed by it right away. It is as if the blob knows what it is doing. The stroking of Ivex&#39;s sheath grows even more frantic and his sheath looks swollen with his arousal. The panther&#39;s cock is obviously trying very hard to grow inside its cage.

Ivex makes effort after effort to move, to get away from the thing assaulting his genitals. His face shows anger, outrage, and every now and then his furious eyes focus on the wolf, but there doesn&#39;t seem to be anything the feline can do to get away, or else he would already have done so. Even the red gemstone, the one that teleports, sits inside the blob below Ivex, but according to his own journal, it is &#39;unreachable&#39; to him anyway. Now $name can see why.

The wolf smirks with satisfaction. Ivex is finally paying for all he has done.</tw-passagedata><tw-passagedata pid="225" name="Ivex Extraction 3 (Text)" tags="text" position="2025,5850" size="100,100">&lt;&lt;print $name&gt;&gt; can&#39;t help but move his own hand down to his cock as he watches the struggling panther get assaulted inside his own device. The karmic justice in it feels weirdly erotic. Or maybe it&#39;s just the effects of the candle still burning hot within him? Either way, it feels great for the wolf to have the freedom to wrap his paw around his member and stroke it.

It feels even better to see Ivex&#39;s eyes shifting downwards towards his cock. The panther is forced to watch the free wolf idly jerking off while, at the same time, the blob keeps working on his cock relentlessly while it is unable to even grow hard.

When $name thinks things can&#39;t get any better, they do.

The blob seems to be working extra hard to stimulate Ivex, but all it gets are the occasional spurts of pre-cum that the feline&#39;s desperately aroused cock lets out. As if outraged by that, the wolf gets a perfect view of how the blob starts treating the feline&#39;s nuts in a rougher manner.

Ivex seems to definitely feel that. The feline&#39;s eyes grow wide, and his face changes to a pained expression for a moment before it goes back to a pleasurable one. The blob seems to alternate between punishing squeezes to the feline&#39;s sack and pleasurable massages, all while never ceasing to stimulate Ivex&#39;s sheath at the same time, trying with all of its might to make the feline grow hard despite it being impossible.

&lt;&lt;print $name&gt;&gt;&#39;s paw speeds up on his own cock. The erotic view of his hateful enemy being mistreated feels even better. The wolf&#39;s cock stands as hard as it was before, the red, tapered canine spire hard all the way to the knot. The wolf takes his sweet time stroking it, enjoying the pleasure the mage cannot feel, but because of how strong the arousal inside him is, he doesn&#39;t feel too far from cumming.

And then things get even better.</tw-passagedata><tw-passagedata pid="226" name="Ivex Extraction Final (Text)" tags="text" position="2150,5850" size="100,100">The wolf&#39;s paw speeds up even more on his cock and he laughs when the blob spreads Ivex&#39;s legs even wider. The movement under the panther&#39;s tail makes what&#39;s going to happen next obvious. It&#39;s unbelievable that Ivex made this thing to do that to someone, but it feels incredibly pleasant to see it done to him!

The panther seems to be aware of what&#39;s going to happen as well. His struggling to move grows more frantic than ever, every muscle in the panther&#39;s body contracting as he tries to move, but it is as if he is encased in solid ice. The panther remains there, floating inside the blob, even as it moves under his tail...

And the wolf gets to see it all. The way it spreads the feline&#39;s entrance as it penetrates him. Whatever the thing is doing, Ivex seems outraged by it. His face grows red, but the wolf can&#39;t tell if it&#39;s from rage or embarrassment. Maybe both? The feline&#39;s ass gets spread even wider as the blob penetrates him, invading his most sensitive spot...

And as the wolf watches it, the lust within him burns. He can&#39;t help but imagine himself shoving his cock in there. Fuck, maybe he should have done that instead, he thinks, but the sight of it is still pleasant enough. $name lets his tongue hang out of his muzzle as he jerks off harder watching it all happen.

Ivex&#39;s expression of anger takes a sudden shift. His face twists with pleasure as the slime moves around his ass. It seems it found the sensitive spot in there. In reaction to it, the panther&#39;s cock lets out a new spurt of pre-cum that makes it past his cage. His cock takes the whole space of his sheath, looking desperate to grow hard, but held still by his own magic. The blob continues to stimulate him from every angle, trying so hard to get him hard for whatever reason.

The sight of the feline fuming with anger and moaning with unwanted pleasure, at the same time coupled with the magical arousal, is enough to push the wolf past the edge.

$name shoots. Jerking himself off, he lets his cock shoot his seed high. Some of it hits the blob and, when it does, the thing absorbs it. Pleasure courses through the wolf. He pants, riding his blessed orgasm, and he can see Ivex&#39;s eyes fixated on the throbbing of his cock with obvious jealousy and need.

What the wolf does not expect is the effect his seed has on the thing. The moment it hits it, the slime absorbs it and sends it down the altar through a small hole under it. What its purpose is, the wolf doesn&#39;t know, but as soon as it gets some seed?

All of its efforts to extract the same thing from Ivex seem to double. The panther&#39;s muzzle moves as he tries to let out sounds, but there is nothing that can be done. Ivex remains trapped, frozen inside the blob as it assaults him in every conceivable way, forcing pleasure he cannot enjoy upon him.

The wolf, on the other hand, slows down his paw. His cock, just as before, remains just as hard, his knot bigger than ever. Because of Ivex&#39;s cursed candle and whatnot, he feels some relief from jerking off, but $name feels as if he can go again right away. Will that lust ever subside?!

Just as he wonders that, the altar where the blob with Ivex inside starts glowing. The wolf takes a step back, readying himself, unsure of what is happening...</tw-passagedata><tw-passagedata pid="227" name="Ivex Extraction End (Text)" tags="text" position="2275,5850" size="100,100">The glowing on the altar grows brighter. Ivex seems to grow more frantic inside it for a moment, and then...

It disappears.

The blob with Ivex inside disappears. For a moment, $name panics. Did the panther manage to get out somehow?! Looking around, however, the wolf quickly spots him. The blob did not disappear, it simply teleported. Ivex is still very frozen inside it, but it now rests within one of the open alcoves that surround the large room. The wolf makes his way there just as the large stone doors of the alcove start closing.

Rushing there, $name stops them from doing so. Holding them open with his muscles alone, the stone stops resisting him. The alcove with Ivex inside remains open, but as the wolf looks up and around to all the closed ones...

Are they all full of people in the same situation Ivex is? The thought of that makes the wolf&#39;s eyes grow wide. It is a scary thought. To be trapped inside something like that in the crazed mage&#39;s tower...

As the wolf wonders about it, a familiar scent hits his nose. It goes in hot, and as soon as he feels it, $name covers his nose with his arm and steps back. It takes him a moment to find its source, but then, much to his surprise, he sees it. An array of candles- no, several arrays, lined up inside the alcove right above the blob Ivex is trapped in. The red candles of lust light up. At first, only one does, but then a second, a third, a fourth...

Ivex looks at them in panic. Unable to move, the panther has no choice but to breathe them in and the effect is instantaneous. His sheath remains as swollen as before, his trapped member unable to get past the magic, but pre-cum starts coming from it more frequently right away. The blob seems satisfied with that, but it keeps working hard to stimulate the feline, again and again...

Keeping his nose covered, the wolf takes a few steps back.

Yet, he smirks. If the panther has really inflicted that upon others, then it is only fitting that he tastes it himself. Completely trapped, it&#39;s clear that Ivex isn&#39;t going anywhere.

The panther&#39;s eyes grow wide with fury when the wolf pushes the first of the alcove&#39;s stone doors closed. Then, $name can see him trying so very hard to move, to say something, all the while his eyes and face start losing themselves in an expression of drunken lust and need before the wolf closes the second door, trapping the crazed mage inside with nothing but his own candles... and his own weird blob-thing.</tw-passagedata><tw-passagedata pid="228" name="Extraction Finish (Text)" tags="text" position="2400,5850" size="100,100">The wolf gets out of the tower and takes pleasure in knowing that, inside this gemstone where the tower is, the target of his bounty is as well.

Lucky for the wolf, he manages to find a worn, old pair of pants in the farmhouse Ivex had made his base. They are far too short for him, but they will do, so that at least he&#39;s not naked.

Gathering what supplies he can, the wolf sets off with everything in hand: Ivex&#39;s tower inside the large gemstone, the pouch of magic gemstones and, most importantly, Ivex.

The journey back to the Wayward Adventurers Guild takes a few days. It could go quicker, but after the deeply distressing effort to capture the mage, $name is not exactly in a hurry to get there anymore. The wolf takes his sweet time recovering from everything he went through inside the mage&#39;s crazy tower, and basking in his success.

A few times during his journey he goes back in to check on Ivex. Every time he does, the panther&#39;s eyes dart to him, but they are glazed. He&#39;s lost in an infinite loop of pleasure. Pleasure he can&#39;t have. The blob always looks like it&#39;s working its hardest to stimulate the panther, but with the chastity spell still on him, all he can provide is pre-cum as his cock always strains to grow hard, but can&#39;t. Other than his pleasurable torment, Ivex seems fine. Whatever magics he has going on in this system with the blob-things, it seems to be made to sustain who is inside and keep them well and healthy.

When the wolf gets back to the Guild, he gives them a thorough re-telling of what he went through and what he has in tow, the official mages in the Wayward Adventurers Guild take a while to extract Ivex himself from his own torment, but from there, they throw him straight into a prison where his magic will be kept in check.

They also handle his tower as a whole. The wolf does not stick around to see it, but the rumors of the insane tower a mage possessed spread like wildfire. Apparently, the mages of the Guild had to go through an arduous, delicate process to save the over fifty people Ivex had trapped inside his tower in the same way he was trapped. All of them males, and all of them kept there to provide energy for the tower&#39;s existence with their seed inside these things that would perpetually extract it from them while, at the same time, stimulating their bodies to produce more. A truly twisted device.

With a handsome amount of gold in his hands, the wolf moves on. The life of an adventurer is like that. Ivex wasn&#39;t the first mage he had to fight and it won&#39;t be the last. The events of the tower stick inside &lt;&lt;print $name&gt;&gt;&#39;s mind, though, and they are enough to make him blush every now and then. He will make sure that such things never happen again.

Or, at least, he will try to.</tw-passagedata><tw-passagedata pid="229" name="Ivex Enthrallment Archive Display" tags="noreturn" position="2200,1000" size="100,100">&lt;&lt;if $enthralmentIvexEnding&gt;&gt;\
  &lt;b&gt;[[Ending: A New Servant|Ivex Enthrallment Archive]]&lt;/b&gt;
&lt;&lt;else&gt;&gt;\
  &lt;span class=&quot;helper-container&quot;&gt;
      &lt;b&gt;&lt;span class=&quot;disabled&quot;&gt;Ending: A New Servant&lt;/span&gt;&lt;/b&gt;
    &lt;small class=&quot;helper-text&quot;&gt;New punishment ideas might come to the adventurer if he has experienced terrible things in different timelines...&lt;/small&gt;
  &lt;/span&gt;
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="230" name="Ivex Enthrallment Archive" tags="noreturn" position="2200,1100" size="100,100">&lt;&lt;include &quot;Enthrallment Vengeance (Text)&quot;&gt;&gt;

&lt;&lt;include &quot;Ivex Enthrallment 1 (Text)&quot;&gt;&gt;

&lt;&lt;include &quot;Ivex Enthrallment 2 (Text)&quot;&gt;&gt;

&lt;&lt;include &quot;Ivex Enthrallment 3 (Text)&quot;&gt;&gt;

&lt;&lt;include &quot;Ivex Enthrallment 4 (Text)&quot;&gt;&gt;

&lt;&lt;include &quot;Ivex Enthrallment 5 (Text)&quot;&gt;&gt;

&lt;&lt;include &quot;Ivex Enthrallment Final (Text)&quot;&gt;&gt;

&lt;&lt;include &quot;Ivex Enthrallment End (Text)&quot;&gt;&gt;

&lt;&lt;include &quot;Enthrallment Finish (Text)&quot;&gt;&gt;

&lt;span class=&quot;good-ending&quot;&gt;Ending: &lt;i&gt;Ivex&#39;s Enthrallment&lt;/i&gt;&lt;/span&gt;

[[Return to the Archives|Archives]]</tw-passagedata><tw-passagedata pid="231" name="Ivex Extraction Archive Display" tags="noreturn" position="2325,1000" size="100,100">&lt;&lt;if $extractionIvexEnding&gt;&gt;\
  &lt;b&gt;[[Ending: Energy Supply|Ivex Extraction Archive]]&lt;/b&gt;
&lt;&lt;else&gt;&gt;\
  &lt;span class=&quot;helper-container&quot;&gt;
      &lt;b&gt;&lt;span class=&quot;disabled&quot;&gt;Ending: Energy Supply&lt;/span&gt;&lt;/b&gt;
    &lt;small class=&quot;helper-text&quot;&gt;New punishment ideas might come to the adventurer if he has experienced terrible things in different timelines...&lt;/small&gt;
  &lt;/span&gt;
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="232" name="Ivex Extraction Archive" tags="noreturn" position="2325,1100" size="100,100">&lt;&lt;include &quot;Extraction Vengeance (Text)&quot;&gt;&gt;

&lt;&lt;include &quot;Ivex Extraction 1 (Text)&quot;&gt;&gt;

&lt;&lt;include &quot;Ivex Extraction 2 (Text)&quot;&gt;&gt;

&lt;&lt;include &quot;Ivex Extraction 3 (Text)&quot;&gt;&gt;

&lt;&lt;include &quot;Ivex Extraction Final (Text)&quot;&gt;&gt;

&lt;&lt;include &quot;Ivex Extraction End (Text)&quot;&gt;&gt;

&lt;&lt;include &quot;Extraction Finish (Text)&quot;&gt;&gt;

&lt;span class=&quot;good-ending&quot;&gt;Ending: &lt;i&gt;Ivex&#39;s Extraction&lt;/i&gt;&lt;/span&gt;

[[Return to the Archives|Archives]]</tw-passagedata><tw-passagedata pid="233" name="Ivex Punishment Archive Display" tags="noreturn" position="2075,1000" size="100,100">&lt;&lt;if $personalEnding&gt;&gt;\
  &lt;b&gt;[[Ending: Punishment|Ivex Punishment Archive]]&lt;/b&gt;
&lt;&lt;else&gt;&gt;\
  &lt;span class=&quot;helper-container&quot;&gt;
      &lt;b&gt;&lt;span class=&quot;disabled&quot;&gt;Ending: Punishment&lt;/span&gt;&lt;/b&gt;
    &lt;small class=&quot;helper-text&quot;&gt;The spoils of victory...&lt;/small&gt;
  &lt;/span&gt;
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="234" name="Ivex Punishment Archive" tags="noreturn" position="2075,1100" size="100,100">The wolf, still holding Ivex up by the scruff, lifts him higher so that he can look at the unconscious feline&#39;s face. Then, without hesitation, $name brings a paw up and gives the panther&#39;s muzzle a hard slap.

Ivex shakes, awakening with a grunt and a mewl. The feline blinks, his feet wiggling up in the air and he looks around confused for a moment before his eyes focus on the large wolf holding him up. The sight of him trying to do something about it, only to realize that his arms are bound behind his back and his bound feet can&#39;t even touch the floor makes for quite an amusing scene.

Of course, after Ivex realizes the direness of his predicament, he still has the audacity to show his teeth at the wolf.

&quot;What do you think you&#39;re doing?! Unhand me! Let me go or I&#39;ll make you regret ever being born with all of my power!&quot; the panther says in a tone that &lt;b&gt;tries&lt;/b&gt; to sound intimidating. Paying attention to the feline, $name can see his eyes darting back and forth across the room and floor. The wolf then picks up the pouch full of gemstones from his belt and lifts it up to the panther with a smirk.

&quot;Looking for these?&quot; $name asks, lightly shaking the sack to showcase the sound of the gemstones inside.

Ivex looks at it for a moment... then juts forward, trying to reach for the sack even without the use of his arms. A most pitiful attempt that makes the larger wolf laugh as he simply pulls the pouch away.

&quot;I was right. You really are completely powerless without your little toys, aren&#39;t you? At least out here, you are...&quot; The wolf grins and chuckles.

&quot;N-no!&quot; the panther says with a small growl. &quot;You fool! When I get out of here, I&#39;m gonna make you lick my feet! Yes! You will spend the rest of your days as my foot rest and cleaner! I will make you lick them every time I g-&quot;

The wolf decides to interrupt the arrogant mage&#39;s babbling with a new slap to his face. It&#39;s enough to make him whine even though the wolf doesn&#39;t even put much strength into it.

After that, he decides to just drop the panther down. He yelps again as he falls down, grunting like a cub and making effort to sit back up. He looks at the wolf, hisses, then starts pathetically trying to crawl away from the large lupine. Like a little worm wiggling on the ground.

A fun sight, but...

Looking down at himself, the wolf can see his cock. Because of Ivex&#39;s own magic, the red spire still throbs with insatiable need. That candle&#39;s effect has to fade at some point, but while it doesn&#39;t...

The wolf looks up at the wiggling panther.

&quot;You&#39;ll pay!&quot; he seethes. &quot;I swear, you&#39;ll pay! To think you&#39;d have the audacity of striking me! Of doing this! You will regret this!&quot; Ivex continues to hurl insult after insult at the wolf. $name all but ignores him, instead focusing on thinking.

What to do to him first?

With a good look at the mage, the wolf decides to do to him the same thing Ivex has done when he was the one bound.

Memories of the perverted panther getting rid of his clothes back in the tower come to the wolf&#39;s mind. Narrowing his eyes towards the feline, he reaches up to him.

&quot;What?! Stop! Let go of me! Let go of me right NOW!&quot; Ivex demands as wiggles in the wolf&#39;s hold. Still, it takes no effort for $name to lift the feline up by his scruff again.

The large wolf is not gentle. Using his own paw and sheer strength, he takes hold of Ivex&#39;s shirt around the neck and &lt;b&gt;pulls&lt;/b&gt;.

Ivex whines as the fabric rips. His skinny chest is exposed to the elements and, with a few more tugs and tears, soon the rags of what was once his shirt fall down to the floor.

Then, both the panther and the wolf look down his pants, the only thing left covering his body.

Their eyes meet, and $name smirks.

&quot;No! NO! Don&#39;t you dare! Don&#39;t-!&quot; Ivex growls, starting to wiggle in his hold again, but the wolf ignores it.

With a pull just as strong, $name grabs the waistband of Ivex&#39;s pants, and it takes very little effort for the big, strong wolf to tear the fabric apart. The bound panther continues to struggle in the air, and when his pants fall, he is left with nothing but a small, worn-looking cloth undergarment wrapped around his crotch. The feline hisses, but for the wolf, it takes but one finger to snap the waistband of Ivex&#39;s last piece of modesty and let it fall down to the floor as well.

&quot;I will make you SUFFER!&quot; the panther yells. Still held up in the air, Ivex presses his legs together in a feeble attempt to hide his modesty. It looks like he doesn&#39;t enjoy it that much when it&#39;s done to him and not to others.

Nonchalantly, the wolf drops the panther back down, letting him fall and taking a good look at his naked form. Ivex rolls on the floor trying to get rid of the ropes keeping him bound and, now naked as he is, the wolf can finally get a good look at his body.

He is lean indeed, not a single muscle adorning his arms, but his body is still... curvy enough. Perhaps it is the arousal speaking, but looking down at the panther&#39;s round ass as he struggles back and forth makes the wolf&#39;s cock throb again. His member, perpetually stuck in an erect state, grows even harder as lustful thoughts fill up his mind...

Still, $name shakes his head and shakes them off. They are still very much there, but there will be plenty of time for that if he decides to go for it. For now, this is about punishing the panther...

&quot;You BRUTE! You brainless, dumb brute! You can&#39;t even fathom what you&#39;re doing! I will make you EAT the clothes you ruined when I get out of here!&quot; Ivex continues to prattle.

On one hand, fucking him would be a fitting punishment. Hell knows that the wolf&#39;s cock wants that... On the other hand, there are other things he could also do to him that would definitely be fun.

Ivex is not aware of the chastity spell yet either. Perhaps giving him a taste of his own medicine in that regard too would be better...

What to do to him next?

It&#39;s time to show him what&#39;s in store for him.

The wolf takes a few heavy steps toward the panther. Seeing $name approaching is enough to make Ivex look fearful again. He tries to wiggle away, but a simple pull on his tail is enough to drag him back closer. Then, the wolf gets down on all fours over the bound mage.

Ivex shrinks and closes his eyes to the simple act of the growling wolf&#39;s sharp teeth approaching him. Upon getting on all fours above the feline, however, the wolf stops. His cock flexes between his legs, so very close to the naked panther and, in fact, with a droplet of pre-cum falling to mat the panther&#39;s perfect black fur.

&quot;Stop! Get away!&quot; Ivex hisses, sounding less and less threatening.

&quot;Quiet,&quot; the wolf orders, plain and simple. With one hand, the wolf grabs the panther&#39;s shoulder and forces him onto his back. Then, looking down at Ivex&#39;s sheath... The wolf takes pleasure in roughly grabbing it and starting to fondle it between two of his powerful fingers.

&quot;What are you doing?!&quot; The panther seems outraged to be touched like that, which is ironic, really. Ivex hisses and tries to wiggle away, but he is very easy to hold down. It is, however, surprisingly soon that the wolf feels the panther&#39;s sheath starting to swell.

Ivex is too busy being angry at first to notice, but before long, he stops. The feline grunts, his eyes go wide, and he looks downward trying to get a look at his sheath.

Upon seeing that, the wolf smiles. His fingers coaxing and stroking Ivex&#39;s sheath start to work faster, kneading it the same way he does his own to force pleasure upon the panther. Both $name and Ivex see the same thing when looking down at that sheath.

The feline&#39;s member trying to grow out of it, but failing. It gets trapped inside it, held back by the barely visible translucent barrier from Ivex&#39;s own spell. Recognition flashes on Ivex&#39;s eyes and the look of seething anger and outrage he gives the wolf make all of this worth it by itself.

&quot;WHAT DID YOU DO?!&quot; he asks, yelling. &quot;You didn&#39;t- NO! YOU FOOL! That spell is not ready yet! Do you know how much work it will be to dispel it?! I will make you PAY for this!&quot;

As the panther attempts to keep yelling his outrage, the wolf simply smirks. His fingers move even faster in stroking and kneading Ivex&#39;s sheath. Soon enough, his complaining stops and, instead, he starts groaning. A droplet of pre-cum comes from Ivex&#39;s sheath, smearing its inside as his cock continues to fail to grow out of it.

This will, indeed, be plenty of fun.

&quot;You- I will place ten layers of this spell on you when I get out of this! It will take an archmage to ever access your fucking sheath ever again!!&quot; Ivex continues to idly threaten... and then he stops to groan in frustrated pleasure again.

$name continues to hold the panther down and forcefully stimulate him. What to do to him next, though? Hmm...

Glancing at the pouch full of Ivex&#39;s own spells, the wolf knows that&#39;s a good choice.

Yes. Ivex has made so many spells with the sole intent of using them on people for his own perversion. Why not use some of these against him?

The wolf smirks down at the panther and lets go of him. The mage stares daggers up at the wolf but is left panting and looking flustered. His sheath is still full and his cock still fights to grow past it. The frustration of it is plain in Ivex&#39;s face and he takes that moment of reprieve to recover a little from it.

In the meantime, the wolf pulls out the pouch filled with his gemstones and brings it up. The moment Ivex sees it, his eyes narrow.

&quot;What are you doing with that, you mongrel?!&quot; he asks between his raspy breathing.

The wolf all but ignores it. He opens the pouch wide and looks down at it. Shoving his paw inside, $name goes through a few of the gemstones, clutching them to get a read of what they do. After a little while, he looks down at the panther and smirks.

There are a few that could definitely be used against Ivex right here...

Why not put him through the same affliction that is making the wolf&#39;s cock throb in need right now?

Pulling out the pink gemstone, the wolf clutches it in his hand and looks down at Ivex.

The panther catches a glimpse of the gemstone and starts shaking his head.

&quot;You can&#39;t! Don&#39;t you DARE!&quot; Ivex growls, but that does nothing to stop the wolf from pressing the glowing gemstone against the squirming panther&#39;s chest.

The moment it does, Ivex lets out a loud, lingering moan. Just to see its effects, $name brings his other paw down to the feline&#39;s sheath. He fondles it, teasing it, and on his fingers, he can feel it actually heating up.

Ivex&#39;s member, which had already been straining to grow hard, clearly pushes even harder against the chastity spell, but it&#39;s hopeless. His cock cannot grow, will not grow, and the feline just moans and writhes in frustration over it. Pre-cum starts coming from his member, little by little at first, but the more the wolf keeps that gemstone pressed against his chest, the more frequent it becomes. 

It seems like the mage doesn&#39;t enjoy his magic being used on him as much as he enjoys using it on others.

With no rush, the wolf keeps kneading the panther&#39;s sheath, stimulating it and helping the spell foster Ivex&#39;s frustration. The feline just writhes, his face shifting between frustration and pleasure every second as he deals with the spell&#39;s effects forcing him into a deep arousal he cannot have.

&quot;Hnnngh... fuck... please...!&quot; Ivex whines after a short while. His hips jut up pathetically as if humping. He seems desperate to grow hard. Pre-cum leaks without ceasing from his member and, even small and forcefully contained as it is, it still pulses inside the panther&#39;s sheath. It looks as if he&#39;s ready to reach his climax, but is unable to without the proper stimulation he can&#39;t get.

$name takes pleasure in keeping the gemstone firmly pressed against the helpless feline as he moans in that state for several minutes. It is only when the wolf&#39;s fingers are drenched in pre-cum and the panther looks like he might pass out from too much pleasure that he finally pulls the gemstone back.

When he does, Ivex lets out a frustrated groan, but finally seems like he starts catching his breath rather than just mindlessly moaning. The panther looks dazed. The wolf wipes his hand on the fur of Ivex&#39;s thigh, but even with the source of arousal gone, Ivex&#39;s cock remains in that state of trying so very hard to grow.

The wolf just snorts. The mage that looked so powerful in the tower, submitting him to that, now looks like a mewling cat under the effects of the same spell.

The wolf&#39;s own cock throbs, ever erect, remembering how it felt, and as it does... he only feels angry. Ivex still has much more to feel.

&quot;Fuck... you!&quot; Ivex mutters between raspy breaths. The wolf merely smirks at it.

Keeping him held down is an easy matter even if he does try to squirm away every now and then. The meek panther does not look threatening at all anymore like that.

As the wolf stares down at him, his own member still pulses, however. The lust Ivex has inflicted on him still feels like it is unsatisfied. Perhaps taking it out on him would satisfy it and, even if it doesn&#39;t, it will at least &lt;b&gt;feel&lt;/b&gt; fucking satisfying. Just the thought of it makes the wolf let out a small growl of lust. His knot feels cold out in the open like that for so long...

$name takes control of his senses, though. He&#39;s there to punish Ivex, not to indulge in his own forced lust. Not that he couldn&#39;t do both at the same time.

&quot;You fucking... mutt! You&#39;ll pay...&quot; Ivex repeats, doing nothing but foster the wolf&#39;s anger.

At any rate, though, what to do with him next?

He&#39;s being way too noisy.

Yeah, silencing him might be a good idea. Given the place Ivex has chosen to hide it is unlikely that anyone would hear him, but his prattling is growing annoying pretty quickly.

&quot;-and when you&#39;re done mopping the floor with your tail, I&#39;ll make you do it all over again with your TONGUE! And then-&quot; the panther continues angrily.

The wolf looks around. There&#39;s a few options on how to silence him. What to gag him with...

The wolf smirks. It&#39;s time to get creative.

Reaching out for Ivex&#39;s cut and discarded clothes, it&#39;s easy to find the stained piece of cloth he had wrapped around his crotch. 

The panther&#39;s eyes follow the wolf&#39;s hand and he seems confused for a moment. Then, $name crumples the cloth into a tight ball and approaches the feline&#39;s muzzle with it.

&quot;WHA-&quot; Ivex has time to say and, when he opens his muzzle to do so, the wolf shoves his own undergarments into his maw with a swift motion.

&quot;HMMFGH!&quot; Ivex complains. His eyes water and his face grows red. The panther shakes his head, clearly trying to dislodge the underwear from within his muzzle, but the wolf does not let him. With two fingers, he presses the garments in deeper and deeper, to the point where they seem like they&#39;re close to reaching the mage&#39;s throat.

&quot;Hnnnnghhfff! Hngh hnmmf!&quot; Ivex complains again, but the wolf can&#39;t even tell what he&#39;s saying. He looks absolutely furious, though.

Sweet, sweet silence.

Keeping the bound mage held down on his back against the floor is remarkably easy, especially when he&#39;s panting and gasping after being... tortured.

What to do with the helpless, evil feline next?

This time, the wolf&#39;s own cock answers the question for him. It can&#39;t wait any longer.

It&#39;s high time Ivex deals with the consequences of what he has caused.

The wolf&#39;s member throbs in excitement. $name keeps one paw firmly on Ivex&#39;s shoulder, holding him down on his back, but the other? The wolf&#39;s eyes lock with the panther&#39;s and he brings it down to his own cock. The wolf gives it a stroke, from top to bottom. The bright red, veiny spire has been aching for this for hours and hours. Ever since he was forced to breathe in that candle. This fire inside him has been burning for too long.

Slowly, the wolf gives himself a few strokes. His paw feels so damn good on the length of his member. From the tapered tip all the way to the engorged knot. When it reaches the base, the wolf envelops his knot with his paw and gasps over how good it feels to squeeze. Just a light squeeze is enough to fuel his arousal, to make him think of sex and little else. Sure, he would prefer a tight cunt over a skinny panther, but...

He looks down at Ivex, who in turn is staring at the wolf&#39;s cock as if guessing what&#39;s coming next.

This will feel immensely satisfying.

Bringing his paw back up, $name spits on it. Then, he looks down at the panther while coating his member with a layer of his saliva.

&quot;H-hmmfgh hmmghff ghmff?!&quot; Ivex tries to ask, his eyes going wide. He looks between the wolf and his cock apprehensively.

&quot;You caused this. Now you gotta deal with it,&quot; the wolf merely says with a low growl. Then, with both hands, he takes hold of the panther&#39;s shoulders and turns him around.

&quot;Hmmfgh! Whmmfgh! Whmmfgh!! Yhmmfg hmmgh hhfmmgh HMMFGH!&quot; 

Ignoring the loud feline, $name takes pleasure in pressing Ivex down against the ground after forcing him to be on his belly. Then, grabbing the panther&#39;s tail, he forces him up on his knees while keeping his face still well-pressed against the floor with pressure on his upper back.

The mage squirms, but bound and pinned down as he is, there is little he can do. The sight of his raised rump is glorious. His pink, tight-looking entrance taunts the wolf and fans the flames burning within him. Pre-cum drips from his cock. No more wasting time.

Positioning himself above the smaller feline, the wolf continues to ignore Ivex&#39;s protesting and struggling beneath him as he lines himself up. The tip of his member brushes against the mage&#39;s entrance and, when it does, he tries to get away from it, but a good tug on his tail keeps his ass up in the air where it should be.

&quot;This is for everything you put me through,&quot; the wolf growls before shoving his hips forward.

&quot;HMMMFGH!&quot; Ivex pretty much yells. The initial penetration... feels absolutely great.

The tight walls of the smaller feline are forced to spread to give room to the wolf&#39;s considerable endowment. Feeling the warmth engulfing his needy cock is the best thing he could have asked for. $name moans out loud. There&#39;s no reason to be quiet. The wolf makes a point to groan and growl as he shoves his hips forward, sinking another inch of his cock into the feline.

Beneath him, Ivex mewls and complains, but the wolf merely presses him down harder against the ground and shoves another inch into him, silencing the panther by making him grunt. It does not take long for the wolf to shove the entirety of his cock into the mage, save for the knot. The drive to shove his knot in is there... and it is strong. The wolf resists it, though. There is plenty of time... and he wants to savor this for as long as possible.

In a rough movement, $name pulls back, pulling his cock out and making Ivex yelp, then he shoves himself back in, driving his entire length in there again. Giving the feline little time to adjust, the wolf takes his pleasure. He pistons in and out of the panther&#39;s ass, fucking him with gusto and taking immense pleasure in sating some of the burning lust within him.

Ivex is simply forced to take the wolf&#39;s pounding.

&quot;Fuck...&quot; the wolf groans. His lusty growling is constant as he continues to fuck the panther hard. In and out, the smaller feline&#39;s ass already taking his size with more ease, yet still feeling delightfully tight around his cock.

&quot;Fhmmgh! Shhmmffwhr! Hnngh!&quot; Ivex mewls beneath him. The wolf ignores it.

$name speeds up. The larger wolf huffs through his nose, his arm that holds Ivex down moves to grab the feline, enveloping him by the chest and bringing him up to press him against the wolf&#39;s own, broader chest. Holding the panther tight, $name finds a better position to fuck, managing to go just a little deeper with each thrust.

Ivex himself groans and grunts without ceasing at that. The skinny panther is easily held against his body in that good fuckable position. The wolf starts thrusting harder. Faster. The pleasure is so great...!

&lt;&lt;print $name&gt;&gt;&#39;s knot grows larger. It begs to be shoved in and, in a couple of harder thrusts, the wolf actually tries, pressing the much larger bulb of flesh against Ivex&#39;s stretched ass, but it&#39;ll take more effort, and...

No! Not quite yet!

Out of nowhere, the wolf suddenly stops. He pauses with his cock deep within the panther. His chest heaves and he pants from the effort of fucking, but though his cock still throbs inside the panther, he continues to stay still.

$name is not catching his breath. No, he realizes he was too close. Too close to finishing inside that tight ass. He wants to do that. More than anything. Just... not so fast.

Ivex has not had all of his punishment just yet.

The panther pants as well beneath him. He seems glad to have a break, even though he groans, obviously stretched by the wolf&#39;s entire cock, save the knot, that remains firmly impaled within him.

Just out of curiosity, &lt;&lt;print $name&gt;&gt;&#39;s paw lets go of Ivex, letting the feline fall down face-first on the floor with a grunt while his ass remains raised and impaled. Ivex yelps at that, but the wolf does not care. No, instead, his paw trails down, moving to grab and feel Ivex&#39;s sheath.

It is very engorged. Just touching it leaves the wolf&#39;s fingers sticky with the feline&#39;s pre-cum. It seems that, liking it or not, the panther&#39;s body is enjoying being pounded.

&quot;Hmgh! Hmmgh ffhmmgh...!&quot; Ivex tries to say clearly flustered.

The wolf simply chuckles. Giving Ivex&#39;s sheath a squeeze just to hear him squirm, the wolf uses a finger to tease the panther&#39;s trapped member. He can feel how hard it tries to grow, but it can&#39;t. It won&#39;t be able to. That thought brings $name enough pleasure to make his cock throb inside the feline again.

This is what it feels like to be on top. Literally. And the panther brought this upon himself.

This and more.

It&#39;s time to mess with him a little more.

$name is fond of the good, old methods, and this seems to be extra effective on the mage.

Roughly taking hold of Ivex&#39;s sheath, the wolf&#39;s fingers start kneading and teasing it in a firmer manner.

&quot;Shmmfgh!&quot; Ivex growls, but though he seems like he wants to hide it, the effects on him are quite obvious. The feline groans, his member straining- &lt;b&gt;begging&lt;/b&gt; to grow hard to the wolf&#39;s stimulation, but it is unable to. The mage&#39;s own spell keeps it firmly stuck inside its sheath as if contained by unyielding metal.

$name takes advantage of that.

The wolf uses every trick in the book. He fondles the mage&#39;s balls, strokes his sheath, and does everything he can to inflict pleasure upon the mage. The way the panther squirms in frustration delights $name immensely. An act that would usually feel great, turned into pure frustration by the mage&#39;s own spell. The irony of it makes the wolf&#39;s own cock throb once in delight.

Despite Ivex&#39;s complaints, he keeps going. For a good while, the wolf continues to tease and pleasure the mage without him being able to enjoy. $name clearly feels how much the panther is dripping, how high his pleasure reaches, and he can read the signs. Soon enough, the panther is teetering at the edge of climax.

Yet, without proper stimulation and unable to even grow hard, he cannot achieve it. The panther squirms in perpetual frustration and the wolf keeps going. Teasing Ivex in that state feels even better.

It&#39;s only when the panther seems like he can barely breathe properly from all the pleasure, that the wolf decides to stop. He wipes his claws sticky with pre-cum on the panther&#39;s own fur and lets him catch his breath. Ivex pants and groans, clearly deeply frustrated and needier than ever.

His cock continues to strain to grow and fail.

Keeping Ivex&#39;s face against the ground and his ass raised, the wolf thrusts forward ever so slightly to keep his cock firmly stuck inside the mage. It still throbs, eager for the fucking to continue, but at the same time, feeling Ivex&#39;s ass clenching around his member as he is... &#39;tortured&#39; is also damn nice.

Holding himself like that, the wolf wonders, what to do to him next?

$name knows he could keep playing with the feline for a good while. Feeling his ass clench around his cock in this delightful way every time the panther is frustratingly close to cumming. But no. The wolf&#39;s knot demands it, and it&#39;s time to finish this.

No holding back. The wolf&#39;s lust is too strong and his instincts start speaking louder. There has been enough messing with the panther. It&#39;s time to finish it.

Ivex just yelps and mewls when the wolf pulls him up and grips him hard against his chest again. The smaller feline squirms, certainly knowing what&#39;s coming, but the wolf stops it with nothing but one threatening growl.

It&#39;s the ideal position. $name pulls his cock back from the panther&#39;s ass... then shoves it back in with a strong, powerful thrust that is enough to make him moan and Ivex grunt beneath him.

And then it begins.

No more holding back, no more keeping his lust in check. The burning fire within him calls for him to fuck, and fuck he will. The wolf growls louder as he speeds up, thrusting in and out of the panther&#39;s ass, letting the tightness of the panther&#39;s rear bring him back to the apex of his pleasure, to the point where he&#39;s close to cumming again. Pistoning in and out of the panther, all he can hear are Ivex&#39;s gasps as he spreads the feline open again and again with his large member. The wolf huffs. His own pleasure grows and grows until he can feel it.

The apex. That incoming climax... and with it, that burning need every wolf has to shove his knot into his bitch and claim it entirely.

With a stronger, brutish thrust, $name slams into the panther&#39;s rear, pressing his knot against his entrance and trying to shove it in. It doesn&#39;t go. He pulls back and shoves it in again. Like a battering ram, the wolf&#39;s knot forces itself against the wizard&#39;s rear, again and again, demanding entrance.

&quot;Ihmm wwhmmf FFHMFFH!!&quot; Ivex tries to yell through his gag, squirming and groaning without stop.

The wolf ignores it. He has fit his knot into many things in the past and he will fit it in again.

With brutish shove after brutish shove, the wolf&#39;s growling grows. His instincts demand something around his knot and he &lt;b&gt;will&lt;/b&gt; have it!

Putting more strength into his hips, $name pushes in one last time and, this time, he doesn&#39;t retreat, but rather forces forward, and then finally...

&quot;HMMMFGH!!&quot; Ivex yells.

It pops in.

$name lets out a loud moan of pure pleasure. His large knot forces its way past the feline&#39;s resistance and, after spreading him wider, settles itself inside, locking the wolf to his bitch as it should.

The pressure around his knot, the most sensitive spot of any wolf, is heavenly to him. It brings his pleasure to its highest point. All that fire, everything Ivex has inflicted upon him since the beginning culminates, gathering into a pleasure unlike any he has ever felt and translating to his cock.

It throbs, it pulses... and it shoots.

At the exact same time, Ivex moans below him. It seems to be too much for him. After all that time being edged, all the teasing, all the lust he was made to feel...

The wolf can feel how the panther&#39;s ass clenches hard around his cock. It feels amazing. $name has fucked men before and he knows that feeling. It is the feeling... of an orgasming male.

The wolf trails down with his paw to feel it. All the edging coupled with the wolf&#39;s knot shoved in and the way he keeps thrusting push Ivex past the point of no return as well... despite his condition.

Even through the chastity spell, even with his cock painfully trapped within his sheath, the wolf can feel the dribbling of seed from Ivex&#39;s forceful orgasm. The panther groans and grunts, the sounds he makes sounding more like ones of frustration than ones of pleasure. It must feel quite terrible to be forced to finish like that, without being able to grow hard and without stimulation, yet he does. With the wolf fucking him as hard as he does and after all that edging... he does.

The panther&#39;s climax dribbles down to the floor. The wolf&#39;s pleasure is only enhanced by that knowledge as he continues to fuck and enjoy his own pleasure.

Holding the mage tight to himself, the wolf feels the heavenly sensation of his climax overcoming him. His body is overwhelmed with pleasure and underneath him...

Ivex groans in distaste as he is filled with wolf seed.

The wolf feels absolute delight in feeling each throb of his cock depositing his spunk inside the hateful mage. His knot grows larger, achieving full size and locking his seed inside and them together.

$name doesn&#39;t care. Midway through his orgasm, he lets Ivex go. Again, the mage yelps as he hits the ground with his face, but his ass remains stuck to the wolf&#39;s crotch being filled to the brim with all of the wolf&#39;s seed, bolstered by his own arousal spells.

When it ends, the wolf&#39;s entire body feels lighter. A feeling of relief washes over him accompanied by a deep satisfaction. Seeing the mage panting and grunting beneath him, struggling to cope with his size inside him and flustered in humiliation after what all he has done is immensely satisfying.

This is it. $name has won, and Ivex is thoroughly defeated.

As he descends upon the aftermath of his blissful orgasm, the wolf still pants. Ivex stays down on the floor panting as well after the intense experience. He seems too tired to even complain or throw insults at the moment.

It will take some time for the wolf&#39;s knot to come down, but $name is not in a hurry.

The wolf spends his time locked with the feline to play with him some more. Watching him squirm and whine turns out to be extremely therapeutic. To &lt;&lt;print $name&gt;&gt;, it&#39;s almost as if all the humiliation he went through in the tower didn&#39;t happen. Almost.

Even though Ivex has managed to cum through his own chastity spell, it must have been quite unsatisfactory, because as soon as the wolf&#39;s fingers touch his sheath and tease it, the panther turns into a mewling puddle of frustration and despair again. His cock seems as eager to grow hard as always, and it doesn&#39;t take long to take him back to the edge of orgasm.

Playing around with the panther&#39;s sheath using his paw and a few of Ivex&#39;s spells is as fun as it was before.

His knot takes a long time to shrink. In fact, it barely does so, and that is also Ivex&#39;s fault for putting him through some crazy candle-based lust spell. After a while, the wolf is forced to just hold Ivex down by placing a paw on his back and pulling hard. The feline doesn&#39;t like that very much, but he doesn&#39;t get a say in it. With enough effort, the wolf&#39;s large knot finally pops out. The sight of his white seed dribbling down the back of the panther&#39;s balls also soothes the wolf&#39;s soul.

Wiping his hands, the wolf looks down at Ivex. Bound, gagged and without his gemstones, the once-powerful mage is nothing but a harmless kitty. It&#39;s time to fulfill the job the wolf came here to do and cash in the bounty for this dangerous mage.

$name steps towards him to pick him up. Ivex still squirms and complains, obviously still angry over having lost. He no longer gets a choice, though.

The wolf does. He wonders if Ivex has had enough punishment or if he should add a finishing touch to his reckoning. After all, it will be a few days&#39; journey back to the Wayward Adventurers Guild. Maybe adding something to... &lt;b&gt;entertain&lt;/b&gt; Ivex in the meantime would be fun as well.

Yeah... Ivex has certainly done enough to deserve an extra.

$name decides that, since Ivex&#39;s arrogance seems to know no bounds, he can deal with a little extra punishment during the trip back.

With a smirk, the wolf looks down at Ivex, who in turn glares daggers up at him, but is unable to say anything gagged as he is. Not breaking eye contact, the wolf shoves his paw into the gem pouch again and... pulls out the pink, lust spell gemstone.

&quot;HMMGH! Hmmghf hmmf!&quot; Ivex immediately tries to say, shaking his head.

$name ignores him. It takes little effort for the wolf to find an adequate piece of string and, with it and the gemstone in hand, he kneels next to the squirming feline. The wolf holds Ivex down on his back, forcing his legs to spread so he can work.

Ivex fights him at first, but the wolf&#39;s large paw grabs hold of his furry balls and gives them a squeeze. It&#39;s enough to make the panther groan in pain through the gag and daze him for long enough to let the wolf work.

Clutching the gemstone in hand, the wolf activates it. He presses the warm gemstone against Ivex&#39;s balls and, with the piece of string... ties the gemstone there, wrapping the string around the base of the feline&#39;s nuts and keeping the warm, lust-inducing gemstone tied against the panther&#39;s balls.

It&#39;s not until he starts feeling its effects again that Ivex moans and looks down. Realizing what was done, the panther shakes his head and yells a hundred different muffled complaints about it, but the wolf simply stands up and smirks.

The panther moans through his gag as the spell works on him continuously. His cock is quick to press hard against the invisible barrier surrounding his sheath and, soon enough, it is leaking all over again. That is how it is staying, though.

Leaving Ivex squirming on the floor, the wolf then prepares to grab his stuff to leave. It will be a long journey for the mage. When $name looks down, his own cock is still pulsing and dribbling as well. He does not know for how long Ivex&#39;s spell will keep affecting him, but, if it gets too bad...

$name just smiles. He has something he can fuck on the way if he needs to.

Lucky for the wolf, he manages to find a worn, old pair of pants in the farmhouse Ivex had made his base. They are far too short for him, but they will do, so that at least he&#39;s not naked.

Gathering what supplies he can, the wolf sets off with everything in hand: Ivex&#39;s tower inside the large gemstone, the pouch of magic gems and, most importantly, Ivex.

The journey back to the Wayward Adventurers Guild takes a few days. It could go quicker, but after the deeply distressing effort to capture the mage, $name is not exactly in a hurry to get there anymore. The wolf takes his sweet time recovering from everything he went through inside the mage&#39;s crazy tower, and basking in his success.

When he gets to the Guild, both the adventurers and officers there are deeply amused by the way $name delivers Ivex to them. After a thorough re-telling of what he went through and what he has in tow, the official mages in the Wayward Adventurers Guild take Ivex to a prison where his magic will be kept in check.

They also handle his tower. The wolf does not stick around to see it, but the rumors of the insane tower a mage possessed spread like wildfire. Apparently, the mages of the Guild had to go through an arduous, delicate process to save the over fifty people Ivex had trapped inside his tower. All of them males.

With a handsome amount of gold in his pocket, the wolf moves on. The life of an adventurer is like that. Ivex wasn&#39;t the first mage he had to fight and it won&#39;t be the last. The events of the tower stick inside &lt;&lt;print $name&gt;&gt;&#39;s mind, though, and they are enough to make him blush every now and then. He will make sure that such things never happen again.

Or, at least, he will try to.

&lt;span class=&quot;good-ending&quot;&gt;Ending: &lt;i&gt;Punishment&lt;/i&gt;&lt;/span&gt;

[[Return to the Archives|Archives]]</tw-passagedata><tw-passagedata pid="235" name="Credits" tags="noreturn" position="2600,700" size="100,100">&lt;&lt;sidebar-auto-stow&gt;&gt; \
&lt;&lt;link &quot;Return to the game&quot; $return&gt;&gt;&lt;&lt;/link&gt;&gt;\
\
&lt;h1&gt;Credits&lt;/h1&gt;\
The writing and development of this interactive story was made by me, [[Sleth|http://www.slethstories.com/]]. Big thanks and kuddos as well to Grayscale Wolf for providing thorough proofreading and numerous other code improvements.

The amazing artwork you see in the game, including the character art and the Mage&#39;s Tower logo, was done by commission by [[BlainWolf|https://twitter.com/Blain_Wolf]]. You can check out more of his stuff in his [[Twitter|https://twitter.com/Blain_Wolf]] or [[FurAffinity|https://www.furaffinity.net/user/blainwolf]] pages!

I&#39;d also like to give a special, personal thanks to [[Raus|https://twitter.com/rausmutt]] and [[MFarley|https://www.furaffinity.net/user/mfarley/]] for supporting this idea  and my writing in general, as well as helping me shape things up and polish them!

Not only that, but I&#39;d also like to extend my deepest gratitude to my patrons, who have been supporting me and my craft through the months it took to develop this interactive story! None of this would be possible without you all!

First and foremost, my patrons that have supported me in these last 4 months it took for me to develop, learn and finish this project:
\
&lt;b&gt;&lt;ul&gt;\
    &lt;li&gt;John Harris&lt;/li&gt;
    &lt;li&gt;Timba Saber&lt;/li&gt;
    &lt;li&gt;Kevin Deiderich&lt;/li&gt;
    &lt;li&gt;Gd &lt;/li&gt;
    &lt;li&gt;Rise&lt;/li&gt;
    &lt;li&gt;Bingturong&lt;/li&gt;
    &lt;li&gt;Laswer5&lt;/li&gt;
    &lt;li&gt;Sándor Bajkai&lt;/li&gt;
    &lt;li&gt;Sameer &lt;/li&gt;
    &lt;li&gt;wssbxj &lt;/li&gt;
    &lt;li&gt;Ian Meyers&lt;/li&gt;
    &lt;li&gt;Daniel Choi&lt;/li&gt;
    &lt;li&gt;Lathbalrog&lt;/li&gt;
    &lt;li&gt;Argentcoyote&lt;/li&gt;
    &lt;li&gt;Rin Ookami&lt;/li&gt;
    &lt;li&gt;xiaokiroz &lt;/li&gt;
    &lt;li&gt;Nigel Leiterman&lt;/li&gt;
    &lt;li&gt;keinok82562 &lt;/li&gt;
    &lt;li&gt;MagicMinnett&lt;/li&gt;
    &lt;li&gt;Ishiah &lt;/li&gt;
    &lt;li&gt;Snow Tastes Great&lt;/li&gt;
    &lt;li&gt;nikokarro&lt;/li&gt;
    &lt;li&gt;Nimrax&lt;/li&gt;
    &lt;li&gt;Maxwell&lt;/li&gt;
    &lt;li&gt;SASO_PRO&lt;/li&gt;
    &lt;li&gt;Lykron &lt;/li&gt;
    &lt;li&gt;Chris &lt;/li&gt;
    &lt;li&gt;AshfurtheBroken &lt;/li&gt;
    &lt;li&gt;Hyenatime &lt;/li&gt;
    &lt;li&gt;Michael &lt;/li&gt;
    &lt;li&gt;Chris Gordon&lt;/li&gt;
    &lt;li&gt;Pinecone&lt;/li&gt;
    &lt;li&gt;Guri Linus&lt;/li&gt;
    &lt;li&gt;Hyao&lt;/li&gt;
    &lt;li&gt;fancyhat &lt;/li&gt;
    &lt;li&gt;llama&lt;/li&gt;
    &lt;li&gt;Abraxas &lt;/li&gt;
    &lt;li&gt;Hollud &lt;/li&gt;
    &lt;li&gt;Lykos Bane&lt;/li&gt;
    &lt;li&gt;Rex Aurum&lt;/li&gt;
    &lt;li&gt;Martin Farley&lt;/li&gt;
    &lt;li&gt;Knight of the Dragon&lt;/li&gt;
    &lt;li&gt;Raus&lt;/li&gt;
&lt;/ul&gt;&lt;/b&gt;\
\
And, of course, also an honorable mention to everyone that has supported me and my writing in the these last years I have had my patreon going:
\
&lt;ul&gt;\
&lt;li&gt;John Harris&lt;/li&gt;
&lt;li&gt;Timba Saber&lt;/li&gt;
&lt;li&gt;Kevin Deiderich&lt;/li&gt;
&lt;li&gt;Hymne &lt;/li&gt;
&lt;li&gt;Gd &lt;/li&gt;
&lt;li&gt;Todd Billings&lt;/li&gt;
&lt;li&gt;Inkwa Seekwa&lt;/li&gt;
&lt;li&gt;SASO_PRO &lt;/li&gt;
&lt;li&gt;Rise&lt;/li&gt;
&lt;li&gt;Bingturong&lt;/li&gt;
&lt;li&gt;Laswer5&lt;/li&gt;
&lt;li&gt;Cyro &lt;/li&gt;
&lt;li&gt;Sándor Bajkai&lt;/li&gt;
&lt;li&gt;Sameer &lt;/li&gt;
&lt;li&gt;wssbxj &lt;/li&gt;
&lt;li&gt;Lathbalrog&lt;/li&gt;
&lt;li&gt;Ian Meyers&lt;/li&gt;
&lt;li&gt;Daniel Choi&lt;/li&gt;
&lt;li&gt;montywolf &lt;/li&gt;
&lt;li&gt;Ace Blue27&lt;/li&gt;
&lt;li&gt;Argentcoyote&lt;/li&gt;
&lt;li&gt;Andrew Wow&lt;/li&gt;
&lt;li&gt;Rin Ookami&lt;/li&gt;
&lt;li&gt;xiaokiroz &lt;/li&gt;
&lt;li&gt;Nigel Leiterman&lt;/li&gt;
&lt;li&gt;keinok82562 &lt;/li&gt;
&lt;li&gt;tiberius Rings&lt;/li&gt;
&lt;li&gt;StaticZeroes &lt;/li&gt;
&lt;li&gt;Yude&lt;/li&gt;
&lt;li&gt;MagicMinnett&lt;/li&gt;
&lt;li&gt;Ishiah &lt;/li&gt;
&lt;li&gt;Snow Tastes Great&lt;/li&gt;
&lt;li&gt;kingthecat&lt;/li&gt;
&lt;li&gt;nikokarro&lt;/li&gt;
&lt;li&gt;October Tiger&lt;/li&gt;
&lt;li&gt;kaerumchn&lt;/li&gt;
&lt;li&gt;Nimrax&lt;/li&gt;
&lt;li&gt;Typo &lt;/li&gt;
&lt;li&gt;Maxwell&lt;/li&gt;
&lt;li&gt;Didiji&lt;/li&gt;
&lt;li&gt;Lykron &lt;/li&gt;
&lt;li&gt;Chris &lt;/li&gt;
&lt;li&gt;Ferin &lt;/li&gt;
&lt;li&gt;Zero&lt;/li&gt;
&lt;li&gt;Cho &lt;/li&gt;
&lt;li&gt;AshfurtheBroken &lt;/li&gt;
&lt;li&gt;Bryan Rutkowski&lt;/li&gt;
&lt;li&gt;Hyenatime &lt;/li&gt;
&lt;li&gt;Jason Huchot&lt;/li&gt;
&lt;li&gt;Michael &lt;/li&gt;
&lt;li&gt;Chris Gordon&lt;/li&gt;
&lt;li&gt;superman &lt;/li&gt;
&lt;li&gt;Patrick Bossen&lt;/li&gt;
&lt;li&gt;Pinecone&lt;/li&gt;
&lt;li&gt;Zsisron Darkwater&lt;/li&gt;
&lt;li&gt;Guri Linus&lt;/li&gt;
&lt;li&gt;Hyao&lt;/li&gt;
&lt;li&gt;fancyhat &lt;/li&gt;
&lt;li&gt;llama&lt;/li&gt;
&lt;li&gt;Abraxas &lt;/li&gt;
&lt;li&gt;Joey Watts&lt;/li&gt;
&lt;li&gt;Hollud &lt;/li&gt;
&lt;li&gt;Lykos Bane&lt;/li&gt;
&lt;li&gt;Rex Aurum&lt;/li&gt;
&lt;li&gt;Mr Blackstone&lt;/li&gt;
&lt;li&gt;Martin Farley&lt;/li&gt;
&lt;li&gt;Raus&lt;/li&gt;
&lt;/ul&gt;\
\
Thank you so much!

&lt;&lt;link &quot;Return to the game&quot; $return&gt;&gt;&lt;&lt;/link&gt;&gt;</tw-passagedata><tw-passagedata pid="236" name="Choose Character" tags="" position="2500,325" size="100,100">&lt;i&gt;Choose Your Adventurer&lt;/i&gt;\

&lt;dl&gt;
&lt;dt&gt;Drekkar&lt;/dt&gt;
&lt;dd&gt;A seasoned fighter, a large wolf that takes pride in his strength. He goes by the name of Drekkar, with his older name being more complex and difficult to pronounce. Hailing from the less advanced wolven tribes from the north, Drekkar left his kind early and adapted well to the wider world. He&#39;s known among his friends at the Wayward Adventurers Guild as &quot;that crazy bastard who took down the Mad Wizard of Carcenvellathrop by punching him in the face&quot;. With a sword in hand, there&#39;s little Drekkar cannot accomplish. Now, however...

&lt;/dd&gt;

&lt;dt&gt;Nero&lt;/dt&gt;
&lt;dd&gt;A slender wolf, and unusually handsome for a mage. But he&#39;s always valued his mind more than his body. Nero is an unacknowledged son of one of Lady Garloch&#39;s nephews (or so he says). He&#39;s equally at ease covering for absent professors at the prestigious Windbone Magic Academy as he is when singing with drunken sailors at a Seaside tavern. His talent for magic has turned out to be very useful in his career of discreetly handling difficult problems for patrons who have way more money than sense. But this time...
&lt;/dd&gt;&lt;/dl&gt;\</tw-passagedata><tw-passagedata pid="237" name="Content Warning" tags="" position="2625,75" size="100,100">This interactive story contains content of an adult nature. If you are under the age of 18, please exit now.

Moreover, this story contains elements that depict dubious or lack of consent, as well as other fetish sexual topics such as mind control, CBT, chastity, and others. If these themes make you uncomfortable or are not enjoyable for you, proceed only at your own discretion.

&lt;div style=&#39;float: right;&#39;&gt;\
&lt;&lt;button Proceed&gt;&gt;
    &lt;&lt;run MT.mdSet(&quot;passedContentWarning&quot;, true)&gt;&gt;
    &lt;&lt;run Dialog.close()&gt;&gt;
    &lt;&lt;goto [[Bound]]&gt;&gt;
&lt;&lt;/button&gt;&gt;\
&lt;/div&gt;\</tw-passagedata><tw-passagedata pid="238" name="g0boot Metadata" tags="" position="2125,275" size="100,100">&lt;&lt;script&gt;&gt;

/*----------------
 * This module manages game metadata.
 * It&#39;s mostly a wrapper around SugarCube&#39;s metadata, with:
 * - &quot;clear metadata&quot; that preserves keys marked PRESERVED.
 * - saving and loading keys marked SAVEDs to saved games.
 * - copying metadata to State.variables for easy access and debug tooling.
 *
 * Note, the values copied to State.variables are writable,
 * but writing them *does not* write to metadata.
 * Persisting a value needs to use `MD.mdSet`.
 */

// metadata types
const UNSAVED = 1;
const SAVED = 2;
const PRESERVED = 3;

/** metadata key -&gt; metadata type. */
const knownKeys = {};

/** If `key` is not known, reports a warning and returns true. */
function warnUnknownKey(key) {
  if (!(key in knownKeys)) {
    MT.diag(`Warning: unknown metadata key ${key}`);
    return true;
  }
  return false;
}

/** If `key` is already known, reports a warning and returns true. */
function warnKnownKey(key) {
  if (key in knownKeys) {
    MT.diag(`Warning: metadata key ${key} already exists.`);
    return true;
  }
  return false;
}

/**
 * Defines `key` to be UNSAVED metadata, which means:
 * - it persists across game resets.
 * - it doesn&#39;t get stored in saved games.
 * - it gets deleted by &quot;clear metadata&quot;.
*/
MT.mdDefUnsaved = (key) =&gt; {
  if (warnKnownKey(key)) return;
  knownKeys[key] = UNSAVED;
};

/**
 * Defines `key` to be SAVED metadata, which means;
 * - it persists across game resets.
 * - it gets stored in saved games.
 * - loading a saved game will set its value from the saved game,
 *   but only if it isn&#39;t already set.
 * - it gets deleted by &quot;clear metadata&quot;.
 */
MT.mdDefSaved = (key) =&gt; {
  if (warnKnownKey(key)) return;
  knownKeys[key] = SAVED;
};

/**
 * Defines `key` to be PRESERVED metadata, which means:
 * - it persists across game resets.
 * - it doesn&#39;t get stored in saved games.
 * - it doesn&#39;t get deleted by &quot;clear metadata&quot;.
 */
MT.mdDefPreserved = (key) =&gt; {
  if (warnKnownKey(key)) return;
  knownKeys[key] = PRESERVED;
};

/** True if `key` is a known metadata key. */
MT.mdKnown = (key) =&gt; knownKeys[key] != null;

/**
 * Returns the value of metadata `key`.
 *
 * Note, each call will always decompress and deserialize
 * all metadata from localStorage, so this is somewhat expensive.
 *
 * If you don&#39;t need the authoritative value, you can read the
 * copy in State.variables (which might be out-of-date if the
 * value was changed in another tab).
 *
 * If you want more than a few authoritative values at a time,
 * use `MT.mdEntries` or `MT.mdRecord`.
 */
MT.mdUncachedGet = (key) =&gt; {
  warnUnknownKey(key);
  return State.metadata.get(key);
};

/**
 * Sets metadata `key` to `value`. Any false-y value will delete the key.
 *
 * Note, each call will always decompress and deserialize
 * all metadata from localStorage, then reserialize and recompress
 * back to localStorage. So this is very expensive, and SugarCube
 * doesn&#39;t give us a way to batch multiple set operations
 * (other than bypassing SugarCube and doing it ourselves.)
 */
MT.mdSet = (key, value) =&gt; {
  warnUnknownKey(key);
  if (value) {
    State.metadata.set(key, value);
    State.variables[key] = value;
  } else {
    State.metadata.delete(key);
    delete State.variables[key];
  }
};

/** Returns an array of all [key, value] metadata entries. */
MT.mdEntries = () =&gt; {
  return State.metadata.entries() || [];
};

/** Returns an object-map of all metadata keys and values. */
MT.mdRecord = () =&gt; {
  return Object.fromEntries(MT.mdEntries());
};

/** Deletes all metadata, except for PRESERVED keys and unknown keys. */
MT.mdClear = () =&gt; {
  const preserve = [];
  const entries = State.metadata.entries() || [];
  for (const [key, value] of entries) {
    warnUnknownKey(key);
    if (knownKeys[key] === PRESERVED) {
      preserve.push([key, value]);
    }
  }
  State.metadata.clear();
  for (const [key, value] of preserve) {
    State.metadata.set(key, value);
  }
};

/** Merges metadata from `save` into current metadata. */
function readFromSave(save) {
  if (!save.metadata) return;
  const current = MT.mdRecord();
  for (const [key, value] of Object.entries(save.metadata)) {
    if (value &amp;&amp; knownKeys[key] === SAVED &amp;&amp; !current[key]) {
      State.metadata.set(key, value);
      // XXX announce the unlock
    }
  }
  copyToVars();
}

/** Adds current metadata to `save`. */
function writeToSave(save) {
  save.metadata ||= {};
  const entries = State.metadata.entries() || [];
  for (const [key, value] of entries) {
    if (knownKeys[key] === SAVED) {
      save.metadata[key] = value;
    }
  }
}

/** Copies current metadata to State.variables */
function copyToVars() {
  const U = MT.untracedVars ? MT.untracedVars() : State.variables;
  const meta = MT.mdRecord();
  // need to do all known keys, not just set keys
  for (const key of Object.keys(knownKeys)) {
    if (meta[key]) {
      U[key] = meta[key];
    } else {
      delete U[key];
    }
  }
};

/** Migrates existing State.variables to metadata */
function migrateFromVars() {
  const U = MT.untracedVars ? MT.untracedVars() : State.variables;
  const meta = MT.mdRecord();
  for (const key of Object.keys(knownKeys)) {
    if (U[key] &amp;&amp; U[key] !== meta[key]) {
      MT.mdSet(key, U[key]);
    }
  }
}

function mdInit() {
  migrateFromVars();
  Save.onLoad.add(readFromSave);
  Save.onSave.add(writeToSave);
  $(document).on(&quot;:passageinit&quot;, copyToVars);
}

mdInit();
&lt;&lt;/script&gt;&gt;</tw-passagedata><tw-passagedata pid="239" name="g1m Archives Forget" tags="" position="2550,850" size="100,100">&lt;&lt;nobr&gt;&gt;
Are you sure you want to lock all the Archives?

&lt;br&gt;&lt;br&gt;
You will have to play through each ending to unlock them again.

&lt;br&gt;&lt;br&gt;
&lt;div&gt;
  &lt;&lt;button &quot;Lock Archives&quot;&gt;&gt;
    &lt;&lt;script&gt;&gt;
      Dialog.close();
      MT.mdClear();
    &lt;&lt;/script&gt;&gt;
    &lt;&lt;goto `State.passage`&gt;&gt;
  &lt;&lt;/button&gt;&gt;
  &lt;&lt;button &quot;Cancel&quot;&gt;&gt;
    &lt;&lt;script&gt;&gt;
      Dialog.close();
    &lt;&lt;/script&gt;&gt;
  &lt;&lt;/button&gt;&gt;
&lt;/div&gt;
&lt;&lt;/nobr&gt;&gt;\</tw-passagedata><tw-passagedata pid="240" name="g0init Saved Games" tags="" position="2250,275" size="100,100">&lt;&lt;script&gt;&gt;

/** Fix up the in-browser saved game title. */
Config.passages.descriptions = function() {

  // SugarCube sometimes gets a description for a passage other than
  // the current one. In that case, use its default excerpt.
  if (this.title !== State.passage) return false;

  // For the current passage, use the rendered text, not the source text.
  const doc = $(&quot;.passage&quot;).clone();
  doc.find(&quot;style, script, .meta-text&quot;).remove();
  doc.find(&quot;br&quot;).replaceWith(&quot; &quot;);
  const text = doc.text();
  const words = text.trim().split(/\s+/);

  let excerpt = words.slice(0, 10).join(&quot; &quot;);

  // Title screen has no text
  if (excerpt === &quot;&quot;) excerpt = State.passage;

  // add unlock count
  const [unlocked, total] = countUnlocks();
  if (unlocked &gt; 0) {
    excerpt = `${unlocked}\uD83D\uDD13 ${excerpt}`;
  }

  console.log({excerpt});
  return excerpt;
};

/** Intercept file save and fix filename */
{
  // sugarcube&#39;s default save UI doesn&#39;t provide any way to change the
  // savefile name, and all its methods are readonly. but it uses a saveAs()
  // function that can be hooked. (the alternative is to re-implement or
  // copy the entire save UI just to tweak the savefile name.)

  const origSaveAs = saveAs;
  saveAs = (blob, name, opt) =&gt; {
    // add unlock count to name
    const [unlocked, total] = countUnlocks();
    if (unlocked &gt; 0) {
      name = name.replace(/-\d/, `-${unlocked}u$&amp;`);
    }
    return origSaveAs(blob, name, opt);
  };
}

function countUnlocks() {
  const meta = MT.mdRecord();
  let num = 0;
  let total = 0;
  const add = (keys) =&gt; {
    total += keys.length;
    for (const k of keys) {
      if (meta[k]) num++;
    }
  };
  add(MT.drekkarEndings);
  return [num, total];
}

&lt;&lt;/script&gt;&gt;</tw-passagedata></tw-storydata>
	<script id="script-sugarcube" type="text/javascript">
	/*! SugarCube JS */
	if(document.documentElement.getAttribute("data-init")==="loading"){(function(window,document,jQuery,undefined){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}var errorPrologRegExp=/^(?:(?:uncaught\s+(?:exception:\s+)?)?\w*(?:error|exception|_err):\s+)+/i,Alert=function(){function mesg(where,error,isFatal,isUncaught){var mesg="Error",nice="A".concat(isFatal?" fatal":"n"," error has occurred.");nice+=isFatal?" Aborting.":" You may be able to continue, but some parts may not work properly.";var isObject=null!==error&&"object"===_typeof(error),what=(isObject&&"message"in error?String(error.message).replace(errorPrologRegExp,""):String(error)).trim()||"unknown error";null!=where&&(mesg+=" [".concat(where,"]")),mesg+=": ".concat(what,"."),isObject&&"stack"in error&&(mesg+="\n\nStack Trace:\n".concat(error.stack)),mesg&&(nice+="\n\n".concat(mesg)),isUncaught||console[isFatal?"error":"warn"](mesg),window.alert(nice)}var origOnError;return origOnError=window.onerror,window.onerror=function(what,source,lineNum,colNum,error){"complete"===document.readyState?mesg(null,null!=error?error:what,!1,!0):(mesg(null,null!=error?error:what,!0,!0),window.onerror=origOnError,"function"==typeof window.onerror&&window.onerror.apply(this,arguments))},Object.freeze(Object.defineProperties({},{error:{value:function(where,error){mesg(where,error)}},fatal:{value:function(where,error){mesg(where,error,!0)}}}))}(),Patterns=(wsMap=new Map([[" ","\\u0020"],["\f","\\f"],["\n","\\n"],["\r","\\r"],["\t","\\t"],["\v","\\v"],[" ","\\u00a0"],[" ","\\u1680"],["᠎","\\u180e"],[" ","\\u2000"],[" ","\\u2001"],[" ","\\u2002"],[" ","\\u2003"],[" ","\\u2004"],[" ","\\u2005"],[" ","\\u2006"],[" ","\\u2007"],[" ","\\u2008"],[" ","\\u2009"],[" ","\\u200a"],["\u2028","\\u2028"],["\u2029","\\u2029"],[" ","\\u202f"],[" ","\\u205f"],["　","\\u3000"],["\ufeff","\\ufeff"]]),wsRe=/^\s$/,missing="",wsMap.forEach((function(pat,char){wsRe.test(char)||(missing+=pat)})),space=missing?"[\\s".concat(missing,"]"):"\\s",spaceNoTerminator="[\\u0020\\f\\t\\v\\u00a0\\u1680\\u180e\\u2000-\\u200a\\u202f\\u205f\\u3000\\ufeff]",notSpace="\\s"===space?"\\S":space.replace(/^\[/,"[^"),anyChar="(?:.|".concat("[\\n\\r\\u2028\\u2029]",")"),anyLetter="[0-9A-Z_a-z\\-\\u00c0-\\u00d6\\u00d8-\\u00f6\\u00f8-\\u00ff\\u0150\\u0170\\u0151\\u0171]",anyLetterStrict=anyLetter.replace("\\-",""),identifier="".concat("[$A-Z_a-z]").concat("[$0-9A-Z_a-z]","*"),variable="[$_]"+identifier,htmlTagName="[A-Za-z](?:".concat(cENChar="(?:[\\x2D.0-9A-Z_a-z\\xB7\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u037D\\u037F-\\u1FFF\\u200C\\u200D\\u203F\\u2040\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD]|[\\uD800-\\uDB7F][\\uDC00-\\uDFFF])","*-").concat(cENChar,"*|[0-9A-Za-z]*)"),twStyle="(".concat(anyLetter,"+)\\(([^\\)\\|\\n]+)\\):"),cssStyle="".concat(spaceNoTerminator,"*(").concat(anyLetter,"+)").concat(spaceNoTerminator,"*:([^;\\|\\n]+);"),idOrClass="".concat(spaceNoTerminator,"*((?:").concat("[#.]").concat(anyLetter,"+").concat(spaceNoTerminator,"*)+);"),inlineCss="".concat(twStyle,"|").concat(cssStyle,"|").concat(idOrClass),Object.freeze({space:space,spaceNoTerminator:spaceNoTerminator,lineTerminator:"[\\n\\r\\u2028\\u2029]",notSpace:notSpace,anyChar:anyChar,anyLetter:anyLetter,anyLetterStrict:anyLetterStrict,identifierFirstChar:"[$A-Z_a-z]",identifierNextChar:"[$0-9A-Z_a-z]",identifier:identifier,variableSigil:"[$_]",variable:variable,macroName:"[A-Za-z][\\w-]*|[=-]",templateName:"[A-Za-z][\\w-]*",htmlTagName:htmlTagName,cssIdOrClassSigil:"[#.]",cssImage:"\\[[<>]?[Ii][Mm][Gg]\\[(?:\\s|\\S)*?\\]\\]+",inlineCss:inlineCss,url:"(?:file|https?|mailto|ftp|javascript|irc|news|data):[^\\s'\"]+"})),wsMap,wsRe,missing,cENChar,twStyle,cssStyle,idOrClass,space,spaceNoTerminator,notSpace,anyChar,anyLetter,anyLetterStrict,identifier,variable,htmlTagName,inlineCss;!function(){var startWSRe,endWSRe,_trimString=(startWSRe=new RegExp("^".concat(Patterns.space).concat(Patterns.space,"*")),endWSRe=new RegExp("".concat(Patterns.space).concat(Patterns.space,"*$")),function(str,where){var val=String(str);if(!val)return val;switch(where){case"start":return startWSRe.test(val)?val.replace(startWSRe,""):val;case"end":return endWSRe.test(val)?val.replace(endWSRe,""):val;default:throw new Error('_trimString called with incorrect where parameter value: "'.concat(where,'"'))}});function _createPadString(length,padding){var targetLength=Number.parseInt(length,10)||0;if(targetLength<1)return"";var padString=void 0===padding?"":String(padding);for(""===padString&&(padString=" ");padString.length<targetLength;){var curPadLength=padString.length,remainingLength=targetLength-curPadLength;padString+=curPadLength>remainingLength?padString.slice(0,remainingLength):padString}return padString.length>targetLength&&(padString=padString.slice(0,targetLength)),padString}Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,writable:!0,value:function flat(){if(null==this)throw new TypeError("Array.prototype.flat called on null or undefined");var depth=0===arguments.length?1:Number(arguments[0])||0;return depth<1?Array.prototype.slice.call(this):Array.prototype.reduce.call(this,(function(acc,cur){return cur instanceof Array?acc.push.apply(acc,_toConsumableArray(flat.call(cur,depth-1))):acc.push(cur),acc}),[])}}),Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.flatMap called on null or undefined");return Array.prototype.map.apply(this,arguments).flat()}}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.includes called on null or undefined");if(0===arguments.length)return!1;var length=this.length>>>0;if(0===length)return!1;var needle=arguments[0],i=Number(arguments[1])||0;for(i<0&&(i=Math.max(0,length+i));i<length;++i){var value=this[i];if(value===needle||value!=value&&needle!=needle)return!0}return!1}}),Object.entries||Object.defineProperty(Object,"entries",{configurable:!0,writable:!0,value:function(obj){if("object"!==_typeof(obj)||null===obj)throw new TypeError("Object.entries object parameter must be an object");return Object.keys(obj).map((function(key){return[key,obj[key]]}))}}),Object.fromEntries||Object.defineProperty(Object,"fromEntries",{configurable:!0,writable:!0,value:function(iter){return Array.from(iter).reduce((function(acc,pair){if(Object(pair)!==pair)throw new TypeError("Object.fromEntries iterable parameter must yield objects");return pair[0]in acc?Object.defineProperty(acc,pair[0],{configurable:!0,enumerable:!0,writable:!0,value:pair[1]}):acc[pair[0]]=pair[1],acc}),{})}}),Object.getOwnPropertyDescriptors||Object.defineProperty(Object,"getOwnPropertyDescriptors",{configurable:!0,writable:!0,value:function(obj){if(null==obj)throw new TypeError("Object.getOwnPropertyDescriptors object parameter is null or undefined");var O=Object(obj);return Reflect.ownKeys(O).reduce((function(acc,key){var desc=Object.getOwnPropertyDescriptor(O,key);return void 0!==desc&&(key in acc?Object.defineProperty(acc,key,{configurable:!0,enumerable:!0,writable:!0,value:desc}):acc[key]=desc),acc}),{})}}),Object.values||Object.defineProperty(Object,"values",{configurable:!0,writable:!0,value:function(obj){if("object"!==_typeof(obj)||null===obj)throw new TypeError("Object.values object parameter must be an object");return Object.keys(obj).map((function(key){return obj[key]}))}}),String.prototype.padStart||Object.defineProperty(String.prototype,"padStart",{configurable:!0,writable:!0,value:function(length,padding){if(null==this)throw new TypeError("String.prototype.padStart called on null or undefined");var baseString=String(this),baseLength=baseString.length,targetLength=Number.parseInt(length,10);return targetLength<=baseLength?baseString:_createPadString(targetLength-baseLength,padding)+baseString}}),String.prototype.padEnd||Object.defineProperty(String.prototype,"padEnd",{configurable:!0,writable:!0,value:function(length,padding){if(null==this)throw new TypeError("String.prototype.padEnd called on null or undefined");var baseString=String(this),baseLength=baseString.length,targetLength=Number.parseInt(length,10);return targetLength<=baseLength?baseString:baseString+_createPadString(targetLength-baseLength,padding)}}),String.prototype.trimStart||Object.defineProperty(String.prototype,"trimStart",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.trimStart called on null or undefined");return _trimString(this,"start")}}),String.prototype.trimLeft||Object.defineProperty(String.prototype,"trimLeft",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.trimLeft called on null or undefined");return _trimString(this,"start")}}),String.prototype.trimEnd||Object.defineProperty(String.prototype,"trimEnd",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.trimEnd called on null or undefined");return _trimString(this,"end")}}),String.prototype.trimRight||Object.defineProperty(String.prototype,"trimRight",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.trimRight called on null or undefined");return _trimString(this,"end")}})}(),function(){var _nativeMathRandom=Math.random,_regExpMetaCharsRe,_hasRegExpMetaCharsRe,_formatRegExp,_hasFormatRegExp;function _random(){var min,max;switch(arguments.length){case 0:throw new Error("_random called with insufficient parameters");case 1:min=0,max=arguments[0];break;default:min=arguments[0],max=arguments[1]}if(min>max){var _ref=[max,min];min=_ref[0],max=_ref[1]}return Math.floor(_nativeMathRandom()*(max-min+1))+min}function _randomIndex(length,boundsArgs){var min,max;switch(boundsArgs.length){case 1:min=0,max=length-1;break;case 2:min=0,max=Math.trunc(boundsArgs[1]);break;default:min=Math.trunc(boundsArgs[1]),max=Math.trunc(boundsArgs[2])}return Number.isNaN(min)?min=0:!Number.isFinite(min)||min>=length?min=length-1:min<0&&(min=length+min)<0&&(min=0),Number.isNaN(max)?max=0:(!Number.isFinite(max)||max>=length||max<0&&(max=length+max)<0)&&(max=length-1),_random(min,max)}function _getCodePointStartAndEnd(str,pos){var code=str.charCodeAt(pos);if(Number.isNaN(code))return{char:"",start:-1,end:-1};if(code<55296||code>57343)return{char:str.charAt(pos),start:pos,end:pos};if(code>=55296&&code<=56319){var nextPos=pos+1;if(nextPos>=str.length)throw new Error("high surrogate without trailing low surrogate");var nextCode=str.charCodeAt(nextPos);if(nextCode<56320||nextCode>57343)throw new Error("high surrogate without trailing low surrogate");return{char:str.charAt(pos)+str.charAt(nextPos),start:pos,end:nextPos}}if(0===pos)throw new Error("low surrogate without leading high surrogate");var prevPos=pos-1,prevCode=str.charCodeAt(prevPos);if(prevCode<55296||prevCode>56319)throw new Error("low surrogate without leading high surrogate");return{char:str.charAt(prevPos)+str.charAt(pos),start:prevPos,end:pos}}Object.defineProperty(Array,"random",{configurable:!0,writable:!0,value:function(array){if("object"!==_typeof(array)||null===array||!Object.prototype.hasOwnProperty.call(array,"length"))throw new TypeError("Array.random array parameter must be an array or array-lke object");var length=array.length>>>0;if(0!==length){var index=0===arguments.length?_random(0,length-1):_randomIndex(length,Array.prototype.slice.call(arguments,1));return array[index]}}}),Object.defineProperty(Array.prototype,"concatUnique",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.concatUnique called on null or undefined");var result=Array.from(this);if(0===arguments.length)return result;var items=Array.prototype.reduce.call(arguments,(function(prev,cur){return prev.concat(cur)}),[]),addSize=items.length;if(0===addSize)return result;for(var indexOf=Array.prototype.indexOf,push=Array.prototype.push,i=0;i<addSize;++i){var value=items[i];-1===indexOf.call(result,value)&&push.call(result,value)}return result}}),Object.defineProperty(Array.prototype,"count",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.count called on null or undefined");for(var indexOf=Array.prototype.indexOf,needle=arguments[0],pos=Number(arguments[1])||0,count=0;-1!==(pos=indexOf.call(this,needle,pos));)++count,++pos;return count}}),Object.defineProperty(Array.prototype,"countWith",{configurable:!0,writable:!0,value:function(predicate,thisArg){if(null==this)throw new TypeError("Array.prototype.countWith called on null or undefined");if("function"!=typeof predicate)throw new Error("Array.prototype.countWith predicate parameter must be a function");var length=this.length>>>0;if(0===length)return 0;for(var count=0,i=0;i<length;++i)predicate.call(thisArg,this[i],i,this)&&++count;return count}}),Object.defineProperty(Array.prototype,"delete",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.delete called on null or undefined");if(0===arguments.length)return[];var length=this.length>>>0;if(0===length)return[];for(var needles=Array.prototype.concat.apply([],arguments),needlesLength=needles.length,indices=[],i=0;i<length;++i)for(var value=this[i],j=0;j<needlesLength;++j){var needle=needles[j];if(value===needle||value!=value&&needle!=needle){indices.push(i);break}}for(var result=[],_i=0,iend=indices.length;_i<iend;++_i)result[_i]=this[indices[_i]];for(var splice=Array.prototype.splice,_i2=indices.length-1;_i2>=0;--_i2)splice.call(this,indices[_i2],1);return result}}),Object.defineProperty(Array.prototype,"deleteAt",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.deleteAt called on null or undefined");if(0===arguments.length)return[];var length=this.length>>>0;if(0===length)return[];for(var splice=Array.prototype.splice,cpyIndices=_toConsumableArray(new Set(Array.prototype.concat.apply([],arguments).map((function(x){return x<0?Math.max(0,length+x):x}))).values()),delIndices=_toConsumableArray(cpyIndices).sort((function(a,b){return b-a})),result=[],i=0,iend=cpyIndices.length;i<iend;++i)result[i]=this[cpyIndices[i]];for(var _i3=0,_iend=delIndices.length;_i3<_iend;++_i3)splice.call(this,delIndices[_i3],1);return result}}),Object.defineProperty(Array.prototype,"deleteWith",{configurable:!0,writable:!0,value:function(predicate,thisArg){if(null==this)throw new TypeError("Array.prototype.deleteWith called on null or undefined");if("function"!=typeof predicate)throw new Error("Array.prototype.deleteWith predicate parameter must be a function");var length=this.length>>>0;if(0===length)return[];for(var splice=Array.prototype.splice,indices=[],result=[],i=0;i<length;++i)predicate.call(thisArg,this[i],i,this)&&(result.push(this[i]),indices.push(i));for(var _i4=indices.length-1;_i4>=0;--_i4)splice.call(this,indices[_i4],1);return result}}),Object.defineProperty(Array.prototype,"first",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.first called on null or undefined");if(0!==this.length>>>0)return this[0]}}),Object.defineProperty(Array.prototype,"includesAll",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.includesAll called on null or undefined");if(1===arguments.length)return Array.isArray(arguments[0])?Array.prototype.includesAll.apply(this,arguments[0]):Array.prototype.includes.apply(this,arguments);for(var i=0,iend=arguments.length;i<iend;++i)if(!Array.prototype.some.call(this,(function(val){return val===this.val||val!=val&&this.val!=this.val}),{val:arguments[i]}))return!1;return!0}}),Object.defineProperty(Array.prototype,"includesAny",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.includesAny called on null or undefined");if(1===arguments.length)return Array.isArray(arguments[0])?Array.prototype.includesAny.apply(this,arguments[0]):Array.prototype.includes.apply(this,arguments);for(var i=0,iend=arguments.length;i<iend;++i)if(Array.prototype.some.call(this,(function(val){return val===this.val||val!=val&&this.val!=this.val}),{val:arguments[i]}))return!0;return!1}}),Object.defineProperty(Array.prototype,"last",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.last called on null or undefined");var length=this.length>>>0;if(0!==length)return this[length-1]}}),Object.defineProperty(Array.prototype,"pluck",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.pluck called on null or undefined");var length=this.length>>>0;if(0!==length){var index=0===arguments.length?_random(0,length-1):_randomIndex(length,Array.prototype.slice.call(arguments));return Array.prototype.splice.call(this,index,1)[0]}}}),Object.defineProperty(Array.prototype,"pluckMany",{configurable:!0,writable:!0,value:function(wantSize){if(null==this)throw new TypeError("Array.prototype.pluckMany called on null or undefined");var length=this.length>>>0;if(0===length)return[];var want=Math.trunc(wantSize);if(!Number.isInteger(want))throw new Error("Array.prototype.pluckMany want parameter must be an integer");if(want<1)return[];want>length&&(want=length);var splice=Array.prototype.splice,result=[],max=length-1;do{result.push(splice.call(this,_random(0,max--),1)[0])}while(result.length<want);return result}}),Object.defineProperty(Array.prototype,"pushUnique",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.pushUnique called on null or undefined");var addSize=arguments.length;if(0===addSize)return this.length>>>0;for(var indexOf=Array.prototype.indexOf,push=Array.prototype.push,i=0;i<addSize;++i){var value=arguments[i];-1===indexOf.call(this,value)&&push.call(this,value)}return this.length>>>0}}),Object.defineProperty(Array.prototype,"random",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.random called on null or undefined");var length=this.length>>>0;if(0!==length){var index=0===arguments.length?_random(0,length-1):_randomIndex(length,Array.prototype.slice.call(arguments));return this[index]}}}),Object.defineProperty(Array.prototype,"randomMany",{configurable:!0,writable:!0,value:function(wantSize){if(null==this)throw new TypeError("Array.prototype.randomMany called on null or undefined");var length=this.length>>>0;if(0===length)return[];var want=Math.trunc(wantSize);if(!Number.isInteger(want))throw new Error("Array.prototype.randomMany want parameter must be an integer");if(want<1)return[];want>length&&(want=length);var picked=new Map,result=[],max=length-1;do{var i=void 0;do{i=_random(0,max)}while(picked.has(i));picked.set(i,!0),result.push(this[i])}while(result.length<want);return result}}),Object.defineProperty(Array.prototype,"shuffle",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.shuffle called on null or undefined");var length=this.length>>>0;if(0===length)return this;for(var i=length-1;i>0;--i){var j=Math.floor(_nativeMathRandom()*(i+1));if(i!==j){var swap=this[i];this[i]=this[j],this[j]=swap}}return this}}),Object.defineProperty(Array.prototype,"unshiftUnique",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.unshiftUnique called on null or undefined");var addSize=arguments.length;if(0===addSize)return this.length>>>0;for(var indexOf=Array.prototype.indexOf,unshift=Array.prototype.unshift,i=0;i<addSize;++i){var value=arguments[i];-1===indexOf.call(this,value)&&unshift.call(this,value)}return this.length>>>0}}),Object.defineProperty(Function.prototype,"partial",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Function.prototype.partial called on null or undefined");var slice=Array.prototype.slice,fn=this,bound=slice.call(arguments,0);return function(){for(var applied=[],argc=0,i=0;i<bound.length;++i)applied.push(bound[i]===undefined?arguments[argc++]:bound[i]);return fn.apply(this,applied.concat(slice.call(arguments,argc)))}}}),Object.defineProperty(Math,"clamp",{configurable:!0,writable:!0,value:function(num,min,max){var value=Number(num);return Number.isNaN(value)?NaN:value.clamp(min,max)}}),Object.defineProperty(Math,"easeInOut",{configurable:!0,writable:!0,value:function(num){return 1-(Math.cos(Number(num)*Math.PI)+1)/2}}),Object.defineProperty(Number.prototype,"clamp",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Number.prototype.clamp called on null or undefined");if(2!==arguments.length)throw new Error("Number.prototype.clamp called with an incorrect number of parameters");var min=Number(arguments[0]),max=Number(arguments[1]);if(min>max){var _ref2=[max,min];min=_ref2[0],max=_ref2[1]}return Math.min(Math.max(this,min),max)}}),RegExp.escape||(_regExpMetaCharsRe=/[\\^$*+?.()|[\]{}]/g,_hasRegExpMetaCharsRe=new RegExp(_regExpMetaCharsRe.source),Object.defineProperty(RegExp,"escape",{configurable:!0,writable:!0,value:function(str){var val=String(str);return val&&_hasRegExpMetaCharsRe.test(val)?val.replace(_regExpMetaCharsRe,"\\$&"):val}})),_formatRegExp=/{(\d+)(?:,([+-]?\d+))?}/g,_hasFormatRegExp=new RegExp(_formatRegExp.source),Object.defineProperty(String,"format",{configurable:!0,writable:!0,value:function(format){function padString(str,align,pad){if(!align)return str;var plen=Math.abs(align)-str.length;if(plen<1)return str;var padding=String(pad).repeat(plen);return align<0?str+padding:padding+str}if(arguments.length<2)return 0===arguments.length?"":format;var args=2===arguments.length&&Array.isArray(arguments[1])?_toConsumableArray(arguments[1]):Array.prototype.slice.call(arguments,1);return 0===args.length?format:_hasFormatRegExp.test(format)?(_formatRegExp.lastIndex=0,format.replace(_formatRegExp,(function(match,index,align){var retval=args[index];if(null==retval)return"";for(;"function"==typeof retval;)retval=retval();switch(_typeof(retval)){case"string":break;case"object":retval=JSON.stringify(retval);break;default:retval=String(retval)}return padString(retval,align?Number.parseInt(align,10):0," ")}))):format}}),Object.defineProperty(String.prototype,"contains",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.contains called on null or undefined");return-1!==String.prototype.indexOf.apply(this,arguments)}}),Object.defineProperty(String.prototype,"count",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.count called on null or undefined");var needle=String(arguments[0]||"");if(""===needle)return 0;for(var indexOf=String.prototype.indexOf,step=needle.length,pos=Number(arguments[1])||0,count=0;-1!==(pos=indexOf.call(this,needle,pos));)++count,pos+=step;return count}}),Object.defineProperty(String.prototype,"first",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.first called on null or undefined");return _getCodePointStartAndEnd(String(this),0).char}}),Object.defineProperty(String.prototype,"last",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.last called on null or undefined");var str=String(this);return _getCodePointStartAndEnd(str,str.length-1).char}}),Object.defineProperty(String.prototype,"splice",{configurable:!0,writable:!0,value:function(startAt,delCount,replacement){if(null==this)throw new TypeError("String.prototype.splice called on null or undefined");var length=this.length>>>0;if(0===length)return"";var start=Number(startAt);Number.isSafeInteger(start)?start<0&&(start+=length)<0&&(start=0):start=0,start>length&&(start=length);var count=Number(delCount);(!Number.isSafeInteger(count)||count<0)&&(count=0);var res=this.slice(0,start);return void 0!==replacement&&(res+=replacement),start+count<length&&(res+=this.slice(start+count)),res}}),Object.defineProperty(String.prototype,"splitOrEmpty",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.splitOrEmpty called on null or undefined");return""===String(this)?[]:String.prototype.split.apply(this,arguments)}}),Object.defineProperty(String.prototype,"toLocaleUpperFirst",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.toLocaleUpperFirst called on null or undefined");var str=String(this),_getCodePointStartAnd3=_getCodePointStartAndEnd(str,0),char=_getCodePointStartAnd3.char,end=_getCodePointStartAnd3.end;return-1===end?"":char.toLocaleUpperCase()+str.slice(end+1)}}),Object.defineProperty(String.prototype,"toUpperFirst",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.toUpperFirst called on null or undefined");var str=String(this),_getCodePointStartAnd4=_getCodePointStartAndEnd(str,0),char=_getCodePointStartAnd4.char,end=_getCodePointStartAnd4.end;return-1===end?"":char.toUpperCase()+str.slice(end+1)}}),Object.defineProperty(Date.prototype,"toJSON",{configurable:!0,writable:!0,value:function(){return["(revive:date)",this.toISOString()]}}),Object.defineProperty(Function.prototype,"toJSON",{configurable:!0,writable:!0,value:function(){return["(revive:eval)","(".concat(this.toString(),")")]}}),Object.defineProperty(Map.prototype,"toJSON",{configurable:!0,writable:!0,value:function(){return["(revive:map)",_toConsumableArray(this)]}}),Object.defineProperty(RegExp.prototype,"toJSON",{configurable:!0,writable:!0,value:function(){return["(revive:eval)",this.toString()]}}),Object.defineProperty(Set.prototype,"toJSON",{configurable:!0,writable:!0,value:function(){return["(revive:set)",_toConsumableArray(this)]}}),Object.defineProperty(JSON,"reviveWrapper",{configurable:!0,writable:!0,value:function(code,data){if("string"!=typeof code)throw new TypeError("JSON.reviveWrapper code parameter must be a string");return["(revive:eval)",[code,data]]}}),Object.defineProperty(JSON,"_real_stringify",{value:JSON.stringify}),Object.defineProperty(JSON,"stringify",{configurable:!0,writable:!0,value:function(_value,replacer,space){return JSON._real_stringify(_value,(function(key,val){var value=val;if("function"==typeof replacer)try{value=replacer(key,value)}catch(ex){}return void 0===value&&(value=["(revive:eval)","undefined"]),value}),space)}}),Object.defineProperty(JSON,"_real_parse",{value:JSON.parse}),Object.defineProperty(JSON,"parse",{configurable:!0,writable:!0,value:function value(text,reviver){return JSON._real_parse(text,(function(key,val){var value=val;if(Array.isArray(value)&&2===value.length)switch(value[0]){case"(revive:set)":value=new Set(value[1]);break;case"(revive:map)":value=new Map(value[1]);break;case"(revive:date)":value=new Date(value[1]);break;case"(revive:eval)":try{if(Array.isArray(value[1])){var $ReviveData$=value[1][1];value=eval(value[1][0])}else value=eval(value[1])}catch(ex){}}else if("string"==typeof value&&"@@revive@@"===value.slice(0,10))try{value=eval(value.slice(10))}catch(ex){}if("function"==typeof reviver)try{value=reviver(key,value)}catch(ex){}return value}))}}),Object.defineProperty(Array.prototype,"contains",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.contains called on null or undefined");return Array.prototype.includes.apply(this,arguments)}}),Object.defineProperty(Array.prototype,"containsAll",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.containsAll called on null or undefined");return Array.prototype.includesAll.apply(this,arguments)}}),Object.defineProperty(Array.prototype,"containsAny",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.containsAny called on null or undefined");return Array.prototype.includesAny.apply(this,arguments)}}),Object.defineProperty(Array.prototype,"flatten",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.flatten called on null or undefined");return Array.prototype.flat.call(this,1/0)}}),Object.defineProperty(String.prototype,"readBracketedList",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.readBracketedList called on null or undefined");for(var match,re=new RegExp("(?:\\[\\[((?:\\s|\\S)*?)\\]\\])|([^\"'\\s]\\S*)","gm"),names=[];null!==(match=re.exec(this));)match[1]?names.push(match[1]):match[2]&&names.push(match[2]);return names}})}();var Browser=(userAgent=navigator.userAgent.toLowerCase(),winPhone=userAgent.includes("windows phone"),isMobile=Object.freeze({Android:!winPhone&&userAgent.includes("android"),BlackBerry:/blackberry|bb10/.test(userAgent),iOS:!winPhone&&/ip(?:hone|ad|od)/.test(userAgent),Opera:!winPhone&&("object"===_typeof(window.operamini)||userAgent.includes("opera mini")),Windows:winPhone||/iemobile|wpdesktop/.test(userAgent),any:function(){return isMobile.Android||isMobile.BlackBerry||isMobile.iOS||isMobile.Opera||isMobile.Windows}}),isGecko=!isMobile.Windows&&!/khtml|trident|edge/.test(userAgent)&&userAgent.includes("gecko"),isIE=!userAgent.includes("opera")&&/msie|trident/.test(userAgent),ieVersion=isIE?(ver=/(?:msie\s+|rv:)(\d+\.\d)/.exec(userAgent))?Number(ver[1]):0:null,isOpera=userAgent.includes("opera")||userAgent.includes(" opr/"),operaVersion=isOpera?function(){var ver=new RegExp("".concat(/khtml|chrome/.test(userAgent)?"opr":"version","\\/(\\d+\\.\\d+)")).exec(userAgent);return ver?Number(ver[1]):0}():null,isVivaldi=userAgent.includes("vivaldi"),Object.freeze({userAgent:userAgent,isMobile:isMobile,isGecko:isGecko,isIE:isIE,ieVersion:ieVersion,isOpera:isOpera,operaVersion:operaVersion,isVivaldi:isVivaldi})),ver,userAgent,winPhone,isMobile,isGecko,isIE,ieVersion,isOpera,operaVersion,isVivaldi,Has=(hasAudioElement=function(){try{return"function"==typeof document.createElement("audio").canPlayType}catch(ex){}return!1}(),hasFile=function(){try{return"Blob"in window&&"File"in window&&"FileList"in window&&"FileReader"in window&&(!Browser.isOpera||Browser.operaVersion>=15)}catch(ex){}return!1}(),hasGeolocation=function(){try{return"geolocation"in navigator&&"function"==typeof navigator.geolocation.getCurrentPosition&&"function"==typeof navigator.geolocation.watchPosition}catch(ex){}return!1}(),hasMutationObserver=function(){try{return"MutationObserver"in window&&"function"==typeof window.MutationObserver}catch(ex){}return!1}(),hasPerformance=function(){try{return"performance"in window&&"function"==typeof window.performance.now}catch(ex){}return!1}(),hasTouch=function(){try{return"ontouchstart"in window||!!window.DocumentTouch&&document instanceof window.DocumentTouch||!!navigator.maxTouchPoints||!!navigator.msMaxTouchPoints}catch(ex){}return!1}(),hasTransitionEndEvent=function(){try{for(var teMap=new Map([["transition","transitionend"],["MSTransition","msTransitionEnd"],["WebkitTransition","webkitTransitionEnd"],["MozTransition","transitionend"]]),teKeys=_toConsumableArray(teMap.keys()),el=document.createElement("div"),i=0;i<teKeys.length;++i)if(el.style[teKeys[i]]!==undefined)return teMap.get(teKeys[i])}catch(ex){}return!1}(),Object.freeze({audio:hasAudioElement,fileAPI:hasFile,geolocation:hasGeolocation,mutationObserver:hasMutationObserver,performance:hasPerformance,touch:hasTouch,transitionEndEvent:hasTransitionEndEvent})),hasAudioElement,hasFile,hasGeolocation,hasMutationObserver,hasPerformance,hasTouch,hasTransitionEndEvent,Visibility=(vendor=function(){try{return Object.freeze([{hiddenProperty:"hidden",stateProperty:"visibilityState",changeEvent:"visibilitychange"},{hiddenProperty:"webkitHidden",stateProperty:"webkitVisibilityState",changeEvent:"webkitvisibilitychange"},{hiddenProperty:"mozHidden",stateProperty:"mozVisibilityState",changeEvent:"mozvisibilitychange"},{hiddenProperty:"msHidden",stateProperty:"msVisibilityState",changeEvent:"msvisibilitychange"}].find((function(vnd){return vnd.hiddenProperty in document})))}catch(ex){}return undefined}(),Object.freeze(Object.defineProperties({},{vendor:{get:function(){return vendor}},state:{get:function(){return vendor&&document[vendor.stateProperty]||"visible"}},isEnabled:{value:function(){return Boolean(vendor)}},isHidden:{value:function(){return Boolean(vendor&&document[vendor.hiddenProperty])}},hiddenProperty:{value:vendor&&vendor.hiddenProperty},stateProperty:{value:vendor&&vendor.stateProperty},changeEvent:{value:vendor&&vendor.changeEvent}}))),vendor,Fullscreen=function(){var _hasPromise,vendor=function(){try{return Object.freeze([{isEnabled:"fullscreenEnabled",element:"fullscreenElement",requestFn:"requestFullscreen",exitFn:"exitFullscreen",changeEvent:"fullscreenchange",errorEvent:"fullscreenerror"},{isEnabled:"webkitFullscreenEnabled",element:"webkitFullscreenElement",requestFn:"webkitRequestFullscreen",exitFn:"webkitExitFullscreen",changeEvent:"webkitfullscreenchange",errorEvent:"webkitfullscreenerror"},{isEnabled:"mozFullScreenEnabled",element:"mozFullScreenElement",requestFn:"mozRequestFullScreen",exitFn:"mozCancelFullScreen",changeEvent:"mozfullscreenchange",errorEvent:"mozfullscreenerror"},{isEnabled:"msFullscreenEnabled",element:"msFullscreenElement",requestFn:"msRequestFullscreen",exitFn:"msExitFullscreen",changeEvent:"MSFullscreenChange",errorEvent:"MSFullscreenError"}].find((function(vnd){return vnd.isEnabled in document})))}catch(ex){}return undefined}(),_returnsPromise=(_hasPromise=null,function(){if(null!==_hasPromise)return _hasPromise;if(_hasPromise=!1,vendor)try{var value=document.exitFullscreen();value.catch((function(){})),_hasPromise=value instanceof Promise}catch(ex){}return _hasPromise});function _selectElement(requestedEl){var selectedEl=requestedEl||document.documentElement;return selectedEl===document.documentElement&&("msRequestFullscreen"===vendor.requestFn||Browser.isOpera&&Browser.operaVersion<15)&&(selectedEl=document.body),selectedEl}function isFullscreen(){return Boolean(vendor&&document[vendor.element])}function requestFullscreen(options,requestedEl){var _this=this;if(!vendor)return Promise.reject(new Error("fullscreen not supported"));var element=_selectElement(requestedEl);if("function"!=typeof element[vendor.requestFn])return Promise.reject(new Error("fullscreen not supported"));if(isFullscreen())return Promise.resolve();if(_returnsPromise())return element[vendor.requestFn](options);var namespace=".Fullscreen_requestFullscreen";return new Promise((function(resolve,reject){jQuery(element).off(namespace).one("".concat(vendor.errorEvent).concat(namespace," ").concat(vendor.changeEvent).concat(namespace),(function(ev){jQuery(_this).off(namespace),ev.type===vendor.errorEvent?reject(new Error("unknown fullscreen request error")):resolve()})),element[vendor.requestFn](options)}))}function exitFullscreen(){var _this2=this;if(!vendor||"function"!=typeof document[vendor.exitFn])return Promise.reject(new TypeError("fullscreen not supported"));if(!isFullscreen())return Promise.reject(new TypeError("fullscreen mode not active"));if(_returnsPromise())return document[vendor.exitFn]();var namespace=".Fullscreen_exitFullscreen";return new Promise((function(resolve,reject){jQuery(document).off(namespace).one("".concat(vendor.errorEvent).concat(namespace," ").concat(vendor.changeEvent).concat(namespace),(function(ev){jQuery(_this2).off(namespace),ev.type===vendor.errorEvent?reject(new Error("unknown fullscreen exit error")):resolve()})),document[vendor.exitFn]()}))}return Object.freeze(Object.defineProperties({},{vendor:{get:function(){return vendor}},element:{get:function(){return vendor?document[vendor.element]:null}},isEnabled:{value:function(){return Boolean(vendor&&document[vendor.isEnabled])}},isFullscreen:{value:isFullscreen},request:{value:requestFullscreen},exit:{value:exitFullscreen},toggle:{value:function(options,requestedEl){return isFullscreen()?exitFullscreen():requestFullscreen(options,requestedEl)}},onChange:{value:function(handlerFn,requestedEl){if(vendor){var element=_selectElement(requestedEl);$(element).on(vendor.changeEvent,handlerFn)}}},offChange:{value:function(handlerFn,requestedEl){if(vendor){var element=_selectElement(requestedEl);handlerFn?$(element).off(vendor.changeEvent,handlerFn):$(element).off(vendor.changeEvent)}}},onError:{value:function(handlerFn,requestedEl){if(vendor){var element=_selectElement(requestedEl);$(element).on(vendor.errorEvent,handlerFn)}}},offError:{value:function(handlerFn,requestedEl){if(vendor){var element=_selectElement(requestedEl);handlerFn?$(element).off(vendor.errorEvent,handlerFn):$(element).off(vendor.errorEvent)}}}}))}(),_ref3=Object.freeze(Object.defineProperties({},{clone:{value:function clone(orig){return"object"!==_typeof(orig)||null===orig?orig:orig instanceof String?String(orig):orig instanceof Number?Number(orig):orig instanceof Boolean?Boolean(orig):"function"==typeof orig.clone?orig.clone(!0):orig.nodeType&&"function"==typeof orig.cloneNode?orig.cloneNode(!0):(orig instanceof Array?copy=new Array(orig.length):orig instanceof Date?copy=new Date(orig.getTime()):orig instanceof Map?(copy=new Map,orig.forEach((function(val,key){return copy.set(key,clone(val))}))):orig instanceof RegExp?copy=new RegExp(orig):orig instanceof Set?(copy=new Set,orig.forEach((function(val){return copy.add(clone(val))}))):copy=Object.create(Object.getPrototypeOf(orig)),Object.keys(orig).forEach((function(name){return copy[name]=clone(orig[name])})),copy);var copy}},convertBreaks:{value:function(source){for(var node,output=document.createDocumentFragment(),para=document.createElement("p");null!==(node=source.firstChild);){if(node.nodeType===Node.ELEMENT_NODE)switch(node.nodeName.toUpperCase()){case"BR":if(null!==node.nextSibling&&node.nextSibling.nodeType===Node.ELEMENT_NODE&&"BR"===node.nextSibling.nodeName.toUpperCase()){source.removeChild(node.nextSibling),source.removeChild(node),output.appendChild(para),para=document.createElement("p");continue}if(!para.hasChildNodes()){source.removeChild(node);continue}break;case"ADDRESS":case"ARTICLE":case"ASIDE":case"BLOCKQUOTE":case"CENTER":case"DIV":case"DL":case"FIGURE":case"FOOTER":case"FORM":case"H1":case"H2":case"H3":case"H4":case"H5":case"H6":case"HEADER":case"HR":case"MAIN":case"NAV":case"OL":case"P":case"PRE":case"SECTION":case"TABLE":case"UL":para.hasChildNodes()&&(output.appendChild(para),para=document.createElement("p")),output.appendChild(node);continue}para.appendChild(node)}para.hasChildNodes()&&output.appendChild(para),source.appendChild(output)}},safeActiveElement:{value:function(){try{return document.activeElement||null}catch(ex){return null}}},setDisplayTitle:{value:function(title){if("string"!=typeof title)throw new TypeError("story display title must be a string (received: ".concat(Util.getType(title),")"));var render=document.createDocumentFragment();new Wikifier(render,title);var text=function(source){for(var node,copy=source.cloneNode(!0),frag=document.createDocumentFragment();null!==(node=copy.firstChild);){if(node.nodeType===Node.ELEMENT_NODE)switch(node.nodeName.toUpperCase()){case"BR":case"DIV":case"P":frag.appendChild(document.createTextNode(" "))}frag.appendChild(node)}return frag.textContent}(render).trim();document.title=Config.passages.displayTitles&&""!==State.passage&&State.passage!==Config.passages.start?"".concat(State.passage," | ").concat(text):text;var storyTitle=document.getElementById("story-title");null!==storyTitle&&jQuery(storyTitle).empty().append(render)}},setPageElement:{value:function(idOrElement,titles,defaultText){var el="object"===_typeof(idOrElement)?idOrElement:document.getElementById(idOrElement);if(null==el)return null;var ids=Array.isArray(titles)?titles:[titles];jQuery(el).empty();for(var i=0,iend=ids.length;i<iend;++i)if(Story.has(ids[i]))return new Wikifier(el,Story.get(ids[i]).processText().trim()),el;if(null!=defaultText){var text=String(defaultText).trim();""!==text&&new Wikifier(el,text)}return el}},throwError:{value:function(place,message,source){var $wrapper=jQuery(document.createElement("div")),$toggle=jQuery(document.createElement("button")),$source=jQuery(document.createElement("pre")),mesg="".concat(L10n.get("errorTitle"),": ").concat(message||"unknown error");return $toggle.addClass("error-toggle").ariaClick({label:L10n.get("errorToggle")},(function(){$toggle.hasClass("enabled")?($toggle.removeClass("enabled"),$source.attr({"aria-hidden":!0,hidden:"hidden"})):($toggle.addClass("enabled"),$source.removeAttr("aria-hidden hidden"))})).appendTo($wrapper),jQuery(document.createElement("span")).addClass("error").text(mesg).appendTo($wrapper),jQuery(document.createElement("code")).text(source).appendTo($source),$source.addClass("error-source").attr({"aria-hidden":!0,hidden:"hidden"}).appendTo($wrapper),$wrapper.addClass("error-view").appendTo(place),console.warn("".concat(mesg,"\n\t").concat(source.replace(/\n/g,"\n\t"))),!1}},stringFrom:{value:function stringFrom(value){switch(_typeof(value)){case"function":return"[function]";case"number":if(Number.isNaN(value))return"[number NaN]";break;case"object":if(null===value)return"[null]";if(value instanceof Array)return value.map((function(val){return stringFrom(val)})).join(", ");if(value instanceof Set)return Array.from(value).map((function(val){return stringFrom(val)})).join(", ");if(value instanceof Map){var result=Array.from(value).map((function(_ref4){var _ref5=_slicedToArray(_ref4,2),key=_ref5[0],val=_ref5[1];return"".concat(stringFrom(key)," → ").concat(stringFrom(val))}));return"{ ".concat(result.join(", ")," }")}if(value instanceof Date)return value.toLocaleString();if(value instanceof Element){if(value===document.documentElement||value===document.head||value===document.body)throw new Error("illegal operation; attempting to convert the <html>, <head>, or <body> tags to string is not allowed");return value.outerHTML}return value instanceof Node?value.textContent:"function"==typeof value.toString?value.toString():Object.prototype.toString.call(value);case"symbol":var desc=void 0!==value.description?' "'.concat(value.description,'"'):"";return"[symbol".concat(desc,"]");case"undefined":return"[undefined]"}return String(value)}}})),clone=_ref3.clone,convertBreaks=_ref3.convertBreaks,safeActiveElement=_ref3.safeActiveElement,setDisplayTitle=_ref3.setDisplayTitle,setPageElement=_ref3.setPageElement,throwError=_ref3.throwError,stringFrom=_ref3.stringFrom;!function(){function onKeypressFn(ev){13!==ev.which&&32!==ev.which||(ev.preventDefault(),jQuery(safeActiveElement()||this).trigger("click"))}function onClickFnWrapper(fn){return function(){var $this=jQuery(this);$this.ariaIsDisabled()||($this.is("[aria-pressed]")&&$this.attr("aria-pressed","true"===$this.attr("aria-pressed")?"false":"true"),fn.apply(this,arguments))}}function oneClickFnWrapper(fn){return onClickFnWrapper((function(){jQuery(this).off(".aria-clickable").removeAttr("role tabindex aria-controls aria-pressed").filter("button").prop("disabled",!0),fn.apply(this,arguments)}))}jQuery.fn.extend({ariaClick:function(options,handler){if(0===this.length||0===arguments.length)return this;var opts=options,fn=handler;return null==fn&&(fn=opts,opts=undefined),"string"!=typeof(opts=jQuery.extend({namespace:undefined,one:!1,selector:undefined,data:undefined,role:undefined,controls:undefined,pressed:undefined,label:undefined},opts)).namespace?opts.namespace="":"."!==opts.namespace[0]&&(opts.namespace=".".concat(opts.namespace)),"boolean"==typeof opts.pressed&&(opts.pressed=opts.pressed?"true":"false"),this.filter("button").prop("type","button"),null!=opts.role?this.attr("role",opts.role):this.not("[role]").filter("a,[data-passage]").attr("role","link").end().not("a").not("[data-passage]").attr("role","button").end().end().end(),this.attr("tabindex",0),null!=opts.controls&&this.attr("aria-controls",opts.controls),null!=opts.pressed&&this.attr("aria-pressed",opts.pressed),null!=opts.label&&this.attr({"aria-label":opts.label,title:opts.label}),this.not("button").on("keypress.aria-clickable".concat(opts.namespace),opts.selector,onKeypressFn),this.on("click.aria-clickable".concat(opts.namespace),opts.selector,opts.data,opts.one?oneClickFnWrapper(fn):onClickFnWrapper(fn)),this},ariaDisabled:function(disable){if(0===this.length||0===arguments.length)return this;var $nonDisableable=this.not("button,fieldset,input,menuitem,optgroup,option,select,textarea"),$disableable=this.filter("button,fieldset,input,menuitem,optgroup,option,select,textarea");return disable?($nonDisableable.each((function(){this.setAttribute("disabled",""),this.setAttribute("aria-disabled","true")})),$disableable.each((function(){this.disabled=!0,this.setAttribute("aria-disabled","true")}))):($nonDisableable.each((function(){this.removeAttribute("disabled"),this.removeAttribute("aria-disabled")})),$disableable.each((function(){this.disabled=!1,this.removeAttribute("aria-disabled")}))),this},ariaIsDisabled:function(){return this.is("[disabled]")}})}(),jQuery.extend({wikiWithOptions:function(options){for(var _len=arguments.length,sources=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)sources[_key-1]=arguments[_key];if(0!==sources.length){var frag=document.createDocumentFragment();sources.forEach((function(content){return new Wikifier(frag,content,options)}));var errors=_toConsumableArray(frag.querySelectorAll(".error")).map((function(errEl){return errEl.textContent.replace(errorPrologRegExp,"")}));if(errors.length>0)throw new Error(errors.join("; "))}},wiki:function(){for(var _len2=arguments.length,sources=new Array(_len2),_key2=0;_key2<_len2;_key2++)sources[_key2]=arguments[_key2];this.wikiWithOptions.apply(this,[undefined].concat(sources))}}),jQuery.fn.extend({wikiWithOptions:function(options){for(var _len3=arguments.length,sources=new Array(_len3>1?_len3-1:0),_key3=1;_key3<_len3;_key3++)sources[_key3-1]=arguments[_key3];if(0===this.length||0===sources.length)return this;var frag=document.createDocumentFragment();return sources.forEach((function(content){return new Wikifier(frag,content,options)})),this.append(frag),this},wiki:function(){for(var _len4=arguments.length,sources=new Array(_len4),_key4=0;_key4<_len4;_key4++)sources[_key4]=arguments[_key4];return this.wikiWithOptions.apply(this,[undefined].concat(sources))}});var Util=function(){var toString,utilGetType="[object Object]"===(toString=Object.prototype.toString).call(new Map)?function(O){if(null===O)return"null";if(O instanceof Map)return"Map";if(O instanceof Set)return"Set";var baseType=_typeof(O);return"object"===baseType?toString.call(O).slice(8,-1):baseType}:function(O){if(null===O)return"null";var baseType=_typeof(O);return"object"===baseType?toString.call(O).slice(8,-1):baseType};function utilToEnum(obj){var pEnum=Object.create(null);if(obj instanceof Array)obj.forEach((function(val,i){return pEnum[String(val)]=i}));else if(obj instanceof Set)Array.from(obj).forEach((function(val,i){return pEnum[String(val)]=i}));else if(obj instanceof Map)obj.forEach((function(val,key){return pEnum[String(key)]=val}));else{if("object"!==_typeof(obj)||null===obj||Object.getPrototypeOf(obj)!==Object.prototype)throw new TypeError("Util.toEnum obj parameter must be an Array, Map, Set, or generic object");Object.assign(pEnum,obj)}return Object.freeze(pEnum)}function utilToStringTag(obj){return Object.prototype.toString.call(obj).slice(8,-1)}var _illegalSlugCharsRe=/[\x00-\x20!-/:-@[-^`{-\x9f]+/g,_isInvalidSlugRe=/^-*$/;var _illegalFilenameCharsRE=/[\x00-\x1f"#$%&'*+,/:;<=>?\\^`|\x7f-\x9f]+/g;var _markupCharsRe=/[!"#$&'*\-/<=>?@[\\\]^_`{|}~]/g,_hasMarkupCharsRe=new RegExp(_markupCharsRe.source),_markupCharsMap=utilToEnum({"!":"&#33;",'"':"&quot;","#":"&#35;",$:"&#36;","&":"&amp;","'":"&#39;","*":"&#42;","-":"&#45;","/":"&#47;","<":"&lt;","=":"&#61;",">":"&gt;","?":"&#63;","@":"&#64;","[":"&#91;","\\":"&#92;","]":"&#93;","^":"&#94;",_:"&#95;","`":"&#96;","{":"&#123;","|":"&#124;","}":"&#125;","~":"&#126;"});var _htmlCharsRe=/[&<>"'`]/g,_hasHtmlCharsRe=new RegExp(_htmlCharsRe.source),_htmlCharsMap=utilToEnum({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"});function utilEscape(str){if(null==str)return"";var val=String(str);return val&&_hasHtmlCharsRe.test(val)?val.replace(_htmlCharsRe,(function(ch){return _htmlCharsMap[ch]})):val}var _escapedHtmlRe=/&(?:amp|#38|#x26|lt|#60|#x3c|gt|#62|#x3e|quot|#34|#x22|apos|#39|#x27|#96|#x60);/gi,_hasEscapedHtmlRe=new RegExp(_escapedHtmlRe.source,"i"),_escapedHtmlMap=utilToEnum({"&amp;":"&","&#38;":"&","&#x26;":"&","&lt;":"<","&#60;":"<","&#x3c;":"<","&gt;":">","&#62;":">","&#x3e;":">","&quot;":'"',"&#34;":'"',"&#x22;":'"',"&apos;":"'","&#39;":"'","&#x27;":"'","&#96;":"`","&#x60;":"`"});function utilUnescape(str){if(null==str)return"";var val=String(str);return val&&_hasEscapedHtmlRe.test(val)?val.replace(_escapedHtmlRe,(function(entity){return _escapedHtmlMap[entity.toLowerCase()]})):val}var _nowSource=Has.performance?performance:Date;var _cssTimeRe=/^([+-]?(?:\d*\.)?\d+)([Mm]?[Ss])$/;var utilScrubEventKey=function(){var separatorKey,decimalKey;if("undefined"!=typeof Intl&&"function"==typeof Intl.NumberFormat){var match=(new Intl.NumberFormat).format(111111.5).match(/(\D*)\d+(\D*)/);match&&(separatorKey=match[1],decimalKey=match[2])}return separatorKey||decimalKey||(separatorKey=",",decimalKey="."),function(key){switch(key){case"Scroll":return"ScrollLock";case"Spacebar":return" ";case"Left":return"ArrowLeft";case"Right":return"ArrowRight";case"Up":return"ArrowUp";case"Down":return"ArrowDown";case"Del":return"Delete";case"Crsel":return"CrSel";case"Exsel":return"ExSel";case"Esc":return"Escape";case"Apps":return"ContextMenu";case"Nonconvert":return"NonConvert";case"MediaNextTrack":return"MediaTrackNext";case"MediaPreviousTrack":return"MediaTrackPrevious";case"VolumeUp":return"AudioVolumeUp";case"VolumeDown":return"AudioVolumeDown";case"VolumeMute":return"AudioVolumeMute";case"Zoom":return"ZoomToggle";case"SelectMedia":case"MediaSelect":return"LaunchMediaPlayer";case"Add":return"+";case"Divide":return"/";case"Multiply":return"*";case"Subtract":return"-";case"Decimal":return decimalKey;case"Separator":return separatorKey}return key}}(),utilHasMediaQuery="function"!=typeof window.matchMedia?function(){return!1}:function(mediaQuery){return window.matchMedia(mediaQuery).matches};return Object.freeze(Object.defineProperties({},{getType:{value:utilGetType},isBoolean:{value:function(obj){return"boolean"==typeof obj||"string"==typeof obj&&("true"===obj||"false"===obj)}},isIterable:{value:function(obj){return null!=obj&&"function"==typeof obj[Symbol.iterator]}},isNumeric:{value:function(obj){var num;switch(_typeof(obj)){case"number":num=obj;break;case"string":num=Number(obj);break;default:return!1}return!Number.isNaN(num)&&Number.isFinite(num)}},sameValueZero:{value:function(a,b){return a===b||a!=a&&b!=b}},toEnum:{value:utilToEnum},toStringTag:{value:utilToStringTag},slugify:{value:function(str){var base=String(str).trim(),_legacy=base.replace(/[^\w\s\u2013\u2014-]+/g,"").replace(/[_\s\u2013\u2014-]+/g,"-").toLocaleLowerCase();return _isInvalidSlugRe.test(_legacy)?base.replace(_illegalSlugCharsRe,"").replace(/[_\s\u2013\u2014-]+/g,"-"):_legacy}},sanitizeFilename:{value:function(str){return String(str).trim().replace(_illegalFilenameCharsRE,"")}},escapeMarkup:{value:function(str){if(null==str)return"";var val=String(str);return val&&_hasMarkupCharsRe.test(val)?val.replace(_markupCharsRe,(function(ch){return _markupCharsMap[ch]})):val}},escape:{value:utilEscape},unescape:{value:utilUnescape},charAndPosAt:{value:function(text,position){var str=String(text),pos=Math.trunc(position),code=str.charCodeAt(pos);if(Number.isNaN(code))return{char:"",start:-1,end:-1};var retval={char:str.charAt(pos),start:pos,end:pos};if(code<55296||code>57343)return retval;if(code>=55296&&code<=56319){var nextPos=pos+1;if(nextPos>=str.length)return retval;var nextCode=str.charCodeAt(nextPos);return nextCode<56320||nextCode>57343||(retval.char=retval.char+str.charAt(nextPos),retval.end=nextPos),retval}if(0===pos)return retval;var prevPos=pos-1,prevCode=str.charCodeAt(prevPos);return prevCode<55296||prevCode>56319||(retval.char=str.charAt(prevPos)+retval.char,retval.start=prevPos),retval}},now:{value:function(){return _nowSource.now()}},fromCssTime:{value:function(cssTime){var match=_cssTimeRe.exec(String(cssTime));if(null===match)throw new SyntaxError('invalid time value syntax: "'.concat(cssTime,'"'));var msec=Number(match[1]);if(1===match[2].length&&(msec*=1e3),Number.isNaN(msec)||!Number.isFinite(msec))throw new RangeError('invalid time value: "'.concat(cssTime,'"'));return msec}},toCssTime:{value:function(msec){if("number"!=typeof msec||Number.isNaN(msec)||!Number.isFinite(msec)){var what;switch(_typeof(msec)){case"string":what='"'.concat(msec,'"');break;case"number":what=String(msec);break;default:what=utilToStringTag(msec)}throw new Error("invalid milliseconds: ".concat(what))}return"".concat(msec,"ms")}},fromCssProperty:{value:function(cssName){if(!cssName.includes("-"))switch(cssName){case"bgcolor":return"backgroundColor";case"float":return"cssFloat";default:return cssName}return("-ms-"===cssName.slice(0,4)?cssName.slice(1):cssName).split("-").map((function(part,i){return 0===i?part:part.toUpperFirst()})).join("")}},parseUrl:{value:function(url){var el=document.createElement("a"),queryObj=Object.create(null);el.href=url,el.search&&el.search.replace(/^\?/,"").splitOrEmpty(/(?:&(?:amp;)?|;)/).forEach((function(query){var _query$split2=_slicedToArray(query.split("="),2),key=_query$split2[0],value=_query$split2[1];queryObj[key]=value}));var pathname=el.host&&"/"!==el.pathname[0]?"/".concat(el.pathname):el.pathname;return{href:el.href,protocol:el.protocol,host:el.host,hostname:el.hostname,port:el.port,path:"".concat(pathname).concat(el.search),pathname:pathname,query:el.search,search:el.search,queries:queryObj,searches:queryObj,hash:el.hash}}},newExceptionFrom:{value:function(original,exceptionType,override){if("object"!==_typeof(original)||null===original)throw new Error("Util.newExceptionFrom original parameter must be an object");if("function"!=typeof exceptionType)throw new Error("Util.newExceptionFrom exceptionType parameter must be an error type constructor");var ex=new exceptionType(original.message);void 0!==original.name&&(ex.name=original.name),void 0!==original.code&&(ex.code=original.code),void 0!==original.columnNumber&&(ex.columnNumber=original.columnNumber),void 0!==original.description&&(ex.description=original.description),void 0!==original.fileName&&(ex.fileName=original.fileName),void 0!==original.lineNumber&&(ex.lineNumber=original.lineNumber),void 0!==original.number&&(ex.number=original.number),void 0!==original.stack&&(ex.stack=original.stack);var overrideType=_typeof(override);if("undefined"!==overrideType)if("object"===overrideType&&null!==override)Object.assign(ex,override);else{if("string"!==overrideType)throw new Error("Util.newExceptionFrom override parameter must be an object or string");ex.message=override}return ex}},scrubEventKey:{value:utilScrubEventKey},hasMediaQuery:{value:utilHasMediaQuery},random:{value:Math.random},entityEncode:{value:utilEscape},entityDecode:{value:utilUnescape},evalExpression:{value:function(){return Scripting.evalJavaScript.apply(Scripting,arguments)}},evalStatements:{value:function(){return Scripting.evalJavaScript.apply(Scripting,arguments)}}}))}(),SimpleStore=(_adapters=[],_initialized=null,Object.freeze(Object.defineProperties({},{adapters:{value:_adapters},create:{value:function(storageId,persistent){if(_initialized)return _initialized.create(storageId,persistent);for(var i=0;i<_adapters.length;++i)if(_adapters[i].init(storageId,persistent))return(_initialized=_adapters[i]).create(storageId,persistent);throw new Error("no valid storage adapters found")}}}))),_adapters,_initialized,_ok,_WebStorageAdapter;SimpleStore.adapters.push((_ok=!1,_WebStorageAdapter=function(){function _WebStorageAdapter(storageId,persistent){_classCallCheck(this,_WebStorageAdapter);var prefix="".concat(storageId,"."),engine=null,name=null;persistent?(engine=window.localStorage,name="localStorage"):(engine=window.sessionStorage,name="sessionStorage"),Object.defineProperties(this,{_engine:{value:engine},_prefix:{value:prefix},_prefixRe:{value:new RegExp("^".concat(RegExp.escape(prefix)))},name:{value:name},id:{value:storageId},persistent:{value:!!persistent}})}return _createClass(_WebStorageAdapter,[{key:"length",get:function(){return this.keys().length}},{key:"size",value:function(){return this.keys().length}},{key:"keys",value:function(){for(var keys=[],i=0;i<this._engine.length;++i){var key=this._engine.key(i);this._prefixRe.test(key)&&keys.push(key.replace(this._prefixRe,""))}return keys}},{key:"has",value:function(key){return!("string"!=typeof key||!key)&&this._engine.hasOwnProperty(this._prefix+key)}},{key:"get",value:function(key){if("string"!=typeof key||!key)return null;var value=this._engine.getItem(this._prefix+key);return null==value?null:_WebStorageAdapter._deserialize(value)}},{key:"set",value:function(key,value){if("string"!=typeof key||!key)return!1;try{this._engine.setItem(this._prefix+key,_WebStorageAdapter._serialize(value))}catch(ex){if(/quota.?(?:exceeded|reached)/i.test(ex.name+ex.message))throw Util.newExceptionFrom(ex,Error,"".concat(this.name," quota exceeded"));throw ex}return!0}},{key:"delete",value:function(key){return!("string"!=typeof key||!key||(this._engine.removeItem(this._prefix+key),0))}},{key:"clear",value:function(){for(var keys=this.keys(),i=0,iend=keys.length;i<iend;++i)this.delete(keys[i]);return!0}}],[{key:"_serialize",value:function(obj){return LZString.compressToUTF16(JSON.stringify(obj))}},{key:"_deserialize",value:function(str){return JSON.parse(LZString.decompressFromUTF16(str))}}]),_WebStorageAdapter}(),Object.freeze(Object.defineProperties({},{init:{value:function(){function hasWebStorage(storeId){try{var store=window[storeId],tid="_sc_".concat(String(Date.now()));store.setItem(tid,tid);var result=store.getItem(tid)===tid;return store.removeItem(tid),result}catch(ex){}return!1}return _ok=hasWebStorage("localStorage")&&hasWebStorage("sessionStorage")}},create:{value:function(storageId,persistent){if(!_ok)throw new Error("adapter not initialized");return new _WebStorageAdapter(storageId,persistent)}}})))),SimpleStore.adapters.push(function(){var _MAX_EXPIRY="Tue, 19 Jan 2038 03:14:07 GMT",_MIN_EXPIRY="Thu, 01 Jan 1970 00:00:00 GMT",_ok=!1,_CookieAdapter=function(){function _CookieAdapter(storageId,persistent){_classCallCheck(this,_CookieAdapter);var prefix="".concat(storageId).concat(persistent?"!":"*",".");Object.defineProperties(this,{_prefix:{value:prefix},_prefixRe:{value:new RegExp("^".concat(RegExp.escape(prefix)))},name:{value:"cookie"},id:{value:storageId},persistent:{value:!!persistent}})}return _createClass(_CookieAdapter,[{key:"length",get:function(){return this.keys().length}},{key:"size",value:function(){return this.keys().length}},{key:"keys",value:function(){if(""===document.cookie)return[];for(var cookies=document.cookie.split(/;\s*/),keys=[],i=0;i<cookies.length;++i){var kvPair=cookies[i].split("="),key=decodeURIComponent(kvPair[0]);if(this._prefixRe.test(key))""!==decodeURIComponent(kvPair[1])&&keys.push(key.replace(this._prefixRe,""))}return keys}},{key:"has",value:function(key){return!("string"!=typeof key||!key)&&null!==_CookieAdapter._getCookie(this._prefix+key)}},{key:"get",value:function(key){if("string"!=typeof key||!key)return null;var value=_CookieAdapter._getCookie(this._prefix+key);return null===value?null:_CookieAdapter._deserialize(value)}},{key:"set",value:function(key,value){if("string"!=typeof key||!key)return!1;try{if(_CookieAdapter._setCookie(this._prefix+key,_CookieAdapter._serialize(value),this.persistent?"Tue, 19 Jan 2038 03:14:07 GMT":undefined),!this.has(key))throw new Error("unknown validation error during set")}catch(ex){throw Util.newExceptionFrom(ex,Error,"cookie error: ".concat(ex.message))}return!0}},{key:"delete",value:function(key){if("string"!=typeof key||!key||!this.has(key))return!1;try{if(_CookieAdapter._setCookie(this._prefix+key,undefined,_MIN_EXPIRY),this.has(key))throw new Error("unknown validation error during delete")}catch(ex){throw Util.newExceptionFrom(ex,Error,"cookie error: ".concat(ex.message))}return!0}},{key:"clear",value:function(){for(var keys=this.keys(),i=0,iend=keys.length;i<iend;++i)this.delete(keys[i]);return!0}}],[{key:"_getCookie",value:function(prefixedKey){if(!prefixedKey||""===document.cookie)return null;for(var cookies=document.cookie.split(/;\s*/),i=0;i<cookies.length;++i){var kvPair=cookies[i].split("=");if(prefixedKey===decodeURIComponent(kvPair[0]))return decodeURIComponent(kvPair[1])||null}return null}},{key:"_setCookie",value:function(prefixedKey,value,expiry){if(prefixedKey){var payload="".concat(encodeURIComponent(prefixedKey),"=");null!=value&&(payload+=encodeURIComponent(value)),null!=expiry&&(payload+="; expires=".concat(expiry)),payload+="; path=/",document.cookie=payload}}},{key:"_serialize",value:function(obj){return LZString.compressToBase64(JSON.stringify(obj))}},{key:"_deserialize",value:function(str){return JSON.parse(LZString.decompressFromBase64(str))}}]),_CookieAdapter}();return Object.freeze(Object.defineProperties({},{init:{value:function(storageId){try{var tid="_sc_".concat(String(Date.now()));_CookieAdapter._setCookie(tid,_CookieAdapter._serialize(tid),undefined),_ok=_CookieAdapter._deserialize(_CookieAdapter._getCookie(tid))===tid,_CookieAdapter._setCookie(tid,undefined,_MIN_EXPIRY)}catch(ex){_ok=!1}return _ok&&function(storageId){if(""===document.cookie)return;for(var oldPrefix="".concat(storageId,"."),oldPrefixRe=new RegExp("^".concat(RegExp.escape(oldPrefix))),persistPrefix="".concat(storageId,"!."),sessionPrefix="".concat(storageId,"*."),sessionTestRe=/\.(?:state|rcWarn)$/,cookies=document.cookie.split(/;\s*/),i=0;i<cookies.length;++i){var kvPair=cookies[i].split("="),key=decodeURIComponent(kvPair[0]);if(oldPrefixRe.test(key)){var value=decodeURIComponent(kvPair[1]);""!==value&&function(){var persist=!sessionTestRe.test(key);_CookieAdapter._setCookie(key,undefined,_MIN_EXPIRY),_CookieAdapter._setCookie(key.replace(oldPrefixRe,(function(){return persist?persistPrefix:sessionPrefix})),value,persist?_MAX_EXPIRY:undefined)}()}}}(storageId),_ok}},create:{value:function(storageId,persistent){if(!_ok)throw new Error("adapter not initialized");return new _CookieAdapter(storageId,persistent)}}}))}());var DebugView=function(){function DebugView(parent,type,name,title){_classCallCheck(this,DebugView),Object.defineProperties(this,{parent:{value:parent},view:{value:document.createElement("span")},break:{value:document.createElement("wbr")}}),jQuery(this.view).attr({title:title,"aria-label":title,"data-type":null!=type?type:"","data-name":null!=name?name:""}).addClass("debug"),jQuery(this.break).addClass("debug hidden"),this.parent.appendChild(this.view),this.parent.appendChild(this.break)}return _createClass(DebugView,[{key:"output",get:function(){return this.view}},{key:"type",get:function(){return this.view.getAttribute("data-type")},set:function(type){this.view.setAttribute("data-type",null!=type?type:"")}},{key:"name",get:function(){return this.view.getAttribute("data-name")},set:function(name){this.view.setAttribute("data-name",null!=name?name:"")}},{key:"title",get:function(){return this.view.title},set:function(title){this.view.title=title}},{key:"append",value:function(el){return jQuery(this.view).append(el),this}},{key:"modes",value:function(options){if(null==options){var current={};return this.view.className.splitOrEmpty(/\s+/).forEach((function(name){"debug"!==name&&(current[name]=!0)})),current}if("object"===_typeof(options))return Object.keys(options).forEach((function(name){this[options[name]?"addClass":"removeClass"](name)}),jQuery(this.view)),this;throw new Error("DebugView.prototype.modes options parameter must be an object or null/undefined")}},{key:"remove",value:function(){var $view=jQuery(this.view);this.view.hasChildNodes()&&$view.contents().appendTo(this.parent),$view.remove(),jQuery(this.break).remove()}}],[{key:"isEnabled",value:function(){return"enabled"===jQuery(document.documentElement).attr("data-debug-view")}},{key:"enable",value:function(){jQuery(document.documentElement).attr("data-debug-view","enabled"),jQuery.event.trigger(":debugviewupdate")}},{key:"disable",value:function(){jQuery(document.documentElement).removeAttr("data-debug-view"),jQuery.event.trigger(":debugviewupdate")}},{key:"toggle",value:function(){"enabled"===jQuery(document.documentElement).attr("data-debug-view")?DebugView.disable():DebugView.enable()}}]),DebugView}(),NodeTyper=function(){var NodeTyper=function(){function NodeTyper(config){if(_classCallCheck(this,NodeTyper),"object"!==_typeof(config)||null===config)throw new Error("config parameter must be an object (received: ".concat(Util.getType(config),")"));if(!(config.hasOwnProperty("targetNode")&&config.targetNode instanceof Node))throw new Error('config parameter object "targetNode" property must be a node');Object.defineProperties(this,{node:{value:config.targetNode},childNodes:{value:[]},nodeValue:{writable:!0,value:""},appendTo:{writable:!0,value:config.parentNode||null},classNames:{writable:!0,value:config.classNames||null},finished:{writable:!0,value:!1}});var childNode,node=this.node;for(node.nodeValue&&(this.nodeValue=node.nodeValue,node.nodeValue="");null!==(childNode=node.firstChild);)this.childNodes.push(new NodeTyper({targetNode:childNode,parentNode:node,classNames:this.classNames})),node.removeChild(childNode)}return _createClass(NodeTyper,[{key:"finish",value:function(){for(;this.type(!0););return!1}},{key:"type",value:function(flush){if(this.finished)return!1;if(this.appendTo){if(this.appendTo.appendChild(this.node),this.appendTo=null,this.node.nodeType!==Node.ELEMENT_NODE&&this.node.nodeType!==Node.TEXT_NODE||"none"===jQuery(this.node.parentNode).css("display"))return this.finish();this.node.parentNode&&this.classNames&&jQuery(this.node.parentNode).addClass(this.classNames)}if(this.nodeValue){if(flush)this.node.nodeValue+=this.nodeValue,this.nodeValue="";else{var _Util$charAndPosAt=Util.charAndPosAt(this.nodeValue,0),char=_Util$charAndPosAt.char,start=_Util$charAndPosAt.start,end=_Util$charAndPosAt.end;this.node.nodeValue+=char,this.nodeValue=this.nodeValue.slice(1+end-start)}return!0}this.classNames&&(jQuery(this.node.parentNode).removeClass(this.classNames),this.classNames=null);for(var childNodes=this.childNodes;childNodes.length>0;){if(childNodes[0].type())return!0;childNodes.shift()}return this.finished=!0,!1}}]),NodeTyper}();return NodeTyper}(),PRNGWrapper=function(){function PRNGWrapper(seed,useEntropy){_classCallCheck(this,PRNGWrapper),Object.defineProperties(this,new Math.seedrandom(seed,useEntropy,(function(prng,seed){return{_prng:{value:prng},seed:{writable:!0,value:seed},pull:{writable:!0,value:0},random:{value:function(){return++this.pull,this._prng()}}}})))}return _createClass(PRNGWrapper,null,[{key:"marshal",value:function(prng){if(!prng||!prng.hasOwnProperty("seed")||!prng.hasOwnProperty("pull"))throw new Error("PRNG is missing required data");return{seed:prng.seed,pull:prng.pull}}},{key:"unmarshal",value:function(prngObj){if(!prngObj||!prngObj.hasOwnProperty("seed")||!prngObj.hasOwnProperty("pull"))throw new Error("PRNG object is missing required data");for(var prng=new PRNGWrapper(prngObj.seed,!1),i=prngObj.pull;i>0;--i)prng.random();return prng}}]),PRNGWrapper}(),StyleWrapper=(_imageMarkupRe=new RegExp(Patterns.cssImage,"g"),_hasImageMarkupRe=new RegExp(Patterns.cssImage),function(){function StyleWrapper(style){if(_classCallCheck(this,StyleWrapper),null==style)throw new TypeError("StyleWrapper style parameter must be an HTMLStyleElement object");Object.defineProperties(this,{style:{value:style}})}return _createClass(StyleWrapper,[{key:"isEmpty",value:function(){return 0===this.style.cssRules.length}},{key:"set",value:function(rawCss){this.clear(),this.add(rawCss)}},{key:"add",value:function(rawCss){var css=rawCss;_hasImageMarkupRe.test(css)&&(_imageMarkupRe.lastIndex=0,css=css.replace(_imageMarkupRe,(function(wikiImage){var markup=Wikifier.helpers.parseSquareBracketedMarkup({source:wikiImage,matchStart:0});if(markup.hasOwnProperty("error")||markup.pos<wikiImage.length)return wikiImage;var source=markup.source;if("data:"!==source.slice(0,5)&&Story.has(source)){var passage=Story.get(source);passage.tags.includes("Twine.image")&&(source=passage.text.trim())}return'url("'.concat(source.replace(/"/g,"%22"),'")')}))),this.style.styleSheet?this.style.styleSheet.cssText+=css:this.style.appendChild(document.createTextNode(css))}},{key:"clear",value:function(){this.style.styleSheet?this.style.styleSheet.cssText="":jQuery(this.style).empty()}}]),StyleWrapper}()),_imageMarkupRe,_hasImageMarkupRe,Diff=(Op=Util.toEnum({Delete:0,SpliceArray:1,Copy:2,CopyDate:3}),Object.freeze(Object.defineProperties({},{Op:{value:Op},diff:{value:function diff(orig,dest){for(var aOpRef,objToString=Object.prototype.toString,origIsArray=orig instanceof Array,keys=[].concat(Object.keys(orig),Object.keys(dest)).sort().filter((function(val,i,arr){return 0===i||arr[i-1]!==val})),diffed={},keyIsAOpRef=function(key){return key===aOpRef},i=0,klen=keys.length;i<klen;++i){var key=keys[i],origP=orig[key],destP=dest[key];if(orig.hasOwnProperty(key))if(dest.hasOwnProperty(key)){if(origP===destP)continue;if(_typeof(origP)===_typeof(destP))if("function"==typeof origP)origP.toString()!==destP.toString()&&(diffed[key]=[Op.Copy,destP]);else if("object"!==_typeof(origP)||null===origP)diffed[key]=[Op.Copy,destP];else{var origPType=objToString.call(origP);if(origPType===objToString.call(destP))if(origP instanceof Date)Number(origP)!==Number(destP)&&(diffed[key]=[Op.Copy,clone(destP)]);else if(origP instanceof Map)diffed[key]=[Op.Copy,clone(destP)];else if(origP instanceof RegExp)origP.toString()!==destP.toString()&&(diffed[key]=[Op.Copy,clone(destP)]);else if(origP instanceof Set)diffed[key]=[Op.Copy,clone(destP)];else if("[object Object]"!==origPType)diffed[key]=[Op.Copy,clone(destP)];else{var recurse=diff(origP,destP);null!==recurse&&(diffed[key]=recurse)}else diffed[key]=[Op.Copy,clone(destP)]}else diffed[key]=[Op.Copy,"object"!==_typeof(destP)||null===destP?destP:clone(destP)]}else if(origIsArray&&Util.isNumeric(key)){var nKey=Number(key);if(!aOpRef){aOpRef="";do{aOpRef+="~"}while(keys.some(keyIsAOpRef));diffed[aOpRef]=[Op.SpliceArray,nKey,nKey]}nKey<diffed[aOpRef][1]&&(diffed[aOpRef][1]=nKey),nKey>diffed[aOpRef][2]&&(diffed[aOpRef][2]=nKey)}else diffed[key]=Op.Delete;else diffed[key]=[Op.Copy,"object"!==_typeof(destP)||null===destP?destP:clone(destP)]}return Object.keys(diffed).length>0?diffed:null}},patch:{value:function patch(orig,diffed){for(var keys=Object.keys(diffed||{}),patched=clone(orig),i=0,klen=keys.length;i<klen;++i){var key=keys[i],diffedP=diffed[key];if(diffedP===Op.Delete)delete patched[key];else if(diffedP instanceof Array)switch(diffedP[0]){case Op.SpliceArray:patched.splice(diffedP[1],diffedP[2]-diffedP[1]+1);break;case Op.Copy:patched[key]=clone(diffedP[1]);break;case Op.CopyDate:patched[key]=new Date(diffedP[1])}else patched[key]=patch(patched[key],diffedP)}return patched}}}))),Op,L10n=(_patternRe=/\{\w+\}/g,_hasPatternRe=new RegExp(_patternRe.source),Object.freeze(Object.defineProperties({},{init:{value:function(){strings&&Object.keys(strings).length>0&&Object.keys(l10nStrings).forEach((function(id){try{var value;switch(id){case"identity":value=strings.identity;break;case"aborting":value=strings.aborting;break;case"cancel":value=strings.cancel;break;case"close":value=strings.close;break;case"ok":value=strings.ok;break;case"errorTitle":value=strings.errors.title;break;case"errorNonexistentPassage":value=strings.errors.nonexistentPassage;break;case"errorSaveMissingData":value=strings.errors.saveMissingData;break;case"errorSaveIdMismatch":value=strings.errors.saveIdMismatch;break;case"warningDegraded":value=strings.warnings.degraded;break;case"debugViewTitle":value=strings.debugView.title;break;case"debugViewToggle":value=strings.debugView.toggle;break;case"uiBarToggle":value=strings.uiBar.toggle;break;case"uiBarBackward":value=strings.uiBar.backward;break;case"uiBarForward":value=strings.uiBar.forward;break;case"uiBarJumpto":value=strings.uiBar.jumpto;break;case"jumptoTitle":value=strings.jumpto.title;break;case"jumptoTurn":value=strings.jumpto.turn;break;case"jumptoUnavailable":value=strings.jumpto.unavailable;break;case"savesTitle":value=strings.saves.title;break;case"savesDisallowed":value=strings.saves.disallowed;break;case"savesIncapable":value=strings.saves.incapable;break;case"savesLabelAuto":value=strings.saves.labelAuto;break;case"savesLabelDelete":value=strings.saves.labelDelete;break;case"savesLabelExport":value=strings.saves.labelExport;break;case"savesLabelImport":value=strings.saves.labelImport;break;case"savesLabelLoad":value=strings.saves.labelLoad;break;case"savesLabelClear":value=strings.saves.labelClear;break;case"savesLabelSave":value=strings.saves.labelSave;break;case"savesLabelSlot":value=strings.saves.labelSlot;break;case"savesUnavailable":value=strings.saves.unavailable;break;case"savesUnknownDate":value=strings.saves.unknownDate;break;case"settingsTitle":value=strings.settings.title;break;case"settingsOff":value=strings.settings.off;break;case"settingsOn":value=strings.settings.on;break;case"settingsReset":value=strings.settings.reset;break;case"restartTitle":value=strings.restart.title;break;case"restartPrompt":value=strings.restart.prompt;break;case"shareTitle":value=strings.share.title;break;case"alertTitle":break;case"autoloadTitle":value=strings.autoload.title;break;case"autoloadCancel":value=strings.autoload.cancel;break;case"autoloadOk":value=strings.autoload.ok;break;case"autoloadPrompt":value=strings.autoload.prompt;break;case"macroBackText":value=strings.macros.back.text;break;case"macroReturnText":value=strings.macros.return.text}value&&(l10nStrings[id]=value.replace(/%\w+%/g,(function(pat){return"{".concat(pat.slice(1,-1),"}")})))}catch(ex){}}))}},get:{value:function(ids,overrides){if(!ids)return"";var selectedId,id=((Array.isArray(ids)?ids:[ids]).some((function(id){return!!l10nStrings.hasOwnProperty(id)&&(selectedId=id,!0)})),selectedId);if(!id)return"";for(var processed=l10nStrings[id],iteration=0;_hasPatternRe.test(processed);){if(++iteration>50)throw new Error("L10n.get exceeded maximum replacement iterations, probable infinite loop");_patternRe.lastIndex=0,processed=processed.replace(_patternRe,(function(pat){var subId=pat.slice(1,-1);return overrides&&overrides.hasOwnProperty(subId)?overrides[subId]:l10nStrings.hasOwnProperty(subId)?l10nStrings[subId]:void 0}))}return processed}}}))),_patternRe,_hasPatternRe,strings={errors:{},warnings:{},debugView:{},uiBar:{},jumpto:{},saves:{},settings:{},restart:{},share:{},autoload:{},macros:{back:{},return:{}}},l10nStrings={identity:"game",aborting:"Aborting",cancel:"Cancel",close:"Close",ok:"OK",errorTitle:"Error",errorToggle:"Toggle the error view",errorNonexistentPassage:'the passage "{passage}" does not exist',errorSaveDiskLoadFailed:"failed to load save file from disk",errorSaveMissingData:"save is missing required data. Either the loaded file is not a save or the save has become corrupted",errorSaveIdMismatch:"save is from the wrong {identity}",_warningIntroLacking:"Your browser either lacks or has disabled",_warningOutroDegraded:", so this {identity} is running in a degraded mode. You may be able to continue, however, some parts may not work properly.",warningNoWebStorage:"{_warningIntroLacking} the Web Storage API{_warningOutroDegraded}",warningDegraded:"{_warningIntroLacking} some of the capabilities required by this {identity}{_warningOutroDegraded}",debugBarToggle:"Toggle the debug bar",debugBarNoWatches:"— no watches set —",debugBarAddWatch:"Add watch",debugBarDeleteWatch:"Delete watch",debugBarWatchAll:"Watch all",debugBarWatchNone:"Delete all",debugBarLabelAdd:"Add",debugBarLabelWatch:"Watch",debugBarLabelTurn:"Turn",debugBarLabelViews:"Views",debugBarViewsToggle:"Toggle the debug views",debugBarWatchToggle:"Toggle the watch panel",uiBarToggle:"Toggle the UI bar",uiBarBackward:"Go backward within the {identity} history",uiBarForward:"Go forward within the {identity} history",uiBarJumpto:"Jump to a specific point within the {identity} history",jumptoTitle:"Jump To",jumptoTurn:"Turn",jumptoUnavailable:"No jump points currently available…",savesTitle:"Saves",savesDisallowed:"Saving has been disallowed on this passage.",savesIncapable:"{_warningIntroLacking} the capabilities required to support saves, so saves have been disabled for this session.",savesLabelAuto:"Autosave",savesLabelDelete:"Delete",savesLabelExport:"Save to Disk…",savesLabelImport:"Load from Disk…",savesLabelLoad:"Load",savesLabelClear:"Delete All",savesLabelSave:"Save",savesLabelSlot:"Slot",savesUnavailable:"No save slots found…",savesUnknownDate:"unknown",settingsTitle:"Settings",settingsOff:"Off",settingsOn:"On",settingsReset:"Reset to Defaults",restartTitle:"Restart",restartPrompt:"Are you sure that you want to restart? Unsaved progress will be lost.",shareTitle:"Share",alertTitle:"Alert",autoloadTitle:"Autoload",autoloadCancel:"Go to start",autoloadOk:"Load autosave",autoloadPrompt:"An autosave exists. Load it now or go to the start?",macroBackText:"Back",macroReturnText:"Return"},Config=(_debug=!1,_addVisitedLinkClass=!1,_cleanupWikifierOutput=!1,_loadDelay=0,_audioPauseOnFadeToZero=!0,_audioPreloadMetadata=!0,_historyControls=!0,_historyMaxStates=40,_macrosIfAssignmentError=!0,_macrosMaxLoopIterations=1e3,_macrosTypeSkipKey=" ",_macrosTypeVisitedPassages=!0,_passagesDisplayTitles=!1,_passagesNobr=!1,_savesId="untitled-story",_savesSlots=8,_savesTryDiskOnMobile=!0,_uiStowBarInitially=800,_uiUpdateStoryElements=!0,_errHistoryModeDeprecated="Config.history.mode has been deprecated and is no longer used by SugarCube, please remove it from your code",Object.freeze({get debug(){return _debug},set debug(value){_debug=Boolean(value)},get addVisitedLinkClass(){return _addVisitedLinkClass},set addVisitedLinkClass(value){_addVisitedLinkClass=Boolean(value)},get cleanupWikifierOutput(){return _cleanupWikifierOutput},set cleanupWikifierOutput(value){_cleanupWikifierOutput=Boolean(value)},get loadDelay(){return _loadDelay},set loadDelay(value){if(!Number.isSafeInteger(value)||value<0)throw new RangeError("Config.loadDelay must be a non-negative integer");_loadDelay=value},audio:Object.freeze({get pauseOnFadeToZero(){return _audioPauseOnFadeToZero},set pauseOnFadeToZero(value){_audioPauseOnFadeToZero=Boolean(value)},get preloadMetadata(){return _audioPreloadMetadata},set preloadMetadata(value){_audioPreloadMetadata=Boolean(value)}}),history:Object.freeze({get controls(){return _historyControls},set controls(value){var controls=Boolean(value);if(1===_historyMaxStates&&controls)throw new Error("Config.history.controls must be false when Config.history.maxStates is 1");_historyControls=controls},get maxStates(){return _historyMaxStates},set maxStates(value){if(!Number.isSafeInteger(value)||value<1)throw new RangeError("Config.history.maxStates must be a positive integer");_historyMaxStates=value,_historyControls&&1===value&&(_historyControls=!1)},get mode(){throw new Error(_errHistoryModeDeprecated)},set mode(_){throw new Error(_errHistoryModeDeprecated)},get tracking(){throw new Error("Config.history.tracking has been deprecated, use Config.history.maxStates instead")},set tracking(_){throw new Error("Config.history.tracking has been deprecated, use Config.history.maxStates instead")}}),macros:Object.freeze({get ifAssignmentError(){return _macrosIfAssignmentError},set ifAssignmentError(value){_macrosIfAssignmentError=Boolean(value)},get maxLoopIterations(){return _macrosMaxLoopIterations},set maxLoopIterations(value){if(!Number.isSafeInteger(value)||value<1)throw new RangeError("Config.macros.maxLoopIterations must be a positive integer");_macrosMaxLoopIterations=value},get typeSkipKey(){return _macrosTypeSkipKey},set typeSkipKey(value){_macrosTypeSkipKey=String(value)},get typeVisitedPassages(){return _macrosTypeVisitedPassages},set typeVisitedPassages(value){_macrosTypeVisitedPassages=Boolean(value)}}),navigation:Object.freeze({get override(){return _navigationOverride},set override(value){if(!(null==value||value instanceof Function))throw new TypeError("Config.navigation.override must be a function or null/undefined (received: ".concat(Util.getType(value),")"));_navigationOverride=value}}),passages:Object.freeze({get descriptions(){return _passagesDescriptions},set descriptions(value){if(null!=value){var valueType=Util.getType(value);if("boolean"!==valueType&&"Object"!==valueType&&"function"!==valueType)throw new TypeError("Config.passages.descriptions must be a boolean, object, function, or null/undefined (received: ".concat(valueType,")"))}_passagesDescriptions=value},get displayTitles(){return _passagesDisplayTitles},set displayTitles(value){_passagesDisplayTitles=Boolean(value)},get nobr(){return _passagesNobr},set nobr(value){_passagesNobr=Boolean(value)},get onProcess(){return _passagesOnProcess},set onProcess(value){if(null!=value){var valueType=Util.getType(value);if("function"!==valueType)throw new TypeError("Config.passages.onProcess must be a function or null/undefined (received: ".concat(valueType,")"))}_passagesOnProcess=value},get start(){return _passagesStart},set start(value){if(null!=value){var valueType=Util.getType(value);if("string"!==valueType)throw new TypeError("Config.passages.start must be a string or null/undefined (received: ".concat(valueType,")"))}_passagesStart=value},get transitionOut(){return _passagesTransitionOut},set transitionOut(value){if(null!=value){var valueType=Util.getType(value);if("string"!==valueType&&("number"!==valueType||!Number.isSafeInteger(value)||value<0))throw new TypeError("Config.passages.transitionOut must be a string, non-negative integer, or null/undefined (received: ".concat(valueType,")"))}_passagesTransitionOut=value}}),saves:Object.freeze({get autoload(){return _savesAutoload},set autoload(value){if(null!=value){var valueType=Util.getType(value);if("boolean"!==valueType&&"string"!==valueType&&"function"!==valueType)throw new TypeError("Config.saves.autoload must be a boolean, string, function, or null/undefined (received: ".concat(valueType,")"))}_savesAutoload=value},get autosave(){return _savesAutosave},set autosave(value){if(null!=value){var valueType=Util.getType(value);if("string"===valueType)return void(_savesAutosave=[value]);if("boolean"!==valueType&&("Array"!==valueType||!value.every((function(item){return"string"==typeof item})))&&"function"!==valueType)throw new TypeError("Config.saves.autosave must be a boolean, Array<string>, function, or null/undefined (received: ".concat(valueType).concat("Array"===valueType?"<any>":"",")"))}_savesAutosave=value},get id(){return _savesId},set id(value){if("string"!=typeof value||""===value)throw new TypeError("Config.saves.id must be a non-empty string (received: ".concat(Util.getType(value),")"));_savesId=value},get isAllowed(){return _savesIsAllowed},set isAllowed(value){if(!(null==value||value instanceof Function))throw new TypeError("Config.saves.isAllowed must be a function or null/undefined (received: ".concat(Util.getType(value),")"));_savesIsAllowed=value},get slots(){return _savesSlots},set slots(value){if(!Number.isSafeInteger(value)||value<0)throw new TypeError("Config.saves.slots must be a non-negative integer (received: ".concat(Util.getType(value),")"));_savesSlots=value},get tryDiskOnMobile(){return _savesTryDiskOnMobile},set tryDiskOnMobile(value){_savesTryDiskOnMobile=Boolean(value)},get version(){return _savesVersion},set version(value){_savesVersion=value},get onLoad(){throw new Error("Config.saves.onLoad has been deprecated, use the Save.onLoad API instead")},set onLoad(value){console.warn("Config.saves.onLoad has been deprecated, use the Save.onLoad API instead"),Save.onLoad.add(value)},get onSave(){throw new Error("Config.saves.onSave has been deprecated, use the Save.onSave API instead")},set onSave(value){console.warn("Config.saves.onSave has been deprecated, use the Save.onSave API instead"),Save.onSave.add(value)}}),ui:Object.freeze({get stowBarInitially(){return _uiStowBarInitially},set stowBarInitially(value){var valueType=Util.getType(value);if("boolean"!==valueType&&("number"!==valueType||!Number.isSafeInteger(value)||value<0))throw new TypeError("Config.ui.stowBarInitially must be a boolean or non-negative integer (received: ".concat(valueType,")"));_uiStowBarInitially=value},get updateStoryElements(){return _uiUpdateStoryElements},set updateStoryElements(value){_uiUpdateStoryElements=Boolean(value)}})})),_navigationOverride,_passagesDescriptions,_passagesStart,_passagesOnProcess,_passagesTransitionOut,_savesAutoload,_savesAutosave,_savesIsAllowed,_savesVersion,_debug,_addVisitedLinkClass,_cleanupWikifierOutput,_loadDelay,_audioPauseOnFadeToZero,_audioPreloadMetadata,_historyControls,_historyMaxStates,_macrosIfAssignmentError,_macrosMaxLoopIterations,_macrosTypeSkipKey,_macrosTypeVisitedPassages,_passagesDisplayTitles,_passagesNobr,_savesId,_savesSlots,_savesTryDiskOnMobile,_uiStowBarInitially,_uiUpdateStoryElements,_errHistoryModeDeprecated,SimpleAudio=function(){var _hasPromise,_gestureEventNames=Object.freeze(["click","contextmenu","dblclick","keyup","mouseup","pointerup","touchend"]),_specialIds=Object.freeze([":not",":all",":looped",":muted",":paused",":playing"]),_formatSpecRe=/^([\w-]+)\s*\|\s*(\S.*)$/,_badIdRe=/[:\s]/,_tracks=new Map,_groups=new Map,_lists=new Map,_subscribers=new Map,_masterRate=1,_masterVolume=1,_masterMute=!1,_masterMuteOnHidden=!1,_playReturnsPromise=(_hasPromise=null,function(){if(null!==_hasPromise)return _hasPromise;if(_hasPromise=!1,Has.audio)try{var audio=document.createElement("audio");audio.muted=!0;var value=audio.play();value.catch((function(){})),_hasPromise=value instanceof Promise}catch(ex){}return _hasPromise}),AudioTrack=function(){function AudioTrack(obj){if(_classCallCheck(this,AudioTrack),obj instanceof Array)this._create(obj);else{if(!(obj instanceof AudioTrack))throw new Error("sources parameter must be either an array, of URIs or source objects, or an AudioTrack instance");this._copy(obj)}}return _createClass(AudioTrack,[{key:"_create",value:function(sourceList){var dataUriRe=/^data:\s*audio\/(?:x-)?([^;,]+)\s*[;,]/i,extRe=/\.([^./\\]+)$/,formats=AudioTrack.formats,usedSources=[],audio=document.createElement("audio");audio.preload="none",sourceList.forEach((function(src){var srcUri=null;switch(_typeof(src)){case"string":var match;if("data:"===src.slice(0,5)){if(null===(match=dataUriRe.exec(src)))throw new Error("source data URI missing media type")}else if(null===(match=extRe.exec(Util.parseUrl(src).pathname)))throw new Error("source URL missing file extension");formats[match[1]]&&(srcUri=src);break;case"object":if(null===src)throw new Error("source object cannot be null");if(!src.hasOwnProperty("src"))throw new Error('source object missing required "src" property');if(!src.hasOwnProperty("format"))throw new Error('source object missing required "format" property');formats[src.format]&&(srcUri=src.src);break;default:throw new Error("invalid source value (type: ".concat(_typeof(src),")"))}if(null!==srcUri){var source=document.createElement("source");source.src=srcUri,audio.appendChild(source),usedSources.push(srcUri)}})),audio.hasChildNodes()&&Config.audio.preloadMetadata&&(audio.preload="metadata"),this._finalize(audio,usedSources,clone(sourceList))}},{key:"_copy",value:function(obj){this._finalize(obj.audio.cloneNode(!0),clone(obj.sources),clone(obj.originals))}},{key:"_finalize",value:function(audio,sources,originals){var _this3=this;Object.defineProperties(this,{audio:{configurable:!0,value:audio},sources:{value:Object.freeze(sources)},originals:{value:Object.freeze(originals)},_error:{writable:!0,value:!1},_faderId:{writable:!0,value:null},_mute:{writable:!0,value:!1},_rate:{writable:!0,value:1},_volume:{writable:!0,value:1}}),jQuery(this.audio).on("loadstart.AudioTrack",(function(){return _this3._error=!1})).on("error.AudioTrack",(function(){return _this3._error=!0})).find("source:last-of-type").on("error.AudioTrack",(function(){return _this3._trigger("error")})),function(id,callback){if("function"!=typeof callback)throw new Error("callback parameter must be a function");_subscribers.set(id,callback)}(this,(function(mesg){if(_this3.audio)switch(mesg){case"loadwithscreen":if(_this3.hasSource()){var lockId=LoadScreen.lock();_this3.one("canplaythrough.AudioTrack_loadwithscreen error.AudioTrack_loadwithscreen",(function(){jQuery(this).off(".AudioTrack_loadwithscreen"),LoadScreen.unlock(lockId)})).load()}break;case"load":_this3.load();break;case"mute":_this3._updateAudioMute();break;case"rate":_this3._updateAudioRate();break;case"stop":_this3.stop();break;case"volume":_this3._updateAudioVolume();break;case"unload":_this3.unload()}else unsubscribe(_this3)})),this._updateAudioMute(),this._updateAudioRate(),this._updateAudioVolume()}},{key:"_trigger",value:function(eventName){jQuery(this.audio).triggerHandler(eventName)}},{key:"_destroy",value:function(){unsubscribe(this),this.audio&&(jQuery(this.audio).off(),this.unload(),this._error=!0,delete this.audio)}},{key:"clone",value:function(){return new AudioTrack(this)}},{key:"load",value:function(){var _this4=this;if(this.fadeStop(),this.audio.pause(),!this.audio.hasChildNodes()){if(0===this.sources.length)return;this.sources.forEach((function(srcUri){var source=document.createElement("source");source.src=srcUri,_this4.audio.appendChild(source)}))}"auto"!==this.audio.preload&&(this.audio.preload="auto"),this.isLoading()||this.audio.load()}},{key:"unload",value:function(){this.fadeStop(),this.stop();var audio=this.audio;for(audio.preload="none";audio.hasChildNodes();)audio.removeChild(audio.firstChild);audio.load()}},{key:"play",value:function(){var _this5=this;if(!this.hasSource())return Promise.reject(new Error("none of the candidate sources were acceptable"));if(this.isUnloaded())return Promise.reject(new Error("no sources are loaded"));if(this.isFailed())return Promise.reject(new Error("failed to load any of the sources"));"auto"!==this.audio.preload&&(this.audio.preload="auto");var namespace=".AudioTrack_play";return _playReturnsPromise()?this.audio.play():new Promise((function(resolve,reject){_this5.isPlaying()?resolve():(jQuery(_this5.audio).off(namespace).one("error".concat(namespace," playing").concat(namespace," timeupdate").concat(namespace),(function(ev){jQuery(_this5).off(namespace),"error"===ev.type?reject(new Error("unknown audio play error")):resolve()})),_this5.audio.play())}))}},{key:"playWhenAllowed",value:function(){var _this6=this;this.play().catch((function(){var gestures=_gestureEventNames.map((function(name){return"".concat(name,".AudioTrack_playWhenAllowed")})).join(" ");jQuery(document).one(gestures,(function(){jQuery(document).off(".AudioTrack_playWhenAllowed"),_this6.audio.play()}))}))}},{key:"pause",value:function(){this.audio.pause()}},{key:"stop",value:function(){this.audio.pause(),this.time(0),this._trigger(":stopped")}},{key:"fade",value:function(duration,toVol,fromVol){var _this7=this;if("number"!=typeof duration)throw new TypeError("duration parameter must be a number");if("number"!=typeof toVol)throw new TypeError("toVolume parameter must be a number");if(null!=fromVol&&"number"!=typeof fromVol)throw new TypeError("fromVolume parameter must be a number");if(!this.hasSource())return Promise.reject(new Error("none of the candidate sources were acceptable"));if(this.isUnloaded())return Promise.reject(new Error("no sources are loaded"));if(this.isFailed())return Promise.reject(new Error("failed to load any of the sources"));this.fadeStop();var from=Math.clamp(null==fromVol?this.volume():fromVol,0,1),to=Math.clamp(toVol,0,1);return from!==to?(this.volume(from),jQuery(this.audio).off("timeupdate.AudioTrack_fade").one("timeupdate.AudioTrack_fade",(function(){var min,max;from<to?(min=from,max=to):(min=to,max=from);var time=Math.max(duration,1),delta=(to-from)/(time/.025);_this7._trigger(":fading"),_this7._faderId=setInterval((function(){_this7.isPlaying()?(_this7.volume(Math.clamp(_this7.volume()+delta,min,max)),Config.audio.pauseOnFadeToZero&&0===_this7.volume()&&_this7.pause(),_this7.volume()===to&&(_this7.fadeStop(),_this7._trigger(":faded"))):_this7.fadeStop()}),25)})),this.play()):void 0}},{key:"fadeIn",value:function(duration,fromVol){return this.fade(duration,1,fromVol)}},{key:"fadeOut",value:function(duration,fromVol){return this.fade(duration,0,fromVol)}},{key:"fadeStop",value:function(){null!==this._faderId&&(clearInterval(this._faderId),this._faderId=null)}},{key:"loop",value:function(_loop){return null==_loop?this.audio.loop:(this.audio.loop=!!_loop,this)}},{key:"mute",value:function(_mute){return null==_mute?this._mute:(this._mute=!!_mute,this._updateAudioMute(),this)}},{key:"_updateAudioMute",value:function(){this.audio.muted=this._mute||_masterMute}},{key:"rate",value:function(_rate){if(null==_rate)return this._rate;if("number"!=typeof _rate)throw new TypeError("rate parameter must be a number");return this._rate=Math.clamp(_rate,.2,5),this._updateAudioRate(),this}},{key:"_updateAudioRate",value:function(){this.audio.playbackRate=Math.clamp(this._rate*_masterRate,.2,5)}},{key:"time",value:function(_time){var _this8=this;if(null==_time)return this.audio.currentTime;if("number"!=typeof _time)throw new TypeError("time parameter must be a number");return this.hasMetadata()?this.audio.currentTime=_time:jQuery(this.audio).off("loadedmetadata.AudioTrack_time").one("loadedmetadata.AudioTrack_time",(function(){return _this8.audio.currentTime=_time})),this}},{key:"volume",value:function(_volume){if(null==_volume)return this._volume;if("number"!=typeof _volume)throw new TypeError("volume parameter must be a number");return this._volume=Math.clamp(_volume,0,1),this._updateAudioVolume(),this}},{key:"_updateAudioVolume",value:function(){this.audio.volume=Math.clamp(this._volume*_masterVolume,0,1)}},{key:"duration",value:function(){return this.audio.duration}},{key:"remaining",value:function(){return this.audio.duration-this.audio.currentTime}},{key:"isFailed",value:function(){return this._error}},{key:"isLoading",value:function(){return this.audio.networkState===HTMLMediaElement.NETWORK_LOADING}},{key:"isUnloaded",value:function(){return!this.audio.hasChildNodes()}},{key:"isUnavailable",value:function(){return!this.hasSource()||this.isUnloaded()||this.isFailed()}},{key:"isPlaying",value:function(){return!this.audio.paused&&this.hasSomeData()}},{key:"isPaused",value:function(){return this.audio.paused&&(this.audio.duration===1/0||this.audio.currentTime>0)&&!this.audio.ended}},{key:"isStopped",value:function(){return this.audio.paused&&0===this.audio.currentTime}},{key:"isEnded",value:function(){return this.audio.ended}},{key:"isFading",value:function(){return null!==this._faderId}},{key:"isSeeking",value:function(){return this.audio.seeking}},{key:"hasSource",value:function(){return this.sources.length>0}},{key:"hasNoData",value:function(){return this.audio.readyState===HTMLMediaElement.HAVE_NOTHING}},{key:"hasMetadata",value:function(){return this.audio.readyState>=HTMLMediaElement.HAVE_METADATA}},{key:"hasSomeData",value:function(){return this.audio.readyState>=HTMLMediaElement.HAVE_CURRENT_DATA}},{key:"hasData",value:function(){return this.audio.readyState===HTMLMediaElement.HAVE_ENOUGH_DATA}},{key:"on",value:function(){for(var _len5=arguments.length,args=new Array(_len5),_key5=0;_key5<_len5;_key5++)args[_key5]=arguments[_key5];return jQuery.fn.on.apply(jQuery(this.audio),args),this}},{key:"one",value:function(){for(var _len6=arguments.length,args=new Array(_len6),_key6=0;_key6<_len6;_key6++)args[_key6]=arguments[_key6];return jQuery.fn.one.apply(jQuery(this.audio),args),this}},{key:"off",value:function(){for(var _len7=arguments.length,args=new Array(_len7),_key7=0;_key7<_len7;_key7++)args[_key7]=arguments[_key7];return jQuery.fn.off.apply(jQuery(this.audio),args),this}}]),AudioTrack}();Object.defineProperties(AudioTrack,{formats:{value:function(){var audio=document.createElement("audio"),types=new Map;function canPlay(mimeType){return types.has(mimeType)||types.set(mimeType,""!==audio.canPlayType(mimeType).replace(/^no$/i,"")),types.get(mimeType)}return Object.assign(Object.create(null),{aac:canPlay("audio/aac"),caf:canPlay("audio/x-caf")||canPlay("audio/caf"),flac:canPlay("audio/x-flac")||canPlay("audio/flac"),mp3:canPlay('audio/mpeg; codecs="mp3"')||canPlay("audio/mpeg")||canPlay("audio/mp3")||canPlay("audio/mpa"),mpeg:canPlay("audio/mpeg"),m4a:canPlay("audio/x-m4a")||canPlay("audio/m4a")||canPlay("audio/aac"),mp4:canPlay("audio/x-mp4")||canPlay("audio/mp4")||canPlay("audio/aac"),ogg:canPlay("audio/ogg"),oga:canPlay("audio/ogg"),opus:canPlay('audio/ogg; codecs="opus"')||canPlay("audio/opus"),wav:canPlay('audio/wave; codecs="1"')||canPlay('audio/wav; codecs="1"')||canPlay("audio/wave")||canPlay("audio/wav"),wave:canPlay('audio/wave; codecs="1"')||canPlay('audio/wav; codecs="1"')||canPlay("audio/wave")||canPlay("audio/wav"),weba:canPlay("audio/webm"),webm:canPlay("audio/webm")})}()}});var AudioList=function(){function AudioList(obj){if(_classCallCheck(this,AudioList),obj instanceof Array)this._create(obj);else{if(!(obj instanceof AudioList))throw new Error("tracks parameter must be either an array, of track objects, or an AudioTrack instance");this._copy(obj)}}return _createClass(AudioList,[{key:"_create",value:function(trackList){var _this9=this;this._finalize(trackList.map((function(trackObj){if("object"!==_typeof(trackObj))throw new Error("tracks parameter array members must be objects");var own,rate,track,volume;if(trackObj instanceof AudioTrack)own=!0,rate=trackObj.rate(),track=trackObj.clone(),volume=trackObj.volume();else{if(!trackObj.hasOwnProperty("track"))throw new Error('track object missing required "track" property');if(!(trackObj.track instanceof AudioTrack))throw new Error('track object\'s "track" property must be an AudioTrack object');own=trackObj.hasOwnProperty("own")&&trackObj.own,rate=trackObj.hasOwnProperty("rate")?trackObj.rate:trackObj.track.rate(),track=trackObj.track,volume=trackObj.hasOwnProperty("volume")?trackObj.volume:trackObj.track.volume()}return track.stop(),track.loop(!1),track.mute(!1),track.rate(rate),track.volume(volume),track.on("ended.AudioList",(function(){return _this9._onEnd()})),{own:own,track:track,volume:volume,rate:rate}})))}},{key:"_copy",value:function(obj){this._finalize(clone(obj.tracks))}},{key:"_finalize",value:function(tracks){Object.defineProperties(this,{tracks:{configurable:!0,value:Object.freeze(tracks)},queue:{configurable:!0,value:[]},current:{writable:!0,value:null},_rate:{writable:!0,value:1},_volume:{writable:!0,value:1},_mute:{writable:!0,value:!1},_loop:{writable:!0,value:!1},_shuffle:{writable:!0,value:!1}})}},{key:"_destroy",value:function(){this.stop(),this.tracks.filter((function(trackObj){return trackObj.own})).forEach((function(trackObj){return trackObj.track._destroy()})),delete this.tracks,delete this.queue}},{key:"load",value:function(){this.tracks.forEach((function(trackObj){return trackObj.track.load()}))}},{key:"unload",value:function(){this.stop(),this.tracks.forEach((function(trackObj){return trackObj.track.unload()}))}},{key:"play",value:function(){return null!==this.current&&!this.current.track.isUnavailable()&&!this.current.track.isEnded()||(0===this.queue.length&&this._fillQueue(),this._next())?this.current.track.play():Promise.reject(new Error("no tracks were available"))}},{key:"playWhenAllowed",value:function(){var _this10=this;this.play().catch((function(){var gestures=_gestureEventNames.map((function(name){return"".concat(name,".AudioList_playWhenAllowed")})).join(" ");jQuery(document).one(gestures,(function(){jQuery(document).off(".AudioList_playWhenAllowed"),_this10.play()}))}))}},{key:"pause",value:function(){null!==this.current&&this.current.track.pause()}},{key:"stop",value:function(){null!==this.current&&(this.current.track.stop(),this.current=null),this._drainQueue()}},{key:"skip",value:function(){this._next()?this.current.track.play():this._loop&&this.play()}},{key:"fade",value:function(duration,toVol,fromVol){if("number"!=typeof duration)throw new TypeError("duration parameter must be a number");if("number"!=typeof toVol)throw new TypeError("toVolume parameter must be a number");if(null!=fromVol&&"number"!=typeof fromVol)throw new TypeError("fromVolume parameter must be a number");if(0===this.queue.length&&this._fillQueue(),null!==this.current&&!this.current.track.isUnavailable()&&!this.current.track.isEnded()||this._next()){var adjFromVol,adjToVol=Math.clamp(toVol,0,1)*this.current.volume;return null!=fromVol&&(adjFromVol=Math.clamp(fromVol,0,1)*this.current.volume),this._volume=toVol,this.current.track.fade(duration,adjToVol,adjFromVol)}}},{key:"fadeIn",value:function(duration,fromVol){return this.fade(duration,1,fromVol)}},{key:"fadeOut",value:function(duration,fromVol){return this.fade(duration,0,fromVol)}},{key:"fadeStop",value:function(){null!==this.current&&this.current.track.fadeStop()}},{key:"loop",value:function(_loop2){return null==_loop2?this._loop:(this._loop=!!_loop2,this)}},{key:"mute",value:function(_mute2){return null==_mute2?this._mute:(this._mute=!!_mute2,null!==this.current&&this.current.track.mute(this._mute),this)}},{key:"rate",value:function(_rate2){if(null==_rate2)return this._rate;if("number"!=typeof _rate2)throw new TypeError("rate parameter must be a number");return this._rate=Math.clamp(_rate2,.2,5),null!==this.current&&this.current.track.rate(this._rate*this.current.rate),this}},{key:"shuffle",value:function(_shuffle){var _this11=this;if(null==_shuffle)return this._shuffle;if(this._shuffle=!!_shuffle,this.queue.length>0&&(this._fillQueue(),!this._shuffle&&null!==this.current&&this.queue.length>1)){var _this$queue,firstIdx=this.queue.findIndex((function(trackObj){return trackObj===_this11.current}));if(-1!==firstIdx)(_this$queue=this.queue).push.apply(_this$queue,_toConsumableArray(this.queue.splice(0,firstIdx+1)))}return this}},{key:"volume",value:function(_volume2){if(null==_volume2)return this._volume;if("number"!=typeof _volume2)throw new TypeError("volume parameter must be a number");return this._volume=Math.clamp(_volume2,0,1),null!==this.current&&this.current.track.volume(this._volume*this.current.volume),this}},{key:"duration",value:function(){if(arguments.length>0)throw new Error("duration takes no parameters");return this.tracks.map((function(trackObj){return trackObj.track.duration()})).reduce((function(prev,cur){return prev+cur}),0)}},{key:"remaining",value:function(){if(arguments.length>0)throw new Error("remaining takes no parameters");var remainingTime=this.queue.map((function(trackObj){return trackObj.track.duration()})).reduce((function(prev,cur){return prev+cur}),0);return null!==this.current&&(remainingTime+=this.current.track.remaining()),remainingTime}},{key:"time",value:function(){if(arguments.length>0)throw new Error("time takes no parameters");return this.duration()-this.remaining()}},{key:"isPlaying",value:function(){return null!==this.current&&this.current.track.isPlaying()}},{key:"isPaused",value:function(){return null===this.current||this.current.track.isPaused()}},{key:"isStopped",value:function(){return 0===this.queue.length&&null===this.current}},{key:"isEnded",value:function(){return 0===this.queue.length&&(null===this.current||this.current.track.isEnded())}},{key:"isFading",value:function(){return null!==this.current&&this.current.track.isFading()}},{key:"_next",value:function(){var nextTrack;for(null!==this.current&&(this.current.track.stop(),this.current=null);nextTrack=this.queue.shift();)if(!nextTrack.track.isUnavailable()){this.current=nextTrack;break}return null!==this.current&&(this.current.track.mute(this._mute),this.current.track.rate(this._rate*this.current.rate),this.current.track.volume(this._volume*this.current.volume),this.current.track.loop(!1),!0)}},{key:"_onEnd",value:function(){if(0===this.queue.length){if(!this._loop)return;this._fillQueue()}this._next()&&this.current.track.play()}},{key:"_drainQueue",value:function(){this.queue.splice(0)}},{key:"_fillQueue",value:function(){var _this$queue2;this._drainQueue(),(_this$queue2=this.queue).push.apply(_this$queue2,_toConsumableArray(this.tracks.filter((function(trackObj){return!trackObj.track.isUnavailable()})))),0!==this.queue.length&&this._shuffle&&(this.queue.shuffle(),this.queue.length>1&&this.queue[0]===this.current&&this.queue.push(this.queue.shift()))}}]),AudioList}(),AudioRunner=function(){function AudioRunner(list){if(_classCallCheck(this,AudioRunner),!(list instanceof Set||list instanceof AudioRunner))throw new TypeError("list parameter must be a Set or a AudioRunner instance");Object.defineProperties(this,{trackIds:{value:new Set(list instanceof AudioRunner?list.trackIds:list)}})}return _createClass(AudioRunner,[{key:"load",value:function(){AudioRunner._run(this.trackIds,AudioTrack.prototype.load)}},{key:"unload",value:function(){AudioRunner._run(this.trackIds,AudioTrack.prototype.unload)}},{key:"play",value:function(){AudioRunner._run(this.trackIds,AudioTrack.prototype.play)}},{key:"playWhenAllowed",value:function(){AudioRunner._run(this.trackIds,AudioTrack.prototype.playWhenAllowed)}},{key:"pause",value:function(){AudioRunner._run(this.trackIds,AudioTrack.prototype.pause)}},{key:"stop",value:function(){AudioRunner._run(this.trackIds,AudioTrack.prototype.stop)}},{key:"fade",value:function(duration,toVol,fromVol){if(null==duration||null==toVol)throw new Error("fade requires parameters");AudioRunner._run(this.trackIds,AudioTrack.prototype.fade,duration,toVol,fromVol)}},{key:"fadeIn",value:function(duration,fromVol){if(null==duration)throw new Error("fadeIn requires a parameter");AudioRunner._run(this.trackIds,AudioTrack.prototype.fadeIn,duration,fromVol)}},{key:"fadeOut",value:function(duration,fromVol){if(null==duration)throw new Error("fadeOut requires a parameter");AudioRunner._run(this.trackIds,AudioTrack.prototype.fadeOut,duration,fromVol)}},{key:"fadeStop",value:function(){AudioRunner._run(this.trackIds,AudioTrack.prototype.fadeStop)}},{key:"loop",value:function(_loop3){if(null==_loop3)throw new Error("loop requires a parameter");return AudioRunner._run(this.trackIds,AudioTrack.prototype.loop,_loop3),this}},{key:"mute",value:function(_mute3){if(null==_mute3)throw new Error("mute requires a parameter");return AudioRunner._run(this.trackIds,AudioTrack.prototype.mute,_mute3),this}},{key:"rate",value:function(_rate3){if(null==_rate3)throw new Error("rate requires a parameter");return AudioRunner._run(this.trackIds,AudioTrack.prototype.rate,_rate3),this}},{key:"time",value:function(_time2){if(null==_time2)throw new Error("time requires a parameter");return AudioRunner._run(this.trackIds,AudioTrack.prototype.time,_time2),this}},{key:"volume",value:function(_volume3){if(null==_volume3)throw new Error("volume requires a parameter");return AudioRunner._run(this.trackIds,AudioTrack.prototype.volume,_volume3),this}},{key:"on",value:function(){for(var _len8=arguments.length,args=new Array(_len8),_key8=0;_key8<_len8;_key8++)args[_key8]=arguments[_key8];return AudioRunner._run.apply(AudioRunner,[this.trackIds,AudioTrack.prototype.on].concat(args)),this}},{key:"one",value:function(){for(var _len9=arguments.length,args=new Array(_len9),_key9=0;_key9<_len9;_key9++)args[_key9]=arguments[_key9];return AudioRunner._run.apply(AudioRunner,[this.trackIds,AudioTrack.prototype.one].concat(args)),this}},{key:"off",value:function(){for(var _len10=arguments.length,args=new Array(_len10),_key10=0;_key10<_len10;_key10++)args[_key10]=arguments[_key10];return AudioRunner._run.apply(AudioRunner,[this.trackIds,AudioTrack.prototype.off].concat(args)),this}}],[{key:"_run",value:function(ids,fn){for(var _len11=arguments.length,args=new Array(_len11>2?_len11-2:0),_key11=2;_key11<_len11;_key11++)args[_key11-2]=arguments[_key11];ids.forEach((function(id){var track=_tracks.get(id);track&&fn.apply(track,args)}))}}]),AudioRunner}();var _runnerParseSelector=function(){var notWsRe=/\S/g,parenRe=/[()]/g;function processNegation(str,startPos){var match;if(notWsRe.lastIndex=startPos,null===(match=notWsRe.exec(str))||"("!==match[0])throw new Error('invalid ":not()" syntax: missing parentheticals');parenRe.lastIndex=notWsRe.lastIndex;for(var start=notWsRe.lastIndex,result={str:"",nextMatch:-1},depth=1;null!==(match=parenRe.exec(str));)if("("===match[0]?++depth:--depth,depth<1){result.nextMatch=parenRe.lastIndex,result.str=str.slice(start,result.nextMatch-1);break}return result}return function parseSelector(idArg){for(var match,ids=[],idRe=/:?[^\s:()]+/g;null!==(match=idRe.exec(idArg));){var id=match[0];if(":not"===id){if(0===ids.length)throw new Error('invalid negation: no group ID preceded ":not()"');var parent=ids[ids.length-1];if(":"!==parent.id[0])throw new Error('invalid negation of track "'.concat(parent.id,'": only groups may be negated with ":not()"'));var negation=processNegation(idArg,idRe.lastIndex);if(-1===negation.nextMatch)throw new Error('unknown error parsing ":not()"');idRe.lastIndex=negation.nextMatch,parent.not=parseSelector(negation.str)}else ids.push({id:id})}return ids}}();function masterMute(mute){if(null==mute)return _masterMute;publish("mute",_masterMute=!!mute)}function unsubscribe(id){_subscribers.delete(id)}function publish(mesg,data){_subscribers.forEach((function(fn){return fn(mesg,data)}))}function _newTrack(sources){return new AudioTrack(sources.map((function(source){if("data:"!==source.slice(0,5)&&Story.has(source)){var passage=Story.get(source);if(passage.tags.includes("Twine.audio"))return passage.text.trim()}var match=_formatSpecRe.exec(source);return null===match?source:{format:match[1],src:match[2]}})))}return Object.freeze(Object.defineProperties({},{tracks:{value:Object.freeze(Object.defineProperties({},{add:{value:function(){if(arguments.length<2){var errors=[];throw arguments.length<1&&errors.push("track ID"),arguments.length<2&&errors.push("sources"),new Error("no ".concat(errors.join(" or ")," specified"))}var id=String(arguments[0]).trim(),what='track ID "'.concat(id,'"');if(_badIdRe.test(id))throw new Error("invalid ".concat(what,": track IDs must not contain colons or whitespace"));var track,sources=Array.isArray(arguments[1])?Array.from(arguments[1]):Array.from(arguments).slice(1);try{track=_newTrack(sources)}catch(ex){throw new Error("".concat(what,": error during track initialization: ").concat(ex.message))}if(Config.debug&&!track.hasSource())throw new Error("".concat(what,": no supported audio sources found"));_tracks.has(id)&&_tracks.get(id)._destroy(),_tracks.set(id,track)}},delete:{value:function(id){return _tracks.has(id)&&_tracks.get(id)._destroy(),_tracks.delete(id)}},clear:{value:function(){_tracks.forEach((function(track){return track._destroy()})),_tracks.clear()}},has:{value:function(id){return _tracks.has(id)}},get:{value:function(id){return _tracks.get(id)||null}}}))},groups:{value:Object.freeze(Object.defineProperties({},{add:{value:function(){if(arguments.length<2){var errors=[];throw arguments.length<1&&errors.push("group ID"),arguments.length<2&&errors.push("track IDs"),new Error("no ".concat(errors.join(" or ")," specified"))}var id=String(arguments[0]).trim(),what='group ID "'.concat(id,'"');if(":"!==id[0]||_badIdRe.test(id.slice(1)))throw new Error("invalid ".concat(what,": group IDs must start with a colon and must not contain colons or whitespace"));if(_specialIds.includes(id))throw new Error("cannot clobber special ".concat(what));var group,trackIds=Array.isArray(arguments[1])?Array.from(arguments[1]):Array.from(arguments).slice(1);try{group=new Set(trackIds.map((function(trackId){if(!_tracks.has(trackId))throw new Error('track "'.concat(trackId,'" does not exist'));return trackId})))}catch(ex){throw new Error("".concat(what,": error during group initialization: ").concat(ex.message))}_groups.set(id,Object.freeze(Array.from(group)))}},delete:{value:function(id){return _groups.delete(id)}},clear:{value:function(){_groups.clear()}},has:{value:function(id){return _groups.has(id)}},get:{value:function(id){return _groups.get(id)||null}}}))},lists:{value:Object.freeze(Object.defineProperties({},{add:{value:function(){if(arguments.length<2){var errors=[];throw arguments.length<1&&errors.push("list ID"),arguments.length<2&&errors.push("track IDs"),new Error("no ".concat(errors.join(" or ")," specified"))}var id=String(arguments[0]).trim(),what='list ID "'.concat(id,'"');if(_badIdRe.test(id))return this.error("invalid ".concat(what,": list IDs must not contain colons or whitespace"));var list,descriptors=Array.isArray(arguments[1])?Array.from(arguments[1]):Array.from(arguments).slice(1);try{list=new AudioList(descriptors.map((function(desc){if(null===desc)throw new Error("track descriptor must be a string or object (type: null)");switch(_typeof(desc)){case"string":desc={id:desc};break;case"object":if(!desc.hasOwnProperty("id")&&!desc.hasOwnProperty("sources"))throw new Error('track descriptor must contain one of either an "id" or a "sources" property');if(desc.hasOwnProperty("id")&&desc.hasOwnProperty("sources"))throw new Error('track descriptor must contain either an "id" or a "sources" property, not both');break;default:throw new Error("track descriptor must be a string or object (type: ".concat(_typeof(desc),")"))}var own,track,volume;if(desc.hasOwnProperty("id")){if("string"!=typeof desc.id)throw new Error('"id" property must be a string');if(!_tracks.has(desc.id))throw new Error('track "'.concat(desc.id,'" does not exist'));track=_tracks.get(desc.id)}else if(desc.hasOwnProperty("sources")){if(!Array.isArray(desc.sources)||0===desc.sources.length)throw new Error('"sources" property must be a non-empty array');if(desc.hasOwnProperty("own"))throw new Error('"own" property is not allowed with the "sources" property');try{track=_newTrack(desc.sources),own=!0}catch(ex){throw new Error("error during track initialization: ".concat(ex.message))}if(Config.debug&&!track.hasSource())throw new Error("no supported audio sources found")}if(desc.hasOwnProperty("own")){if("boolean"!=typeof desc.own)throw new Error('"own" property must be a boolean');(own=desc.own)&&(track=track.clone())}if(desc.hasOwnProperty("volume")){if("number"!=typeof desc.volume||Number.isNaN(desc.volume)||!Number.isFinite(desc.volume)||desc.volume<0)throw new Error('"volume" property must be a non-negative finite number');volume=desc.volume}return{own:null!=own&&own,track:track,volume:null!=volume?volume:track.volume()}})))}catch(ex){throw new Error("".concat(what,": error during playlist initialization: ").concat(ex.message))}_lists.has(id)&&_lists.get(id)._destroy(),_lists.set(id,list)}},delete:{value:function(id){return _lists.has(id)&&_lists.get(id)._destroy(),_lists.delete(id)}},clear:{value:function(){_lists.forEach((function(list){return list._destroy()})),_lists.clear()}},has:{value:function(id){return _lists.has(id)}},get:{value:function(id){return _lists.get(id)||null}}}))},select:{value:function(){if(0===arguments.length)throw new Error("no track selector specified");var selector=String(arguments[0]).trim(),trackIds=new Set;try{var renderIds=function renderIds(idObj){var ids,id=idObj.id;switch(id){case":all":ids=allIds;break;case":looped":ids=allIds.filter((function(id){return _tracks.get(id).loop()}));break;case":muted":ids=allIds.filter((function(id){return _tracks.get(id).mute()}));break;case":paused":ids=allIds.filter((function(id){return _tracks.get(id).isPaused()}));break;case":playing":ids=allIds.filter((function(id){return _tracks.get(id).isPlaying()}));break;default:ids=":"===id[0]?_groups.get(id):[id]}if(idObj.hasOwnProperty("not")){var negated=idObj.not.map((function(idObj){return renderIds(idObj)})).flat(1/0);ids=ids.filter((function(id){return!negated.includes(id)}))}return ids},allIds=Array.from(_tracks.keys());_runnerParseSelector(selector).forEach((function(idObj){return renderIds(idObj).forEach((function(id){if(!_tracks.has(id))throw new Error('track "'.concat(id,'" does not exist'));trackIds.add(id)}))}))}catch(ex){throw new Error("error during runner initialization: ".concat(ex.message))}return new AudioRunner(trackIds)}},load:{value:function(){publish("load")}},loadWithScreen:{value:function(){publish("loadwithscreen")}},mute:{value:masterMute},muteOnHidden:{value:function(mute){if(!Visibility.isEnabled())return!1;if(null==mute)return _masterMuteOnHidden;var namespace=".SimpleAudio_masterMuteOnHidden";if(_masterMuteOnHidden=!!mute){var visibilityChange="".concat(Visibility.changeEvent).concat(namespace);jQuery(document).off(namespace).on(visibilityChange,(function(){return masterMute(Visibility.isHidden())})),Visibility.isHidden()&&masterMute(!0)}else jQuery(document).off(namespace)}},rate:{value:function(rate){if(null==rate)return _masterRate;if("number"!=typeof rate||Number.isNaN(rate)||!Number.isFinite(rate))throw new Error("rate must be a finite number");publish("rate",_masterRate=Math.clamp(rate,.2,5))}},stop:{value:function(){publish("stop")}},unload:{value:function(){publish("unload")}},volume:{value:function(volume){if(null==volume)return _masterVolume;if("number"!=typeof volume||Number.isNaN(volume)||!Number.isFinite(volume))throw new Error("volume must be a finite number");publish("volume",_masterVolume=Math.clamp(volume,0,1))}}}))}(),State=function(){var _history=[],_active=momentCreate(),_activeIndex=-1,_expired=[],_prng=null,_tempVariables={};function stateMarshal(noDelta){var stateObj={index:_activeIndex};return noDelta?stateObj.history=clone(_history):stateObj.delta=historyDeltaEncode(_history),_expired.length>0&&(stateObj.expired=_toConsumableArray(_expired)),null!==_prng&&(stateObj.seed=_prng.seed),stateObj}function stateUnmarshal(stateObj,noDelta){if(null==stateObj)throw new Error("state object is null or undefined");if(!stateObj.hasOwnProperty(noDelta?"history":"delta")||0===stateObj[noDelta?"history":"delta"].length)throw new Error("state object has no history or history is empty");if(!stateObj.hasOwnProperty("index"))throw new Error("state object has no index");if(null!==_prng&&!stateObj.hasOwnProperty("seed"))throw new Error("state object has no seed, but PRNG is enabled");if(null===_prng&&stateObj.hasOwnProperty("seed"))throw new Error("state object has seed, but PRNG is disabled");_history=noDelta?clone(stateObj.history):historyDeltaDecode(stateObj.delta),_activeIndex=stateObj.index,_expired=stateObj.hasOwnProperty("expired")?_toConsumableArray(stateObj.expired):[],stateObj.hasOwnProperty("seed")&&(_prng.seed=stateObj.seed),momentActivate(_activeIndex)}function momentCreate(title,variables){return{title:null==title?"":String(title),variables:null==variables?{}:clone(variables)}}function momentActivate(moment){if(null==moment)throw new Error("moment activation attempted with null or undefined");switch(_typeof(moment)){case"object":_active=clone(moment);break;case"number":if(historyIsEmpty())throw new Error("moment activation attempted with index on empty history");if(moment<0||moment>=historySize())throw new RangeError("moment activation attempted with out-of-bounds index; need [0, ".concat(historySize()-1,"], got ").concat(moment));_active=clone(_history[moment]);break;default:throw new TypeError('moment activation attempted with a "'.concat(_typeof(moment),'"; must be an object or valid history stack index'))}return null!==_prng&&(_prng=PRNGWrapper.unmarshal({seed:_prng.seed,pull:_active.pull})),session.set("state",stateMarshal()),jQuery.event.trigger(":historyupdate"),_active}function historyLength(){return _activeIndex+1}function historySize(){return _history.length}function historyIsEmpty(){return 0===_history.length}function historyTop(){return _history.length>0?_history[_history.length-1]:null}function historyGoTo(index){return!(null==index||index<0||index>=historySize()||index===_activeIndex)&&(momentActivate(_activeIndex=index),!0)}function historyDeltaEncode(historyArr){if(!Array.isArray(historyArr))return null;if(0===historyArr.length)return[];for(var delta=[historyArr[0]],i=1,iend=historyArr.length;i<iend;++i)delta.push(Diff.diff(historyArr[i-1],historyArr[i]));return delta}function historyDeltaDecode(delta){if(!Array.isArray(delta))return null;if(0===delta.length)return[];for(var historyArr=[clone(delta[0])],i=1,iend=delta.length;i<iend;++i)historyArr.push(Diff.patch(historyArr[i-1],delta[i]));return historyArr}function prngInit(seed,useEntropy){var scriptSection;if(!historyIsEmpty())throw scriptSection="the Story JavaScript",new Error("State.prng.init must be called during initialization, within either ".concat(scriptSection," or the StoryInit special passage"));_prng=new PRNGWrapper(seed,useEntropy),_active.pull=_prng.pull}function metadataDelete(key){if("string"!=typeof key)throw new TypeError("State.metadata.delete key parameter must be a string (received: ".concat(_typeof(key),")"));var store=storage.get("metadata");store&&store.hasOwnProperty(key)&&(1===Object.keys(store).length?storage.delete("metadata"):(delete store[key],storage.set("metadata",store)))}return Object.freeze(Object.defineProperties({},{reset:{value:function(){session.delete("state"),_history=[],_active=momentCreate(),_activeIndex=-1,_expired=[],_prng=null===_prng?null:new PRNGWrapper(_prng.seed,!1)}},restore:{value:function(){if(session.has("state")){var stateObj=session.get("state");return null!=stateObj&&(stateUnmarshal(stateObj),!0)}return!1}},marshalForSave:{value:function(){return stateMarshal(!0)}},unmarshalForSave:{value:function(stateObj){return stateUnmarshal(stateObj,!0)}},expired:{get:function(){return _expired}},turns:{get:function(){return _expired.length+historyLength()}},passages:{get:function(){return _expired.concat(_history.slice(0,historyLength()).map((function(moment){return moment.title})))}},hasPlayed:{value:function(title){return null!=title&&""!==title&&(!!_expired.includes(title)||!!_history.slice(0,historyLength()).some((function(moment){return moment.title===title})))}},active:{get:function(){return _active}},activeIndex:{get:function(){return _activeIndex}},passage:{get:function(){return _active.title}},variables:{get:function(){return _active.variables}},history:{get:function(){return _history}},length:{get:historyLength},size:{get:historySize},isEmpty:{value:historyIsEmpty},current:{get:function(){return _history.length>0?_history[_activeIndex]:null}},top:{get:historyTop},bottom:{get:function(){return _history.length>0?_history[0]:null}},index:{value:function(index){return historyIsEmpty()||index<0||index>_activeIndex?null:_history[index]}},peek:{value:function(offset){if(historyIsEmpty())return null;var lengthOffset=1+(offset?Math.abs(offset):0);return lengthOffset>historyLength()?null:_history[historyLength()-lengthOffset]}},has:{value:function(title){if(historyIsEmpty()||null==title||""===title)return!1;for(var i=_activeIndex;i>=0;--i)if(_history[i].title===title)return!0;return!1}},create:{value:function(title){for(0,historyLength()<historySize()&&_history.splice(historyLength(),historySize()-historyLength()),_history.push(momentCreate(title,_active.variables)),_prng&&(historyTop().pull=_prng.pull);historySize()>Config.history.maxStates;)_expired.push(_history.shift().title);return momentActivate(_activeIndex=historySize()-1),historyLength()}},goTo:{value:historyGoTo},go:{value:function(offset){return null!=offset&&0!==offset&&historyGoTo(_activeIndex+offset)}},deltaEncode:{value:historyDeltaEncode},deltaDecode:{value:historyDeltaDecode},prng:{value:Object.freeze(Object.defineProperties({},{init:{value:prngInit},isEnabled:{value:function(){return null!==_prng}},pull:{get:function(){return _prng?_prng.pull:NaN}},seed:{get:function(){return _prng?_prng.seed:null}}}))},random:{value:function(){return _prng?_prng.random():Math.random()}},clearTemporary:{value:function(){TempVariables=_tempVariables={}}},temporary:{get:function(){return _tempVariables}},getVar:{value:function(varExpression){try{return Scripting.evalTwineScript(varExpression)}catch(ex){}}},setVar:{value:function(varExpression,value){try{return Scripting.evalTwineScript("".concat(varExpression," = evalTwineScript$Data$"),null,value),!0}catch(ex){}return!1}},metadata:{value:Object.freeze(Object.defineProperties({},{clear:{value:function(){storage.delete("metadata")}},delete:{value:metadataDelete},entries:{value:function(){var store=storage.get("metadata");return store&&Object.entries(store)}},get:{value:function(key){if("string"!=typeof key)throw new TypeError("State.metadata.get key parameter must be a string (received: ".concat(_typeof(key),")"));var store=storage.get("metadata");return store&&store.hasOwnProperty(key)?store[key]:undefined}},has:{value:function(key){if("string"!=typeof key)throw new TypeError("State.metadata.has key parameter must be a string (received: ".concat(_typeof(key),")"));var store=storage.get("metadata");return store&&store.hasOwnProperty(key)}},keys:{value:function(){var store=storage.get("metadata");return store&&Object.keys(store)}},set:{value:function(key,value){if("string"!=typeof key)throw new TypeError("State.metadata.set key parameter must be a string (received: ".concat(_typeof(key),")"));if(void 0===value)metadataDelete(key);else{var store=storage.get("metadata")||{};store[key]=value,storage.set("metadata",store)}}},size:{get:function(){var store=storage.get("metadata");return store?Object.keys(store).length:0}}}))},initPRNG:{value:prngInit},restart:{value:function(){return Engine.restart()}},backward:{value:function(){return Engine.backward()}},forward:{value:function(){return Engine.forward()}},display:{value:function(){return Engine.display.apply(Engine,arguments)}},show:{value:function(){return Engine.show.apply(Engine,arguments)}},play:{value:function(){return Engine.play.apply(Engine,arguments)}}}))}(),Scripting=function(){function addAccessibleClickHandler(targets,selector,handler,one,namespace){if(arguments.length<2)throw new Error("addAccessibleClickHandler insufficient number of parameters");var fn,opts;if("function"==typeof selector?(fn=selector,opts={namespace:one,one:!!handler}):(fn=handler,opts={namespace:namespace,one:!!one,selector:selector}),"function"!=typeof fn)throw new TypeError("addAccessibleClickHandler handler parameter must be a function");return jQuery(targets).ariaClick(opts,fn)}function insertElement(place,type,id,classNames,text,title){var $el=jQuery(document.createElement(type));return id&&$el.attr("id",id),classNames&&$el.addClass(classNames),title&&$el.attr("title",title),text&&$el.text(text),place&&$el.appendTo(place),$el[0]}function insertText(place,text){jQuery(place).append(document.createTextNode(text))}function removeChildren(node){jQuery(node).empty()}function removeElement(node){jQuery(node).remove()}function fade(el,options){var current,intervalId,direction="in"===options.fade?1:-1,proxy=el.cloneNode(!0);function setOpacity(el,opacity){el.style.zoom=1,el.style.filter="alpha(opacity=".concat(Math.floor(100*opacity),")"),el.style.opacity=opacity}el.parentNode.replaceChild(proxy,el),"in"===options.fade?(current=0,proxy.style.visibility="visible"):current=1,setOpacity(proxy,current),intervalId=window.setInterval((function(){current+=.05*direction,setOpacity(proxy,Math.easeInOut(current)),(1===direction&&current>=1||-1===direction&&current<=0)&&(el.style.visibility="in"===options.fade?"visible":"hidden",proxy.parentNode.replaceChild(el,proxy),proxy=null,window.clearInterval(intervalId),options.onComplete&&options.onComplete())}),25)}function scrollWindowTo(el,incrementBy){var increment=null!=incrementBy?Number(incrementBy):.1;Number.isNaN(increment)||!Number.isFinite(increment)||increment<0?increment=.1:increment>1&&(increment=1);var intervalId,start=window.scrollY?window.scrollY:document.body.scrollTop,end=function(el){var posTop=function(el){var curtop=0;for(;el.offsetParent;)curtop+=el.offsetTop,el=el.offsetParent;return curtop}(el),posBottom=posTop+el.offsetHeight,winTop=window.scrollY?window.scrollY:document.body.scrollTop,winHeight=window.innerHeight?window.innerHeight:document.body.clientHeight,winBottom=winTop+winHeight;return posTop>=winTop&&posBottom>winBottom&&el.offsetHeight<winHeight?posTop-(winHeight-el.offsetHeight)+20:posTop}(el),distance=Math.abs(start-end),direction=start>end?-1:1,progress=0;intervalId=window.setInterval((function(){progress+=increment,window.scroll(0,start+direction*(distance*Math.easeInOut(progress))),progress>=1&&window.clearInterval(intervalId)}),25)}function toStringOrDefault(value){return stringFrom(value)}function either(){if(0!==arguments.length)return Array.prototype.concat.apply([],arguments).random()}function forget(key){if("string"!=typeof key)throw new TypeError("forget key parameter must be a string (received: ".concat(Util.getType(key),")"));State.metadata.delete(key)}function hasVisited(){if(0===arguments.length)throw new Error("hasVisited called with insufficient parameters");if(State.isEmpty())return!1;for(var needles=Array.prototype.concat.apply([],arguments),played=State.passages,i=0,iend=needles.length;i<iend;++i)if(!played.includes(needles[i]))return!1;return!0}function lastVisited(){if(0===arguments.length)throw new Error("lastVisited called with insufficient parameters");if(State.isEmpty())return-1;for(var needles=Array.prototype.concat.apply([],arguments),played=State.passages,uBound=played.length-1,turns=State.turns,i=0,iend=needles.length;i<iend&&turns>-1;++i){var lastIndex=played.lastIndexOf(needles[i]);turns=Math.min(turns,-1===lastIndex?-1:uBound-lastIndex)}return turns}function memorize(key,value){if("string"!=typeof key)throw new TypeError("memorize key parameter must be a string (received: ".concat(Util.getType(key),")"));State.metadata.set(key,value)}function passage(){return State.passage}function previous(){var passages=State.passages;if(arguments.length>0){var offset=Number(arguments[0]);if(!Number.isSafeInteger(offset)||offset<1)throw new RangeError("previous offset parameter must be a positive integer greater than zero");return passages.length>offset?passages[passages.length-1-offset]:""}for(var i=passages.length-2;i>=0;--i)if(passages[i]!==State.passage)return passages[i];return""}function random(){var min,max;switch(arguments.length){case 0:throw new Error("random called with insufficient parameters");case 1:min=0,max=Math.trunc(arguments[0]);break;default:min=Math.trunc(arguments[0]),max=Math.trunc(arguments[1])}if(!Number.isInteger(min))throw new Error("random min parameter must be an integer");if(!Number.isInteger(max))throw new Error("random max parameter must be an integer");if(min>max){var _ref6=[max,min];min=_ref6[0],max=_ref6[1]}return Math.floor(State.random()*(max-min+1))+min}function randomFloat(){var min,max;switch(arguments.length){case 0:throw new Error("randomFloat called with insufficient parameters");case 1:min=0,max=Number(arguments[0]);break;default:min=Number(arguments[0]),max=Number(arguments[1])}if(Number.isNaN(min)||!Number.isFinite(min))throw new Error("randomFloat min parameter must be a number");if(Number.isNaN(max)||!Number.isFinite(max))throw new Error("randomFloat max parameter must be a number");if(min>max){var _ref7=[max,min];min=_ref7[0],max=_ref7[1]}return State.random()*(max-min)+min}function recall(key,defaultValue){if("string"!=typeof key)throw new TypeError("recall key parameter must be a string (received: ".concat(Util.getType(key),")"));return State.metadata.has(key)?State.metadata.get(key):defaultValue}function tags(){if(0===arguments.length)return Story.get(State.passage).tags.slice(0);for(var passages=Array.prototype.concat.apply([],arguments),tags=[],i=0,iend=passages.length;i<iend;++i)tags=tags.concat(Story.get(passages[i]).tags);return tags}function temporary(){return State.temporary}function time(){return null===Engine.lastPlay?0:Util.now()-Engine.lastPlay}function turns(){return State.turns}function variables(){return State.variables}function visited(){if(State.isEmpty())return 0;for(var needles=Array.prototype.concat.apply([],0===arguments.length?[State.passage]:arguments),played=State.passages,count=State.turns,i=0,iend=needles.length;i<iend&&count>0;++i)count=Math.min(count,played.count(needles[i]));return count}function visitedTags(){if(0===arguments.length)throw new Error("visitedTags called with insufficient parameters");if(State.isEmpty())return 0;for(var needles=Array.prototype.concat.apply([],arguments),nLength=needles.length,played=State.passages,seen=new Map,count=0,i=0,iend=played.length;i<iend;++i){var title=played[i];if(seen.has(title))seen.get(title)&&++count;else{var _tags2=Story.get(title).tags;if(_tags2.length>0){for(var found=0,j=0;j<nLength;++j)_tags2.includes(needles[j])&&++found;found===nLength?(++count,seen.set(title,!0)):seen.set(title,!1)}}}return count}var _ref8=function(){function slugifyUrl(url){return Util.parseUrl(url).path.replace(/^[^\w]+|[^\w]+$/g,"").replace(/[^\w]+/g,"-").toLocaleLowerCase()}function addScript(url){return new Promise((function(resolve,reject){jQuery(document.createElement("script")).one("load abort error",(function(ev){jQuery(ev.target).off(),"load"===ev.type?resolve(ev.target):reject(new Error('importScripts failed to load the script "'.concat(url,'".')))})).appendTo(document.head).attr({id:"script-imported-".concat(slugifyUrl(url)),type:"text/javascript",src:url})}))}function addStyle(url){return new Promise((function(resolve,reject){jQuery(document.createElement("link")).one("load abort error",(function(ev){jQuery(ev.target).off(),"load"===ev.type?resolve(ev.target):reject(new Error('importStyles failed to load the stylesheet "'.concat(url,'".')))})).appendTo(document.head).attr({id:"style-imported-".concat(slugifyUrl(url)),rel:"stylesheet",href:url})}))}function sequence(callbacks){return callbacks.reduce((function(seq,fn){return seq.then(fn)}),Promise.resolve())}return{importScripts:function(){for(var _len12=arguments.length,urls=new Array(_len12),_key12=0;_key12<_len12;_key12++)urls[_key12]=arguments[_key12];return Promise.all(urls.map((function(oneOrSeries){return Array.isArray(oneOrSeries)?sequence(oneOrSeries.map((function(url){return function(){return addScript(url)}}))):addScript(oneOrSeries)})))},importStyles:function(){for(var _len13=arguments.length,urls=new Array(_len13),_key13=0;_key13<_len13;_key13++)urls[_key13]=arguments[_key13];return Promise.all(urls.map((function(oneOrSeries){return Array.isArray(oneOrSeries)?sequence(oneOrSeries.map((function(url){return function(){return addStyle(url)}}))):addStyle(oneOrSeries)})))}}}(),importScripts=_ref8.importScripts,importStyles=_ref8.importStyles,parse=function(){var tokenTable=Util.toEnum({$:"State.variables.",_:"State.temporary.",to:"=",eq:"==",neq:"!=",is:"===",isnot:"!==",gt:">",gte:">=",lt:"<",lte:"<=",and:"&&",or:"||",not:"!",def:'"undefined" !== typeof',ndef:'"undefined" === typeof'}),parseRe=new RegExp(["(?:\"\"|''|``)",'(?:"(?:\\\\.|[^"\\\\])+")',"(?:'(?:\\\\.|[^'\\\\])+')","(`(?:\\\\.|[^`\\\\])+`)","(?:[=+\\-*\\/%<>&\\|\\^~!?:,;\\(\\)\\[\\]{}]+)","([^\"'=+\\-*\\/%<>&\\|\\^~!?:,;\\(\\)\\[\\]{}\\s]+)"].join("|"),"g"),notSpaceRe=/\S/,varTest=new RegExp("^".concat(Patterns.variable)),withColonTestRe=/^\s*:/,withNotTestRe=/^\s+not\b/;function parse(rawCodeString){if(0!==parseRe.lastIndex)throw new RangeError("Scripting.parse last index is non-zero at start");for(var match,code=rawCodeString;null!==(match=parseRe.exec(code));)if(match[1]){var rawTemplate=match[1],parsedTemplate=parseTemplate(rawTemplate);parsedTemplate!==rawTemplate&&(code=code.splice(match.index,rawTemplate.length,parsedTemplate),parseRe.lastIndex+=parsedTemplate.length-rawTemplate.length)}else if(match[2]){var token=match[2];if("$"===token||"_"===token)continue;if(varTest.test(token))token=token[0];else if("is"===token){var start=parseRe.lastIndex,ahead=code.slice(start);withNotTestRe.test(ahead)&&(code=code.splice(start,ahead.search(notSpaceRe)),token="isnot")}else{var _ahead=code.slice(parseRe.lastIndex);if(withColonTestRe.test(_ahead))continue}tokenTable[token]&&(code=code.splice(match.index,token.length,tokenTable[token]),parseRe.lastIndex+=tokenTable[token].length-token.length)}return code}var templateGroupStartRe=/\$\{/g,templateGroupParseRe=new RegExp(["(?:\"\"|'')",'(?:"(?:\\\\.|[^"\\\\])+")',"(?:'(?:\\\\.|[^'\\\\])+')","(\\{)","(\\})"].join("|"),"g");function parseTemplate(rawTemplateLiteral){if(0!==templateGroupStartRe.lastIndex)throw new RangeError("Scripting.parse last index is non-zero at start of template literal");for(var startMatch,template=rawTemplateLiteral;null!==(startMatch=templateGroupStartRe.exec(template));){var startIdx=startMatch.index+2,endIdx=startIdx,depth=1,endMatch=void 0;for(templateGroupParseRe.lastIndex=startIdx;null!==(endMatch=templateGroupParseRe.exec(template));)if(endMatch[1]?++depth:endMatch[2]&&--depth,0===depth){endIdx=endMatch.index;break}if(endIdx>startIdx){var parseIndex=parseRe.lastIndex,rawGroup=template.slice(startIdx,endIdx);parseRe.lastIndex=0;var parsedGroup=parse(rawGroup);parseRe.lastIndex=parseIndex,template=template.splice(startIdx,rawGroup.length,parsedGroup),templateGroupStartRe.lastIndex+=parsedGroup.length-rawGroup.length}}return template}return parse}();function evalJavaScript(code,output,data){return function(code,output,evalJavaScript$Data$){return eval(code)}.call(output?{output:output}:null,String(code),output,data)}function evalTwineScript(code,output,data){return function(code,output,evalTwineScript$Data$){return eval(code)}.call(output?{output:output}:null,parse(String(code)),output,data)}return Object.freeze(Object.defineProperties({},{parse:{value:parse},evalJavaScript:{value:evalJavaScript},evalTwineScript:{value:evalTwineScript}}))}(),_ref9=function(){var Lexer=function(){function Lexer(source,initialState){if(_classCallCheck(this,Lexer),arguments.length<2)throw new Error("Lexer constructor called with too few parameters (source:string , initialState:function)");Object.defineProperties(this,{source:{value:source},initial:{value:initialState},state:{writable:!0,value:initialState},start:{writable:!0,value:0},pos:{writable:!0,value:0},depth:{writable:!0,value:0},items:{writable:!0,value:[]},data:{writable:!0,value:{}}})}return _createClass(Lexer,[{key:"reset",value:function(){this.state=this.initial,this.start=0,this.pos=0,this.depth=0,this.items=[],this.data={}}},{key:"run",value:function(){for(;null!==this.state;)this.state=this.state(this);return this.items}},{key:"nextItem",value:function(){for(;0===this.items.length&&null!==this.state;)this.state=this.state(this);return this.items.shift()}},{key:"next",value:function(){return this.pos>=this.source.length?-1:this.source[this.pos++]}},{key:"peek",value:function(){return this.pos>=this.source.length?-1:this.source[this.pos]}},{key:"backup",value:function(num){this.pos-=num||1}},{key:"forward",value:function(num){this.pos+=num||1}},{key:"ignore",value:function(){this.start=this.pos}},{key:"accept",value:function(valid){var ch=this.next();return-1!==ch&&(!!valid.includes(ch)||(this.backup(),!1))}},{key:"acceptRe",value:function(validRe){var ch=this.next();return-1!==ch&&(!!validRe.test(ch)||(this.backup(),!1))}},{key:"acceptRun",value:function(valid){for(;;){var ch=this.next();if(-1===ch)return;if(!valid.includes(ch))break}this.backup()}},{key:"acceptRunRe",value:function(validRe){for(;;){var ch=this.next();if(-1===ch)return;if(!validRe.test(ch))break}this.backup()}},{key:"emit",value:function(type){this.items.push({type:type,text:this.source.slice(this.start,this.pos),start:this.start,pos:this.pos}),this.start=this.pos}},{key:"error",value:function(type,message){if(arguments.length<2)throw new Error("Lexer.prototype.error called with too few parameters (type:number , message:string)");return this.items.push({type:type,message:message,text:this.source.slice(this.start,this.pos),start:this.start,pos:this.pos}),null}}],[{key:"enumFromNames",value:function(names){var obj=names.reduce((function(obj,name,i){return obj[name]=i,obj}),{});return Object.freeze(Object.assign(Object.create(null),obj))}}]),Lexer}();return{EOF:-1,Lexer:Lexer}}(),EOF=_ref9.EOF,Lexer=_ref9.Lexer,Wikifier=function(){var _optionsStack,lookaheadRe,idOrClassRe,_callDepth=0,Wikifier=function(){function Wikifier(destination,source,options){_classCallCheck(this,Wikifier),Wikifier.Parser.Profile.isEmpty()&&Wikifier.Parser.Profile.compile(),Object.defineProperties(this,{source:{value:String(source)},options:{writable:!0,value:Object.assign({profile:"all"},options)},nextMatch:{writable:!0,value:0},output:{writable:!0,value:null},_rawArgs:{writable:!0,value:""}}),null==destination?this.output=document.createDocumentFragment():destination.jquery?this.output=destination[0]:this.output=destination;try{++_callDepth,this.subWikify(this.output),1===_callDepth&&Config.cleanupWikifierOutput&&convertBreaks(this.output)}finally{--_callDepth}}return _createClass(Wikifier,[{key:"subWikify",value:function(output,terminator,options){var newOptions,oldOptions,oldOutput=this.output;this.output=output,Wikifier.Option.length>0&&(newOptions=Object.assign(newOptions||{},Wikifier.Option.options)),null!==options&&"object"===_typeof(options)&&(newOptions=Object.assign(newOptions||{},options)),newOptions&&(oldOptions=this.options,this.options=Object.assign({},this.options,newOptions));var terminatorMatch,parserMatch,parsersProfile=Wikifier.Parser.Profile.get(this.options.profile),terminatorRegExp=terminator?new RegExp("(?:".concat(terminator,")"),this.options.ignoreTerminatorCase?"gim":"gm"):null;do{if(parsersProfile.parserRegExp.lastIndex=this.nextMatch,terminatorRegExp&&(terminatorRegExp.lastIndex=this.nextMatch),parserMatch=parsersProfile.parserRegExp.exec(this.source),(terminatorMatch=terminatorRegExp?terminatorRegExp.exec(this.source):null)&&(!parserMatch||terminatorMatch.index<=parserMatch.index))return terminatorMatch.index>this.nextMatch&&this.outputText(this.output,this.nextMatch,terminatorMatch.index),this.matchStart=terminatorMatch.index,this.matchLength=terminatorMatch[0].length,this.matchText=terminatorMatch[0],this.nextMatch=terminatorRegExp.lastIndex,this.output=oldOutput,void(oldOptions&&(this.options=oldOptions));if(parserMatch){parserMatch.index>this.nextMatch&&this.outputText(this.output,this.nextMatch,parserMatch.index),this.matchStart=parserMatch.index,this.matchLength=parserMatch[0].length,this.matchText=parserMatch[0],this.nextMatch=parsersProfile.parserRegExp.lastIndex;for(var matchingParser=void 0,i=1,iend=parserMatch.length;i<iend;++i)if(parserMatch[i]){matchingParser=i-1;break}if(parsersProfile.parsers[matchingParser].handler(this),null!=TempState.break)break}}while(terminatorMatch||parserMatch);null==TempState.break?this.nextMatch<this.source.length&&(this.outputText(this.output,this.nextMatch,this.source.length),this.nextMatch=this.source.length):this.output.lastChild&&this.output.lastChild.nodeType===Node.ELEMENT_NODE&&"BR"===this.output.lastChild.nodeName.toUpperCase()&&jQuery(this.output.lastChild).remove(),this.output=oldOutput,oldOptions&&(this.options=oldOptions)}},{key:"outputText",value:function(destination,startPos,endPos){jQuery(destination).append(document.createTextNode(this.source.substring(startPos,endPos)))}},{key:"rawArgs",value:function(){return this._rawArgs}},{key:"fullArgs",value:function(){return Scripting.parse(this._rawArgs)}}],[{key:"wikifyEval",value:function(text){var output=document.createDocumentFragment();new Wikifier(output,text);var errors=output.querySelector(".error");if(null!==errors)throw new Error(errors.textContent.replace(errorPrologRegExp,""));return output}},{key:"createInternalLink",value:function(destination,passage,text,callback){var $link=jQuery(document.createElement("a"));return null!=passage&&($link.attr("data-passage",passage),Story.has(passage)?($link.addClass("link-internal"),Config.addVisitedLinkClass&&State.hasPlayed(passage)&&$link.addClass("link-visited")):$link.addClass("link-broken"),$link.ariaClick({one:!0},(function(){"function"==typeof callback&&callback(),Engine.play(passage)}))),text&&$link.append(document.createTextNode(text)),destination&&$link.appendTo(destination),$link[0]}},{key:"createExternalLink",value:function(destination,url,text){var $link=jQuery(document.createElement("a")).attr("target","_blank").addClass("link-external").text(text).appendTo(destination);return null!=url&&$link.attr({href:url,tabindex:0}),$link[0]}},{key:"isExternalLink",value:function(link){return!Story.has(link)&&(new RegExp("^".concat(Patterns.url),"gim").test(link)||/[/.?#]/.test(link))}}]),Wikifier}();return Object.defineProperty(Wikifier,"Option",{value:(_optionsStack=[],Object.freeze(Object.defineProperties({},{length:{get:function(){return _optionsStack.length}},options:{get:function(){return Object.assign.apply(Object,[{}].concat(_toConsumableArray(_optionsStack)))}},clear:{value:function(){_optionsStack=[]}},get:{value:function(idx){return _optionsStack[idx]}},pop:{value:function(){return _optionsStack.pop()}},push:{value:function(options){if("object"!==_typeof(options)||null===options)throw new TypeError("Wikifier.Option.push options parameter must be an object (received: ".concat(Util.getType(options),")"));return _optionsStack.push(options)}}})))}),Object.defineProperty(Wikifier,"Parser",{value:function(){var _profiles,_parsers=[];function parsersHas(name){return!!_parsers.find((function(parser){return parser.name===name}))}return Object.freeze(Object.defineProperties({},{parsers:{get:function(){return _parsers}},add:{value:function(parser){if("object"!==_typeof(parser))throw new Error("Wikifier.Parser.add parser parameter must be an object");if(!parser.hasOwnProperty("name"))throw new Error('parser object missing required "name" property');if("string"!=typeof parser.name)throw new Error('parser object "name" property must be a string');if(!parser.hasOwnProperty("match"))throw new Error('parser object missing required "match" property');if("string"!=typeof parser.match)throw new Error('parser object "match" property must be a string');if(!parser.hasOwnProperty("handler"))throw new Error('parser object missing required "handler" property');if("function"!=typeof parser.handler)throw new Error('parser object "handler" property must be a function');if(parser.hasOwnProperty("profiles")&&!Array.isArray(parser.profiles))throw new Error('parser object "profiles" property must be an array');if(parsersHas(parser.name))throw new Error('cannot clobber existing parser "'.concat(parser.name,'"'));_parsers.push(parser)}},delete:{value:function(name){var parser=_parsers.find((function(parser){return parser.name===name}));parser&&_parsers.delete(parser)}},isEmpty:{value:function(){return 0===_parsers.length}},has:{value:parsersHas},get:{value:function(name){return _parsers.find((function(parser){return parser.name===name}))||null}},Profile:{value:Object.freeze(Object.defineProperties({},{profiles:{get:function(){return _profiles}},compile:{value:function(){var all=_parsers,core=all.filter((function(parser){return!Array.isArray(parser.profiles)||parser.profiles.includes("core")}));return _profiles=Object.freeze({all:{parsers:all,parserRegExp:new RegExp(all.map((function(parser){return"(".concat(parser.match,")")})).join("|"),"gm")},core:{parsers:core,parserRegExp:new RegExp(core.map((function(parser){return"(".concat(parser.match,")")})).join("|"),"gm")}})}},isEmpty:{value:function(){return"object"!==_typeof(_profiles)||0===Object.keys(_profiles).length}},has:{value:function(profile){return"object"===_typeof(_profiles)&&_profiles.hasOwnProperty(profile)}},get:{value:function(profile){if("object"!==_typeof(_profiles)||!_profiles.hasOwnProperty(profile))throw new Error('nonexistent parser profile "'.concat(profile,'"'));return _profiles[profile]}}}))}}))}()}),Object.defineProperties(Wikifier,{helpers:{value:{}},getValue:{value:State.getVar},setValue:{value:State.setVar},parse:{value:Scripting.parse},evalExpression:{value:Scripting.evalTwineScript},evalStatements:{value:Scripting.evalTwineScript},textPrimitives:{value:Patterns}}),Object.defineProperties(Wikifier.helpers,{inlineCss:{value:(lookaheadRe=new RegExp(Patterns.inlineCss,"gm"),idOrClassRe=new RegExp("(".concat(Patterns.cssIdOrClassSigil,")(").concat(Patterns.anyLetter,"+)"),"g"),function(w){var matched,css={classes:[],id:"",styles:{}};do{lookaheadRe.lastIndex=w.nextMatch;var match=lookaheadRe.exec(w.source);if(matched=match&&match.index===w.nextMatch){if(match[1])css.styles[Util.fromCssProperty(match[1])]=match[2].trim();else if(match[3])css.styles[Util.fromCssProperty(match[3])]=match[4].trim();else if(match[5]){var subMatch=void 0;for(idOrClassRe.lastIndex=0;null!==(subMatch=idOrClassRe.exec(match[5]));)"."===subMatch[1]?css.classes.push(subMatch[2]):css.id=subMatch[2]}w.nextMatch=lookaheadRe.lastIndex}}while(matched);return css})},evalText:{value:function(text){var result;try{switch(_typeof(result=Scripting.evalTwineScript(text))){case"string":""===result.trim()&&(result=text);break;case"number":result=String(result);break;default:result=text}}catch(ex){result=text}return result}},evalPassageId:{value:function(passage){return null==passage||Story.has(passage)?passage:Wikifier.helpers.evalText(passage)}},hasBlockContext:{value:function(nodes){for(var hasGCS="function"==typeof window.getComputedStyle,i=nodes.length-1;i>=0;--i){var node=nodes[i];switch(node.nodeType){case Node.ELEMENT_NODE:var tagName=node.nodeName.toUpperCase();if("BR"===tagName)return!0;var styles=hasGCS?window.getComputedStyle(node,null):node.currentStyle;if(styles&&styles.display){if("none"===styles.display)continue;return"block"===styles.display}switch(tagName){case"ADDRESS":case"ARTICLE":case"ASIDE":case"BLOCKQUOTE":case"CENTER":case"DIV":case"DL":case"FIGURE":case"FOOTER":case"FORM":case"H1":case"H2":case"H3":case"H4":case"H5":case"H6":case"HEADER":case"HR":case"MAIN":case"NAV":case"OL":case"P":case"PRE":case"SECTION":case"TABLE":case"UL":return!0}return!1;case Node.COMMENT_NODE:continue;default:return!1}}return!0}},createShadowSetterCallback:{value:function(){var macroParser=null;function getMacroContextShadowView(){for(var macro=macroParser||function(){if(!macroParser&&!(macroParser=Wikifier.Parser.get("macro")))throw new Error('cannot find "macro" parser');return macroParser}(),view=new Set,context=macro.context;null!==context;context=context.parent)context._shadows&&context._shadows.forEach((function(name){return view.add(name)}));return _toConsumableArray(view)}return function(code){var shadowStore={};return getMacroContextShadowView().forEach((function(varName){var varKey=varName.slice(1),store="$"===varName[0]?State.variables:State.temporary;shadowStore[varName]=store[varKey]})),function(){var shadowNames=Object.keys(shadowStore),valueCache=shadowNames.length>0?{}:null;try{return shadowNames.forEach((function(varName){var varKey=varName.slice(1),store="$"===varName[0]?State.variables:State.temporary;store.hasOwnProperty(varKey)&&(valueCache[varKey]=store[varKey]),store[varKey]=shadowStore[varName]})),Scripting.evalJavaScript(code)}finally{shadowNames.forEach((function(varName){var varKey=varName.slice(1),store="$"===varName[0]?State.variables:State.temporary;shadowStore[varName]=store[varKey],valueCache.hasOwnProperty(varKey)?store[varKey]=valueCache[varKey]:delete store[varKey]}))}}}}()},parseSquareBracketedMarkup:{value:function(){var Item=Lexer.enumFromNames(["Error","DelimLTR","DelimRTL","InnerMeta","ImageMeta","LinkMeta","Link","RightMeta","Setter","Source","Text"]),Delim=Lexer.enumFromNames(["None","LTR","RTL"]);function slurpQuote(lexer,endQuote){loop:for(;;)switch(lexer.next()){case"\\":var ch=lexer.next();if(ch!==EOF&&"\n"!==ch)break;case EOF:case"\n":return EOF;case endQuote:break loop}return lexer.pos}function lexLeftMeta(lexer){if(!lexer.accept("["))return lexer.error(Item.Error,"malformed square-bracketed markup");if(lexer.accept("["))lexer.data.isLink=!0,lexer.emit(Item.LinkMeta);else{if(lexer.accept("<>"),!(lexer.accept("Ii")&&lexer.accept("Mm")&&lexer.accept("Gg")&&lexer.accept("[")))return lexer.error(Item.Error,"malformed square-bracketed markup");lexer.data.isLink=!1,lexer.emit(Item.ImageMeta)}return lexer.depth=2,lexCoreComponents}function lexCoreComponents(lexer){for(var what=lexer.data.isLink?"link":"image",delim=Delim.None;;)switch(lexer.next()){case EOF:case"\n":return lexer.error(Item.Error,"unterminated ".concat(what," markup"));case'"':if(slurpQuote(lexer,'"')===EOF)return lexer.error(Item.Error,"unterminated double quoted string in ".concat(what," markup"));break;case"|":delim===Delim.None&&(delim=Delim.LTR,lexer.backup(),lexer.emit(Item.Text),lexer.forward(),lexer.emit(Item.DelimLTR));break;case"-":delim===Delim.None&&">"===lexer.peek()&&(delim=Delim.LTR,lexer.backup(),lexer.emit(Item.Text),lexer.forward(2),lexer.emit(Item.DelimLTR));break;case"<":delim===Delim.None&&"-"===lexer.peek()&&(delim=Delim.RTL,lexer.backup(),lexer.emit(lexer.data.isLink?Item.Link:Item.Source),lexer.forward(2),lexer.emit(Item.DelimRTL));break;case"[":++lexer.depth;break;case"]":if(--lexer.depth,1===lexer.depth)switch(lexer.peek()){case"[":return++lexer.depth,lexer.backup(),delim===Delim.RTL?lexer.emit(Item.Text):lexer.emit(lexer.data.isLink?Item.Link:Item.Source),lexer.forward(2),lexer.emit(Item.InnerMeta),lexer.data.isLink?lexSetter:lexImageLink;case"]":return--lexer.depth,lexer.backup(),delim===Delim.RTL?lexer.emit(Item.Text):lexer.emit(lexer.data.isLink?Item.Link:Item.Source),lexer.forward(2),lexer.emit(Item.RightMeta),null;default:return lexer.error(Item.Error,"malformed ".concat(what," markup"))}}}function lexImageLink(lexer){for(var what=lexer.data.isLink?"link":"image";;)switch(lexer.next()){case EOF:case"\n":return lexer.error(Item.Error,"unterminated ".concat(what," markup"));case'"':if(slurpQuote(lexer,'"')===EOF)return lexer.error(Item.Error,"unterminated double quoted string in ".concat(what," markup link component"));break;case"[":++lexer.depth;break;case"]":if(--lexer.depth,1===lexer.depth)switch(lexer.peek()){case"[":return++lexer.depth,lexer.backup(),lexer.emit(Item.Link),lexer.forward(2),lexer.emit(Item.InnerMeta),lexSetter;case"]":return--lexer.depth,lexer.backup(),lexer.emit(Item.Link),lexer.forward(2),lexer.emit(Item.RightMeta),null;default:return lexer.error(Item.Error,"malformed ".concat(what," markup"))}}}function lexSetter(lexer){for(var what=lexer.data.isLink?"link":"image";;)switch(lexer.next()){case EOF:case"\n":return lexer.error(Item.Error,"unterminated ".concat(what," markup"));case'"':if(slurpQuote(lexer,'"')===EOF)return lexer.error(Item.Error,"unterminated double quoted string in ".concat(what," markup setter component"));break;case"'":if(slurpQuote(lexer,"'")===EOF)return lexer.error(Item.Error,"unterminated single quoted string in ".concat(what," markup setter component"));break;case"[":++lexer.depth;break;case"]":if(--lexer.depth,1===lexer.depth)return"]"!==lexer.peek()?lexer.error(Item.Error,"malformed ".concat(what," markup")):(--lexer.depth,lexer.backup(),lexer.emit(Item.Setter),lexer.forward(2),lexer.emit(Item.RightMeta),null)}}return function(w){var lexer=new Lexer(w.source,lexLeftMeta);lexer.start=lexer.pos=w.matchStart;var markup={},items=lexer.run(),last=items.last();return last&&last.type===Item.Error?markup.error=last.message:items.forEach((function(item){var text=item.text.trim();switch(item.type){case Item.ImageMeta:markup.isImage=!0,"<"===text[1]?markup.align="left":">"===text[1]&&(markup.align="right");break;case Item.LinkMeta:markup.isLink=!0;break;case Item.Link:"~"===text[0]?(markup.forceInternal=!0,markup.link=text.slice(1)):markup.link=text;break;case Item.Setter:markup.setter=text;break;case Item.Source:markup.source=text;break;case Item.Text:markup.text=text}})),markup.pos=lexer.pos,markup}}()}}),Wikifier}();!function(){function _verbatimTagHandler(w){this.lookahead.lastIndex=w.matchStart;var match=this.lookahead.exec(w.source);match&&match.index===w.matchStart&&(w.nextMatch=this.lookahead.lastIndex,jQuery(document.createDocumentFragment()).append(match[1]).appendTo(w.output))}Wikifier.Parser.add({name:"quoteByBlock",profiles:["block"],match:"^<<<\\n",terminator:"^<<<\\n",handler:function(w){Wikifier.helpers.hasBlockContext(w.output.childNodes)?w.subWikify(jQuery(document.createElement("blockquote")).appendTo(w.output).get(0),this.terminator):jQuery(w.output).append(document.createTextNode(w.matchText))}}),Wikifier.Parser.add({name:"quoteByLine",profiles:["block"],match:"^>+",lookahead:/^>+/gm,terminator:"\\n",handler:function(w){if(Wikifier.helpers.hasBlockContext(w.output.childNodes)){var matched,i,destStack=[w.output],curLevel=0,newLevel=w.matchLength;do{if(newLevel>curLevel)for(i=curLevel;i<newLevel;++i)destStack.push(jQuery(document.createElement("blockquote")).appendTo(destStack[destStack.length-1]).get(0));else if(newLevel<curLevel)for(i=curLevel;i>newLevel;--i)destStack.pop();curLevel=newLevel,w.subWikify(destStack[destStack.length-1],this.terminator),jQuery(document.createElement("br")).appendTo(destStack[destStack.length-1]),this.lookahead.lastIndex=w.nextMatch;var match=this.lookahead.exec(w.source);(matched=match&&match.index===w.nextMatch)&&(newLevel=match[0].length,w.nextMatch+=match[0].length)}while(matched)}else jQuery(w.output).append(document.createTextNode(w.matchText))}}),Wikifier.Parser.add({name:"macro",profiles:["core"],match:"<<",lookahead:new RegExp("<<(/?".concat(Patterns.macroName,")(?:\\s*)((?:(?:/\\*[^*]*\\*+(?:[^/*][^*]*\\*+)*/)|(?://.*\\n)|(?:`(?:\\\\.|[^`\\\\])*`)|(?:\"(?:\\\\.|[^\"\\\\])*\")|(?:'(?:\\\\.|[^'\\\\])*')|(?:\\[(?:[<>]?[Ii][Mm][Gg])?\\[[^\\r\\n]*?\\]\\]+)|[^>]|(?:>(?!>)))*)>>"),"gm"),working:{source:"",name:"",arguments:"",index:0},context:null,handler:function(w){var matchStart=this.lookahead.lastIndex=w.matchStart;if(this.parseTag(w)){var macro,nextMatch=w.nextMatch,name=this.working.name,rawArgs=this.working.arguments;try{if(!(macro=Macro.get(name))){if(Macro.tags.has(name)){var tags=Macro.tags.get(name);return throwError(w.output,"child tag <<".concat(name,">> was found outside of a call to its parent macro").concat(1===tags.length?"":"s"," <<").concat(tags.join(">>, <<"),">>"),w.source.slice(matchStart,w.nextMatch))}return throwError(w.output,"macro <<".concat(name,">> does not exist"),w.source.slice(matchStart,w.nextMatch))}var payload=null;if(void 0!==macro.tags&&!(payload=this.parseBody(w,macro)))return w.nextMatch=nextMatch,throwError(w.output,"cannot find a closing tag for macro <<".concat(name,">>"),"".concat(w.source.slice(matchStart,w.nextMatch),"…"));if("function"!=typeof macro.handler)return throwError(w.output,"macro <<".concat(name,">> handler function ").concat(void 0===macro.handler?"does not exist":"is not a function"),w.source.slice(matchStart,w.nextMatch));var args=payload?payload[0].args:this.createArgs(rawArgs,this.skipArgs(macro,macro.name));if(void 0!==macro._MACRO_API){this.context=new MacroContext({macro:macro,name:name,args:args,payload:payload,source:w.source.slice(matchStart,w.nextMatch),parent:this.context,parser:w});try{macro.handler.call(this.context)}finally{this.context=this.context.parent}}else{var prevRawArgs=w._rawArgs;w._rawArgs=rawArgs;try{macro.handler(w.output,name,args,w,payload)}finally{w._rawArgs=prevRawArgs}}}catch(ex){return throwError(w.output,"cannot execute ".concat(macro&&macro.isWidget?"widget":"macro"," <<").concat(name,">>: ").concat(ex.message),w.source.slice(matchStart,w.nextMatch))}finally{this.working.source="",this.working.name="",this.working.arguments="",this.working.index=0}}else w.outputText(w.output,w.matchStart,w.nextMatch)},parseTag:function(w){var match=this.lookahead.exec(w.source);return!(!match||match.index!==w.matchStart||!match[1])&&(w.nextMatch=this.lookahead.lastIndex,this.working.source=w.source.slice(match.index,this.lookahead.lastIndex),this.working.name=match[1],this.working.arguments=match[2],this.working.index=match.index,!0)},parseBody:function(w,macro){for(var openTag=this.working.name,closeTag="/".concat(openTag),closeAlt="end".concat(openTag),bodyTags=!!Array.isArray(macro.tags)&&macro.tags,payload=[],end=-1,opened=1,curSource=this.working.source,curTag=this.working.name,curArgument=this.working.arguments,contentStart=w.nextMatch;-1!==(w.matchStart=w.source.indexOf(this.match,w.nextMatch));)if(this.parseTag(w)){var tagSource=this.working.source,tagName=this.working.name,tagArgs=this.working.arguments,tagBegin=this.working.index,tagEnd=w.nextMatch,hasArgs=""!==tagArgs.trim();switch(tagName){case openTag:++opened;break;case closeAlt:case closeTag:if(hasArgs)throw w.nextMatch=tagBegin+2+tagName.length,new Error('malformed closing tag: "'.concat(tagSource,'"'));--opened;break;default:if(hasArgs&&(tagName.startsWith("/")||tagName.startsWith("end"))){this.lookahead.lastIndex=w.nextMatch=tagBegin+2+tagName.length;continue}if(1===opened&&bodyTags)for(var i=0,iend=bodyTags.length;i<iend;++i)tagName===bodyTags[i]&&(payload.push({source:curSource,name:curTag,arguments:curArgument,args:this.createArgs(curArgument,this.skipArgs(macro,curTag)),contents:w.source.slice(contentStart,tagBegin)}),curSource=tagSource,curTag=tagName,curArgument=tagArgs,contentStart=tagEnd)}if(0===opened){payload.push({source:curSource,name:curTag,arguments:curArgument,args:this.createArgs(curArgument,this.skipArgs(macro,curTag)),contents:w.source.slice(contentStart,tagBegin)}),end=tagEnd;break}}else this.lookahead.lastIndex=w.nextMatch=w.matchStart+this.match.length;return-1!==end?(w.nextMatch=end,payload):null},createArgs:function(rawArgsString,skipArgs){var args=skipArgs?[]:this.parseArgs(rawArgsString);return Object.defineProperties(args,{raw:{value:rawArgsString},full:{value:Scripting.parse(rawArgsString)}}),args},skipArgs:function(macro,tagName){if(void 0!==macro.skipArgs){var sa=macro.skipArgs;return"boolean"==typeof sa&&sa||Array.isArray(sa)&&sa.includes(tagName)}return void 0!==macro.skipArg0&&(macro.skipArg0&&macro.name===tagName)},parseArgs:function(){var Item=Lexer.enumFromNames(["Error","Bareword","Expression","String","SquareBracket"]),spaceRe=new RegExp(Patterns.space),notSpaceRe=new RegExp(Patterns.notSpace),varTest=new RegExp("^".concat(Patterns.variable));function slurpQuote(lexer,endQuote){loop:for(;;)switch(lexer.next()){case"\\":var ch=lexer.next();if(ch!==EOF&&"\n"!==ch)break;case EOF:case"\n":return EOF;case endQuote:break loop}return lexer.pos}function lexSpace(lexer){var offset=lexer.source.slice(lexer.pos).search(notSpaceRe);if(offset===EOF)return null;switch(0!==offset&&(lexer.pos+=offset,lexer.ignore()),lexer.next()){case"`":return lexExpression;case'"':return lexDoubleQuote;case"'":return lexSingleQuote;case"[":return lexSquareBracket;default:return lexBareword}}function lexExpression(lexer){return slurpQuote(lexer,"`")===EOF?lexer.error(Item.Error,"unterminated backquote expression"):(lexer.emit(Item.Expression),lexSpace)}function lexDoubleQuote(lexer){return slurpQuote(lexer,'"')===EOF?lexer.error(Item.Error,"unterminated double quoted string"):(lexer.emit(Item.String),lexSpace)}function lexSingleQuote(lexer){return slurpQuote(lexer,"'")===EOF?lexer.error(Item.Error,"unterminated single quoted string"):(lexer.emit(Item.String),lexSpace)}function lexSquareBracket(lexer){var what;if(lexer.accept("<>IiMmGg")?(what="image",lexer.acceptRun("<>IiMmGg")):what="link",!lexer.accept("["))return lexer.error(Item.Error,"malformed ".concat(what," markup"));lexer.depth=2;loop:for(;;)switch(lexer.next()){case"\\":var ch=lexer.next();if(ch!==EOF&&"\n"!==ch)break;case EOF:case"\n":return lexer.error(Item.Error,"unterminated ".concat(what," markup"));case"[":++lexer.depth;break;case"]":if(--lexer.depth,lexer.depth<0)return lexer.error(Item.Error,"unexpected right square bracket ']'");if(1===lexer.depth){if("]"===lexer.next()){--lexer.depth;break loop}lexer.backup()}}return lexer.emit(Item.SquareBracket),lexSpace}function lexBareword(lexer){var offset=lexer.source.slice(lexer.pos).search(spaceRe);return lexer.pos=offset===EOF?lexer.source.length:lexer.pos+offset,lexer.emit(Item.Bareword),offset===EOF?null:lexSpace}return function(rawArgsString){var lexer=new Lexer(rawArgsString,lexSpace),args=[];return lexer.run().forEach((function(item){var arg=item.text;switch(item.type){case Item.Error:throw new Error('unable to parse macro argument "'.concat(arg,'": ').concat(item.message));case Item.Bareword:if(varTest.test(arg))arg=State.getVar(arg);else if(/^(?:settings|setup)[.[]/.test(arg))try{arg=Scripting.evalTwineScript(arg)}catch(ex){throw new Error('unable to parse macro argument "'.concat(arg,'": ').concat(ex.message))}else if("null"===arg)arg=null;else if("undefined"===arg)arg=undefined;else if("true"===arg)arg=!0;else if("false"===arg)arg=!1;else if("NaN"===arg)arg=NaN;else{var argAsNum=Number(arg);Number.isNaN(argAsNum)||(arg=argAsNum)}break;case Item.Expression:if(""===(arg=arg.slice(1,-1).trim()))arg=undefined;else try{arg=Scripting.evalTwineScript("(".concat(arg,")"))}catch(ex){throw new Error('unable to parse macro argument expression "'.concat(arg,'": ').concat(ex.message))}break;case Item.String:try{arg=Scripting.evalJavaScript(arg)}catch(ex){throw new Error('unable to parse macro argument string "'.concat(arg,'": ').concat(ex.message))}break;case Item.SquareBracket:var markup=Wikifier.helpers.parseSquareBracketedMarkup({source:arg,matchStart:0});if(markup.hasOwnProperty("error"))throw new Error('unable to parse macro argument "'.concat(arg,'": ').concat(markup.error));if(markup.pos<arg.length)throw new Error('unable to parse macro argument "'.concat(arg,'": unexpected character(s) "').concat(arg.slice(markup.pos),'" (pos: ').concat(markup.pos,")"));markup.isLink?((arg={isLink:!0}).count=markup.hasOwnProperty("text")?2:1,arg.link=Wikifier.helpers.evalPassageId(markup.link),arg.text=markup.hasOwnProperty("text")?Wikifier.helpers.evalText(markup.text):arg.link,arg.external=!markup.forceInternal&&Wikifier.isExternalLink(arg.link),arg.setFn=markup.hasOwnProperty("setter")?Wikifier.helpers.createShadowSetterCallback(Scripting.parse(markup.setter)):null):markup.isImage&&(arg=function(source){var imgObj={source:source,isImage:!0};if("data:"!==source.slice(0,5)&&Story.has(source)){var passage=Story.get(source);passage.tags.includes("Twine.image")&&(imgObj.source=passage.text,imgObj.passage=passage.title)}return imgObj}(Wikifier.helpers.evalPassageId(markup.source)),markup.hasOwnProperty("align")&&(arg.align=markup.align),markup.hasOwnProperty("text")&&(arg.title=Wikifier.helpers.evalText(markup.text)),markup.hasOwnProperty("link")&&(arg.link=Wikifier.helpers.evalPassageId(markup.link),arg.external=!markup.forceInternal&&Wikifier.isExternalLink(arg.link)),arg.setFn=markup.hasOwnProperty("setter")?Wikifier.helpers.createShadowSetterCallback(Scripting.parse(markup.setter)):null)}args.push(arg)})),args}}()}),Wikifier.Parser.add({name:"link",profiles:["core"],match:"\\[\\[[^[]",handler:function(w){var markup=Wikifier.helpers.parseSquareBracketedMarkup(w);if(markup.hasOwnProperty("error"))w.outputText(w.output,w.matchStart,w.nextMatch);else{w.nextMatch=markup.pos;var link=Wikifier.helpers.evalPassageId(markup.link),text=markup.hasOwnProperty("text")?Wikifier.helpers.evalText(markup.text):link,setFn=markup.hasOwnProperty("setter")?Wikifier.helpers.createShadowSetterCallback(Scripting.parse(markup.setter)):null,output=(Config.debug?new DebugView(w.output,"link-markup","[[link]]",w.source.slice(w.matchStart,w.nextMatch)):w).output;markup.forceInternal||!Wikifier.isExternalLink(link)?Wikifier.createInternalLink(output,link,text,setFn):Wikifier.createExternalLink(output,link,text)}}}),Wikifier.Parser.add({name:"urlLink",profiles:["core"],match:Patterns.url,handler:function(w){w.outputText(Wikifier.createExternalLink(w.output,w.matchText),w.matchStart,w.nextMatch)}}),Wikifier.Parser.add({name:"image",profiles:["core"],match:"\\[[<>]?[Ii][Mm][Gg]\\[",handler:function(w){var markup=Wikifier.helpers.parseSquareBracketedMarkup(w);if(markup.hasOwnProperty("error"))w.outputText(w.output,w.matchStart,w.nextMatch);else{var debugView;w.nextMatch=markup.pos,Config.debug&&(debugView=new DebugView(w.output,"image-markup",markup.hasOwnProperty("link")?"[img[][link]]":"[img[]]",w.source.slice(w.matchStart,w.nextMatch))).modes({block:!0});var source,setFn=markup.hasOwnProperty("setter")?Wikifier.helpers.createShadowSetterCallback(Scripting.parse(markup.setter)):null,el=(Config.debug?debugView:w).output;if(markup.hasOwnProperty("link")){var link=Wikifier.helpers.evalPassageId(markup.link);(el=markup.forceInternal||!Wikifier.isExternalLink(link)?Wikifier.createInternalLink(el,link,null,setFn):Wikifier.createExternalLink(el,link)).classList.add("link-image")}if(el=jQuery(document.createElement("img")).appendTo(el).get(0),"data:"!==(source=Wikifier.helpers.evalPassageId(markup.source)).slice(0,5)&&Story.has(source)){var passage=Story.get(source);passage.tags.includes("Twine.image")&&(el.setAttribute("data-passage",passage.title),source=passage.text.trim())}el.src=source,markup.hasOwnProperty("text")&&(el.title=Wikifier.helpers.evalText(markup.text)),markup.hasOwnProperty("align")&&(el.align=markup.align)}}}),Wikifier.Parser.add({name:"monospacedByBlock",profiles:["block"],match:"^\\{\\{\\{\\n",lookahead:/^\{\{\{\n((?:^[^\n]*\n)+?)(^\}\}\}$\n?)/gm,handler:function(w){this.lookahead.lastIndex=w.matchStart;var match=this.lookahead.exec(w.source);if(match&&match.index===w.matchStart){var pre=jQuery(document.createElement("pre"));jQuery(document.createElement("code")).text(match[1]).appendTo(pre),pre.appendTo(w.output),w.nextMatch=this.lookahead.lastIndex}}}),Wikifier.Parser.add({name:"formatByChar",profiles:["core"],match:"''|//|__|\\^\\^|~~|==|\\{\\{\\{",handler:function(w){switch(w.matchText){case"''":w.subWikify(jQuery(document.createElement("strong")).appendTo(w.output).get(0),"''");break;case"//":w.subWikify(jQuery(document.createElement("em")).appendTo(w.output).get(0),"//");break;case"__":w.subWikify(jQuery(document.createElement("u")).appendTo(w.output).get(0),"__");break;case"^^":w.subWikify(jQuery(document.createElement("sup")).appendTo(w.output).get(0),"\\^\\^");break;case"~~":w.subWikify(jQuery(document.createElement("sub")).appendTo(w.output).get(0),"~~");break;case"==":w.subWikify(jQuery(document.createElement("s")).appendTo(w.output).get(0),"==");break;case"{{{":var lookahead=/\{\{\{((?:.|\n)*?)\}\}\}/gm;lookahead.lastIndex=w.matchStart;var match=lookahead.exec(w.source);match&&match.index===w.matchStart&&(jQuery(document.createElement("code")).text(match[1]).appendTo(w.output),w.nextMatch=lookahead.lastIndex)}}}),Wikifier.Parser.add({name:"customStyle",profiles:["core"],match:"@@",terminator:"@@",blockRe:/\s*\n/gm,handler:function(w){var css=Wikifier.helpers.inlineCss(w);this.blockRe.lastIndex=w.nextMatch;var blockMatch=this.blockRe.exec(w.source),blockLevel=blockMatch&&blockMatch.index===w.nextMatch,$el=jQuery(document.createElement(blockLevel?"div":"span")).appendTo(w.output);0===css.classes.length&&""===css.id&&0===Object.keys(css.styles).length?$el.addClass("marked"):(css.classes.forEach((function(className){return $el.addClass(className)})),""!==css.id&&$el.attr("id",css.id),$el.css(css.styles)),blockLevel?(w.nextMatch+=blockMatch[0].length,w.subWikify($el[0],"\\n?".concat(this.terminator))):w.subWikify($el[0],this.terminator)}}),Wikifier.Parser.add({name:"verbatimText",profiles:["core"],match:'"{3}|<[Nn][Oo][Ww][Ii][Kk][Ii]>',lookahead:/(?:"{3}((?:.|\n)*?)"{3})|(?:<[Nn][Oo][Ww][Ii][Kk][Ii]>((?:.|\n)*?)<\/[Nn][Oo][Ww][Ii][Kk][Ii]>)/gm,handler:function(w){this.lookahead.lastIndex=w.matchStart;var match=this.lookahead.exec(w.source);match&&match.index===w.matchStart&&(w.nextMatch=this.lookahead.lastIndex,jQuery(document.createElement("span")).addClass("verbatim").text(match[1]||match[2]).appendTo(w.output))}}),Wikifier.Parser.add({name:"horizontalRule",profiles:["core"],match:"^----+$\\n?|<[Hh][Rr]\\s*/?>\\n?",handler:function(w){jQuery(document.createElement("hr")).appendTo(w.output)}}),Wikifier.Parser.add({name:"emdash",profiles:["core"],match:"--",handler:function(w){jQuery(document.createTextNode("—")).appendTo(w.output)}}),Wikifier.Parser.add({name:"doubleDollarSign",profiles:["core"],match:"\\${2}",handler:function(w){jQuery(document.createTextNode("$")).appendTo(w.output)}}),Wikifier.Parser.add({name:"nakedVariable",profiles:["core"],match:"".concat(Patterns.variable,"(?:(?:\\.").concat(Patterns.identifier,")|(?:\\[\\d+\\])|(?:\\[\"(?:\\\\.|[^\"\\\\])+\"\\])|(?:\\['(?:\\\\.|[^'\\\\])+'\\])|(?:\\[").concat(Patterns.variable,"\\]))*"),handler:function(w){var result=State.getVar(w.matchText);null==result?jQuery(document.createTextNode(w.matchText)).appendTo(w.output):new Wikifier((Config.debug?new DebugView(w.output,"variable",w.matchText,w.matchText):w).output,stringFrom(result))}}),Wikifier.Parser.add({name:"template",profiles:["core"],match:"\\?".concat(Patterns.templateName),handler:function(w){var name=w.matchText.slice(1),template=Template.get(name),result=null;switch(template instanceof Array&&(template=template.random()),_typeof(template)){case"function":try{result=stringFrom(template.call({name:name}))}catch(ex){return throwError(w.output,"cannot execute function template ?".concat(name,": ").concat(ex.message),w.source.slice(w.matchStart,w.nextMatch))}break;case"string":result=template}null===result?jQuery(document.createTextNode(w.matchText)).appendTo(w.output):new Wikifier((Config.debug?new DebugView(w.output,"template",w.matchText,w.matchText):w).output,result)}}),Wikifier.Parser.add({name:"heading",profiles:["block"],match:"^!{1,6}",terminator:"\\n",handler:function(w){Wikifier.helpers.hasBlockContext(w.output.childNodes)?w.subWikify(jQuery(document.createElement("h".concat(w.matchLength))).appendTo(w.output).get(0),this.terminator):jQuery(w.output).append(document.createTextNode(w.matchText))}}),Wikifier.Parser.add({name:"table",profiles:["block"],match:"^\\|(?:[^\\n]*)\\|(?:[fhck]?)$",lookahead:/^\|([^\n]*)\|([fhck]?)$/gm,rowTerminator:"\\|(?:[cfhk]?)$\\n?",cellPattern:"(?:\\|([^\\n\\|]*)\\|)|(\\|[cfhk]?$\\n?)",cellTerminator:"(?:\\u0020*)\\|",rowTypes:{c:"caption",f:"tfoot",h:"thead","":"tbody"},handler:function(w){if(Wikifier.helpers.hasBlockContext(w.output.childNodes)){var matched,table=jQuery(document.createElement("table")).appendTo(w.output).get(0),prevColumns=[],curRowType=null,$rowContainer=null,rowCount=0;w.nextMatch=w.matchStart;do{this.lookahead.lastIndex=w.nextMatch;var match=this.lookahead.exec(w.source);if(matched=match&&match.index===w.nextMatch){var nextRowType=match[2];"k"===nextRowType?(table.className=match[1],w.nextMatch+=match[0].length+1):(nextRowType!==curRowType&&(curRowType=nextRowType,$rowContainer=jQuery(document.createElement(this.rowTypes[nextRowType])).appendTo(table)),"c"===curRowType?($rowContainer.css("caption-side",0===rowCount?"top":"bottom"),w.nextMatch+=1,w.subWikify($rowContainer[0],this.rowTerminator)):this.rowHandler(w,jQuery(document.createElement("tr")).appendTo($rowContainer).get(0),prevColumns),++rowCount)}}while(matched)}else jQuery(w.output).append(document.createTextNode(w.matchText))},rowHandler:function(w,rowEl,prevColumns){var matched,_this12=this,cellRe=new RegExp(this.cellPattern,"gm"),col=0,curColCount=1;do{cellRe.lastIndex=w.nextMatch;var cellMatch=cellRe.exec(w.source);if(matched=cellMatch&&cellMatch.index===w.nextMatch){if("~"===cellMatch[1]){var last=prevColumns[col];last&&(++last.rowCount,last.$element.attr("rowspan",last.rowCount).css("vertical-align","middle")),w.nextMatch=cellMatch.index+cellMatch[0].length-1}else if(">"===cellMatch[1])++curColCount,w.nextMatch=cellMatch.index+cellMatch[0].length-1;else{if(cellMatch[2]){w.nextMatch=cellMatch.index+cellMatch[0].length;break}!function(){++w.nextMatch;for(var css=Wikifier.helpers.inlineCss(w),spaceLeft=!1,spaceRight=!1,$cell=void 0;" "===w.source.substr(w.nextMatch,1);)spaceLeft=!0,++w.nextMatch;"!"===w.source.substr(w.nextMatch,1)?($cell=jQuery(document.createElement("th")).appendTo(rowEl),++w.nextMatch):$cell=jQuery(document.createElement("td")).appendTo(rowEl),prevColumns[col]={rowCount:1,$element:$cell},curColCount>1&&($cell.attr("colspan",curColCount),curColCount=1),w.subWikify($cell[0],_this12.cellTerminator)," "===w.matchText.substr(w.matchText.length-2,1)&&(spaceRight=!0),css.classes.forEach((function(className){return $cell.addClass(className)})),""!==css.id&&$cell.attr("id",css.id),spaceLeft&&spaceRight?css.styles["text-align"]="center":spaceLeft?css.styles["text-align"]="right":spaceRight&&(css.styles["text-align"]="left"),$cell.css(css.styles),w.nextMatch=w.nextMatch-1}()}++col}}while(matched)}}),Wikifier.Parser.add({name:"list",profiles:["block"],match:"^(?:(?:\\*+)|(?:#+))",lookahead:/^(?:(\*+)|(#+))/gm,terminator:"\\n",handler:function(w){if(Wikifier.helpers.hasBlockContext(w.output.childNodes)){w.nextMatch=w.matchStart;var matched,i,destStack=[w.output],curType=null,curLevel=0;do{this.lookahead.lastIndex=w.nextMatch;var match=this.lookahead.exec(w.source);if(matched=match&&match.index===w.nextMatch){var newType=match[2]?"ol":"ul",newLevel=match[0].length;if(w.nextMatch+=match[0].length,newLevel>curLevel)for(i=curLevel;i<newLevel;++i)destStack.push(jQuery(document.createElement(newType)).appendTo(destStack[destStack.length-1]).get(0));else if(newLevel<curLevel)for(i=curLevel;i>newLevel;--i)destStack.pop();else newLevel===curLevel&&newType!==curType&&(destStack.pop(),destStack.push(jQuery(document.createElement(newType)).appendTo(destStack[destStack.length-1]).get(0)));curLevel=newLevel,curType=newType,w.subWikify(jQuery(document.createElement("li")).appendTo(destStack[destStack.length-1]).get(0),this.terminator)}}while(matched)}else jQuery(w.output).append(document.createTextNode(w.matchText))}}),Wikifier.Parser.add({name:"commentByBlock",profiles:["core"],match:"(?:/(?:%|\\*))|(?:\x3c!--)",lookahead:/(?:\/(%|\*)(?:(?:.|\n)*?)\1\/)|(?:<!--(?:(?:.|\n)*?)-->)/gm,handler:function(w){this.lookahead.lastIndex=w.matchStart;var match=this.lookahead.exec(w.source);match&&match.index===w.matchStart&&(w.nextMatch=this.lookahead.lastIndex)}}),Wikifier.Parser.add({name:"lineContinuation",profiles:["core"],match:"\\\\".concat(Patterns.spaceNoTerminator,"*\\n|\\n").concat(Patterns.spaceNoTerminator,"*\\\\|\\n?\\\\").concat(Patterns.spaceNoTerminator,"*$|^").concat(Patterns.spaceNoTerminator,"*\\\\\\n?"),handler:function(w){w.nextMatch=w.matchStart+w.matchLength}}),Wikifier.Parser.add({name:"lineBreak",profiles:["core"],match:"\\n|<[Bb][Rr]\\s*/?>",handler:function(w){w.options.nobr||jQuery(document.createElement("br")).appendTo(w.output)}}),Wikifier.Parser.add({name:"htmlCharacterReference",profiles:["core"],match:"(?:(?:&#?[0-9A-Za-z]{2,8};|.)(?:&#?(?:x0*(?:3[0-6][0-9A-Fa-f]|1D[C-Fc-f][0-9A-Fa-f]|20[D-Fd-f][0-9A-Fa-f]|FE2[0-9A-Fa-f])|0*(?:76[89]|7[7-9][0-9]|8[0-7][0-9]|761[6-9]|76[2-7][0-9]|84[0-3][0-9]|844[0-7]|6505[6-9]|6506[0-9]|6507[0-1]));)+|&#?[0-9A-Za-z]{2,8};)",handler:function(w){jQuery(document.createDocumentFragment()).append(w.matchText).appendTo(w.output)}}),Wikifier.Parser.add({name:"xmlProlog",profiles:["core"],match:"<\\?[Xx][Mm][Ll][^>]*\\?>",handler:function(w){w.nextMatch=w.matchStart+w.matchLength}}),Wikifier.Parser.add({name:"verbatimHtml",profiles:["core"],match:"<[Hh][Tt][Mm][Ll]>",lookahead:/<[Hh][Tt][Mm][Ll]>((?:.|\n)*?)<\/[Hh][Tt][Mm][Ll]>/gm,handler:_verbatimTagHandler}),Wikifier.Parser.add({name:"verbatimScriptTag",profiles:["core"],match:"<[Ss][Cc][Rr][Ii][Pp][Tt][^>]*>",lookahead:/(<[Ss][Cc][Rr][Ii][Pp][Tt]*>(?:.|\n)*?<\/[Ss][Cc][Rr][Ii][Pp][Tt]>)/gm,handler:_verbatimTagHandler}),Wikifier.Parser.add({name:"styleTag",profiles:["core"],match:"<[Ss][Tt][Yy][Ll][Ee][^>]*>",lookahead:/(<[Ss][Tt][Yy][Ll][Ee]*>)((?:.|\n)*?)(<\/[Ss][Tt][Yy][Ll][Ee]>)/gm,imageMarkup:new RegExp(Patterns.cssImage,"g"),hasImageMarkup:new RegExp(Patterns.cssImage),handler:function(w){this.lookahead.lastIndex=w.matchStart;var match=this.lookahead.exec(w.source);if(match&&match.index===w.matchStart){w.nextMatch=this.lookahead.lastIndex;var css=match[2];this.hasImageMarkup.test(css)&&(this.imageMarkup.lastIndex=0,css=css.replace(this.imageMarkup,(function(wikiImage){var markup=Wikifier.helpers.parseSquareBracketedMarkup({source:wikiImage,matchStart:0});if(markup.hasOwnProperty("error")||markup.pos<wikiImage.length)return wikiImage;var source=markup.source;if("data:"!==source.slice(0,5)&&Story.has(source)){var passage=Story.get(source);passage.tags.includes("Twine.image")&&(source=passage.text)}return'url("'.concat(source.replace(/"/g,"%22"),'")')}))),jQuery(document.createDocumentFragment()).append(match[1]+css+match[3]).appendTo(w.output)}}}),Wikifier.Parser.add({name:"svgTag",profiles:["core"],match:"<[Ss][Vv][Gg][^>]*>",lookahead:/<(\/?)[Ss][Vv][Gg][^>]*>/gm,namespace:"http://www.w3.org/2000/svg",handler:function(w){var _this13=this;this.lookahead.lastIndex=w.nextMatch;for(var match,depth=1;depth>0&&null!==(match=this.lookahead.exec(w.source));)depth+="/"===match[1]?-1:1;if(0===depth){w.nextMatch=this.lookahead.lastIndex;var svgTag=w.source.slice(w.matchStart,this.lookahead.lastIndex),$frag=jQuery(document.createDocumentFragment()).append(svgTag);$frag.find("a[data-passage],image[data-passage]").each((function(_,el){var tagName=el.tagName.toLowerCase();try{_this13.processAttributeDirectives(el)}catch(ex){return throwError(w.output,"svg|<".concat(tagName,">: ").concat(ex.message),"".concat(w.matchText,"…"))}el.hasAttribute("data-passage")&&_this13.processDataAttributes(el,tagName)})),$frag.appendTo(w.output)}},processAttributeDirectives:function(el){_toConsumableArray(el.attributes).forEach((function(_ref10){var name=_ref10.name,value=_ref10.value,evalShorthand="@"===name[0];if(evalShorthand||name.startsWith("sc-eval:")){var result,newName=name.slice(evalShorthand?1:8);if("data-setter"===newName)throw new Error('evaluation directive is not allowed on the data-setter attribute: "'.concat(name,'"'));try{result=Scripting.evalTwineScript(value)}catch(ex){throw new Error('bad evaluation from attribute directive "'.concat(name,'": ').concat(ex.message))}try{el.setAttribute(newName,result),el.removeAttribute(name)}catch(ex){throw new Error('cannot transform attribute directive "'.concat(name,'" into attribute "').concat(newName,'"'))}}}))},processDataAttributes:function(el,tagName){var passage=el.getAttribute("data-passage");if(null!=passage){var evaluated=Wikifier.helpers.evalPassageId(passage);if(evaluated!==passage&&(passage=evaluated,el.setAttribute("data-passage",evaluated)),""!==passage)if("image"===tagName)"data:"!==passage.slice(0,5)&&Story.has(passage)&&(passage=Story.get(passage)).tags.includes("Twine.image")&&el.setAttribute("href",passage.text.trim());else{var setFn,setter=el.getAttribute("data-setter");null!=setter&&""!==(setter=String(setter).trim())&&(setFn=Wikifier.helpers.createShadowSetterCallback(Scripting.parse(setter))),Story.has(passage)?(el.classList.add("link-internal"),Config.addVisitedLinkClass&&State.hasPlayed(passage)&&el.classList.add("link-visited")):el.classList.add("link-broken"),jQuery(el).ariaClick({one:!0},(function(){"function"==typeof setFn&&setFn.call(this),Engine.play(passage)}))}}}}),Wikifier.Parser.add({name:"htmlTag",profiles:["core"],match:"<".concat(Patterns.htmlTagName,"(?:\\s+[^\\u0000-\\u001F\\u007F-\\u009F\\s\"'>\\/=]+(?:\\s*=\\s*(?:\"[^\"]*?\"|'[^']*?'|[^\\s\"'=<>`]+))?)*\\s*\\/?>"),tagRe:new RegExp("^<(".concat(Patterns.htmlTagName,")")),mediaTags:["audio","img","source","track","video"],nobrTags:["audio","colgroup","datalist","dl","figure","meter","ol","optgroup","picture","progress","ruby","select","table","tbody","tfoot","thead","tr","ul","video"],voidTags:["area","base","br","col","embed","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr"],handler:function(w){var tagMatch=this.tagRe.exec(w.matchText),tag=tagMatch&&tagMatch[1],tagName=tag&&tag.toLowerCase();if(tagName){var terminator,terminatorMatch,isVoid=this.voidTags.includes(tagName)||w.matchText.endsWith("/>"),isNobr=this.nobrTags.includes(tagName);if(!isVoid){terminator="<\\/".concat(tagName,"\\s*>");var terminatorRe=new RegExp(terminator,"gim");terminatorRe.lastIndex=w.matchStart,terminatorMatch=terminatorRe.exec(w.source)}if(!isVoid&&!terminatorMatch)return throwError(w.output,"cannot find a closing tag for HTML <".concat(tag,">"),"".concat(w.matchText,"…"));var debugView,output=w.output,el=document.createElement(w.output.tagName);for(el.innerHTML=w.matchText;el.firstChild;)el=el.firstChild;try{this.processAttributeDirectives(el)}catch(ex){return throwError(w.output,"<".concat(tagName,">: ").concat(ex.message),"".concat(w.matchText,"…"))}if(el.hasAttribute("data-passage")&&(this.processDataAttributes(el,tagName),Config.debug&&((debugView=new DebugView(w.output,"html-".concat(tagName),tagName,w.matchText)).modes({block:"img"===tagName,nonvoid:terminatorMatch}),output=debugView.output)),terminatorMatch){try{Wikifier.Option.push({nobr:isNobr}),w.subWikify(el,terminator,{ignoreTerminatorCase:!0})}finally{Wikifier.Option.pop()}debugView&&jQuery(el).find(".debug.block").length>0&&debugView.modes({block:!0})}output.appendChild("track"===tagName?el.cloneNode(!0):el)}},processAttributeDirectives:function(el){_toConsumableArray(el.attributes).forEach((function(_ref11){var name=_ref11.name,value=_ref11.value,evalShorthand="@"===name[0];if(evalShorthand||name.startsWith("sc-eval:")){var result,newName=name.slice(evalShorthand?1:8);if("data-setter"===newName)throw new Error('evaluation directive is not allowed on the data-setter attribute: "'.concat(name,'"'));try{result=Scripting.evalTwineScript(value)}catch(ex){throw new Error('bad evaluation from attribute directive "'.concat(name,'": ').concat(ex.message))}try{el.setAttribute(newName,result),el.removeAttribute(name)}catch(ex){throw new Error('cannot transform attribute directive "'.concat(name,'" into attribute "').concat(newName,'"'))}}}))},processDataAttributes:function(el,tagName){var passage=el.getAttribute("data-passage");if(null!=passage){var evaluated=Wikifier.helpers.evalPassageId(passage);if(evaluated!==passage&&(passage=evaluated,el.setAttribute("data-passage",evaluated)),""!==passage)if(this.mediaTags.includes(tagName)){if("data:"!==passage.slice(0,5)&&Story.has(passage)){var parentName,twineTag;switch(passage=Story.get(passage),tagName){case"audio":case"video":twineTag="Twine.".concat(tagName);break;case"img":twineTag="Twine.image";break;case"track":twineTag="Twine.vtt";break;case"source":var $parent=$(el).closest("audio,picture,video");$parent.length&&(parentName=$parent.get(0).tagName.toLowerCase(),twineTag="Twine.".concat("picture"===parentName?"image":parentName))}passage.tags.includes(twineTag)&&(el["picture"===parentName?"srcset":"src"]=passage.text.trim())}}else{var setFn,setter=el.getAttribute("data-setter");null!=setter&&""!==(setter=String(setter).trim())&&(setFn=Wikifier.helpers.createShadowSetterCallback(Scripting.parse(setter))),Story.has(passage)?(el.classList.add("link-internal"),Config.addVisitedLinkClass&&State.hasPlayed(passage)&&el.classList.add("link-visited")):el.classList.add("link-broken"),jQuery(el).ariaClick({one:!0},(function(){"function"==typeof setFn&&setFn.call(this),Engine.play(passage)}))}}}})}();var Template=(_templates=new Map,_validNameRe=new RegExp("^(?:".concat(Patterns.templateName,")$")),_validType=function(template){var templateType=_typeof(template);return"function"===templateType||"string"===templateType},Object.freeze(Object.defineProperties({},{add:{value:function(name,template){if(!(_validType(template)||template instanceof Array&&template.length>0&&template.every(_validType)))throw new TypeError("invalid template type (".concat(name,"); templates must be: functions, strings, or an array of either"));(name instanceof Array?name:[name]).forEach((function(name){if(!_validNameRe.test(name))throw new Error('invalid template name "'.concat(name,'"'));if(_templates.has(name))throw new Error("cannot clobber existing template ?".concat(name));_templates.set(name,template)}))}},delete:{value:function(name){(name instanceof Array?name:[name]).forEach((function(name){return _templates.delete(name)}))}},get:{value:function(name){return _templates.has(name)?_templates.get(name):null}},has:{value:function(name){return _templates.has(name)}},size:{get:function(){return _templates.size}}}))),_templates,_validNameRe,_validType,Macro=function(){var _macros={},_tags={},_validNameRe=new RegExp("^(?:".concat(Patterns.macroName,")$"));function macrosHas(name){return _macros.hasOwnProperty(name)}function tagsRegister(parent,bodyTags){if(!parent)throw new Error("no parent specified");for(var endTags=["/".concat(parent),"end".concat(parent)],allTags=[].concat(endTags,Array.isArray(bodyTags)?bodyTags:[]),i=0;i<allTags.length;++i){var tag=allTags[i];if(macrosHas(tag))throw new Error("cannot register tag for an existing macro");tagsHas(tag)?_tags[tag].includes(parent)||(_tags[tag].push(parent),_tags[tag].sort()):_tags[tag]=[parent]}}function tagsUnregister(parent){if(!parent)throw new Error("no parent specified");Object.keys(_tags).forEach((function(tag){var i=_tags[tag].indexOf(parent);-1!==i&&(1===_tags[tag].length?delete _tags[tag]:_tags[tag].splice(i,1))}))}function tagsHas(name){return _tags.hasOwnProperty(name)}return Object.freeze(Object.defineProperties({},{add:{value:function macrosAdd(name,def){if(Array.isArray(name))name.forEach((function(name){return macrosAdd(name,def)}));else{if(!_validNameRe.test(name))throw new Error('invalid macro name "'.concat(name,'"'));if(macrosHas(name))throw new Error("cannot clobber existing macro <<".concat(name,">>"));if(tagsHas(name))throw new Error("cannot clobber child tag <<".concat(name,">> of parent macro").concat(1===_tags[name].length?"":"s"," <<").concat(_tags[name].join(">>, <<"),">>"));try{if("object"===_typeof(def))_macros[name]=Object.assign(Object.create(null),def,{_MACRO_API:!0});else{if(!macrosHas(def))throw new Error("cannot create alias of nonexistent macro <<".concat(def,">>"));_macros[name]=Object.create(_macros[def],{_ALIAS_OF:{enumerable:!0,value:def}})}Object.defineProperty(_macros,name,{writable:!1})}catch(ex){throw"TypeError"===ex.name?new Error("cannot clobber protected macro <<".concat(name,">>")):new Error("unknown error when attempting to add macro <<".concat(name,">>: [").concat(ex.name,"] ").concat(ex.message))}if(void 0!==_macros[name].tags)if(null==_macros[name].tags)tagsRegister(name);else{if(!Array.isArray(_macros[name].tags))throw new Error('bad value for "tags" property of macro <<'.concat(name,">>"));tagsRegister(name,_macros[name].tags)}}}},delete:{value:function macrosDelete(name){if(Array.isArray(name))name.forEach((function(name){return macrosDelete(name)}));else if(macrosHas(name)){void 0!==_macros[name].tags&&tagsUnregister(name);try{Object.defineProperty(_macros,name,{writable:!0}),delete _macros[name]}catch(ex){throw new Error("unknown error removing macro <<".concat(name,">>: ").concat(ex.message))}}else if(tagsHas(name))throw new Error("cannot remove child tag <<".concat(name,">> of parent macro <<").concat(_tags[name],">>"))}},isEmpty:{value:function(){return 0===Object.keys(_macros).length}},has:{value:macrosHas},get:{value:function(name){var macro=null;return macrosHas(name)&&"function"==typeof _macros[name].handler?macro=_macros[name]:macros.hasOwnProperty(name)&&"function"==typeof macros[name].handler&&(macro=macros[name]),macro}},init:{value:function(){var handler=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"init";Object.keys(_macros).forEach((function(name){"function"==typeof _macros[name][handler]&&_macros[name][handler](name)})),Object.keys(macros).forEach((function(name){"function"==typeof macros[name][handler]&&macros[name][handler](name)}))}},tags:{value:Object.freeze(Object.defineProperties({},{register:{value:tagsRegister},unregister:{value:tagsUnregister},has:{value:tagsHas},get:{value:function(name){return tagsHas(name)?_tags[name]:null}}}))},evalStatements:{value:function(){return Scripting.evalJavaScript.apply(Scripting,arguments)}}}))}(),MacroContext=function(){var MacroContext=function(){function MacroContext(contextData){_classCallCheck(this,MacroContext);var context=Object.assign({parent:null,macro:null,name:"",displayName:"",args:null,payload:null,parser:null,source:""},contextData);if(null===context.macro||""===context.name||null===context.parser)throw new TypeError("context object missing required properties");Object.defineProperties(this,{self:{value:context.macro},name:{value:void 0===context.macro._ALIAS_OF?context.name:context.macro._ALIAS_OF},displayName:{value:context.name},args:{value:context.args},payload:{value:context.payload},source:{value:context.source},parent:{value:context.parent},parser:{value:context.parser},_output:{value:context.parser.output},_shadows:{writable:!0,value:null},_debugView:{writable:!0,value:null},_debugViewEnabled:{writable:!0,value:Config.debug}})}return _createClass(MacroContext,[{key:"output",get:function(){return this._debugViewEnabled?this.debugView.output:this._output}},{key:"shadows",get:function(){return _toConsumableArray(this._shadows)}},{key:"shadowView",get:function(){var view=new Set;return this.contextSelectAll((function(ctx){return ctx._shadows})).forEach((function(ctx){return ctx._shadows.forEach((function(name){return view.add(name)}))})),_toConsumableArray(view)}},{key:"debugView",get:function(){return this._debugViewEnabled?null!==this._debugView?this._debugView:this.createDebugView():null}},{key:"contextHas",value:function(filter){for(var context=this;null!==(context=context.parent);)if(filter(context))return!0;return!1}},{key:"contextSelect",value:function(filter){for(var context=this;null!==(context=context.parent);)if(filter(context))return context;return null}},{key:"contextSelectAll",value:function(filter){for(var result=[],context=this;null!==(context=context.parent);)filter(context)&&result.push(context);return result}},{key:"addShadow",value:function(){var _this14=this;this._shadows||(this._shadows=new Set);for(var varRe=new RegExp("^".concat(Patterns.variable,"$")),_len14=arguments.length,names=new Array(_len14),_key14=0;_key14<_len14;_key14++)names[_key14]=arguments[_key14];names.flat(1/0).forEach((function(name){if("string"!=typeof name)throw new TypeError("variable name must be a string; type: ".concat(_typeof(name)));if(!varRe.test(name))throw new Error('invalid variable name "'.concat(name,'"'));_this14._shadows.add(name)}))}},{key:"createShadowWrapper",value:function(callback,doneCallback,startCallback){var shadowStore,shadowContext=this;return"function"==typeof callback&&(shadowStore={},this.shadowView.forEach((function(varName){var varKey=varName.slice(1),store="$"===varName[0]?State.variables:State.temporary;shadowStore[varName]=store[varKey]}))),function(){for(var _len15=arguments.length,args=new Array(_len15),_key15=0;_key15<_len15;_key15++)args[_key15]=arguments[_key15];if("function"==typeof startCallback&&startCallback.apply(this,args),"function"==typeof callback){var contextCache,shadowNames=Object.keys(shadowStore),valueCache=shadowNames.length>0?{}:null,macroParser=Wikifier.Parser.get("macro");try{shadowNames.forEach((function(varName){var varKey=varName.slice(1),store="$"===varName[0]?State.variables:State.temporary;store.hasOwnProperty(varKey)&&(valueCache[varKey]=store[varKey]),store[varKey]=shadowStore[varName]})),contextCache=macroParser.context,macroParser.context=shadowContext,callback.apply(this,args)}finally{contextCache!==undefined&&(macroParser.context=contextCache),shadowNames.forEach((function(varName){var varKey=varName.slice(1),store="$"===varName[0]?State.variables:State.temporary;shadowStore[varName]=store[varKey],valueCache.hasOwnProperty(varKey)?store[varKey]=valueCache[varKey]:delete store[varKey]}))}}"function"==typeof doneCallback&&doneCallback.apply(this,args)}}},{key:"createDebugView",value:function(name,title){return this._debugView=new DebugView(this._output,"macro",name||this.displayName,title||this.source),null!==this.payload&&this.payload.length>0&&this._debugView.modes({nonvoid:!0}),this._debugViewEnabled=!0,this._debugView}},{key:"removeDebugView",value:function(){null!==this._debugView&&(this._debugView.remove(),this._debugView=null),this._debugViewEnabled=!1}},{key:"error",value:function(message,source){return throwError(this._output,"<<".concat(this.displayName,">>: ").concat(message),source||this.source)}}]),MacroContext}();return MacroContext}();!function(){if(Macro.add("capture",{skipArgs:!0,tags:null,tsVarRe:new RegExp("(".concat(Patterns.variable,")"),"g"),handler:function(){if(0===this.args.raw.length)return this.error("no story/temporary variable list specified");var valueCache={};try{for(var match,tsVarRe=this.self.tsVarRe;null!==(match=tsVarRe.exec(this.args.raw));){var varName=match[1],varKey=varName.slice(1),store="$"===varName[0]?State.variables:State.temporary;store.hasOwnProperty(varKey)&&(valueCache[varKey]=store[varKey]),this.addShadow(varName)}new Wikifier(this.output,this.payload[0].contents)}finally{this.shadows.forEach((function(varName){var varKey=varName.slice(1),store="$"===varName[0]?State.variables:State.temporary;valueCache.hasOwnProperty(varKey)?store[varKey]=valueCache[varKey]:delete store[varKey]}))}}}),Macro.add("set",{skipArgs:!0,handler:function(){if(0===this.args.full.length)return this.error("no expression specified");try{Scripting.evalJavaScript(this.args.full)}catch(ex){return this.error("bad evaluation: ".concat("object"===_typeof(ex)?ex.message:ex))}Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("unset",{skipArgs:!0,jsVarRe:new RegExp("State\\.(variables|temporary)\\.(".concat(Patterns.identifier,")"),"g"),handler:function(){if(0===this.args.full.length)return this.error("no story/temporary variable list specified");for(var match,jsVarRe=this.self.jsVarRe;null!==(match=jsVarRe.exec(this.args.full));){var store=State[match[1]],name=match[2];store.hasOwnProperty(name)&&delete store[name]}Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("remember",{skipArgs:!0,jsVarRe:new RegExp("State\\.variables\\.(".concat(Patterns.identifier,")"),"g"),handler:function(){if(0===this.args.full.length)return this.error("no expression specified");try{Scripting.evalJavaScript(this.args.full)}catch(ex){return this.error("bad evaluation: ".concat("object"===_typeof(ex)?ex.message:ex))}for(var match,remember=storage.get("remember")||{},jsVarRe=this.self.jsVarRe;null!==(match=jsVarRe.exec(this.args.full));){var name=match[1];remember[name]=State.variables[name]}if(!storage.set("remember",remember))return this.error("unknown error, cannot remember: ".concat(this.args.raw));Config.debug&&this.debugView.modes({hidden:!0})},init:function(){var remember=storage.get("remember");remember&&Object.keys(remember).forEach((function(name){return State.variables[name]=remember[name]}))}}),Macro.add("forget",{skipArgs:!0,jsVarRe:new RegExp("State\\.variables\\.(".concat(Patterns.identifier,")"),"g"),handler:function(){if(0===this.args.full.length)return this.error("no story variable list specified");for(var match,remember=storage.get("remember"),jsVarRe=this.self.jsVarRe,needStore=!1;null!==(match=jsVarRe.exec(this.args.full));){var name=match[1];State.variables.hasOwnProperty(name)&&delete State.variables[name],remember&&remember.hasOwnProperty(name)&&(needStore=!0,delete remember[name])}if(needStore)if(0===Object.keys(remember).length){if(!storage.delete("remember"))return this.error("unknown error, cannot update remember store")}else if(!storage.set("remember",remember))return this.error("unknown error, cannot update remember store");Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("run","set"),Macro.add("script",{skipArgs:!0,tags:null,handler:function(){var output=document.createDocumentFragment();try{Scripting.evalJavaScript(this.payload[0].contents,output)}catch(ex){return this.error("bad evaluation: ".concat("object"===_typeof(ex)?ex.message:ex))}Config.debug&&this.createDebugView(),output.hasChildNodes()&&this.output.appendChild(output)}}),Macro.add("include",{handler:function(){return 0===this.args.length?this.error("no passage specified"):(passage="object"===_typeof(this.args[0])?this.args[0].link:this.args[0],Story.has(passage)?(Config.debug&&this.debugView.modes({block:!0}),passage=Story.get(passage),void(this.args[1]?jQuery(document.createElement(this.args[1])).addClass("".concat(passage.domId," macro-").concat(this.name)).attr("data-passage",passage.title).appendTo(this.output):jQuery(this.output)).wiki(passage.processText())):this.error('passage "'.concat(passage,'" does not exist')));var passage}}),Macro.add("nobr",{skipArgs:!0,tags:null,handler:function(){new Wikifier(this.output,this.payload[0].contents.replace(/^\n+|\n+$/g,"").replace(/\n+/g," "))}}),Macro.add(["print","=","-"],{skipArgs:!0,handler:function(){if(0===this.args.full.length)return this.error("no expression specified");try{var result=stringFrom(Scripting.evalJavaScript(this.args.full));null!==result&&new Wikifier(this.output,"-"===this.name?Util.escape(result):result)}catch(ex){return this.error("bad evaluation: ".concat("object"===_typeof(ex)?ex.message:ex))}}}),Macro.add("silently",{skipArgs:!0,tags:null,handler:function(){var frag=document.createDocumentFragment();if(new Wikifier(frag,this.payload[0].contents.trim()),Config.debug)this.debugView.modes({block:!0,hidden:!0}),this.output.appendChild(frag);else{var errList=_toConsumableArray(frag.querySelectorAll(".error")).map((function(errEl){return errEl.textContent}));if(errList.length>0)return this.error("error".concat(1===errList.length?"":"s"," within contents (").concat(errList.join("; "),")"))}}}),Macro.add("type",{isAsync:!0,tags:null,typeId:0,handler:function(){if(0===this.args.length)return this.error("no speed specified");var cursor,speed=Util.fromCssTime(this.args[0]);if(speed<0)return this.error("speed time value must be non-negative (received: ".concat(this.args[0],")"));for(var elClass="",elId="",elTag="div",skipKey=Config.macros.typeSkipKey,start=400,options=this.args.slice(1);options.length>0;){var option=options.shift();switch(option){case"class":if(0===options.length)return this.error("class option missing required class name(s)");if(""===(elClass=options.shift()))throw new Error('class option class name(s) must be non-empty (received: "")');break;case"element":if(0===options.length)return this.error("element option missing required element tag name");if(""===(elTag=options.shift()))throw new Error('element option tag name must be non-empty (received: "")');break;case"id":if(0===options.length)return this.error("id option missing required ID");if(""===(elId=options.shift()))throw new Error('id option ID must be non-empty (received: "")');break;case"keep":cursor="keep";break;case"none":cursor="none";break;case"skipkey":if(0===options.length)return this.error("skipkey option missing required key value");if(""===(skipKey=options.shift()))throw new Error('skipkey option key value must be non-empty (received: "")');break;case"start":if(0===options.length)return this.error("start option missing required time value");var value=options.shift();if((start=Util.fromCssTime(value))<0)throw new Error("start option time value must be non-negative (received: ".concat(value,")"));break;default:return this.error("unknown option: ".concat(option))}}var contents=this.payload[0].contents;if(""!==contents.trim()){Config.debug&&this.debugView.modes({block:!0});var className="macro-".concat(this.name),namespace=".".concat(className),$target=jQuery(document.createElement(elTag)).addClass("".concat(className," ").concat(className,"-target")).appendTo(this.output);TempState.macroTypeQueue||(TempState.macroTypeQueue=[],$(document).off(namespace).one(":passageinit".concat(namespace),(function(){return $(document).off(namespace)})));var startTyping=0===TempState.macroTypeQueue.length,selfId=++this.self.typeId;TempState.macroTypeQueue.push({id:selfId,handler:function(){var $wrapper=jQuery(document.createElement(elTag)).addClass(className);elId&&$wrapper.attr("id",elId),elClass&&$wrapper.addClass(elClass),new Wikifier($wrapper,contents);var passage=State.passage,turn=State.turns;if(!Config.macros.typeVisitedPassages&&State.passages.slice(0,-1).some((function(title){return title===passage}))||$wrapper.find(".error").length>0)return $target.replaceWith($wrapper),TempState.macroTypeQueue.shift(),void(TempState.macroTypeQueue.length>0&&TempState.macroTypeQueue.first().handler());var typer=new NodeTyper({targetNode:$wrapper.get(0),classNames:"none"===cursor?null:"".concat(className,"-cursor")});$target.replaceWith($wrapper);var keydownAndNS="keydown".concat(namespace),typingStopAndNS="".concat(":typingstop").concat(namespace);$(document).off(keydownAndNS).on(keydownAndNS,(function(ev){Util.scrubEventKey(ev.key)!==skipKey||ev.target!==document.body&&ev.target!==document.documentElement||(ev.preventDefault(),$(document).off(keydownAndNS),typer.finish())})).one(typingStopAndNS,(function(){TempState.macroTypeQueue&&(0===TempState.macroTypeQueue.length?jQuery.event.trigger(":typingcomplete"):TempState.macroTypeQueue.first().handler())}));var typeNode=function(){var typeNodeMember=function(typeIntervalId){State.passage===passage&&State.turns===turn&&typer.type()||(typeIntervalId&&clearInterval(typeIntervalId),TempState.macroTypeQueue&&TempState.macroTypeQueue.length>0&&TempState.macroTypeQueue.first().id===selfId&&TempState.macroTypeQueue.shift(),$wrapper.trigger(":typingstop"),$wrapper.addClass("".concat(className,"-done")),"keep"===cursor&&$wrapper.addClass("".concat(className,"-cursor")))};$wrapper.trigger(":typingstart"),typeNodeMember();var typeNodeMemberId=setInterval((function(){return typeNodeMember(typeNodeMemberId)}),speed)};start?setTimeout(typeNode,start):typeNode()}}),startTyping&&(Engine.isPlaying()?$(document).one(":passageend".concat(namespace),(function(){return TempState.macroTypeQueue.first().handler()})):TempState.macroTypeQueue.first().handler())}}}),Macro.add("display","include"),Macro.add("if",{skipArgs:!0,tags:["elseif","else"],elseifWsRe:/^\s*if\b/i,ifAssignRe:/[^!=&^|<>*/%+-]=[^=>]/,handler:function(){var i;try{var len=this.payload.length,elseifWsRe=this.self.elseifWsRe,ifAssignRe=this.self.ifAssignRe;for(i=0;i<len;++i)if("else"===this.payload[i].name){if(this.payload[i].args.raw.length>0)return elseifWsRe.test(this.payload[i].args.raw)?this.error('whitespace is not allowed between the "else" and "if" in <<elseif>> clause'.concat(i>0?" (#"+i+")":"")):this.error("<<else>> does not accept a conditional expression (perhaps you meant to use <<elseif>>), invalid: ".concat(this.payload[i].args.raw));if(i+1!==len)return this.error("<<else>> must be the final clause")}else{if(0===this.payload[i].args.full.length)return this.error("no conditional expression specified for <<".concat(this.payload[i].name,">> clause").concat(i>0?" (#"+i+")":""));if(Config.macros.ifAssignmentError&&ifAssignRe.test(this.payload[i].args.full))return this.error("assignment operator found within <<".concat(this.payload[i].name,">> clause").concat(i>0?" (#"+i+")":""," (perhaps you meant to use an equality operator: ==, ===, eq, is), invalid: ").concat(this.payload[i].args.raw))}var evalJavaScript=Scripting.evalJavaScript,success=!1;for(i=0;i<len;++i){if(Config.debug&&this.createDebugView(this.payload[i].name,this.payload[i].source).modes({nonvoid:!1}),"else"===this.payload[i].name||evalJavaScript(this.payload[i].args.full)){success=!0,new Wikifier(this.output,this.payload[i].contents);break}Config.debug&&this.debugView.modes({hidden:!0,invalid:!0})}if(Config.debug){for(++i;i<len;++i)this.createDebugView(this.payload[i].name,this.payload[i].source).modes({nonvoid:!1,hidden:!0,invalid:!0});this.createDebugView("/".concat(this.name),"<</".concat(this.name,">>")).modes({nonvoid:!1,hidden:!success,invalid:!success})}}catch(ex){return this.error("bad conditional expression in <<".concat(0===i?"if":"elseif",">> clause").concat(i>0?" (#"+i+")":"",": ").concat("object"===_typeof(ex)?ex.message:ex))}}}),Macro.add("switch",{skipArgs:["switch"],tags:["case","default"],handler:function(){if(0===this.args.full.length)return this.error("no expression specified");var i,result,len=this.payload.length;if(1===len)return this.error("no cases specified");for(i=1;i<len;++i)if("default"===this.payload[i].name){if(this.payload[i].args.length>0)return this.error("<<default>> does not accept values, invalid: ".concat(this.payload[i].args.raw));if(i+1!==len)return this.error("<<default>> must be the final case")}else if(0===this.payload[i].args.length)return this.error("no value(s) specified for <<".concat(this.payload[i].name,">> (#").concat(i,")"));try{result=Scripting.evalJavaScript(this.args.full)}catch(ex){return this.error("bad evaluation: ".concat("object"===_typeof(ex)?ex.message:ex))}var debugView=this.debugView,success=!1;for(Config.debug&&debugView.modes({nonvoid:!1,hidden:!0}),i=1;i<len;++i){if(Config.debug&&this.createDebugView(this.payload[i].name,this.payload[i].source).modes({nonvoid:!1}),"default"===this.payload[i].name||this.payload[i].args.some((function(val){return val===result}))){success=!0,new Wikifier(this.output,this.payload[i].contents);break}Config.debug&&this.debugView.modes({hidden:!0,invalid:!0})}if(Config.debug){for(++i;i<len;++i)this.createDebugView(this.payload[i].name,this.payload[i].source).modes({nonvoid:!1,hidden:!0,invalid:!0});debugView.modes({nonvoid:!1,hidden:!0,invalid:!success}),this.createDebugView("/".concat(this.name),"<</".concat(this.name,">>")).modes({nonvoid:!1,hidden:!0,invalid:!success})}}}),Macro.add("for",{skipArgs:!0,tags:null,hasRangeRe:new RegExp("^\\S".concat(Patterns.anyChar,"*?\\s+range\\s+\\S").concat(Patterns.anyChar,"*?$")),rangeRe:new RegExp("^(?:State\\.(variables|temporary)\\.(".concat(Patterns.identifier,")\\s*,\\s*)?State\\.(variables|temporary)\\.(").concat(Patterns.identifier,")\\s+range\\s+(\\S").concat(Patterns.anyChar,"*?)$")),threePartRe:/^([^;]*?)\s*;\s*([^;]*?)\s*;\s*([^;]*?)$/,forInRe:/^\S+\s+in\s+\S+/i,forOfRe:/^\S+\s+of\s+\S+/i,handler:function(){var argsStr=this.args.full.trim(),payload=this.payload[0].contents.replace(/\n$/,"");if(0===argsStr.length)this.self.handleFor.call(this,payload,null,!0,null);else if(this.self.hasRangeRe.test(argsStr)){var parts=argsStr.match(this.self.rangeRe);if(null===parts)return this.error("invalid range form syntax, format: [index ,] value range collection");this.self.handleForRange.call(this,payload,{type:parts[1],name:parts[2]},{type:parts[3],name:parts[4]},parts[5])}else{var init,condition,post;if(-1===argsStr.indexOf(";")){if(this.self.forInRe.test(argsStr))return this.error("invalid syntax, for…in is not supported; see: for…range");if(this.self.forOfRe.test(argsStr))return this.error("invalid syntax, for…of is not supported; see: for…range");condition=argsStr}else{var _parts=argsStr.match(this.self.threePartRe);if(null===_parts)return this.error("invalid 3-part conditional form syntax, format: [init] ; [condition] ; [post]");init=_parts[1],condition=_parts[2].trim(),post=_parts[3],0===condition.length&&(condition=!0)}this.self.handleFor.call(this,payload,init,condition,post)}},handleFor:function(payload,init,condition,post){var evalJavaScript=Scripting.evalJavaScript,first=!0,safety=Config.macros.maxLoopIterations;Config.debug&&this.debugView.modes({block:!0});try{if(TempState.break=null,init)try{evalJavaScript(init)}catch(ex){return this.error("bad init expression: ".concat("object"===_typeof(ex)?ex.message:ex))}for(;evalJavaScript(condition);){if(--safety<0)return this.error("exceeded configured maximum loop iterations (".concat(Config.macros.maxLoopIterations,")"));if(new Wikifier(this.output,first?payload.replace(/^\n/,""):payload),first&&(first=!1),null!=TempState.break)if(1===TempState.break)TempState.break=null;else if(2===TempState.break){TempState.break=null;break}if(post)try{evalJavaScript(post)}catch(ex){return this.error("bad post expression: ".concat("object"===_typeof(ex)?ex.message:ex))}}}catch(ex){return this.error("bad conditional expression: ".concat("object"===_typeof(ex)?ex.message:ex))}finally{TempState.break=null}},handleForRange:function(payload,indexVar,valueVar,rangeExp){var rangeList,first=!0;try{rangeList=this.self.toRangeList(rangeExp)}catch(ex){return this.error(ex.message)}Config.debug&&this.debugView.modes({block:!0});try{TempState.break=null;for(var i=0;i<rangeList.length;++i)if(indexVar.name&&(State[indexVar.type][indexVar.name]=rangeList[i][0]),State[valueVar.type][valueVar.name]=rangeList[i][1],new Wikifier(this.output,first?payload.replace(/^\n/,""):payload),first&&(first=!1),null!=TempState.break)if(1===TempState.break)TempState.break=null;else if(2===TempState.break){TempState.break=null;break}}catch(ex){return this.error("object"===_typeof(ex)?ex.message:ex)}finally{TempState.break=null}},toRangeList:function(rangeExp){var value,list,evalJavaScript=Scripting.evalJavaScript;try{value=evalJavaScript("{"===rangeExp[0]?"(".concat(rangeExp,")"):rangeExp)}catch(ex){if("object"!==_typeof(ex))throw new Error("bad range expression: ".concat(ex));throw ex.message="bad range expression: ".concat(ex.message),ex}switch(_typeof(value)){case"string":list=[];for(var i=0;i<value.length;){var obj=Util.charAndPosAt(value,i);list.push([i,obj.char]),i=1+obj.end}break;case"object":if(Array.isArray(value))list=value.map((function(val,i){return[i,val]}));else if(value instanceof Set)list=_toConsumableArray(value).map((function(val,i){return[i,val]}));else if(value instanceof Map)list=_toConsumableArray(value.entries());else{if("Object"!==Util.toStringTag(value))throw new Error("unsupported range expression type: ".concat(Util.toStringTag(value)));list=Object.keys(value).map((function(key){return[key,value[key]]}))}break;default:throw new Error("unsupported range expression type: ".concat(_typeof(value)))}return list}}),Macro.add(["break","continue"],{skipArgs:!0,handler:function(){if(!this.contextHas((function(ctx){return"for"===ctx.name})))return this.error("must only be used in conjunction with its parent macro <<for>>");TempState.break="continue"===this.name?1:2,Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add(["button","link"],{isAsync:!0,tags:null,handler:function(){var _this15=this;if(0===this.args.length)return this.error("no ".concat("button"===this.name?"button":"link"," text specified"));var passage,$link=jQuery(document.createElement("button"===this.name?"button":"a"));if("object"===_typeof(this.args[0]))if(this.args[0].isImage){var $image=jQuery(document.createElement("img")).attr("src",this.args[0].source).appendTo($link);$link.addClass("link-image"),this.args[0].hasOwnProperty("passage")&&$image.attr("data-passage",this.args[0].passage),this.args[0].hasOwnProperty("title")&&$image.attr("title",this.args[0].title),this.args[0].hasOwnProperty("align")&&$image.attr("align",this.args[0].align),passage=this.args[0].link}else $link.append(document.createTextNode(this.args[0].text)),passage=this.args[0].link;else $link.wikiWithOptions({profile:"core"},this.args[0]),passage=this.args.length>1?this.args[1]:undefined;null!=passage?($link.attr("data-passage",passage),Story.has(passage)?($link.addClass("link-internal"),Config.addVisitedLinkClass&&State.hasPlayed(passage)&&$link.addClass("link-visited")):$link.addClass("link-broken")):$link.addClass("link-internal"),$link.addClass("macro-".concat(this.name)).ariaClick({namespace:".macros",role:null!=passage?"link":"button",one:null!=passage},this.createShadowWrapper(""!==this.payload[0].contents?function(){return Wikifier.wikifyEval(_this15.payload[0].contents.trim())}:null,null!=passage?function(){return Engine.play(passage)}:null)).appendTo(this.output)}}),Macro.add("checkbox",{isAsync:!0,handler:function(){if(this.args.length<3){var errors=[];return this.args.length<1&&errors.push("variable name"),this.args.length<2&&errors.push("unchecked value"),this.args.length<3&&errors.push("checked value"),this.error("no ".concat(errors.join(" or ")," specified"))}if("string"!=typeof this.args[0])return this.error("variable name argument is not a string");var varName=this.args[0].trim();if("$"!==varName[0]&&"_"!==varName[0])return this.error('variable name "'.concat(this.args[0],'" is missing its sigil ($ or _)'));var varId=Util.slugify(varName),uncheckValue=this.args[1],checkValue=this.args[2],el=document.createElement("input");switch(jQuery(el).attr({id:"".concat(this.name,"-").concat(varId),name:"".concat(this.name,"-").concat(varId),type:"checkbox",tabindex:0}).addClass("macro-".concat(this.name)).on("change.macros",this.createShadowWrapper((function(){State.setVar(varName,this.checked?checkValue:uncheckValue)}))).appendTo(this.output),this.args[3]){case"autocheck":State.getVar(varName)===checkValue?el.checked=!0:State.setVar(varName,uncheckValue);break;case"checked":el.checked=!0,State.setVar(varName,checkValue);break;default:State.setVar(varName,uncheckValue)}}}),Macro.add(["cycle","listbox"],{isAsync:!0,skipArgs:["optionsfrom"],tags:["option","optionsfrom"],handler:function(){var _this16=this;if(0===this.args.length)return this.error("no variable name specified");if("string"!=typeof this.args[0])return this.error("variable name argument is not a string");var varName=this.args[0].trim();if("$"!==varName[0]&&"_"!==varName[0])return this.error('variable name "'.concat(this.args[0],'" is missing its sigil ($ or _)'));var varId=Util.slugify(varName),len=this.payload.length;if(1===len)return this.error("no options specified");for(var config={autoselect:!1,once:!1},i=1;i<this.args.length;++i){var arg=this.args[i];switch(arg){case"once":config.once=!0;break;case"autoselect":config.autoselect=!0;break;default:return this.error("unknown argument: ".concat(arg))}}for(var options=[],tagCount={option:0,optionsfrom:0},selectedIdx=-1,_i5=1;_i5<len;++_i5){var payload=this.payload[_i5];if("option"===payload.name){if(++tagCount.option,0===payload.args.length)return this.error("no arguments specified for <<".concat(payload.name,">> (#").concat(tagCount.option,")"));var option={label:String(payload.args[0])},isSelected=!1;switch(payload.args.length){case 1:option.value=payload.args[0];break;case 2:"selected"===payload.args[1]?(option.value=payload.args[0],isSelected=!0):option.value=payload.args[1];break;default:option.value=payload.args[1],"selected"===payload.args[2]&&(isSelected=!0)}if(options.push(option),isSelected){if(config.autoselect)return this.error("cannot specify both the autoselect and selected keywords");if(-1!==selectedIdx)return this.error("multiple selected keywords specified for <<".concat(payload.name,">> (#").concat(selectedIdx+1," & #").concat(tagCount.option,")"));selectedIdx=options.length-1}}else{var _ret=function(){if(++tagCount.optionsfrom,0===payload.args.full.length)return{v:_this16.error("no expression specified for <<".concat(payload.name,">> (#").concat(tagCount.optionsfrom,")"))};var result=void 0;try{var exp=payload.args.full;result=Scripting.evalJavaScript("{"===exp[0]?"(".concat(exp,")"):exp)}catch(ex){return{v:_this16.error("bad evaluation: ".concat("object"===_typeof(ex)?ex.message:ex))}}if("object"!==_typeof(result)||null===result)return{v:_this16.error("expression must yield a supported collection or generic object (type: ".concat(null===result?"null":_typeof(result),")"))};if(result instanceof Array||result instanceof Set)result.forEach((function(val){return options.push({label:String(val),value:val})}));else if(result instanceof Map)result.forEach((function(val,key){return options.push({label:String(key),value:val})}));else{var oType=Util.toStringTag(result);if("Object"!==oType)return{v:_this16.error("expression must yield a supported collection or generic object (object type: ".concat(oType,")"))};Object.keys(result).forEach((function(key){return options.push({label:key,value:result[key]})}))}}();if("object"===_typeof(_ret))return _ret.v}}if(-1===selectedIdx)if(config.autoselect){var sameValueZero=Util.sameValueZero,curValue=State.getVar(varName),curValueIdx=options.findIndex((function(opt){return sameValueZero(opt.value,curValue)}));selectedIdx=-1===curValueIdx?0:curValueIdx}else selectedIdx=0;if("cycle"===this.name){var lastIdx=options.length-1;if(config.once&&selectedIdx===lastIdx)jQuery(this.output).wikiWithOptions({profile:"core"},options[selectedIdx].label);else{var cycleIdx=selectedIdx;jQuery(document.createElement("a")).wikiWithOptions({profile:"core"},options[selectedIdx].label).attr("id","".concat(this.name,"-").concat(varId)).addClass("macro-".concat(this.name)).ariaClick({namespace:".macros",role:"button"},this.createShadowWrapper((function(){var $this=$(this);cycleIdx=(cycleIdx+1)%options.length,State.setVar(varName,options[cycleIdx].value),$this.empty().wikiWithOptions({profile:"core"},options[cycleIdx].label),config.once&&cycleIdx===lastIdx&&$this.off().contents().unwrap()}))).appendTo(this.output)}}else{var $select=jQuery(document.createElement("select"));options.forEach((function(opt,i){jQuery(document.createElement("option")).val(i).text(opt.label).appendTo($select)})),$select.attr({id:"".concat(this.name,"-").concat(varId),name:"".concat(this.name,"-").concat(varId),tabindex:0}).addClass("macro-".concat(this.name)).val(selectedIdx).on("change.macros",this.createShadowWrapper((function(){State.setVar(varName,options[Number(this.value)].value)}))).appendTo(this.output)}State.setVar(varName,options[selectedIdx].value)}}),Macro.add(["linkappend","linkprepend","linkreplace"],{isAsync:!0,tags:null,t8nRe:/^(?:transition|t8n)$/,handler:function(){var _this17=this;if(0===this.args.length)return this.error("no link text specified");var $link=jQuery(document.createElement("a")),$insert=jQuery(document.createElement("span")),transition=this.args.length>1&&this.self.t8nRe.test(this.args[1]);$link.wikiWithOptions({profile:"core"},this.args[0]).addClass("link-internal macro-".concat(this.name)).ariaClick({namespace:".macros",one:!0},this.createShadowWrapper((function(){if("linkreplace"===_this17.name?$link.remove():$link.wrap('<span class="macro-'.concat(_this17.name,'"></span>')).replaceWith((function(){return $link.html()})),""!==_this17.payload[0].contents){var frag=document.createDocumentFragment();new Wikifier(frag,_this17.payload[0].contents),$insert.append(frag)}transition&&setTimeout((function(){return $insert.removeClass("macro-".concat(_this17.name,"-in"))}),Engine.minDomActionDelay)}))).appendTo(this.output),$insert.addClass("macro-".concat(this.name,"-insert")),transition&&$insert.addClass("macro-".concat(this.name,"-in")),"linkprepend"===this.name?$insert.insertBefore($link):$insert.insertAfter($link)}}),Macro.add(["numberbox","textbox"],{isAsync:!0,handler:function(){if(this.args.length<2){var errors=[];return this.args.length<1&&errors.push("variable name"),this.args.length<2&&errors.push("default value"),this.error("no ".concat(errors.join(" or ")," specified"))}if("string"!=typeof this.args[0])return this.error("variable name argument is not a string");var varName=this.args[0].trim();if("$"!==varName[0]&&"_"!==varName[0])return this.error('variable name "'.concat(this.args[0],'" is missing its sigil ($ or _)'));Config.debug&&this.debugView.modes({block:!0});var asNumber="numberbox"===this.name,defaultValue=asNumber?Number(this.args[1]):this.args[1];if(asNumber&&Number.isNaN(defaultValue))return this.error('default value "'.concat(this.args[1],'" is neither a number nor can it be parsed into a number'));var passage,varId=Util.slugify(varName),el=document.createElement("input"),autofocus=!1;this.args.length>3?(passage=this.args[2],autofocus="autofocus"===this.args[3]):this.args.length>2&&("autofocus"===this.args[2]?autofocus=!0:passage=this.args[2]),"object"===_typeof(passage)&&(passage=passage.link),jQuery(el).attr({id:"".concat(this.name,"-").concat(varId),name:"".concat(this.name,"-").concat(varId),type:asNumber?"number":"text",inputmode:asNumber?"decimal":"text",tabindex:0}).addClass("macro-".concat(this.name)).on("change.macros",this.createShadowWrapper((function(){State.setVar(varName,asNumber?Number(this.value):this.value)}))).on("keypress.macros",this.createShadowWrapper((function(ev){13===ev.which&&(ev.preventDefault(),State.setVar(varName,asNumber?Number(this.value):this.value),null!=passage&&Engine.play(passage))}))).appendTo(this.output),asNumber&&(el.step="any"),State.setVar(varName,defaultValue),el.value=defaultValue,autofocus&&(el.setAttribute("autofocus","autofocus"),postdisplay["#autofocus:".concat(el.id)]=function(task){delete postdisplay[task],setTimeout((function(){return el.focus()}),Engine.minDomActionDelay)})}}),Macro.add("radiobutton",{isAsync:!0,handler:function(){if(this.args.length<2){var errors=[];return this.args.length<1&&errors.push("variable name"),this.args.length<2&&errors.push("checked value"),this.error("no ".concat(errors.join(" or ")," specified"))}if("string"!=typeof this.args[0])return this.error("variable name argument is not a string");var varName=this.args[0].trim();if("$"!==varName[0]&&"_"!==varName[0])return this.error('variable name "'.concat(this.args[0],'" is missing its sigil ($ or _)'));var varId=Util.slugify(varName),checkValue=this.args[1],el=document.createElement("input");switch(TempState.hasOwnProperty(this.name)||(TempState[this.name]={}),TempState[this.name].hasOwnProperty(varId)||(TempState[this.name][varId]=0),jQuery(el).attr({id:"".concat(this.name,"-").concat(varId,"-").concat(TempState[this.name][varId]++),name:"".concat(this.name,"-").concat(varId),type:"radio",tabindex:0}).addClass("macro-".concat(this.name)).on("change.macros",this.createShadowWrapper((function(){this.checked&&State.setVar(varName,checkValue)}))).appendTo(this.output),this.args[2]){case"autocheck":State.getVar(varName)===checkValue&&(el.checked=!0);break;case"checked":el.checked=!0,State.setVar(varName,checkValue)}}}),Macro.add("textarea",{isAsync:!0,handler:function(){if(this.args.length<2){var errors=[];return this.args.length<1&&errors.push("variable name"),this.args.length<2&&errors.push("default value"),this.error("no ".concat(errors.join(" or ")," specified"))}if("string"!=typeof this.args[0])return this.error("variable name argument is not a string");var varName=this.args[0].trim();if("$"!==varName[0]&&"_"!==varName[0])return this.error('variable name "'.concat(this.args[0],'" is missing its sigil ($ or _)'));Config.debug&&this.debugView.modes({block:!0});var varId=Util.slugify(varName),defaultValue=this.args[1],autofocus="autofocus"===this.args[2],el=document.createElement("textarea");jQuery(el).attr({id:"".concat(this.name,"-").concat(varId),name:"".concat(this.name,"-").concat(varId),rows:4,tabindex:0}).addClass("macro-".concat(this.name)).on("change.macros",this.createShadowWrapper((function(){State.setVar(varName,this.value)}))).appendTo(this.output),State.setVar(varName,defaultValue),el.textContent=defaultValue,autofocus&&(el.setAttribute("autofocus","autofocus"),postdisplay["#autofocus:".concat(el.id)]=function(task){delete postdisplay[task],setTimeout((function(){return el.focus()}),Engine.minDomActionDelay)})}}),Macro.add("click","link"),Macro.add("actions",{handler:function(){for(var $list=jQuery(document.createElement("ul")).addClass(this.name).appendTo(this.output),i=0;i<this.args.length;++i){var passage=void 0,text=void 0,$image=void 0,setFn=void 0;if("object"===_typeof(this.args[i])?this.args[i].isImage?($image=jQuery(document.createElement("img")).attr("src",this.args[i].source),this.args[i].hasOwnProperty("passage")&&$image.attr("data-passage",this.args[i].passage),this.args[i].hasOwnProperty("title")&&$image.attr("title",this.args[i].title),this.args[i].hasOwnProperty("align")&&$image.attr("align",this.args[i].align),passage=this.args[i].link,setFn=this.args[i].setFn):(text=this.args[i].text,passage=this.args[i].link,setFn=this.args[i].setFn):text=passage=this.args[i],!(State.variables.hasOwnProperty("#actions")&&State.variables["#actions"].hasOwnProperty(passage)&&State.variables["#actions"][passage])){var $link=jQuery(Wikifier.createInternalLink(jQuery(document.createElement("li")).appendTo($list),passage,null,function(passage,fn){return function(){State.variables.hasOwnProperty("#actions")||(State.variables["#actions"]={}),State.variables["#actions"][passage]=!0,"function"==typeof fn&&fn()}}(passage,setFn))).addClass("macro-".concat(this.name)).append($image||document.createTextNode(text));$image&&$link.addClass("link-image")}}}}),Macro.add(["back","return"],{handler:function(){if(this.args.length>1)return this.error("too many arguments specified, check the documentation for details");var passage,text,$image,$link,momentIndex=-1;if(1===this.args.length&&("object"===_typeof(this.args[0])?this.args[0].isImage?($image=jQuery(document.createElement("img")).attr("src",this.args[0].source),this.args[0].hasOwnProperty("passage")&&$image.attr("data-passage",this.args[0].passage),this.args[0].hasOwnProperty("title")&&$image.attr("title",this.args[0].title),this.args[0].hasOwnProperty("align")&&$image.attr("align",this.args[0].align),this.args[0].hasOwnProperty("link")&&(passage=this.args[0].link)):(1===this.args[0].count||(text=this.args[0].text),passage=this.args[0].link):1===this.args.length&&(text=this.args[0])),null==passage){for(var i=State.length-2;i>=0;--i)if(State.history[i].title!==State.passage){momentIndex=i,passage=State.history[i].title;break}if(null==passage&&"return"===this.name)for(var _i6=State.expired.length-1;_i6>=0;--_i6)if(State.expired[_i6]!==State.passage){passage=State.expired[_i6];break}}else{if(!Story.has(passage))return this.error('passage "'.concat(passage,'" does not exist'));if("back"===this.name){for(var _i7=State.length-2;_i7>=0;--_i7)if(State.history[_i7].title===passage){momentIndex=_i7;break}if(-1===momentIndex)return this.error('cannot find passage "'.concat(passage,'" in the current story history'))}}if(null==passage)return this.error("cannot find passage");"back"!==this.name||-1!==momentIndex?($link=jQuery(document.createElement("a")).addClass("link-internal").ariaClick({one:!0},"return"===this.name?function(){return Engine.play(passage)}:function(){return Engine.goTo(momentIndex)}),$image&&$link.addClass("link-image")):$link=jQuery(document.createElement("span")).addClass("link-disabled"),$link.addClass("macro-".concat(this.name)).append($image||document.createTextNode(text||L10n.get("macro".concat(this.name.toUpperFirst(),"Text")))).appendTo(this.output)}}),Macro.add("choice",{handler:function(){if(0===this.args.length)return this.error("no passage specified");var passage,text,$image,setFn,$link,choiceId=State.passage;if(1===this.args.length?"object"===_typeof(this.args[0])?this.args[0].isImage?($image=jQuery(document.createElement("img")).attr("src",this.args[0].source),this.args[0].hasOwnProperty("passage")&&$image.attr("data-passage",this.args[0].passage),this.args[0].hasOwnProperty("title")&&$image.attr("title",this.args[0].title),this.args[0].hasOwnProperty("align")&&$image.attr("align",this.args[0].align),passage=this.args[0].link,setFn=this.args[0].setFn):(text=this.args[0].text,passage=this.args[0].link,setFn=this.args[0].setFn):text=passage=this.args[0]:(passage=this.args[0],text=this.args[1]),State.variables.hasOwnProperty("#choice")&&State.variables["#choice"].hasOwnProperty(choiceId)&&State.variables["#choice"][choiceId])return $link=jQuery(document.createElement("span")).addClass("link-disabled macro-".concat(this.name)).attr("tabindex",-1).append($image||document.createTextNode(text)).appendTo(this.output),void($image&&$link.addClass("link-image"));$link=jQuery(Wikifier.createInternalLink(this.output,passage,null,(function(){State.variables.hasOwnProperty("#choice")||(State.variables["#choice"]={}),State.variables["#choice"][choiceId]=!0,"function"==typeof setFn&&setFn()}))).addClass("macro-".concat(this.name)).append($image||document.createTextNode(text)),$image&&$link.addClass("link-image")}}),Macro.add(["addclass","toggleclass"],{handler:function(){if(this.args.length<2){var errors=[];return this.args.length<1&&errors.push("selector"),this.args.length<2&&errors.push("class names"),this.error("no ".concat(errors.join(" or ")," specified"))}var $targets=jQuery(this.args[0]);if(0===$targets.length)return this.error('no elements matched the selector "'.concat(this.args[0],'"'));switch(this.name){case"addclass":$targets.addClass(this.args[1].trim());break;case"toggleclass":$targets.toggleClass(this.args[1].trim())}Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("removeclass",{handler:function(){if(0===this.args.length)return this.error("no selector specified");var $targets=jQuery(this.args[0]);if(0===$targets.length)return this.error('no elements matched the selector "'.concat(this.args[0],'"'));this.args.length>1?$targets.removeClass(this.args[1].trim()):$targets.removeClass(),Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("copy",{handler:function(){if(0===this.args.length)return this.error("no selector specified");var $targets=jQuery(this.args[0]);if(0===$targets.length)return this.error('no elements matched the selector "'.concat(this.args[0],'"'));jQuery(this.output).append($targets.html()),Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add(["append","prepend","replace"],{tags:null,t8nRe:/^(?:transition|t8n)$/,handler:function(){var _this18=this;if(0===this.args.length)return this.error("no selector specified");var $insert,$targets=jQuery(this.args[0]);if(0===$targets.length)return this.error('no elements matched the selector "'.concat(this.args[0],'"'));if(""!==this.payload[0].contents)switch(this.args.length>1&&this.self.t8nRe.test(this.args[1])?(($insert=jQuery(document.createElement("span"))).addClass("macro-".concat(this.name,"-insert macro-").concat(this.name,"-in")),setTimeout((function(){return $insert.removeClass("macro-".concat(_this18.name,"-in"))}),Engine.minDomActionDelay)):$insert=jQuery(document.createDocumentFragment()),$insert.wiki(this.payload[0].contents),this.name){case"replace":$targets.empty();case"append":$targets.append($insert);break;case"prepend":$targets.prepend($insert)}else"replace"===this.name&&$targets.empty();Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("remove",{handler:function(){if(0===this.args.length)return this.error("no selector specified");var $targets=jQuery(this.args[0]);if(0===$targets.length)return this.error('no elements matched the selector "'.concat(this.args[0],'"'));$targets.remove(),Config.debug&&this.debugView.modes({hidden:!0})}}),Has.audio){var errorOnePlaybackAction=function(cur,prev){return'only one playback action allowed per invocation, "'.concat(cur,'" cannot be combined with "').concat(prev,'"')};Macro.add("audio",{handler:function(){if(this.args.length<2){var errors=[];return this.args.length<1&&errors.push("track and/or group IDs"),this.args.length<2&&errors.push("actions"),this.error("no ".concat(errors.join(" or ")," specified"))}var selected;try{selected=SimpleAudio.select(this.args[0])}catch(ex){return this.error(ex.message)}for(var action,fadeTo,loop,mute,passage,time,volume,args=this.args.slice(1),fadeOver=5;args.length>0;){var arg=args.shift(),raw=void 0;switch(arg){case"load":case"pause":case"play":case"stop":case"unload":if(action)return this.error(errorOnePlaybackAction(arg,action));action=arg;break;case"fadein":if(action)return this.error(errorOnePlaybackAction(arg,action));action="fade",fadeTo=1;break;case"fadeout":if(action)return this.error(errorOnePlaybackAction(arg,action));action="fade",fadeTo=0;break;case"fadeto":if(action)return this.error(errorOnePlaybackAction(arg,action));if(0===args.length)return this.error("fadeto missing required level value");if(action="fade",raw=args.shift(),fadeTo=Number.parseFloat(raw),Number.isNaN(fadeTo)||!Number.isFinite(fadeTo))return this.error("cannot parse fadeto: ".concat(raw));break;case"fadeoverto":if(action)return this.error(errorOnePlaybackAction(arg,action));if(args.length<2){var _errors=[];return args.length<1&&_errors.push("seconds"),args.length<2&&_errors.push("level"),this.error("fadeoverto missing required ".concat(_errors.join(" and ")," value").concat(_errors.length>1?"s":""))}if(action="fade",raw=args.shift(),fadeOver=Number.parseFloat(raw),Number.isNaN(fadeOver)||!Number.isFinite(fadeOver))return this.error("cannot parse fadeoverto: ".concat(raw));if(raw=args.shift(),fadeTo=Number.parseFloat(raw),Number.isNaN(fadeTo)||!Number.isFinite(fadeTo))return this.error("cannot parse fadeoverto: ".concat(raw));break;case"volume":if(0===args.length)return this.error("volume missing required level value");if(raw=args.shift(),volume=Number.parseFloat(raw),Number.isNaN(volume)||!Number.isFinite(volume))return this.error("cannot parse volume: ".concat(raw));break;case"mute":case"unmute":mute="mute"===arg;break;case"time":if(0===args.length)return this.error("time missing required seconds value");if(raw=args.shift(),time=Number.parseFloat(raw),Number.isNaN(time)||!Number.isFinite(time))return this.error("cannot parse time: ".concat(raw));break;case"loop":case"unloop":loop="loop"===arg;break;case"goto":if(0===args.length)return this.error("goto missing required passage title");if(raw=args.shift(),passage="object"===_typeof(raw)?raw.link:raw,!Story.has(passage))return this.error('passage "'.concat(passage,'" does not exist'));break;default:return this.error("unknown action: ".concat(arg))}}try{if(null!=volume&&selected.volume(volume),null!=time&&selected.time(time),null!=mute&&selected.mute(mute),null!=loop&&selected.loop(loop),null!=passage){var nsEnded="ended.macros.macro-".concat(this.name,"_goto");selected.off(nsEnded).one(nsEnded,(function(){selected.off(nsEnded),Engine.play(passage)}))}switch(action){case"fade":selected.fade(fadeOver,fadeTo);break;case"load":selected.load();break;case"pause":selected.pause();break;case"play":selected.playWhenAllowed();break;case"stop":selected.stop();break;case"unload":selected.unload()}Config.debug&&this.debugView.modes({hidden:!0})}catch(ex){return this.error("error executing action: ".concat(ex.message))}}}),Macro.add("cacheaudio",{handler:function(){var _this19=this;if(this.args.length<2){var errors=[];return this.args.length<1&&errors.push("track ID"),this.args.length<2&&errors.push("sources"),this.error("no ".concat(errors.join(" or ")," specified"))}var id=String(this.args[0]).trim(),oldFmtRe=/^format:\s*([\w-]+)\s*;\s*/i;try{SimpleAudio.tracks.add(id,this.args.slice(1).map((function(source){if(oldFmtRe.test(source)){if(Config.debug)return _this19.error('track ID "'.concat(id,'": format specifier migration required, "format:formatId;" → "formatId|"'));source=source.replace(oldFmtRe,"$1|")}return source})))}catch(ex){return this.error(ex.message)}if(Config.debug&&!SimpleAudio.tracks.get(id).hasSource())return this.error('track ID "'.concat(id,'": no supported audio sources found'));Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("createaudiogroup",{tags:["track"],handler:function(){if(0===this.args.length)return this.error("no group ID specified");if(1===this.payload.length)return this.error("no tracks defined via <<track>>");Config.debug&&this.debugView.modes({nonvoid:!1,hidden:!0});for(var groupId=String(this.args[0]).trim(),trackIds=[],i=1,len=this.payload.length;i<len;++i){if(this.payload[i].args.length<1)return this.error("no track ID specified");trackIds.push(String(this.payload[i].args[0]).trim()),Config.debug&&this.createDebugView(this.payload[i].name,this.payload[i].source).modes({nonvoid:!1,hidden:!0})}try{SimpleAudio.groups.add(groupId,trackIds)}catch(ex){return this.error(ex.message)}Config.debug&&this.createDebugView("/".concat(this.name),"<</".concat(this.name,">>")).modes({nonvoid:!1,hidden:!0})}}),Macro.add("createplaylist",{tags:["track"],handler:function(){if(0===this.args.length)return this.error("no list ID specified");if(1===this.payload.length)return this.error("no tracks defined via <<track>>");var playlist=Macro.get("playlist");if(null!==playlist.from&&"createplaylist"!==playlist.from)return this.error("a playlist has already been defined with <<setplaylist>>");Config.debug&&this.debugView.modes({nonvoid:!1,hidden:!0});for(var listId=String(this.args[0]).trim(),trackObjs=[],i=1,len=this.payload.length;i<len;++i){if(0===this.payload[i].args.length)return this.error("no track ID specified");for(var trackObj={id:String(this.payload[i].args[0]).trim()},args=this.payload[i].args.slice(1);args.length>0;){var arg=args.shift(),raw=void 0,parsed=void 0;switch(arg){case"copy":case"own":trackObj.own=!0;break;case"rate":args.length>0&&args.shift();break;case"volume":if(0===args.length)return this.error("volume missing required level value");if(raw=args.shift(),parsed=Number.parseFloat(raw),Number.isNaN(parsed)||!Number.isFinite(parsed))return this.error("cannot parse volume: ".concat(raw));trackObj.volume=parsed;break;default:return this.error("unknown action: ".concat(arg))}}trackObjs.push(trackObj),Config.debug&&this.createDebugView(this.payload[i].name,this.payload[i].source).modes({nonvoid:!1,hidden:!0})}try{SimpleAudio.lists.add(listId,trackObjs)}catch(ex){return this.error(ex.message)}null===playlist.from&&(playlist.from="createplaylist"),Config.debug&&this.createDebugView("/".concat(this.name),"<</".concat(this.name,">>")).modes({nonvoid:!1,hidden:!0})}}),Macro.add("masteraudio",{handler:function(){if(0===this.args.length)return this.error("no actions specified");for(var action,mute,muteOnHide,volume,args=this.args.slice(0);args.length>0;){var arg=args.shift(),raw=void 0;switch(arg){case"load":case"stop":case"unload":if(action)return this.error(errorOnePlaybackAction(arg,action));action=arg;break;case"mute":case"unmute":mute="mute"===arg;break;case"muteonhide":case"nomuteonhide":muteOnHide="muteonhide"===arg;break;case"volume":if(0===args.length)return this.error("volume missing required level value");if(raw=args.shift(),volume=Number.parseFloat(raw),Number.isNaN(volume)||!Number.isFinite(volume))return this.error("cannot parse volume: ".concat(raw));break;default:return this.error("unknown action: ".concat(arg))}}try{switch(null!=mute&&SimpleAudio.mute(mute),null!=muteOnHide&&SimpleAudio.muteOnHidden(muteOnHide),null!=volume&&SimpleAudio.volume(volume),action){case"load":SimpleAudio.load();break;case"stop":SimpleAudio.stop();break;case"unload":SimpleAudio.unload()}Config.debug&&this.debugView.modes({hidden:!0})}catch(ex){return this.error("error executing action: ".concat(ex.message))}}}),Macro.add("playlist",{from:null,handler:function(){var list,args,action,from=this.self.from;if(null===from)return this.error("no playlists have been created");if("createplaylist"===from){if(this.args.length<2){var errors=[];return this.args.length<1&&errors.push("list ID"),this.args.length<2&&errors.push("actions"),this.error("no ".concat(errors.join(" or ")," specified"))}var id=String(this.args[0]).trim();if(!SimpleAudio.lists.has(id))return this.error('playlist "'.concat(id,'" does not exist'));list=SimpleAudio.lists.get(id),args=this.args.slice(1)}else{if(0===this.args.length)return this.error("no actions specified");list=SimpleAudio.lists.get("setplaylist"),args=this.args.slice(0)}for(var fadeTo,loop,mute,shuffle,volume,fadeOver=5;args.length>0;){var arg=args.shift(),raw=void 0;switch(arg){case"load":case"pause":case"play":case"skip":case"stop":case"unload":if(action)return this.error(errorOnePlaybackAction(arg,action));action=arg;break;case"fadein":if(action)return this.error(errorOnePlaybackAction(arg,action));action="fade",fadeTo=1;break;case"fadeout":if(action)return this.error(errorOnePlaybackAction(arg,action));action="fade",fadeTo=0;break;case"fadeto":if(action)return this.error(errorOnePlaybackAction(arg,action));if(0===args.length)return this.error("fadeto missing required level value");if(action="fade",raw=args.shift(),fadeTo=Number.parseFloat(raw),Number.isNaN(fadeTo)||!Number.isFinite(fadeTo))return this.error("cannot parse fadeto: ".concat(raw));break;case"fadeoverto":if(action)return this.error(errorOnePlaybackAction(arg,action));if(args.length<2){var _errors2=[];return args.length<1&&_errors2.push("seconds"),args.length<2&&_errors2.push("level"),this.error("fadeoverto missing required ".concat(_errors2.join(" and ")," value").concat(_errors2.length>1?"s":""))}if(action="fade",raw=args.shift(),fadeOver=Number.parseFloat(raw),Number.isNaN(fadeOver)||!Number.isFinite(fadeOver))return this.error("cannot parse fadeoverto: ".concat(raw));if(raw=args.shift(),fadeTo=Number.parseFloat(raw),Number.isNaN(fadeTo)||!Number.isFinite(fadeTo))return this.error("cannot parse fadeoverto: ".concat(raw));break;case"volume":if(0===args.length)return this.error("volume missing required level value");if(raw=args.shift(),volume=Number.parseFloat(raw),Number.isNaN(volume)||!Number.isFinite(volume))return this.error("cannot parse volume: ".concat(raw));break;case"mute":case"unmute":mute="mute"===arg;break;case"loop":case"unloop":loop="loop"===arg;break;case"shuffle":case"unshuffle":shuffle="shuffle"===arg;break;default:return this.error("unknown action: ".concat(arg))}}try{switch(null!=volume&&list.volume(volume),null!=mute&&list.mute(mute),null!=loop&&list.loop(loop),null!=shuffle&&list.shuffle(shuffle),action){case"fade":list.fade(fadeOver,fadeTo);break;case"load":list.load();break;case"pause":list.pause();break;case"play":list.playWhenAllowed();break;case"skip":list.skip();break;case"stop":list.stop();break;case"unload":list.unload()}Config.debug&&this.debugView.modes({hidden:!0})}catch(ex){return this.error("error executing action: ".concat(ex.message))}}}),Macro.add("removeaudiogroup",{handler:function(){if(0===this.args.length)return this.error("no group ID specified");var id=String(this.args[0]).trim();if(!SimpleAudio.groups.has(id))return this.error('group "'.concat(id,'" does not exist'));SimpleAudio.groups.delete(id),Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("removeplaylist",{handler:function(){if(0===this.args.length)return this.error("no list ID specified");var id=String(this.args[0]).trim();if(!SimpleAudio.lists.has(id))return this.error('playlist "'.concat(id,'" does not exist'));SimpleAudio.lists.delete(id),Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("waitforaudio",{skipArgs:!0,handler:function(){SimpleAudio.loadWithScreen()}}),Macro.add("setplaylist",{handler:function(){if(0===this.args.length)return this.error("no track ID(s) specified");var playlist=Macro.get("playlist");if(null!==playlist.from&&"setplaylist"!==playlist.from)return this.error("playlists have already been defined with <<createplaylist>>");try{SimpleAudio.lists.add("setplaylist",this.args.slice(0))}catch(ex){return this.error(ex.message)}null===playlist.from&&(playlist.from="setplaylist"),Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("stopallaudio",{skipArgs:!0,handler:function(){SimpleAudio.select(":all").stop(),Config.debug&&this.debugView.modes({hidden:!0})}})}else Macro.add(["audio","cacheaudio","createaudiogroup","createplaylist","masteraudio","playlist","removeaudiogroup","removeplaylist","waitforaudio","setplaylist","stopallaudio"],{skipArgs:!0,handler:function(){Config.debug&&this.debugView.modes({hidden:!0})}});Macro.add("done",{skipArgs:!0,tags:null,handler:function(){var contents=this.payload[0].contents.trim();""!==contents&&setTimeout(this.createShadowWrapper((function(){return $.wiki(contents)})),Engine.minDomActionDelay)}}),Macro.add("goto",{handler:function(){return 0===this.args.length?this.error("no passage specified"):(passage="object"===_typeof(this.args[0])?this.args[0].link:this.args[0],Story.has(passage)?void setTimeout((function(){return Engine.play(passage)}),Engine.minDomActionDelay):this.error('passage "'.concat(passage,'" does not exist')));var passage}}),Macro.add("repeat",{isAsync:!0,tags:null,timers:new Set,t8nRe:/^(?:transition|t8n)$/,handler:function(){var delay,_this20=this;if(0===this.args.length)return this.error("no time value specified");try{delay=Math.max(Engine.minDomActionDelay,Util.fromCssTime(this.args[0]))}catch(ex){return this.error(ex.message)}Config.debug&&this.debugView.modes({block:!0});var transition=this.args.length>1&&this.self.t8nRe.test(this.args[1]),$wrapper=jQuery(document.createElement("span")).addClass("macro-".concat(this.name)).appendTo(this.output);this.self.registerInterval(this.createShadowWrapper((function(){var frag=document.createDocumentFragment();new Wikifier(frag,_this20.payload[0].contents);var $output=$wrapper;transition&&($output=jQuery(document.createElement("span")).addClass("macro-repeat-insert macro-repeat-in").appendTo($output)),$output.append(frag),transition&&setTimeout((function(){return $output.removeClass("macro-repeat-in")}),Engine.minDomActionDelay)})),delay)},registerInterval:function(callback,delay){var _this21=this;if("function"!=typeof callback)throw new TypeError("callback parameter must be a function");var passage=State.passage,turn=State.turns,timers=this.timers,timerId=null;timerId=setInterval((function(){if(State.passage!==passage||State.turns!==turn)return clearInterval(timerId),void timers.delete(timerId);var timerIdCache;try{TempState.break=null,TempState.hasOwnProperty("repeatTimerId")&&(timerIdCache=TempState.repeatTimerId),TempState.repeatTimerId=timerId,callback.call(_this21)}finally{void 0!==timerIdCache?TempState.repeatTimerId=timerIdCache:delete TempState.repeatTimerId,TempState.break=null}}),delay),timers.add(timerId),prehistory.hasOwnProperty("#repeat-timers-cleanup")||(prehistory["#repeat-timers-cleanup"]=function(task){delete prehistory[task],timers.forEach((function(timerId){return clearInterval(timerId)})),timers.clear()})}}),Macro.add("stop",{skipArgs:!0,handler:function(){if(!TempState.hasOwnProperty("repeatTimerId"))return this.error("must only be used in conjunction with its parent macro <<repeat>>");var timers=Macro.get("repeat").timers,timerId=TempState.repeatTimerId;clearInterval(timerId),timers.delete(timerId),TempState.break=2,Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("timed",{isAsync:!0,tags:["next"],timers:new Set,t8nRe:/^(?:transition|t8n)$/,handler:function(){if(0===this.args.length)return this.error("no time value specified in <<timed>>");var i,items=[];try{items.push({name:this.name,source:this.source,delay:Math.max(Engine.minDomActionDelay,Util.fromCssTime(this.args[0])),content:this.payload[0].contents})}catch(ex){return this.error("".concat(ex.message," in <<timed>>"))}if(this.payload.length>1)try{var len;for(i=1,len=this.payload.length;i<len;++i)items.push({name:this.payload[i].name,source:this.payload[i].source,delay:0===this.payload[i].args.length?items[items.length-1].delay:Math.max(Engine.minDomActionDelay,Util.fromCssTime(this.payload[i].args[0])),content:this.payload[i].contents})}catch(ex){return this.error("".concat(ex.message," in <<next>> (#").concat(i,")"))}Config.debug&&this.debugView.modes({block:!0});var transition=this.args.length>1&&this.self.t8nRe.test(this.args[1]),$wrapper=jQuery(document.createElement("span")).addClass("macro-".concat(this.name)).appendTo(this.output);this.self.registerTimeout(this.createShadowWrapper((function(item){var frag=document.createDocumentFragment();new Wikifier(frag,item.content);var $output=$wrapper;Config.debug&&"next"===item.name&&($output=jQuery(new DebugView($output[0],"macro",item.name,item.source).output)),transition&&($output=jQuery(document.createElement("span")).addClass("macro-timed-insert macro-timed-in").appendTo($output)),$output.append(frag),transition&&setTimeout((function(){return $output.removeClass("macro-timed-in")}),Engine.minDomActionDelay)})),items)},registerTimeout:function(callback,items){if("function"!=typeof callback)throw new TypeError("callback parameter must be a function");var passage=State.passage,turn=State.turns,timers=this.timers,timerId=null,nextItem=items.shift();timerId=setTimeout((function worker(){if(timers.delete(timerId),State.passage===passage&&State.turns===turn){var curItem=nextItem;null!=(nextItem=items.shift())&&(timerId=setTimeout(worker,nextItem.delay),timers.add(timerId)),callback.call(this,curItem)}}),nextItem.delay),timers.add(timerId),prehistory.hasOwnProperty("#timed-timers-cleanup")||(prehistory["#timed-timers-cleanup"]=function(task){delete prehistory[task],timers.forEach((function(timerId){return clearTimeout(timerId)})),timers.clear()})}}),Macro.add("widget",{tags:null,handler:function(){if(0===this.args.length)return this.error("no widget name specified");var widgetCode,widgetName=this.args[0],isNonVoid=this.args.length>1&&"container"===this.args[1];if(Macro.has(widgetName)){if(!Macro.get(widgetName).isWidget)return this.error('cannot clobber existing macro "'.concat(widgetName,'"'));Macro.delete(widgetName)}try{var widgetDef={isWidget:!0,handler:(widgetCode=this.payload[0].contents,function(){var shadowStore={};State.temporary.hasOwnProperty("args")&&(shadowStore._args=State.temporary.args),State.temporary.args=_toConsumableArray(this.args),State.temporary.args.raw=this.args.raw,State.temporary.args.full=this.args.full,this.addShadow("_args"),isNonVoid&&(State.temporary.hasOwnProperty("contents")&&(shadowStore._contents=State.temporary.contents),State.temporary.contents=this.payload[0].contents,this.addShadow("_contents")),State.variables.hasOwnProperty("args")&&(shadowStore.$args=State.variables.args),State.variables.args=State.temporary.args,this.addShadow("$args");try{var resFrag=document.createDocumentFragment(),errList=[];if(new Wikifier(resFrag,widgetCode),Array.from(resFrag.querySelectorAll(".error")).forEach((function(errEl){errList.push(errEl.textContent)})),0!==errList.length)return this.error("error".concat(errList.length>1?"s":""," within widget code (").concat(errList.join("; "),")"));this.output.appendChild(resFrag)}catch(ex){return this.error("cannot execute widget: ".concat(ex.message))}finally{shadowStore.hasOwnProperty("_args")?State.temporary.args=shadowStore._args:delete State.temporary.args,isNonVoid&&(shadowStore.hasOwnProperty("_contents")?State.temporary.contents=shadowStore._contents:delete State.temporary.contents),shadowStore.hasOwnProperty("$args")?State.variables.args=shadowStore.$args:delete State.variables.args}})};isNonVoid&&(widgetDef.tags=[]),Macro.add(widgetName,widgetDef),Config.debug&&this.debugView.modes({hidden:!0})}catch(ex){return this.error('cannot create widget macro "'.concat(widgetName,'": ').concat(ex.message))}}})}();var Dialog=function(){var _$overlay=null,_$dialog=null,_$dialogTitle=null,_$dialogBody=null,_lastActive=null,_scrollbarWidth=0,_dialogObserver=null;function dialogClose(ev){return _$dialogBody.trigger(":dialogclosing"),jQuery(document).off(".dialog-close"),_dialogObserver?(_dialogObserver.disconnect(),_dialogObserver=null):_$dialogBody.off(".dialog-resize"),jQuery(window).off(".dialog-resize"),_$dialog.removeClass("open").css({left:"",right:"",top:"",bottom:""}),jQuery("#ui-bar,#story").find("[tabindex=-2]").removeAttr("aria-hidden").attr("tabindex",0),jQuery("body>[tabindex=-3]").removeAttr("aria-hidden").removeAttr("tabindex"),_$overlay.removeClass("open"),jQuery(document.documentElement).removeAttr("data-dialog"),_$dialogTitle.empty(),_$dialogBody.empty().removeClass(),null!==_lastActive&&(jQuery(_lastActive).focus(),_lastActive=null),ev&&ev.data&&"function"==typeof ev.data.closeFn&&ev.data.closeFn(ev),_$dialogBody.trigger(":dialogclose"),_$dialogBody.trigger(":dialogclosed"),Dialog}function dialogIsOpen(classNames){return _$dialog.hasClass("open")&&(!classNames||classNames.splitOrEmpty(/\s+/).every((function(cn){return _$dialogBody.hasClass(cn)})))}function dialogOpen(options,closeFn){_$dialogBody.trigger(":dialogopening");var top=jQuery.extend({top:50},options).top;return dialogIsOpen()||(_lastActive=safeActiveElement()),jQuery(document.documentElement).attr("data-dialog","open"),_$overlay.addClass("open"),null!==_$dialogBody[0].querySelector("img")&&_$dialogBody.imagesLoaded().always((function(){return _resizeHandler({data:{top:top}})})),jQuery("body>:not(script,#store-area,tw-storydata,#ui-bar,#ui-overlay,#ui-dialog)").attr("tabindex",-3).attr("aria-hidden",!0),jQuery("#ui-bar,#story").find("[tabindex]:not([tabindex^=-])").attr("tabindex",-2).attr("aria-hidden",!0),_$dialog.css(_calcPosition(top)).addClass("open").focus(),jQuery(window).on("resize.dialog-resize",null,{top:top},jQuery.throttle(40,_resizeHandler)),Has.mutationObserver?(_dialogObserver=new MutationObserver((function(mutations){for(var i=0;i<mutations.length;++i)if("childList"===mutations[i].type){_resizeHandler({data:{top:top}});break}}))).observe(_$dialogBody[0],{childList:!0,subtree:!0}):_$dialogBody.on("DOMNodeInserted.dialog-resize DOMNodeRemoved.dialog-resize",null,{top:top},jQuery.throttle(40,_resizeHandler)),jQuery(document).one("click.dialog-close",".ui-close",{closeFn:closeFn},(function(ev){dialogClose(ev)})).one("keypress.dialog-close",".ui-close",(function(ev){13!==ev.which&&32!==ev.which||jQuery(this).trigger("click")})),_$dialogBody.trigger(":dialogopen"),_$dialogBody.trigger(":dialogopened"),Dialog}function _calcPosition(topPos){var top=null!=topPos?topPos:50,$parent=jQuery(window),dialogPos={left:"",right:"",top:"",bottom:""};_$dialog.css(dialogPos);var horzSpace=$parent.width()-_$dialog.outerWidth(!0)-1,vertSpace=$parent.height()-_$dialog.outerHeight(!0)-1;return horzSpace<=32+_scrollbarWidth&&(vertSpace-=_scrollbarWidth),vertSpace<=32+_scrollbarWidth&&(horzSpace-=_scrollbarWidth),dialogPos.left=dialogPos.right=horzSpace<=32?16:horzSpace/2>>0,dialogPos.top=vertSpace<=32?dialogPos.bottom=16:vertSpace/2>top?top:dialogPos.bottom=vertSpace/2>>0,Object.keys(dialogPos).forEach((function(key){""!==dialogPos[key]&&(dialogPos[key]+="px")})),dialogPos}function _resizeHandler(ev){var top=ev&&ev.data&&void 0!==ev.data.top?ev.data.top:50;"block"===_$dialog.css("display")&&(_$dialog.css({display:"none"}),_$dialog.css(jQuery.extend({display:""},_calcPosition(top))))}return Object.freeze(Object.defineProperties({},{append:{value:function(){var _$dialogBody2;return(_$dialogBody2=_$dialogBody).append.apply(_$dialogBody2,arguments),Dialog}},body:{value:function(){return _$dialogBody.get(0)}},close:{value:dialogClose},init:{value:function(){if(!document.getElementById("ui-dialog")){_scrollbarWidth=function(){var scrollbarWidth;try{var inner=document.createElement("p"),outer=document.createElement("div");inner.style.width="100%",inner.style.height="200px",outer.style.position="absolute",outer.style.left="0px",outer.style.top="0px",outer.style.width="100px",outer.style.height="100px",outer.style.visibility="hidden",outer.style.overflow="hidden",outer.appendChild(inner),document.body.appendChild(outer);var w1=inner.offsetWidth;outer.style.overflow="auto";var w2=inner.offsetWidth;w1===w2&&(w2=outer.clientWidth),document.body.removeChild(outer),scrollbarWidth=w1-w2}catch(ex){}return scrollbarWidth||17}();var $elems=jQuery(document.createDocumentFragment()).append('<div id="ui-overlay" class="ui-close"></div><div id="ui-dialog" tabindex="0" role="dialog" aria-labelledby="ui-dialog-title"><div id="ui-dialog-titlebar"><h1 id="ui-dialog-title"></h1>'+'<button id="ui-dialog-close" class="ui-close" tabindex="0" aria-label="'.concat(L10n.get("close"),'"></button>')+'</div><div id="ui-dialog-body"></div></div>');_$overlay=jQuery($elems.find("#ui-overlay").get(0)),_$dialog=jQuery($elems.find("#ui-dialog").get(0)),_$dialogTitle=jQuery($elems.find("#ui-dialog-title").get(0)),_$dialogBody=jQuery($elems.find("#ui-dialog-body").get(0)),$elems.insertBefore("body>script#script-sugarcube")}}},isOpen:{value:dialogIsOpen},open:{value:dialogOpen},resize:{value:function(data){return _resizeHandler("object"===_typeof(data)?{data:data}:undefined)}},setup:{value:function(title,classNames){return _$dialogBody.empty().removeClass(),null!=classNames&&_$dialogBody.addClass(classNames),_$dialogTitle.empty().append((null!=title?String(title):"")||" "),_$dialogBody.get(0)}},wiki:{value:function(){var _$dialogBody3;return(_$dialogBody3=_$dialogBody).wiki.apply(_$dialogBody3,arguments),Dialog}},addClickHandler:{value:function(targets,options,startFn,doneFn,closeFn){return jQuery(targets).ariaClick((function(ev){ev.preventDefault(),"function"==typeof startFn&&startFn(ev),dialogOpen(options,closeFn),"function"==typeof doneFn&&doneFn(ev)}))}}}))}(),Engine=function(){var States=Util.toEnum({Idle:"idle",Playing:"playing",Rendering:"rendering"}),_initDebugViews=[],_state=States.Idle,_lastPlay=null,_outlinePatch=null,_updating=null;function engineGo(offset){var succeded=State.go(offset);return succeded&&engineShow(),succeded}function engineShow(){return enginePlay(State.passage,!0)}function enginePlay(title,noHistory){var passageReadyOutput,passageDoneOutput,passageTitle=title;if(_state=States.Playing,TempState={},State.clearTemporary(),"function"==typeof Config.navigation.override)try{var overrideTitle=Config.navigation.override(passageTitle);overrideTitle&&(passageTitle=overrideTitle)}catch(ex){}var passage=Story.get(passageTitle);if(jQuery.event.trigger({type:":passageinit",passage:passage}),Object.keys(prehistory).forEach((function(task){"function"==typeof prehistory[task]&&prehistory[task].call(passage,task)})),noHistory||State.create(passage.title),document.body.className&&(document.body.className=""),_lastPlay=Util.now(),Object.keys(predisplay).forEach((function(task){"function"==typeof predisplay[task]&&predisplay[task].call(passage,task)})),Story.has("PassageReady"))try{passageReadyOutput=Wikifier.wikifyEval(Story.get("PassageReady").text)}catch(ex){console.error(ex),Alert.error("PassageReady",ex.message)}_state=States.Rendering;var dataTags=passage.tags.length>0?passage.tags.join(" "):null,passageEl=document.createElement("div");jQuery(passageEl).attr({id:passage.domId,"data-passage":passage.title,"data-tags":dataTags}).addClass("passage ".concat(passage.className)),jQuery(document.body).attr("data-tags",dataTags).addClass(passage.className),jQuery(document.documentElement).attr("data-tags",dataTags),jQuery.event.trigger({type:":passagestart",content:passageEl,passage:passage}),Object.keys(prerender).forEach((function(task){"function"==typeof prerender[task]&&prerender[task].call(passage,passageEl,task)})),Story.has("PassageHeader")&&new Wikifier(passageEl,Story.get("PassageHeader").processText()),passageEl.appendChild(passage.render()),Story.has("PassageFooter")&&new Wikifier(passageEl,Story.get("PassageFooter").processText()),jQuery.event.trigger({type:":passagerender",content:passageEl,passage:passage}),Object.keys(postrender).forEach((function(task){"function"==typeof postrender[task]&&postrender[task].call(passage,passageEl,task)}));var debugView,containerEl=document.getElementById("passages");if(containerEl.hasChildNodes()&&("number"==typeof Config.passages.transitionOut||"string"==typeof Config.passages.transitionOut&&""!==Config.passages.transitionOut&&Has.transitionEndEvent?_toConsumableArray(containerEl.childNodes).forEach((function(outgoing){var $outgoing=jQuery(outgoing);if(outgoing.nodeType===Node.ELEMENT_NODE&&$outgoing.hasClass("passage")){if($outgoing.hasClass("passage-out"))return;$outgoing.attr({id:"out-".concat($outgoing.attr("id")),"aria-live":"off"}).addClass("passage-out"),"string"==typeof Config.passages.transitionOut?$outgoing.on(Has.transitionEndEvent,(function(ev){ev.propertyName===Config.passages.transitionOut&&$outgoing.remove()})):setTimeout((function(){return $outgoing.remove()}),Math.max(40,Config.passages.transitionOut))}else $outgoing.remove()})):jQuery(containerEl).empty()),jQuery(passageEl).addClass("passage-in").appendTo(containerEl),setTimeout((function(){return jQuery(passageEl).removeClass("passage-in")}),40),Story.has("StoryDisplayTitle")?null===_updating&&Config.ui.updateStoryElements||setDisplayTitle(Story.get("StoryDisplayTitle").processText()):Config.passages.displayTitles&&passage.title!==Config.passages.start&&(document.title="".concat(passage.title," | ").concat(Story.title)),window.scroll(0,0),_state=States.Playing,Story.has("PassageDone"))try{passageDoneOutput=Wikifier.wikifyEval(Story.get("PassageDone").text)}catch(ex){console.error(ex),Alert.error("PassageDone",ex.message)}(jQuery.event.trigger({type:":passagedisplay",content:passageEl,passage:passage}),Object.keys(postdisplay).forEach((function(task){"function"==typeof postdisplay[task]&&postdisplay[task].call(passage,task)})),null!==_updating?_updating.forEach((function(pair){jQuery(pair.element).empty(),new Wikifier(pair.element,Story.get(pair.passage).processText().trim())})):Config.ui.updateStoryElements&&UIBar.update(),Config.debug)&&(null!=passageReadyOutput&&((debugView=new DebugView(document.createDocumentFragment(),"special","PassageReady","PassageReady")).modes({hidden:!0}),debugView.append(passageReadyOutput),jQuery(passageEl).prepend(debugView.output)),null!=passageDoneOutput&&((debugView=new DebugView(document.createDocumentFragment(),"special","PassageDone","PassageDone")).modes({hidden:!0}),debugView.append(passageDoneOutput),jQuery(passageEl).append(debugView.output)),1===State.turns&&_initDebugViews.length>0&&jQuery(passageEl).prepend(_initDebugViews));switch(jQuery("#story").find("a[href]:not(.link-external)").addClass("link-external").end().find("a,link,button,input,select,textarea").not("[tabindex]").attr("tabindex",0),_typeof(Config.saves.autosave)){case"boolean":Config.saves.autosave&&Save.autosave.save();break;case"object":passage.tags.some((function(tag){return Config.saves.autosave.includes(tag)}))&&Save.autosave.save();break;case"function":Config.saves.autosave()&&Save.autosave.save()}return jQuery.event.trigger({type:":passageend",content:passageEl,passage:passage}),_state=States.Idle,_lastPlay=Util.now(),passageEl}function _hideOutlines(){_outlinePatch.set("*:focus{outline:none;}")}return Object.freeze(Object.defineProperties({},{States:{value:States},minDomActionDelay:{value:40},init:{value:function(){var _lastOutlineEvent;jQuery("#init-no-js,#init-lacking").remove(),function(){var $elems=jQuery(document.createDocumentFragment()),markup=Story.has("StoryInterface")&&Story.get("StoryInterface").text.trim();if(markup){UIBar.destroy(),jQuery(document.head).find("#style-core-display").remove(),$elems.append(markup);var $passages=$elems.find("#passages");if(0===$passages.length)throw new Error('no element with ID "passages" found within "StoryInterface" special passage');$passages.empty().not("[aria-live]").attr("aria-live","polite").end(),$elems.find("[data-init-passage]").each((function(i,el){if("passages"===el.id)throw new Error('"StoryInterface" element <'.concat(el.nodeName.toLowerCase(),' id="passages"> must not contain a "data-init-passage" content attribute'));var passage=el.getAttribute("data-init-passage").trim();if(el.hasAttribute("data-passage"))throw new Error('"StoryInterface" element <'.concat(el.nodeName.toLowerCase(),' data-init-passage="').concat(passage,'"> must not contain a "data-passage" content attribute'));if(null!==el.firstElementChild)throw new Error('"StoryInterface" element <'.concat(el.nodeName.toLowerCase(),' data-init-passage="').concat(passage,'"> contains child elements'));Story.has(passage)&&jQuery(el).empty().wiki(Story.get(passage).processText().trim())}));var updating=[];$elems.find("[data-passage]").each((function(i,el){if("passages"===el.id)throw new Error('"StoryInterface" element <'.concat(el.nodeName.toLowerCase(),' id="passages"> must not contain a "data-passage" content attribute'));var passage=el.getAttribute("data-passage").trim();if(null!==el.firstElementChild)throw new Error('"StoryInterface" element <'.concat(el.nodeName.toLowerCase(),' data-passage="').concat(passage,'"> contains child elements'));Story.has(passage)&&updating.push({passage:passage,element:el})})),updating.length>0&&(_updating=updating),Config.ui.updateStoryElements=!1}else $elems.append('<div id="story" role="main"><div id="passages" aria-live="polite"></div></div>');$elems.insertBefore("body>script#script-sugarcube")}(),_outlinePatch=new StyleWrapper(jQuery(document.createElement("style")).attr({id:"style-aria-outlines",type:"text/css"}).appendTo(document.head).get(0)),_hideOutlines(),jQuery(document).on("mousedown.aria-outlines keydown.aria-outlines",(function(ev){ev.type!==_lastOutlineEvent&&(_lastOutlineEvent=ev.type,"keydown"===ev.type?_outlinePatch.clear():_hideOutlines())}))}},start:{value:function(){if(Story.getAllInit().forEach((function(passage){try{var debugBuffer=Wikifier.wikifyEval(passage.text);if(Config.debug){var debugView=new DebugView(document.createDocumentFragment(),"special","".concat(passage.title," [init-tagged]"),"".concat(passage.title," [init-tagged]"));debugView.modes({hidden:!0}),debugView.append(debugBuffer),_initDebugViews.push(debugView.output)}}catch(ex){console.error(ex),Alert.error("".concat(passage.title," [init-tagged]"),"object"===_typeof(ex)?ex.message:ex)}})),Story.has("StoryInit"))try{var debugBuffer=Wikifier.wikifyEval(Story.get("StoryInit").text);if(Config.debug){var debugView=new DebugView(document.createDocumentFragment(),"special","StoryInit","StoryInit");debugView.modes({hidden:!0}),debugView.append(debugBuffer),_initDebugViews.push(debugView.output)}}catch(ex){console.error(ex),Alert.error("StoryInit","object"===_typeof(ex)?ex.message:ex)}if(null==Config.passages.start)throw new Error("starting passage not selected");if(!Story.has(Config.passages.start))throw new Error('starting passage ("'.concat(Config.passages.start,'") not found'));if(jQuery(document.documentElement).focus(),State.restore())engineShow();else{var loadStart=!0;switch(_typeof(Config.saves.autoload)){case"boolean":Config.saves.autoload&&Save.autosave.ok()&&Save.autosave.has()&&(loadStart=!Save.autosave.load());break;case"string":"prompt"===Config.saves.autoload&&Save.autosave.ok()&&Save.autosave.has()&&(loadStart=!1,UI.buildAutoload(),Dialog.open());break;case"function":Save.autosave.ok()&&Save.autosave.has()&&Config.saves.autoload()&&(loadStart=!Save.autosave.load())}loadStart&&enginePlay(Config.passages.start)}}},restart:{value:function(){LoadScreen.show(),window.scroll(0,0),State.reset(),jQuery.event.trigger(":enginerestart"),window.location.reload()}},state:{get:function(){return _state}},isIdle:{value:function(){return _state===States.Idle}},isPlaying:{value:function(){return _state!==States.Idle}},isRendering:{value:function(){return _state===States.Rendering}},lastPlay:{get:function(){return _lastPlay}},goTo:{value:function(idx){var succeded=State.goTo(idx);return succeded&&engineShow(),succeded}},go:{value:engineGo},backward:{value:function(){return engineGo(-1)}},forward:{value:function(){return engineGo(1)}},show:{value:engineShow},play:{value:enginePlay},display:{value:function(title,link,option){var noHistory=!1;switch(option){case undefined:break;case"replace":case"back":noHistory=!0;break;default:throw new Error('Engine.display option parameter called with obsolete value "'.concat(option,'"; please notify the developer'))}enginePlay(title,noHistory)}}}))}(),Passage=(_tagsToSkip=/^(?:debug|nobr|passage|widget|twine\..*)$/i,function(){function Passage(title,el){var _this22=this;_classCallCheck(this,Passage),Object.defineProperties(this,{title:{value:Util.unescape(title)},element:{value:el||null},tags:{value:Object.freeze(el&&el.hasAttribute("tags")?Array.from(new Set(el.getAttribute("tags").trim().splitOrEmpty(/\s+/))):[])},_excerpt:{writable:!0,value:null}}),Object.defineProperties(this,{domId:{value:"passage-".concat(Util.slugify(this.title))},classes:{value:Object.freeze(0===this.tags.length?[]:_this22.tags.filter((function(tag){return!_tagsToSkip.test(tag)})).map((function(tag){return Util.slugify(tag)})))}})}return _createClass(Passage,[{key:"className",get:function(){return this.classes.join(" ")}},{key:"text",get:function(){if(null==this.element){var passage=Util.escapeMarkup(this.title),mesg="".concat(L10n.get("errorTitle"),": ").concat(L10n.get("errorNonexistentPassage",{passage:passage}));return'<div class="error-view"><span class="error">'.concat(mesg,"</span></div>")}return this.element.textContent.replace(/\r/g,"")}},{key:"description",value:function(){var descriptions=Config.passages.descriptions;switch(_typeof(descriptions)){case"boolean":if(descriptions)return this.title;break;case"object":if(descriptions.hasOwnProperty(this.title))return descriptions[this.title];break;case"function":var result=descriptions.call(this);if(result)return result}return null===this._excerpt&&(this._excerpt=Passage.getExcerptFromText(this.text)),this._excerpt}},{key:"processText",value:function(){if(null==this.element)return this.text;if(this.tags.includes("Twine.image"))return"[img[".concat(this.text,"]]");var processed=this.text;return Config.passages.onProcess&&(processed=Config.passages.onProcess.call(null,{title:this.title,tags:this.tags,text:processed})),(Config.passages.nobr||this.tags.includes("nobr"))&&(processed=processed.replace(/^\n+|\n+$/g,"").replace(/\n+/g," ")),processed}},{key:"render",value:function(options){var frag=document.createDocumentFragment();return new Wikifier(frag,this.processText(),options),this._excerpt=Passage.getExcerptFromNode(frag),frag}}],[{key:"getExcerptFromNode",value:function(node,count){if(!node.hasChildNodes())return"";var excerpt=node.textContent.trim();if(""!==excerpt){var excerptRe=new RegExp("(\\S+(?:\\s+\\S+){0,".concat(count>0?count-1:7,"})"));excerpt=excerpt.replace(/\s+/g," ").match(excerptRe)}return excerpt?"".concat(excerpt[1],"…"):"…"}},{key:"getExcerptFromText",value:function(text,count){if(""===text)return"";var excerptRe=new RegExp("(\\S+(?:\\s+\\S+){0,".concat(count>0?count-1:7,"})")),excerpt=text.replace(/<<.*?>>/g," ").replace(/<.*?>/g," ").trim().replace(/^\s*\|.*\|.*?$/gm,"").replace(/\[[<>]?img\[[^\]]*\]\]/g,"").replace(/\[\[([^|\]]*?)(?:(?:\||->|<-)[^\]]*)?\]\]/g,"$1").replace(/^\s*!+(.*?)$/gm,"$1").replace(/'{2}|\/{2}|_{2}|@{2}/g,"").trim().replace(/\s+/g," ").match(excerptRe);return excerpt?"".concat(excerpt[1],"…"):"…"}}]),Passage}()),_tagsToSkip,Save=function(){var Type=Util.toEnum({Autosave:"autosave",Disk:"disk",Serialize:"serialize",Slot:"slot"}),_slotsUBound=-1,_onLoadHandlers=new Set,_onSaveHandlers=new Set;function savesObjGet(){var saves=storage.get("saves");return null===saves?{autosave:null,slots:_appendSlots([],Config.saves.slots)}:saves}function savesObjClear(){return storage.delete("saves"),!0}function autosaveOk(){return"cookie"!==storage.name&&void 0!==Config.saves.autosave}function slotsOk(){return"cookie"!==storage.name&&-1!==_slotsUBound}function slotsCount(){if(!slotsOk())return 0;for(var saves=savesObjGet(),count=0,i=0,iend=saves.slots.length;i<iend;++i)null!==saves.slots[i]&&++count;return count}function _appendSlots(array,num){for(var i=0;i<num;++i)array.push(null);return array}function _savesObjIsEmpty(saves){for(var slots=saves.slots,isSlotsEmpty=!0,i=0,iend=slots.length;i<iend;++i)if(null!==slots[i]){isSlotsEmpty=!1;break}return null===saves.autosave&&isSlotsEmpty}function _savesObjSave(saves){return _savesObjIsEmpty(saves)?(storage.delete("saves"),!0):storage.set("saves",saves)}function _savesObjUpdate(saveObj){if(null==saveObj||"object"!==_typeof(saveObj))return!1;var updated=!1;return saveObj.hasOwnProperty("state")&&saveObj.state.hasOwnProperty("delta")&&saveObj.state.hasOwnProperty("index")||(saveObj.hasOwnProperty("data")?(delete saveObj.mode,saveObj.state={delta:State.deltaEncode(saveObj.data)},delete saveObj.data):saveObj.state.hasOwnProperty("delta")?saveObj.state.hasOwnProperty("index")||delete saveObj.state.mode:(delete saveObj.state.mode,saveObj.state.delta=State.deltaEncode(saveObj.state.history),delete saveObj.state.history),saveObj.state.index=saveObj.state.delta.length-1,updated=!0),saveObj.state.hasOwnProperty("rseed")&&(saveObj.state.seed=saveObj.state.rseed,delete saveObj.state.rseed,saveObj.state.delta.forEach((function(_,i,delta){delta[i].hasOwnProperty("rcount")&&(delta[i].pull=delta[i].rcount,delete delta[i].rcount)})),updated=!0),(saveObj.state.hasOwnProperty("expired")&&"number"==typeof saveObj.state.expired||saveObj.state.hasOwnProperty("unique")||saveObj.state.hasOwnProperty("last"))&&(saveObj.state.hasOwnProperty("expired")&&"number"==typeof saveObj.state.expired&&delete saveObj.state.expired,(saveObj.state.hasOwnProperty("unique")||saveObj.state.hasOwnProperty("last"))&&(saveObj.state.expired=[],saveObj.state.hasOwnProperty("unique")&&(saveObj.state.expired.push(saveObj.state.unique),delete saveObj.state.unique),saveObj.state.hasOwnProperty("last")&&(saveObj.state.expired.push(saveObj.state.last),delete saveObj.state.last)),updated=!0),updated}function _marshal(supplemental,details){if(null!=supplemental&&"object"!==_typeof(supplemental))throw new Error("supplemental parameter must be an object");var saveObj=Object.assign({},supplemental,{id:Config.saves.id,state:State.marshalForSave()});return Config.saves.version&&(saveObj.version=Config.saves.version),_onSaveHandlers.forEach((function(fn){return fn(saveObj,details)})),saveObj.state.delta=State.deltaEncode(saveObj.state.history),delete saveObj.state.history,saveObj}function _unmarshal(saveObj){try{if(_savesObjUpdate(saveObj),!saveObj||!saveObj.hasOwnProperty("id")||!saveObj.hasOwnProperty("state"))throw new Error(L10n.get("errorSaveMissingData"));if(saveObj.state.history=State.deltaDecode(saveObj.state.delta),delete saveObj.state.delta,_onLoadHandlers.forEach((function(fn){return fn(saveObj)})),saveObj.id!==Config.saves.id)throw new Error(L10n.get("errorSaveIdMismatch"));State.unmarshalForSave(saveObj.state),Engine.show()}catch(ex){return UI.alert("".concat(ex.message.toUpperFirst(),".</p><p>").concat(L10n.get("aborting"),".")),!1}return!0}return Object.freeze(Object.defineProperties({},{init:{value:function(){if("cookie"===storage.name)return savesObjClear(),Config.saves.autoload=undefined,Config.saves.autosave=undefined,Config.saves.slots=0,!1;var saves=savesObjGet(),updated=!1;Array.isArray(saves)&&(saves={autosave:null,slots:saves},updated=!0),Config.saves.slots!==saves.slots.length&&(Config.saves.slots<saves.slots.length?(saves.slots.reverse(),saves.slots=saves.slots.filter((function(val){return!(null===val&&this.count>0)||(--this.count,!1)}),{count:saves.slots.length-Config.saves.slots}),saves.slots.reverse()):Config.saves.slots>saves.slots.length&&_appendSlots(saves.slots,Config.saves.slots-saves.slots.length),updated=!0),_savesObjUpdate(saves.autosave)&&(updated=!0);for(var i=0;i<saves.slots.length;++i)_savesObjUpdate(saves.slots[i])&&(updated=!0);return _savesObjIsEmpty(saves)&&(storage.delete("saves"),updated=!1),updated&&_savesObjSave(saves),_slotsUBound=saves.slots.length-1,!0}},get:{value:savesObjGet},clear:{value:savesObjClear},ok:{value:function(){return autosaveOk()||slotsOk()}},autosave:{value:Object.freeze(Object.defineProperties({},{ok:{value:autosaveOk},has:{value:function(){return null!==savesObjGet().autosave}},get:{value:function(){return savesObjGet().autosave}},load:{value:function(){var saves=savesObjGet();return null!==saves.autosave&&_unmarshal(saves.autosave)}},save:{value:function(title,metadata){if("function"==typeof Config.saves.isAllowed&&!Config.saves.isAllowed())return!1;var saves=savesObjGet(),supplemental={title:title||Story.get(State.passage).description(),date:Date.now()};return null!=metadata&&(supplemental.metadata=metadata),saves.autosave=_marshal(supplemental,{type:Type.Autosave}),_savesObjSave(saves)}},delete:{value:function(){var saves=savesObjGet();return saves.autosave=null,_savesObjSave(saves)}}}))},slots:{value:Object.freeze(Object.defineProperties({},{ok:{value:slotsOk},length:{get:function(){return _slotsUBound+1}},isEmpty:{value:function(){return 0===slotsCount()}},count:{value:slotsCount},has:{value:function(slot){if(slot<0||slot>_slotsUBound)return!1;var saves=savesObjGet();return!(slot>=saves.slots.length||null===saves.slots[slot])}},get:{value:function(slot){if(slot<0||slot>_slotsUBound)return null;var saves=savesObjGet();return slot>=saves.slots.length?null:saves.slots[slot]}},load:{value:function(slot){if(slot<0||slot>_slotsUBound)return!1;var saves=savesObjGet();return!(slot>=saves.slots.length||null===saves.slots[slot])&&_unmarshal(saves.slots[slot])}},save:{value:function(slot,title,metadata){if("function"==typeof Config.saves.isAllowed&&!Config.saves.isAllowed())return Dialog.isOpen()?$(document).one(":dialogclosed",(function(){return UI.alert(L10n.get("savesDisallowed"))})):UI.alert(L10n.get("savesDisallowed")),!1;if(slot<0||slot>_slotsUBound)return!1;var saves=savesObjGet();if(slot>=saves.slots.length)return!1;var supplemental={title:title||Story.get(State.passage).description(),date:Date.now()};return null!=metadata&&(supplemental.metadata=metadata),saves.slots[slot]=_marshal(supplemental,{type:Type.Slot}),_savesObjSave(saves)}},delete:{value:function(slot){if(slot<0||slot>_slotsUBound)return!1;var saves=savesObjGet();return!(slot>=saves.slots.length)&&(saves.slots[slot]=null,_savesObjSave(saves))}}}))},export:{value:function(filename,metadata){if("function"!=typeof Config.saves.isAllowed||Config.saves.isAllowed()){var str,now,MM,DD,hh,mm,ss,baseName=null==filename?Story.domId:(str=filename,Util.sanitizeFilename(str).replace(/[_\s\u2013\u2014-]+/g,"-")),saveName="".concat(baseName,"-").concat((now=new Date,MM=now.getMonth()+1,DD=now.getDate(),hh=now.getHours(),mm=now.getMinutes(),ss=now.getSeconds(),MM<10&&(MM="0".concat(MM)),DD<10&&(DD="0".concat(DD)),hh<10&&(hh="0".concat(hh)),mm<10&&(mm="0".concat(mm)),ss<10&&(ss="0".concat(ss)),"".concat(now.getFullYear()).concat(MM).concat(DD,"-").concat(hh).concat(mm).concat(ss)),".save"),supplemental=null==metadata?{}:{metadata:metadata},saveObj=LZString.compressToBase64(JSON.stringify(_marshal(supplemental,{type:Type.Disk})));saveAs(new Blob([saveObj],{type:"text/plain;charset=UTF-8"}),saveName)}else Dialog.isOpen()?$(document).one(":dialogclosed",(function(){return UI.alert(L10n.get("savesDisallowed"))})):UI.alert(L10n.get("savesDisallowed"))}},import:{value:function(event){var file=event.target.files[0],reader=new FileReader;jQuery(reader).one("loadend",(function(){if(reader.error){var ex=reader.error;UI.alert("".concat(L10n.get("errorSaveDiskLoadFailed").toUpperFirst()," (").concat(ex.name,": ").concat(ex.message,").</p><p>").concat(L10n.get("aborting"),"."))}else{var saveObj;try{saveObj=JSON.parse(/\.json$/i.test(file.name)||/^\{/.test(reader.result)?reader.result:LZString.decompressFromBase64(reader.result))}catch(ex){}_unmarshal(saveObj)}})),reader.readAsText(file)}},serialize:{value:function(metadata){if("function"==typeof Config.saves.isAllowed&&!Config.saves.isAllowed())return Dialog.isOpen()?$(document).one(":dialogclosed",(function(){return UI.alert(L10n.get("savesDisallowed"))})):UI.alert(L10n.get("savesDisallowed")),null;var supplemental=null==metadata?{}:{metadata:metadata};return LZString.compressToBase64(JSON.stringify(_marshal(supplemental,{type:Type.Serialize})))}},deserialize:{value:function(base64Str){var saveObj;try{saveObj=JSON.parse(LZString.decompressFromBase64(base64Str))}catch(ex){}return _unmarshal(saveObj)?saveObj.metadata:null}},onLoad:{value:Object.freeze(Object.defineProperties({},{add:{value:function(handler){var valueType=Util.getType(handler);if("function"!==valueType)throw new TypeError("Save.onLoad.add handler parameter must be a function (received: ".concat(valueType,")"));_onLoadHandlers.add(handler)}},clear:{value:function(){_onLoadHandlers.clear()}},delete:{value:function(handler){return _onLoadHandlers.delete(handler)}},size:{get:function(){return _onLoadHandlers.size}}}))},onSave:{value:Object.freeze(Object.defineProperties({},{add:{value:function(handler){var valueType=Util.getType(handler);if("function"!==valueType)throw new TypeError("Save.onSave.add handler parameter must be a function (received: ".concat(valueType,")"));_onSaveHandlers.add(handler)}},clear:{value:function(){_onSaveHandlers.clear()}},delete:{value:function(handler){return _onSaveHandlers.delete(handler)}},size:{get:function(){return _onSaveHandlers.size}}}))}}))}(),Setting=function(){var Types=Util.toEnum({Header:0,Toggle:1,List:2,Range:3}),_definitions=[];function settingsCreate(){return Object.create(null)}function settingsSave(){var savedSettings=settingsCreate();return Object.keys(settings).length>0&&_definitions.filter((function(def){return def.type!==Types.Header&&settings[def.name]!==def.default})).forEach((function(def){return savedSettings[def.name]=settings[def.name]})),0===Object.keys(savedSettings).length?(storage.delete("settings"),!0):storage.set("settings",savedSettings)}function settingsLoad(){var defaultSettings=settingsCreate(),loadedSettings=storage.get("settings")||settingsCreate();_definitions.filter((function(def){return def.type!==Types.Header})).forEach((function(def){return defaultSettings[def.name]=def.default})),window.SugarCube.settings=settings=Object.assign(defaultSettings,loadedSettings)}function settingsClear(){return window.SugarCube.settings=settings=settingsCreate(),storage.delete("settings"),!0}function definitionsAdd(type,name,def){if(arguments.length<3){var errors=[];throw arguments.length<1&&errors.push("type"),arguments.length<2&&errors.push("name"),arguments.length<3&&errors.push("definition"),new Error("missing parameters, no ".concat(errors.join(" or ")," specified"))}if("object"!==_typeof(def))throw new TypeError("definition parameter must be an object");if(definitionsHas(name))throw new Error('cannot clobber existing setting "'.concat(name,'"'));var str,pos,definition={type:type,name:name,label:"string"==typeof def.label?def.label.trim():""};if("string"==typeof def.desc){var desc=def.desc.trim();""!==desc&&(definition.desc=desc)}switch(type){case Types.Header:break;case Types.Toggle:definition.default=!!def.default;break;case Types.List:if(!def.hasOwnProperty("list"))throw new Error("no list specified");if(!Array.isArray(def.list))throw new TypeError("list must be an array");if(0===def.list.length)throw new Error("list must not be empty");if(definition.list=Object.freeze(def.list),null==def.default)definition.default=def.list[0];else{var defaultIndex=def.list.indexOf(def.default);if(-1===defaultIndex)throw new Error("list does not contain default");definition.default=def.list[defaultIndex]}break;case Types.Range:if(!def.hasOwnProperty("min"))throw new Error("no min specified");if("number"!=typeof def.min||Number.isNaN(def.min)||!Number.isFinite(def.min))throw new TypeError("min must be a finite number");if(!def.hasOwnProperty("max"))throw new Error("no max specified");if("number"!=typeof def.max||Number.isNaN(def.max)||!Number.isFinite(def.max))throw new TypeError("max must be a finite number");if(!def.hasOwnProperty("step"))throw new Error("no step specified");if("number"!=typeof def.step||Number.isNaN(def.step)||!Number.isFinite(def.step)||def.step<=0)throw new TypeError("step must be a finite number greater than zero");var stepValidate=function(value){if(fracDigits>0){var ma=Number("".concat(def.min,"e").concat(fracDigits)),sa=Number("".concat(def.step,"e").concat(fracDigits)),_va=Number("".concat(value,"e").concat(fracDigits))-ma;return Number("".concat(_va-_va%sa+ma,"e-").concat(fracDigits))}var va=value-def.min;return va-va%def.step+def.min},fracDigits=(str=String(def.step),-1===(pos=str.lastIndexOf("."))?0:str.length-pos-1);if(stepValidate(def.max)!==def.max)throw new RangeError("max (".concat(def.max,") is not a multiple of the step (").concat(def.step,") plus the min (").concat(def.min,")"));if(definition.max=def.max,definition.min=def.min,definition.step=def.step,null==def.default)definition.default=def.max;else{if("number"!=typeof def.default||Number.isNaN(def.default)||!Number.isFinite(def.default))throw new TypeError("default must be a finite number");if(def.default<def.min)throw new RangeError("default (".concat(def.default,") is less than min (").concat(def.min,")"));if(def.default>def.max)throw new RangeError("default (".concat(def.default,") is greater than max (").concat(def.max,")"));definition.default=def.default}break;default:throw new Error("unknown Setting type: ".concat(type))}"function"==typeof def.onInit&&(definition.onInit=Object.freeze(def.onInit)),"function"==typeof def.onChange&&(definition.onChange=Object.freeze(def.onChange)),_definitions.push(Object.freeze(definition))}function definitionsHas(name){return _definitions.some((function(definition){return definition.name===name}))}function definitionsGet(name){return _definitions.find((function(definition){return definition.name===name}))}return Object.freeze(Object.defineProperties({},{Types:{value:Types},init:{value:function(){if(storage.has("options")){var old=storage.get("options");null!==old&&(window.SugarCube.settings=settings=Object.assign(settingsCreate(),old)),settingsSave(),storage.delete("options")}settingsLoad(),_definitions.forEach((function(def){if(def.hasOwnProperty("onInit")){var thisArg={name:def.name,value:settings[def.name],default:def.default};def.hasOwnProperty("list")&&(thisArg.list=def.list),def.onInit.call(thisArg)}}))}},create:{value:settingsCreate},save:{value:settingsSave},load:{value:settingsLoad},clear:{value:settingsClear},reset:{value:function(name){if(0===arguments.length)settingsClear(),settingsLoad();else{if(null==name||!definitionsHas(name))throw new Error('nonexistent setting "'.concat(name,'"'));var def=definitionsGet(name);def.type!==Types.Header&&(settings[name]=def.default)}return settingsSave()}},forEach:{value:function(callback,thisArg){_definitions.forEach(callback,thisArg)}},add:{value:definitionsAdd},addHeader:{value:function(name,desc){definitionsAdd(Types.Header,name,{desc:desc})}},addToggle:{value:function(){for(var _len16=arguments.length,args=new Array(_len16),_key16=0;_key16<_len16;_key16++)args[_key16]=arguments[_key16];definitionsAdd.apply(void 0,[Types.Toggle].concat(args))}},addList:{value:function(){for(var _len17=arguments.length,args=new Array(_len17),_key17=0;_key17<_len17;_key17++)args[_key17]=arguments[_key17];definitionsAdd.apply(void 0,[Types.List].concat(args))}},addRange:{value:function(){for(var _len18=arguments.length,args=new Array(_len18),_key18=0;_key18<_len18;_key18++)args[_key18]=arguments[_key18];definitionsAdd.apply(void 0,[Types.Range].concat(args))}},isEmpty:{value:function(){return 0===_definitions.length}},has:{value:definitionsHas},get:{value:definitionsGet},delete:{value:function definitionsDelete(name){definitionsHas(name)&&delete settings[name];for(var i=0;i<_definitions.length;++i)if(_definitions[i].name===name){_definitions.splice(i,1),definitionsDelete(name);break}}}}))}(),Story=function(){var _passages={},_inits=[],_scripts=[],_styles=[],_widgets=[],_title="",_ifId="",_domId="";function _storySetTitle(rawTitle){if(null==rawTitle)throw new Error("story title must not be null or undefined");var title=Util.unescape(String(rawTitle)).trim();if(""===title)throw new Error("story title must not be empty or consist solely of whitespace");if(document.title=_title=title,""===(_domId=Util.slugify(_title)))if(""!==_ifId)_domId=_ifId;else for(var i=0,len=_title.length;i<len;++i){var _Util$charAndPosAt2=Util.charAndPosAt(_title,i),char=_Util$charAndPosAt2.char,start=_Util$charAndPosAt2.start,end=_Util$charAndPosAt2.end;_domId+=char.codePointAt(0).toString(16),i+=end-start}}return Object.freeze(Object.defineProperties({},{load:{value:function(){var validationCodeTags=["init","widget"],validationNoCodeTagPassages=["PassageDone","PassageFooter","PassageHeader","PassageReady","StoryAuthor","StoryBanner","StoryCaption","StoryInit","StoryMenu","StoryShare","StorySubtitle"];function validateStartingPassage(passage){if(passage.tags.includesAny(validationCodeTags))throw new Error('starting passage "'.concat(passage.title,'" contains special tags; invalid: "').concat(passage.tags.filter((function(tag){return validationCodeTags.includes(tag)})).sort().join('", "'),'"'))}function validateSpecialPassages(passage){if(validationNoCodeTagPassages.includes(passage.title)){for(var _len19=arguments.length,tags=new Array(_len19>1?_len19-1:0),_key19=1;_key19<_len19;_key19++)tags[_key19-1]=arguments[_key19];throw new Error('special passage "'.concat(passage.title,'" contains special tags; invalid: "').concat(tags.sort().join('", "'),'"'))}var codeTags=[].concat(validationCodeTags),foundTags=[];if(passage.tags.forEach((function(tag){codeTags.includes(tag)&&foundTags.push.apply(foundTags,_toConsumableArray(codeTags.delete(tag)))})),foundTags.length>1)throw new Error('passage "'.concat(passage.title,'" contains multiple special tags; invalid: "').concat(foundTags.sort().join('", "'),'"'))}var $storydata=jQuery("tw-storydata"),startNode=$storydata.attr("startnode")||"";Config.passages.start=null,Config.debug=/\bdebug\b/.test($storydata.attr("options")),$storydata.children("style").each((function(i){_styles.push(new Passage("tw-user-style-".concat(i),this))})),$storydata.children("script").each((function(i){_scripts.push(new Passage("tw-user-script-".concat(i),this))})),$storydata.children('tw-passagedata:not([tags~="Twine.private"],[tags~="annotation"])').each((function(){var $this=jQuery(this),pid=$this.attr("pid")||"",passage=new Passage($this.attr("name"),this);pid===startNode&&""!==startNode?(Config.passages.start=passage.title,validateStartingPassage(passage),_passages[passage.title]=passage):passage.tags.includes("init")?(validateSpecialPassages(passage,"init"),_inits.push(passage)):passage.tags.includes("widget")?(validateSpecialPassages(passage,"widget"),_widgets.push(passage)):_passages[passage.title]=passage})),_ifId=$storydata.attr("ifid"),_storySetTitle("The Mage&#39;s Tower"),Config.saves.id=Story.domId}},init:{value:function(){var storyStyle;storyStyle=document.createElement("style"),new StyleWrapper(storyStyle).add(_styles.map((function(style){return style.text.trim()})).join("\n")),jQuery(storyStyle).appendTo(document.head).attr({id:"style-story",type:"text/css"});for(var i=0;i<_scripts.length;++i)try{Scripting.evalJavaScript(_scripts[i].text)}catch(ex){console.error(ex),Alert.error(_scripts[i].title,"object"===_typeof(ex)?ex.message:ex)}for(var _i8=0;_i8<_widgets.length;++_i8)try{Wikifier.wikifyEval(_widgets[_i8].processText())}catch(ex){console.error(ex),Alert.error(_widgets[_i8].title,"object"===_typeof(ex)?ex.message:ex)}}},title:{get:function(){return _title}},domId:{get:function(){return _domId}},ifId:{get:function(){return _ifId}},add:{value:function(passage){if(!(passage instanceof Passage))throw new TypeError("Story.add passage parameter must be an instance of Passage");var title=passage.title;return!_passages.hasOwnProperty(title)&&(_passages[title]=passage,!0)}},has:{value:function(title){var type=_typeof(title);switch(type){case"number":case"string":return _passages.hasOwnProperty(String(title));case"undefined":break;case"object":type=null===title?"null":"an object";break;default:type="a ".concat(type)}throw new TypeError("Story.has title parameter cannot be ".concat(type))}},get:{value:function(title){var type=_typeof(title);switch(type){case"number":case"string":var id=String(title);return _passages.hasOwnProperty(id)?_passages[id]:new Passage(id||"(unknown)");case"undefined":break;case"object":type=null===title?"null":"an object";break;default:type="a ".concat(type)}throw new TypeError("Story.get title parameter cannot be ".concat(type))}},getAllInit:{value:function(){return Object.freeze(Array.from(_inits))}},getAllRegular:{value:function(){return Object.freeze(Object.assign({},_passages))}},getAllScript:{value:function(){return Object.freeze(Array.from(_scripts))}},getAllStylesheet:{value:function(){return Object.freeze(Array.from(_styles))}},getAllWidget:{value:function(){return Object.freeze(Array.from(_widgets))}},lookup:{value:function(key,value){var sortKey=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"title",results=[];return Object.keys(_passages).forEach((function(name){var passage=_passages[name];"object"===_typeof(passage[key])&&null!==passage[key]?passage[key]instanceof Array&&passage[key].some((function(m){return Util.sameValueZero(m,value)}))&&results.push(passage):Util.sameValueZero(passage[key],value)&&results.push(passage)})),results.sort((function(a,b){return a[sortKey]==b[sortKey]?0:a[sortKey]<b[sortKey]?-1:1})),results}},lookupWith:{value:function(predicate){var sortKey=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"title";if("function"!=typeof predicate)throw new TypeError("Story.lookupWith predicate parameter must be a function");var results=[];return Object.keys(_passages).forEach((function(name){var passage=_passages[name];predicate(passage)&&results.push(passage)})),results.sort((function(a,b){return a[sortKey]==b[sortKey]?0:a[sortKey]<b[sortKey]?-1:1})),results}}}))}(),UI=function(){function uiAssembleLinkList(passage,listEl){var list=listEl,debugState=Config.debug,cleanState=Config.cleanupWikifierOutput;Config.debug=!1,Config.cleanupWikifierOutput=!1;try{null==list&&(list=document.createElement("ul"));var frag=document.createDocumentFragment();new Wikifier(frag,Story.get(passage).processText().trim());var errors=_toConsumableArray(frag.querySelectorAll(".error")).map((function(errEl){return errEl.textContent.replace(errorPrologRegExp,"")}));if(errors.length>0)throw new Error(errors.join("; "));for(;frag.hasChildNodes();){var node=frag.firstChild;if(node.nodeType===Node.ELEMENT_NODE&&"A"===node.nodeName.toUpperCase()){var li=document.createElement("li");list.appendChild(li),li.appendChild(node)}else frag.removeChild(node)}}finally{Config.cleanupWikifierOutput=cleanState,Config.debug=debugState}return list}function uiOpenAlert(message){jQuery(Dialog.setup(L10n.get("alertTitle"),"alert")).append("<p>".concat(message,'</p><ul class="buttons">')+'<li><button id="alert-ok" class="ui-close">'.concat(L10n.get(["alertOk","ok"]),"</button></li>")+"</ul>");for(var _len20=arguments.length,args=new Array(_len20>1?_len20-1:0),_key20=1;_key20<_len20;_key20++)args[_key20-1]=arguments[_key20];Dialog.open.apply(Dialog,args)}function uiBuildAutoload(){return jQuery(Dialog.setup(L10n.get("autoloadTitle"),"autoload")).append("<p>".concat(L10n.get("autoloadPrompt"),'</p><ul class="buttons">')+'<li><button id="autoload-ok" class="ui-close">'.concat(L10n.get(["autoloadOk","ok"]),"</button></li>")+'<li><button id="autoload-cancel" class="ui-close">'.concat(L10n.get(["autoloadCancel","cancel"]),"</button></li>")+"</ul>"),jQuery(document).one("click.autoload",".ui-close",(function(ev){var isAutoloadOk="autoload-ok"===ev.target.id;jQuery(document).one(":dialogclosed",(function(){isAutoloadOk&&Save.autosave.load()||Engine.play(Config.passages.start)}))})),!0}function uiBuildJumpto(){var list=document.createElement("ul");jQuery(Dialog.setup(L10n.get("jumptoTitle"),"jumpto list")).append(list);for(var expired=State.expired.length,i=State.size-1;i>=0;--i)if(i!==State.activeIndex){var passage=Story.get(State.history[i].title);passage&&passage.tags.includes("bookmark")&&jQuery(document.createElement("li")).append(jQuery(document.createElement("a")).ariaClick({one:!0},function(idx){return function(){return jQuery(document).one(":dialogclosed",(function(){return Engine.goTo(idx)}))}}(i)).addClass("ui-close").text("".concat(L10n.get("jumptoTurn")," ").concat(expired+i+1,": ").concat(passage.description()))).appendTo(list)}list.hasChildNodes()||jQuery(list).append("<li><a><em>".concat(L10n.get("jumptoUnavailable"),"</em></a></li>"))}function uiBuildRestart(){return jQuery(Dialog.setup(L10n.get("restartTitle"),"restart")).append("<p>".concat(L10n.get("restartPrompt"),'</p><ul class="buttons">')+'<li><button id="restart-ok">'.concat(L10n.get(["restartOk","ok"]),"</button></li>")+'<li><button id="restart-cancel" class="ui-close">'.concat(L10n.get(["restartCancel","cancel"]),"</button></li>")+"</ul>").find("#restart-ok").ariaClick({one:!0},(function(){jQuery(document).one(":dialogclosed",(function(){return Engine.restart()})),Dialog.close()})),!0}function uiBuildSaves(){var savesAllowed="function"!=typeof Config.saves.isAllowed||Config.saves.isAllowed();function createActionItem(bId,bClass,bText,bAction){var $btn=jQuery(document.createElement("button")).attr("id","saves-".concat(bId)).html(bText);return bClass&&$btn.addClass(bClass),bAction?$btn.ariaClick(bAction):$btn.ariaDisabled(!0),jQuery(document.createElement("li")).append($btn)}var $dialogBody=jQuery(Dialog.setup(L10n.get("savesTitle"),"saves")),savesOk=Save.ok(),fileOk=Has.fileAPI&&(Config.saves.tryDiskOnMobile||!Browser.isMobile.any());if(savesOk&&$dialogBody.append(function(){function createButton(bId,bClass,bText,bSlot,bAction){var $btn=jQuery(document.createElement("button")).attr("id","saves-".concat(bId,"-").concat(bSlot)).addClass(bId).html(bText);return bClass&&$btn.addClass(bClass),bAction?"auto"===bSlot?$btn.ariaClick({label:"".concat(bText," ").concat(L10n.get("savesLabelAuto"))},(function(){return bAction()})):$btn.ariaClick({label:"".concat(bText," ").concat(L10n.get("savesLabelSlot")," ").concat(bSlot+1)},(function(){return bAction(bSlot)})):$btn.ariaDisabled(!0),$btn}var saves=Save.get(),$tbody=jQuery(document.createElement("tbody"));if(Save.autosave.ok()){var $tdSlot=jQuery(document.createElement("td")),$tdLoad=jQuery(document.createElement("td")),$tdDesc=jQuery(document.createElement("td")),$tdDele=jQuery(document.createElement("td"));jQuery(document.createElement("b")).attr({title:L10n.get("savesLabelAuto"),"aria-label":L10n.get("savesLabelAuto")}).text("A").appendTo($tdSlot),saves.autosave?($tdLoad.append(createButton("load","ui-close",L10n.get("savesLabelLoad"),"auto",(function(){jQuery(document).one(":dialogclosed",(function(){return Save.autosave.load()}))}))),jQuery(document.createElement("div")).text(saves.autosave.title).appendTo($tdDesc),jQuery(document.createElement("div")).addClass("datestamp").html(saves.autosave.date?"".concat(new Date(saves.autosave.date).toLocaleString()):"<em>".concat(L10n.get("savesUnknownDate"),"</em>")).appendTo($tdDesc),$tdDele.append(createButton("delete",null,L10n.get("savesLabelDelete"),"auto",(function(){Save.autosave.delete(),uiBuildSaves()})))):($tdLoad.append(createButton("load",null,L10n.get("savesLabelLoad"),"auto")),$tdDesc.addClass("empty").text("•  •  •"),$tdDele.append(createButton("delete",null,L10n.get("savesLabelDelete"),"auto"))),jQuery(document.createElement("tr")).append($tdSlot).append($tdLoad).append($tdDesc).append($tdDele).appendTo($tbody)}for(var i=0,iend=saves.slots.length;i<iend;++i){var _$tdSlot=jQuery(document.createElement("td")),_$tdLoad=jQuery(document.createElement("td")),_$tdDesc=jQuery(document.createElement("td")),_$tdDele=jQuery(document.createElement("td"));_$tdSlot.append(document.createTextNode(i+1)),saves.slots[i]?(_$tdLoad.append(createButton("load","ui-close",L10n.get("savesLabelLoad"),i,(function(slot){jQuery(document).one(":dialogclosed",(function(){return Save.slots.load(slot)}))}))),jQuery(document.createElement("div")).text(saves.slots[i].title).appendTo(_$tdDesc),jQuery(document.createElement("div")).addClass("datestamp").html(saves.slots[i].date?"".concat(new Date(saves.slots[i].date).toLocaleString()):"<em>".concat(L10n.get("savesUnknownDate"),"</em>")).appendTo(_$tdDesc),_$tdDele.append(createButton("delete",null,L10n.get("savesLabelDelete"),i,(function(slot){Save.slots.delete(slot),uiBuildSaves()})))):(_$tdLoad.append(createButton("save","ui-close",L10n.get("savesLabelSave"),i,savesAllowed?Save.slots.save:null)),_$tdDesc.addClass("empty").text("•  •  •"),_$tdDele.append(createButton("delete",null,L10n.get("savesLabelDelete"),i))),jQuery(document.createElement("tr")).append(_$tdSlot).append(_$tdLoad).append(_$tdDesc).append(_$tdDele).appendTo($tbody)}return jQuery(document.createElement("table")).attr("id","saves-list").append($tbody)}()),savesOk||fileOk){var $btnBar=jQuery(document.createElement("ul")).addClass("buttons").appendTo($dialogBody);return fileOk&&($btnBar.append(createActionItem("export","ui-close",L10n.get("savesLabelExport"),savesAllowed?function(){return Save.export()}:null)),$btnBar.append(createActionItem("import",null,L10n.get("savesLabelImport"),(function(){return $dialogBody.find("#saves-import-file").trigger("click")}))),jQuery(document.createElement("input")).css({display:"block",visibility:"hidden",position:"fixed",left:"-9999px",top:"-9999px",width:"1px",height:"1px"}).attr({type:"file",id:"saves-import-file",tabindex:-1,"aria-hidden":!0}).on("change",(function(ev){jQuery(document).one(":dialogclosed",(function(){return Save.import(ev)})),Dialog.close()})).appendTo($dialogBody)),savesOk&&$btnBar.append(createActionItem("clear",null,L10n.get("savesLabelClear"),Save.autosave.has()||!Save.slots.isEmpty()?function(){Save.clear(),uiBuildSaves()}:null)),!0}return uiOpenAlert(L10n.get("savesIncapable")),!1}function uiBuildSettings(){var $dialogBody=jQuery(Dialog.setup(L10n.get("settingsTitle"),"settings"));return Setting.forEach((function(control){if(control.type===Setting.Types.Header){var _name=control.name,_id=Util.slugify(_name),$header=jQuery(document.createElement("div")),$heading=jQuery(document.createElement("h2"));return $header.attr("id","header-body-".concat(_id)).append($heading).appendTo($dialogBody),$heading.attr("id","header-heading-".concat(_id)).wiki(_name),void(control.desc&&jQuery(document.createElement("p")).attr("id","header-desc-".concat(_id)).wiki(control.desc).appendTo($header))}var $control,name=control.name,id=Util.slugify(name),$setting=jQuery(document.createElement("div")),$label=jQuery(document.createElement("label")),$controlBox=jQuery(document.createElement("div"));switch(jQuery(document.createElement("div")).append($label).append($controlBox).appendTo($setting),control.desc&&jQuery(document.createElement("p")).attr("id","setting-desc-".concat(id)).wiki(control.desc).appendTo($setting),$label.attr({id:"setting-label-".concat(id),for:"setting-control-".concat(id)}).wiki(control.label),null==settings[name]&&(settings[name]=control.default),control.type){case Setting.Types.Toggle:$control=jQuery(document.createElement("button")),settings[name]?$control.addClass("enabled").text(L10n.get("settingsOn")):$control.text(L10n.get("settingsOff")),$control.ariaClick((function(){settings[name]?(jQuery(this).removeClass("enabled").text(L10n.get("settingsOff")),settings[name]=!1):(jQuery(this).addClass("enabled").text(L10n.get("settingsOn")),settings[name]=!0),Setting.save(),control.hasOwnProperty("onChange")&&control.onChange.call({name:name,value:settings[name],default:control.default})}));break;case Setting.Types.List:$control=jQuery(document.createElement("select"));for(var i=0,iend=control.list.length;i<iend;++i)jQuery(document.createElement("option")).val(i).text(control.list[i]).appendTo($control);$control.val(control.list.indexOf(settings[name])).attr("tabindex",0).on("change",(function(){settings[name]=control.list[Number(this.value)],Setting.save(),control.hasOwnProperty("onChange")&&control.onChange.call({name:name,value:settings[name],default:control.default,list:control.list})}));break;case Setting.Types.Range:($control=jQuery(document.createElement("input"))).attr({type:"range",min:control.min,max:control.max,step:control.step,value:settings[name],tabindex:0}).on("change input",(function(){settings[name]=Number(this.value),Setting.save(),control.hasOwnProperty("onChange")&&control.onChange.call({name:name,value:settings[name],default:control.default,min:control.min,max:control.max,step:control.step})})).on("keypress",(function(ev){13===ev.which&&(ev.preventDefault(),$control.trigger("change"))}))}$control.attr("id","setting-control-".concat(id)).appendTo($controlBox),$setting.attr("id","setting-body-".concat(id)).appendTo($dialogBody)})),$dialogBody.append('<ul class="buttons">'+'<li><button id="settings-ok" class="ui-close">'.concat(L10n.get(["settingsOk","ok"]),"</button></li>")+'<li><button id="settings-reset">'.concat(L10n.get("settingsReset"),"</button></li>")+"</ul>").find("#settings-reset").ariaClick({one:!0},(function(){jQuery(document).one(":dialogclosed",(function(){Setting.reset(),window.location.reload()})),Dialog.close()})),!0}function uiBuildShare(){try{jQuery(Dialog.setup(L10n.get("shareTitle"),"share list")).append(uiAssembleLinkList("StoryShare"))}catch(ex){return console.error(ex),Alert.error("StoryShare",ex.message),!1}return!0}return Object.freeze(Object.defineProperties({},{assembleLinkList:{value:uiAssembleLinkList},alert:{value:uiOpenAlert},jumpto:{value:function(){uiBuildJumpto(),Dialog.open.apply(Dialog,arguments)}},restart:{value:function(){uiBuildRestart(),Dialog.open.apply(Dialog,arguments)}},saves:{value:function(){uiBuildSaves(),Dialog.open.apply(Dialog,arguments)}},settings:{value:function(){uiBuildSettings(),Dialog.open.apply(Dialog,arguments)}},share:{value:function(){uiBuildShare(),Dialog.open.apply(Dialog,arguments)}},buildAutoload:{value:uiBuildAutoload},buildJumpto:{value:uiBuildJumpto},buildRestart:{value:uiBuildRestart},buildSaves:{value:uiBuildSaves},buildSettings:{value:uiBuildSettings},buildShare:{value:uiBuildShare},stow:{value:function(){return UIBar.stow()}},unstow:{value:function(){return UIBar.unstow()}},setStoryElements:{value:function(){return UIBar.update()}},isOpen:{value:function(){return Dialog.isOpen.apply(Dialog,arguments)}},body:{value:function(){return Dialog.body()}},setup:{value:function(){return Dialog.setup.apply(Dialog,arguments)}},addClickHandler:{value:function(){return Dialog.addClickHandler.apply(Dialog,arguments)}},open:{value:function(){return Dialog.open.apply(Dialog,arguments)}},close:{value:function(){return Dialog.close.apply(Dialog,arguments)}},resize:{value:function(){return Dialog.resize()}},buildDialogAutoload:{value:uiBuildAutoload},buildDialogJumpto:{value:uiBuildJumpto},buildDialogRestart:{value:uiBuildRestart},buildDialogSaves:{value:uiBuildSaves},buildDialogSettings:{value:uiBuildSettings},buildDialogShare:{value:uiBuildShare},buildLinkListFromPassage:{value:uiAssembleLinkList}}))}(),UIBar=function(){var _$uiBar=null;function uiBarStow(noAnimation){var $story;_$uiBar&&!_$uiBar.hasClass("stowed")&&(noAnimation&&(($story=jQuery("#story")).addClass("no-transition"),_$uiBar.addClass("no-transition")),_$uiBar.addClass("stowed"),noAnimation&&setTimeout((function(){$story.removeClass("no-transition"),_$uiBar.removeClass("no-transition")}),Engine.minDomActionDelay));return this}function uiBarUpdate(){if(Story.has("StoryDisplayTitle")&&setDisplayTitle(Story.get("StoryDisplayTitle").processText()),_$uiBar){setPageElement("story-banner","StoryBanner"),setPageElement("story-subtitle","StorySubtitle"),setPageElement("story-author","StoryAuthor"),setPageElement("story-caption","StoryCaption");var menuStory=document.getElementById("menu-story");if(null!==menuStory&&(jQuery(menuStory).empty(),Story.has("StoryMenu")))try{UI.assembleLinkList("StoryMenu",menuStory)}catch(ex){console.error(ex),Alert.error("StoryMenu",ex.message)}}}return Object.freeze(Object.defineProperties({},{destroy:{value:function(){_$uiBar&&(_$uiBar.hide(),jQuery(document).off(".ui-bar"),jQuery(document.head).find("#style-ui-bar").remove(),_$uiBar.remove(),_$uiBar=null)}},hide:{value:function(){return _$uiBar&&_$uiBar.hide(),this}},init:{value:function(){if(!document.getElementById("ui-bar")){var toggleLabel,backwardLabel,jumptoLabel,forwardLabel,$backward,$forward,$elems=(toggleLabel=L10n.get("uiBarToggle"),backwardLabel=L10n.get("uiBarBackward"),jumptoLabel=L10n.get("uiBarJumpto"),forwardLabel=L10n.get("uiBarForward"),jQuery(document.createDocumentFragment()).append('<div id="ui-bar" aria-live="polite"><div id="ui-bar-tray">'+'<button id="ui-bar-toggle" tabindex="0" title="'.concat(toggleLabel,'" aria-label="').concat(toggleLabel,'"></button>')+'<div id="ui-bar-history">'+'<button id="history-backward" tabindex="0" title="'.concat(backwardLabel,'" aria-label="').concat(backwardLabel,'"></button>')+'<button id="history-jumpto" tabindex="0" title="'.concat(jumptoLabel,'" aria-label="').concat(jumptoLabel,'"></button>')+'<button id="history-forward" tabindex="0" title="'.concat(forwardLabel,'" aria-label="').concat(forwardLabel,'"></button>')+'</div></div><div id="ui-bar-body"><header id="title" role="banner"><div id="story-banner"></div><h1 id="story-title"></h1><div id="story-subtitle"></div><div id="story-title-separator"></div><p id="story-author"></p></header><div id="story-caption"></div><nav id="menu" role="navigation"><ul id="menu-story"></ul><ul id="menu-core">'+'<li id="menu-item-saves"><a tabindex="0">'.concat(L10n.get("savesTitle"),"</a></li>")+'<li id="menu-item-settings"><a tabindex="0">'.concat(L10n.get("settingsTitle"),"</a></li>")+'<li id="menu-item-restart"><a tabindex="0">'.concat(L10n.get("restartTitle"),"</a></li>")+'<li id="menu-item-share"><a tabindex="0">'.concat(L10n.get("shareTitle"),"</a></li>")+"</ul></nav></div></div>"));_$uiBar=jQuery($elems.find("#ui-bar").get(0)),$elems.insertBefore("body>script#script-sugarcube"),jQuery(document).on(":historyupdate.ui-bar",($backward=jQuery("#history-backward"),$forward=jQuery("#history-forward"),function(){$backward.ariaDisabled(State.length<2),$forward.ariaDisabled(State.length===State.size)}))}}},isHidden:{value:function(){return _$uiBar&&"none"===_$uiBar.css("display")}},isStowed:{value:function(){return _$uiBar&&_$uiBar.hasClass("stowed")}},show:{value:function(){return _$uiBar&&_$uiBar.show(),this}},start:{value:function(){_$uiBar&&(("boolean"==typeof Config.ui.stowBarInitially?Config.ui.stowBarInitially:jQuery(window).width()<=Config.ui.stowBarInitially)&&uiBarStow(!0),jQuery("#ui-bar-toggle").ariaClick({label:L10n.get("uiBarToggle")},(function(){return _$uiBar.toggleClass("stowed")})),Config.history.controls?(jQuery("#history-backward").ariaDisabled(State.length<2).ariaClick({label:L10n.get("uiBarBackward")},(function(){return Engine.backward()})),Story.lookup("tags","bookmark").length>0?jQuery("#history-jumpto").ariaClick({label:L10n.get("uiBarJumpto")},(function(){return UI.jumpto()})):jQuery("#history-jumpto").remove(),jQuery("#history-forward").ariaDisabled(State.length===State.size).ariaClick({label:L10n.get("uiBarForward")},(function(){return Engine.forward()}))):jQuery("#ui-bar-history").remove(),Story.has("StoryDisplayTitle")?setDisplayTitle(Story.get("StoryDisplayTitle").processText()):jQuery("#story-title").text(Story.title),Story.has("StoryCaption")||jQuery("#story-caption").remove(),Story.has("StoryMenu")||jQuery("#menu-story").remove(),Config.ui.updateStoryElements||uiBarUpdate(),jQuery("#menu-item-saves a").ariaClick({role:"button"},(function(ev){ev.preventDefault(),UI.buildSaves(),Dialog.open()})).text(L10n.get("savesTitle")),Setting.isEmpty()?jQuery("#menu-item-settings").remove():jQuery("#menu-item-settings a").ariaClick({role:"button"},(function(ev){ev.preventDefault(),UI.buildSettings(),Dialog.open()})).text(L10n.get("settingsTitle")),jQuery("#menu-item-restart a").ariaClick({role:"button"},(function(ev){ev.preventDefault(),UI.buildRestart(),Dialog.open()})).text(L10n.get("restartTitle")),Story.has("StoryShare")?jQuery("#menu-item-share a").ariaClick({role:"button"},(function(ev){ev.preventDefault(),UI.buildShare(),Dialog.open()})).text(L10n.get("shareTitle")):jQuery("#menu-item-share").remove())}},stow:{value:uiBarStow},unstow:{value:function(noAnimation){var $story;return _$uiBar&&_$uiBar.hasClass("stowed")&&(noAnimation&&(($story=jQuery("#story")).addClass("no-transition"),_$uiBar.addClass("no-transition")),_$uiBar.removeClass("stowed"),noAnimation&&setTimeout((function(){$story.removeClass("no-transition"),_$uiBar.removeClass("no-transition")}),Engine.minDomActionDelay)),this}},update:{value:uiBarUpdate},setStoryElements:{value:uiBarUpdate}}))}(),DebugBar=function(){var _variableRe=new RegExp("^".concat(Patterns.variable,"$")),_numericKeyRe=/^\d+$/,_watchList=[],_$debugBar=null,_$watchBody=null,_$watchList=null,_$turnSelect=null,_stowed=!0;function debugBarStow(){_$debugBar.css("right","-".concat(_$debugBar.outerWidth(),"px")),_stowed=!0,_updateSession()}function debugBarUnstow(){_$debugBar.css("right",0),_stowed=!1,_updateSession()}function debugBarToggle(){_stowed?debugBarUnstow():debugBarStow()}function debugBarWatchAdd(varName){_variableRe.test(varName)&&(_watchList.pushUnique(varName),_watchList.sort(),_updateWatchBody(),_updateWatchList(),_updateSession())}function debugBarWatchAddAll(){Object.keys(State.variables).map((function(name){return _watchList.pushUnique("$".concat(name))})),Object.keys(State.temporary).map((function(name){return _watchList.pushUnique("_".concat(name))})),_watchList.sort(),_updateWatchBody(),_updateWatchList(),_updateSession()}function debugBarWatchClear(){for(var i=_watchList.length-1;i>=0;--i)_watchList.pop();_updateWatchBody(),_updateWatchList(),_updateSession()}function debugBarWatchDelete(varName){_watchList.delete(varName),_updateWatchBody(),_updateWatchList(),_updateSession()}function debugBarWatchDisable(){_debugBarWatchDisableNoUpdate(),_updateSession()}function debugBarWatchEnable(){_debugBarWatchEnableNoUpdate(),_updateSession()}function debugBarWatchIsEnabled(){return!_$watchBody.attr("hidden")}function debugBarWatchToggle(){_$watchBody.attr("hidden")?debugBarWatchEnable():debugBarWatchDisable()}function _debugBarWatchDisableNoUpdate(){_$watchBody.attr({"aria-hidden":!0,hidden:"hidden"})}function _debugBarWatchEnableNoUpdate(){_$watchBody.removeAttr("aria-hidden hidden")}function _clearSession(){session.delete("debugState")}function _hasSession(){return session.has("debugState")}function _updateSession(){session.set("debugState",{stowed:_stowed,watchList:_watchList,watchEnabled:debugBarWatchIsEnabled(),viewsEnabled:DebugView.isEnabled()})}function _updateWatchBody(){if(0!==_watchList.length){for(var delLabel=L10n.get("debugBarDeleteWatch"),$table=jQuery(document.createElement("table")),$tbody=jQuery(document.createElement("tbody")),_loop4=function(i,len){var varName=_watchList[i],varKey=varName.slice(1),store="$"===varName[0]?State.variables:State.temporary,$row=jQuery(document.createElement("tr")),$delBtn=jQuery(document.createElement("button")),$code=jQuery(document.createElement("code"));$delBtn.addClass("watch-delete").attr("data-name",varName).ariaClick({one:!0,label:delLabel},(function(){return debugBarWatchDelete(varName)})),$code.text(_toWatchString(store[varKey])),jQuery(document.createElement("td")).append($delBtn).appendTo($row),jQuery(document.createElement("td")).text(varName).appendTo($row),jQuery(document.createElement("td")).append($code).appendTo($row),$row.appendTo($tbody)},i=0,len=_watchList.length;i<len;++i)_loop4(i);$table.append($tbody),_$watchBody.empty().append($table)}else _$watchBody.empty().append("<div>".concat(L10n.get("debugBarNoWatches"),"</div>"))}function _updateWatchList(){var svn=Object.keys(State.variables),tvn=Object.keys(State.temporary);if(0!==svn.length||0!==tvn.length){var names=[].concat(_toConsumableArray(svn.map((function(name){return"$".concat(name)}))),_toConsumableArray(tvn.map((function(name){return"_".concat(name)})))).sort(),options=document.createDocumentFragment();names.delete(_watchList);for(var i=0,len=names.length;i<len;++i)jQuery(document.createElement("option")).val(names[i]).appendTo(options);_$watchList.empty().append(options)}else _$watchList.empty()}function _updateTurnSelect(){for(var histLen=State.size,expLen=State.expired.length,options=document.createDocumentFragment(),i=0;i<histLen;++i)jQuery(document.createElement("option")).val(i).text("".concat(expLen+i+1,". ").concat(Util.escape(State.history[i].title))).appendTo(options);_$turnSelect.empty().ariaDisabled(histLen<2).append(options).val(State.activeIndex)}function _toWatchString(value){if(null===value)return"null";switch(_typeof(value)){case"number":if(Number.isNaN(value))return"NaN";if(!Number.isFinite(value))return"Infinity";case"boolean":case"symbol":case"undefined":return String(value);case"string":return JSON.stringify(value);case"function":return"Function"}var objType=Util.toStringTag(value);if("Date"===objType)return"Date {".concat(value.toLocaleString(),"}");if("RegExp"===objType)return"RegExp ".concat(value.toString());var result=[];if(value instanceof Array||value instanceof Set){for(var list=value instanceof Array?value:Array.from(value),i=0,len=list.length;i<len;++i)result.push(list.hasOwnProperty(i)?_toWatchString(list[i]):"<empty>");return Object.keys(list).filter((function(key){return!_numericKeyRe.test(key)})).forEach((function(key){return result.push("".concat(_toWatchString(key),": ").concat(_toWatchString(list[key])))})),"".concat(objType,"(").concat(list.length,") [").concat(result.join(", "),"]")}return value instanceof Map?(value.forEach((function(val,key){return result.push("".concat(_toWatchString(key)," → ").concat(_toWatchString(val)))})),"".concat(objType,"(").concat(value.size,") {").concat(result.join(", "),"}")):(Object.keys(value).forEach((function(key){return result.push("".concat(_toWatchString(key),": ").concat(_toWatchString(value[key])))})),"".concat(objType," {").concat(result.join(", "),"}"))}return Object.freeze(Object.defineProperties({},{init:{value:function(){var barToggleLabel=L10n.get("debugBarToggle"),watchAddLabel=L10n.get("debugBarAddWatch"),watchAllLabel=L10n.get("debugBarWatchAll"),watchNoneLabel=L10n.get("debugBarWatchNone"),watchToggleLabel=L10n.get("debugBarWatchToggle"),viewsToggleLabel=L10n.get("debugBarViewsToggle");jQuery(document.createDocumentFragment()).append('<div id="debug-bar"><div id="debug-bar-watch">'+"<div>".concat(L10n.get("debugBarNoWatches"),"</div>>")+"</div><div>"+'<button id="debug-bar-watch-toggle" tabindex="0" title="'.concat(watchToggleLabel,'" aria-label="').concat(watchToggleLabel,'">').concat(L10n.get("debugBarLabelWatch"),"</button>")+'<label id="debug-bar-watch-label" for="debug-bar-watch-input">'.concat(L10n.get("debugBarLabelAdd"),"</label>")+'<input id="debug-bar-watch-input" name="debug-bar-watch-input" type="text" list="debug-bar-watch-list" tabindex="0"><datalist id="debug-bar-watch-list" aria-hidden="true" hidden="hidden"></datalist>'+'<button id="debug-bar-watch-add" tabindex="0" title="'.concat(watchAddLabel,'" aria-label="').concat(watchAddLabel,'"></button>')+'<button id="debug-bar-watch-all" tabindex="0" title="'.concat(watchAllLabel,'" aria-label="').concat(watchAllLabel,'"></button>')+'<button id="debug-bar-watch-none" tabindex="0" title="'.concat(watchNoneLabel,'" aria-label="').concat(watchNoneLabel,'"></button>')+"</div><div>"+'<button id="debug-bar-views-toggle" tabindex="0" title="'.concat(viewsToggleLabel,'" aria-label="').concat(viewsToggleLabel,'">').concat(L10n.get("debugBarLabelViews"),"</button>")+'<label id="debug-bar-turn-label" for="debug-bar-turn-select">'.concat(L10n.get("debugBarLabelTurn"),"</label>")+'<select id="debug-bar-turn-select" tabindex="0"></select></div>'+'<button id="debug-bar-toggle" tabindex="0" title="'.concat(barToggleLabel,'" aria-label="').concat(barToggleLabel,'"></button>')+'</div><div id="debug-bar-hint"></div>').appendTo("body"),_$debugBar=jQuery("#debug-bar"),_$watchBody=jQuery(_$debugBar.find("#debug-bar-watch").get(0)),_$watchList=jQuery(_$debugBar.find("#debug-bar-watch-list").get(0)),_$turnSelect=jQuery(_$debugBar.find("#debug-bar-turn-select").get(0));var $barToggle=jQuery(_$debugBar.find("#debug-bar-toggle").get(0)),$watchToggle=jQuery(_$debugBar.find("#debug-bar-watch-toggle").get(0)),$watchInput=jQuery(_$debugBar.find("#debug-bar-watch-input").get(0)),$watchAdd=jQuery(_$debugBar.find("#debug-bar-watch-add").get(0)),$watchAll=jQuery(_$debugBar.find("#debug-bar-watch-all").get(0)),$watchNone=jQuery(_$debugBar.find("#debug-bar-watch-none").get(0)),$viewsToggle=jQuery(_$debugBar.find("#debug-bar-views-toggle").get(0));$barToggle.ariaClick(debugBarToggle),$watchToggle.ariaClick(debugBarWatchToggle),$watchInput.on(":addwatch",(function(){debugBarWatchAdd(this.value.trim()),this.value=""})).on("keypress",(function(ev){13===ev.which&&(ev.preventDefault(),$watchInput.trigger(":addwatch"))})),$watchAdd.ariaClick((function(){return $watchInput.trigger(":addwatch")})),$watchAll.ariaClick(debugBarWatchAddAll),$watchNone.ariaClick(debugBarWatchClear),_$turnSelect.on("change",(function(){Engine.goTo(Number(this.value))})),$viewsToggle.ariaClick((function(){DebugView.toggle(),_updateSession()})),jQuery(document).on(":historyupdate.debug-bar",_updateTurnSelect).on(":passageend.debug-bar",(function(){_updateWatchBody(),_updateWatchList()})).on(":enginerestart.debug-bar",_clearSession),_hasSession()||DebugView.enable()}},isStowed:{value:function(){return _stowed}},start:{value:function(){(function(){if(!_hasSession())return!1;var debugState=session.get("debugState");_stowed=debugState.stowed,_watchList.push.apply(_watchList,_toConsumableArray(debugState.watchList)),debugState.watchEnabled?_debugBarWatchEnableNoUpdate():_debugBarWatchDisableNoUpdate();debugState.viewsEnabled?DebugView.enable():DebugView.disable()})(),_stowed?debugBarStow():debugBarUnstow(),_updateTurnSelect(),_updateWatchBody(),_updateWatchList()}},stow:{value:debugBarStow},toggle:{value:debugBarToggle},unstow:{value:debugBarUnstow},watch:{value:Object.freeze(Object.defineProperties({},{add:{value:debugBarWatchAdd},all:{value:debugBarWatchAddAll},clear:{value:debugBarWatchClear},delete:{value:debugBarWatchDelete},disable:{value:debugBarWatchDisable},enable:{value:debugBarWatchEnable},isEnabled:{value:debugBarWatchIsEnabled},toggle:{value:debugBarWatchToggle}}))}}))}(),LoadScreen=function(){var _locks=new Set,_autoId=0;function loadScreenHide(){jQuery(document.documentElement).removeAttr("data-init")}function loadScreenShow(){jQuery(document.documentElement).attr("data-init","loading")}return Object.freeze(Object.defineProperties({},{init:{value:function(){jQuery(document).on("readystatechange.SugarCube",(function(){_locks.size>0||("complete"===document.readyState?"loading"===jQuery(document.documentElement).attr("data-init")&&(Config.loadDelay>0?setTimeout((function(){0===_locks.size&&loadScreenHide()}),Math.max(Engine.minDomActionDelay,Config.loadDelay)):loadScreenHide()):loadScreenShow())}))}},clear:{value:function(){jQuery(document).off("readystatechange.SugarCube"),_locks.clear(),loadScreenHide()}},hide:{value:loadScreenHide},show:{value:loadScreenShow},lock:{value:function(){return++_autoId,_locks.add(_autoId),loadScreenShow(),_autoId}},unlock:{value:function(id){if(null==id)throw new Error("LoadScreen.unlock called with a null or undefined ID");_locks.has(id)&&_locks.delete(id),0===_locks.size&&jQuery(document).trigger("readystatechange")}}}))}(),version=Object.freeze({title:"SugarCube",major:2,minor:36,patch:1,prerelease:null,build:9717,date:new Date("2021-12-22T05:37:33.467Z"),extensions:{},toString:function(){var prerelease=this.prerelease?"-".concat(this.prerelease):"";return"".concat(this.major,".").concat(this.minor,".").concat(this.patch).concat(prerelease,"+").concat(this.build)},short:function(){var prerelease=this.prerelease?"-".concat(this.prerelease):"";return"".concat(this.title," (v").concat(this.major,".").concat(this.minor,".").concat(this.patch).concat(prerelease,")")},long:function(){return"".concat(this.title," v").concat(this.toString()," (").concat(this.date.toUTCString(),")")}}),TempState={},macros={},postdisplay={},postrender={},predisplay={},prehistory={},prerender={},session=null,settings={},setup={},storage=null,browser=Browser,config=Config,has=Has,History=State,state=State,tale=Story,TempVariables=State.temporary;window.SugarCube={},jQuery((function(){try{var lockId=LoadScreen.lock();LoadScreen.init(),document.normalize&&document.normalize(),Story.load(),storage=SimpleStore.create(Story.domId,!0),session=SimpleStore.create(Story.domId,!1),Dialog.init(),UIBar.init(),Engine.init(),Story.init(),L10n.init(),session.has("rcWarn")||"cookie"!==storage.name||(session.set("rcWarn",1),window.alert(L10n.get("warningNoWebStorage"))),Save.init(),Setting.init(),Macro.init(),Engine.start(),Config.debug&&DebugBar.init();var $window=$(window),vprCheckId=setInterval((function(){$window.width()&&(clearInterval(vprCheckId),UIBar.start(),Config.debug&&DebugBar.start(),jQuery.event.trigger({type:":storyready"}),setTimeout((function(){return LoadScreen.unlock(lockId)}),2*Engine.minDomActionDelay))}),Engine.minDomActionDelay);Object.defineProperty(window,"SugarCube",{value:Object.seal(Object.assign(Object.create(null),{Browser:Browser,Config:Config,Dialog:Dialog,Engine:Engine,Fullscreen:Fullscreen,Has:Has,L10n:L10n,Macro:Macro,Passage:Passage,Save:Save,Scripting:Scripting,Setting:Setting,SimpleAudio:SimpleAudio,State:State,Story:Story,UI:UI,UIBar:UIBar,DebugBar:DebugBar,Util:Util,Visibility:Visibility,Wikifier:Wikifier,session:session,settings:settings,setup:setup,storage:storage,version:version}))})}catch(ex){return console.error(ex),LoadScreen.clear(),Alert.fatal(null,ex.message,ex)}}))})(window,window.document,jQuery);}
	</script>
</body>
</html>
